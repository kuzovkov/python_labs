Content-Type: multipart/related; start=<op.mhtml.1383077451591.251e681f345c404a@192.168.0.100>; boundary=----------JT9IxdzOAbzruBfpUSKiDX
Content-Location: http://pygame.info/docs/tut/SpriteIntro.html
Subject: =?utf-8?Q?Pygame=20Tutorials=20-=20Sprite=20Module=20Introduction=20=E2=80=94=20Pygame=20v1.9.2=20documentation?=
MIME-Version: 1.0

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=SpriteIntro.html
Content-Type: text/html; charset=utf-8; name=SpriteIntro.html
Content-ID: <op.mhtml.1383077451591.251e681f345c404a@192.168.0.100>
Content-Location: http://pygame.info/docs/tut/SpriteIntro.html
Content-Transfer-Encoding: 8bit

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pygame Tutorials - Sprite Module Introduction &mdash; Pygame v1.9.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/pygame.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.9.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/pygame.ico"/>
    <link rel="top" title="Pygame v1.9.2 documentation" href="../index.html" /> 
  </head>
  <body>  

    <div class="document">

  <div class="header">
    <table>
      <tr>
	<td class="logo">
	  <a href="http://www.pygame.org/">
	    <img src="../_static/pygame_tiny.png"/>
	  </a>
	  <h5>pygame documentation</h5>
	</td>
	<td class="pagelinks">
	  <p class="top">
	    <a href="http://www.pygame.org/">Pygame Home</a> ||
	    <a href="../index.html">Help Contents</a> ||
	    <a href="../genindex.html">Reference Index</a>
	  </p>
	  <p class="bottom">
	    <a href="../ref/camera.html">camera</a> | 
	    <a href="../ref/cdrom.html">cdrom</a> | 
	    <a href="../ref/color.html">Color</a> | 
	    <a href="../ref/cursors.html">cursors</a> | 
	    <a href="../ref/display.html">display</a> | 
	    <a href="../ref/draw.html">draw</a> | 
	    <a href="../ref/event.html">event</a> | 
	    <a href="../ref/examples.html">examples</a> | 
	    <a href="../ref/font.html">font</a> | 
	    <a href="../ref/freetype.html">freetype</a> | 
	    <a href="../ref/gfxdraw.html">gfxdraw</a> | 
	    <a href="../ref/image.html">image</a> | 
	    <a href="../ref/joystick.html">joystick</a> | 
	    <a href="../ref/key.html">key</a> | 
	    <a href="../ref/locals.html">locals</a> | 
	    <a href="../ref/mask.html">mask</a> | 
	    <a href="../ref/math.html">math</a> | 
	    <a href="../ref/midi.html">midi</a> | 
	    <a href="../ref/mixer.html">mixer</a> | 
	    <a href="../ref/mouse.html">mouse</a> | 
	    <a href="../ref/movie.html">movie</a> | 
	    <a href="../ref/music.html">music</a> | 
	    <a href="../ref/overlay.html">Overlay</a> | 
	    <a href="../ref/pixelarray.html">PixelArray</a> | 
	    <a href="../ref/pixelcopy.html">pixelcopy</a> | 
	    <a href="../ref/pygame.html">pygame</a> | 
	    <a href="../ref/rect.html">Rect</a> | 
	    <a href="../ref/scrap.html">scrap</a> | 
	    <a href="../ref/sndarray.html">sndarray</a> | 
	    <a href="../ref/sprite.html">sprite</a> | 
	    <a href="../ref/surface.html">Surface</a> | 
	    <a href="../ref/surfarray.html">surfarray</a> | 
	    <a href="../ref/tests.html">tests</a> | 
	    <a href="../ref/time.html">time</a> | 
	    <a href="../ref/transform.html">transform</a> | 
	    <a href="../ref/pygame.html#module-pygame.version">version</a>
	  </p>
	</td>
      </tr>
    </table>
  </div>

      <div class="documentwrapper">
          <div class="body">
            
  <div class="sectionwrapper">
    <h1>Pygame Tutorials - Sprite Module Introduction</h1>
<div class="section" id="pygame-tutorials-sprite-module-introduction">
<p>by Pete Shinners &lt;<a class="reference external" href="mailto:pete&#37;&#52;&#48;shinners&#46;org">pete<span>&#64;</span>shinners<span>&#46;</span>org</a>&gt;</p>
<p>Revision 1.1, April 12th, 2002</p>
<p>Pygame version 1.3 comes with a new module, <tt class="docutils literal"><span class="pre">pygame.sprite</span></tt>. This module is
written in python and includes some higher level classes to manage your game
objects. By using this module to its full potential, you can easily manage and
draw your game objects. The sprite classes are very optimized, so it&#8217;s likely
your game will run faster with the sprite module than without.</p>
<p>The sprite module is also meant to be very generic. It turns out you can use it
with nearly any type of gameplay. All this flexibility comes with a slight
penalty, it needs a little understanding to properly use it. The
<a class="reference internal" href="../ref/sprite.html#module-pygame.sprite" title="pygame.sprite: pygame module with basic game object classes"><tt class="xref py py-mod docutils literal"><span class="pre">reference</span> <span class="pre">documentation</span></tt></a> for the sprite module can keep
you running, but you&#8217;ll probably need a bit more explanation of how to use
:mod:pygame.sprite in your own game.</p>
<p>Several of the pygame examples (like &#8220;chimp&#8221; and &#8220;aliens&#8221;) have been updated to
use the sprite module. You may want to look into those first to see what this
sprite module is all about. The chimp module even has it&#8217;s own line-by-line
tutorial, which may help get more an understanding of programming with python
and pygame.</p>
<p>Note that this introduction will assume you have a bit of experience
programming with python, and are somewhat framiliar with the different parts of
creating a simple game.  In this tutorial the word &#8220;reference&#8221; is occasionally
used.  This represents a python variable. Variables in python are references,
so you can have several variables all pointing to the same object.</p>
<div class="section" id="history-lesson">
<h2>History Lesson<a class="headerlink" href="#history-lesson" title="Permalink to this headline">¶</a></h2>
<p>The term &#8220;sprite&#8221; is a holdover from older computer and game machines.  These
older boxes were unable to draw and erase normal graphics fast enough for them
to work as games. These machines had special hardware to handle game like
objects that needed to animate very quickly. These objects were called
&#8220;sprites&#8221; and had special limitations, but could be drawn and updated very
fast. They usually existed in special overlay buffers in the video.  These days
computers have become generally fast enough to handle sprite like objects
without dedicated hardware. The term sprite is still used to represent just
about anything in a 2D game that is animated.</p>
</div>
<div class="section" id="the-classes">
<h2>The Classes<a class="headerlink" href="#the-classes" title="Permalink to this headline">¶</a></h2>
<p>The sprite module comes with two main classes. The first is <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Sprite" title="pygame.sprite.Sprite"><tt class="xref py py-class docutils literal"><span class="pre">Sprite</span></tt></a>, which should be used as a base class for all your game
objects. This class doesn&#8217;t really do anything on its own, it just includes
several functions to help manage the game object. The other type of class is
<a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group" title="pygame.sprite.Group"><tt class="xref py py-class docutils literal"><span class="pre">Group</span></tt></a>. The <tt class="docutils literal"><span class="pre">Group</span></tt> class is a container for
different <tt class="docutils literal"><span class="pre">Sprite</span></tt> objects. There are actually several different types of
group classes. Some of the <tt class="docutils literal"><span class="pre">Groups</span></tt> can draw all the elements they contain,
for example.</p>
<p>This is all there really is to it. We&#8217;ll start with a description of what each
type of class does, and then discuss the proper ways to use these two classes.</p>
</div>
<div class="section" id="the-sprite-class">
<h2>The Sprite Class<a class="headerlink" href="#the-sprite-class" title="Permalink to this headline">¶</a></h2>
<p>As mentioned before, the Sprite class is designed to be a base class for all
your game objects. You cannot really use it on its own, as it only has several
methods to help it work with the different <tt class="docutils literal"><span class="pre">Group</span></tt> classes. The sprite keeps
track of which groups it belongs to. The class constructor (<tt class="xref py py-func docutils literal"><span class="pre">__init__</span></tt> method) takes an argument of a <tt class="docutils literal"><span class="pre">Group</span></tt> (or
list of <tt class="docutils literal"><span class="pre">Groups</span></tt>) the <tt class="docutils literal"><span class="pre">Sprite</span></tt> instance should belong to. You can also
change the <tt class="docutils literal"><span class="pre">Group</span></tt> membership for the <tt class="docutils literal"><span class="pre">Sprite</span></tt> with the <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Sprite.add" title="pygame.sprite.Sprite.add"><tt class="xref py py-func docutils literal"><span class="pre">add()</span></tt></a> and <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Sprite.remove" title="pygame.sprite.Sprite.remove"><tt class="xref py py-func docutils literal"><span class="pre">remove()</span></tt></a>
methods.  There is also a <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Sprite.groups" title="pygame.sprite.Sprite.groups"><tt class="xref py py-func docutils literal"><span class="pre">groups()</span></tt></a>
method, which returns a list of the current groups containing the sprite.</p>
<p>When using the your Sprite classes it&#8217;s best to think of them as &#8220;valid&#8221; or
&#8220;alive&#8221; when they are belonging to one or more <tt class="docutils literal"><span class="pre">Groups</span></tt>. When you remove the
instance from all groups pygame will clean up the object. (Unless you have your
own references to the instance somewhere else.) The <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Sprite.kill" title="pygame.sprite.Sprite.kill"><tt class="xref py py-func docutils literal"><span class="pre">kill()</span></tt></a> method removes the sprite from all groups it
belongs to. This will cleanly delete the sprite object. If you&#8217;ve put some
little games together, you&#8217;ll know sometimes cleanly deleting a game object can
be tricky. The sprite also comes with an <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Sprite.alive" title="pygame.sprite.Sprite.alive"><tt class="xref py py-func docutils literal"><span class="pre">alive()</span></tt></a> method, which returns true if it is still a
member of any groups.</p>
</div>
<div class="section" id="the-group-class">
<h2>The Group Class<a class="headerlink" href="#the-group-class" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">Group</span></tt> class is just a simple container. Similar to the sprite, it has
an <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group.add" title="pygame.sprite.Group.add"><tt class="xref py py-func docutils literal"><span class="pre">add()</span></tt></a> and <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group.remove" title="pygame.sprite.Group.remove"><tt class="xref py py-func docutils literal"><span class="pre">remove()</span></tt></a> method which can change which sprites belong to
the group. You also can pass a sprite or list of sprites to the constructor
(<tt class="xref py py-func docutils literal"><span class="pre">__init__()</span></tt> method) to create a <tt class="docutils literal"><span class="pre">Group</span></tt>
instance that contains some initial sprites.</p>
<p>The <tt class="docutils literal"><span class="pre">Group</span></tt> has a few other methods like <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group.empty" title="pygame.sprite.Group.empty"><tt class="xref py py-func docutils literal"><span class="pre">empty()</span></tt></a> to remove all sprites from the group and
<a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group.copy" title="pygame.sprite.Group.copy"><tt class="xref py py-func docutils literal"><span class="pre">copy()</span></tt></a> which will return a copy of the group
with all the same members. Also the <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group.has" title="pygame.sprite.Group.has"><tt class="xref py py-func docutils literal"><span class="pre">has()</span></tt></a>
method will quickly check if the <tt class="docutils literal"><span class="pre">Group</span></tt> contains a sprite or list of
sprites.</p>
<p>The other function you will use frequently is the <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group.sprites" title="pygame.sprite.Group.sprites"><tt class="xref py py-func docutils literal"><span class="pre">sprites()</span></tt></a> method. This returns an object that can be
looped on to access every sprite the group contains.  Currently this is just a
list of the sprites, but in later version of python this will likely use
iterators for better performance.</p>
<p>As a shortcut, the <tt class="docutils literal"><span class="pre">Group</span></tt> also has an <a class="reference internal" href="../ref/sprite.html#pygame.sprite.Group.update" title="pygame.sprite.Group.update"><tt class="xref py py-func docutils literal"><span class="pre">update()</span></tt></a> method, which will call an <tt class="docutils literal"><span class="pre">update()</span></tt> method on
every sprite in the group. Passing the same arguments to each one. Usually in a
game you need some function that updates the state of a game object. It&#8217;s very
easy to call your own methods using the <tt class="docutils literal"><span class="pre">Group.sprites()</span></tt> method, but this is
a shortcut that&#8217;s used enough to be included. Also note that the base
<tt class="docutils literal"><span class="pre">Sprite</span></tt> class has a &#8220;dummy&#8221; <tt class="docutils literal"><span class="pre">update()</span></tt> method that takes any sort of
arguments and does nothing.</p>
<p>Lastly, the Group has a couple other methods that allow you to use it with
the builtin <tt class="docutils literal"><span class="pre">len()</span></tt> function, getting the number of sprites it contains, and
the &#8220;truth&#8221; operator, which allows you to do &#8220;if mygroup:&#8221; to check if the
group has any sprites.</p>
</div>
<div class="section" id="mixing-them-together">
<h2>Mixing Them Together<a class="headerlink" href="#mixing-them-together" title="Permalink to this headline">¶</a></h2>
<p>At this point the two classes seem pretty basic. Not doing a lot more than you
can do with a simple list and your own class of game objects. But there are
some big advantages to using the <tt class="docutils literal"><span class="pre">Sprite</span></tt> and <tt class="docutils literal"><span class="pre">Group</span></tt> together. A sprite
can belong to as many groups as you want. Remember as soon as it belongs to no
groups, it will usually be cleared up (unless you have other &#8220;non-group&#8221;
references to that object).</p>
<p>The first big thing is a fast simple way to categorize sprites. For example,
say we had a Pacman-like game. We could make separate groups for the different
types of objects in the game. Ghosts, Pac, and Pellets. When Pac eats a power
pellet, we can change the state for all ghost objects by effecting everything
in the Ghost group. This is quicker and simpler than looping through a list
of all the game objects and checking which ones are ghosts.</p>
<p>Adding and removing groups and sprites from each other is a very fast
operation, quicker than using lists to store everything. Therefore you can very
efficiently change group memberships. Groups can be used to work like simple
attributes for each game object. Instead of tracking some attribute like
&#8220;close_to_player&#8221; for a bunch of enemy objects, you could add them to a
separate group. Then when you need to access all the enemies that are near the
player, you already have a list of them, instead of going through a list of all
the enemies, checking for the &#8220;close_to_player&#8221; flag. Later on your game could
add multiple players, and instead of adding more &#8220;close_to_player2&#8221;,
&#8220;close_to_player3&#8221; attributes, you can easily add them to different groups or
each player.</p>
<p>Another important benefit of using the <tt class="docutils literal"><span class="pre">Sprites</span></tt> and <tt class="docutils literal"><span class="pre">Groups</span></tt>, the groups
cleanly handle the deleting (or killing) of game objects. In a game where many
objects are referencing other objects, sometimes deleting an object can be the
hardest part, since it can&#8217;t go away until it is not referenced by anyone. Say
we have an object that is &#8220;chasing&#8221; another object. The chaser can keep a
simple Group that references the object (or objects) it is chasing. If the
object being chased happens to be destroyed, we don&#8217;t need to worry about
notifying the chaser to stop chasing. The chaser can see for itself that its
group is now empty, and perhaps find a new target.</p>
<p>Again, the thing to remember is that adding and removing sprites from groups is
a very cheap/fast operation. You may be best off by adding many groups to
contain and organize your game objects. Some could even be empty for large
portions of the game, there isn&#8217;t any penalties for managing your game like
this.</p>
</div>
<div class="section" id="the-many-group-types">
<h2>The Many Group Types<a class="headerlink" href="#the-many-group-types" title="Permalink to this headline">¶</a></h2>
<p>The above examples and reasons to use <tt class="docutils literal"><span class="pre">Sprites</span></tt> and <tt class="docutils literal"><span class="pre">Groups</span></tt> are only a tip
of the iceberg. Another advantage is that the sprite module comes with several
different types of <tt class="docutils literal"><span class="pre">Groups</span></tt>. These groups all work just like a regular old
<tt class="docutils literal"><span class="pre">Group</span></tt>, but they also have added functionality (or slightly different
functionality).  Here&#8217;s a list of the <tt class="docutils literal"><span class="pre">Group</span></tt> classes included with the
sprite module.</p>
<div class="section" id="group">
<h3>Group<a class="headerlink" href="#group" title="Permalink to this headline">¶</a></h3>
<p>This is the standard &#8220;no frills&#8221; group mainly explained above. Most of the
other <tt class="docutils literal"><span class="pre">Groups</span></tt> are derived from this one, but not all.</p>
</div>
<div class="section" id="groupsingle">
<h3>GroupSingle<a class="headerlink" href="#groupsingle" title="Permalink to this headline">¶</a></h3>
<p>This works exactly like the regular <tt class="docutils literal"><span class="pre">Group</span></tt> class, but it only contains
the most recently added sprite. Therefore when you add a sprite to this group,
it &#8220;forgets&#8221; about any previous sprites it had. Therefore it always contains
only one or zero sprites.</p>
</div>
<div class="section" id="renderplain">
<h3>RenderPlain<a class="headerlink" href="#renderplain" title="Permalink to this headline">¶</a></h3>
<p>This is a standard group derived from <tt class="docutils literal"><span class="pre">Group</span></tt>. It has a draw() method
that draws all the sprites it contains to the screen (or any <tt class="docutils literal"><span class="pre">Surface</span></tt>). For
this to work, it requires all sprites it contains to have a &#8220;image&#8221; and &#8220;rect&#8221;
attributes. It uses these to know what to blit, and where to blit it.</p>
</div>
<div class="section" id="renderclear">
<h3>RenderClear<a class="headerlink" href="#renderclear" title="Permalink to this headline">¶</a></h3>
<p>This is derived from the <tt class="docutils literal"><span class="pre">RenderPlain</span></tt> group, and adds a method named
<tt class="docutils literal"><span class="pre">clear()</span></tt>. This will erase the previous position of all drawn sprites. It
uses a background image to fill in the areas where the sprite were. It is smart
enough to handle deleted sprites and properly clear them from the screen when
the <tt class="docutils literal"><span class="pre">clear()</span></tt> method is called.</p>
</div>
<div class="section" id="renderupdates">
<h3>RenderUpdates<a class="headerlink" href="#renderupdates" title="Permalink to this headline">¶</a></h3>
<p>This is the cadillac of rendering <tt class="docutils literal"><span class="pre">Groups</span></tt>. It is inherited from
<tt class="docutils literal"><span class="pre">RenderClear</span></tt>, but changes the <tt class="docutils literal"><span class="pre">draw()</span></tt> method to also return a list of
pygame <tt class="docutils literal"><span class="pre">Rects</span></tt>, which represent all the areas on screen that have been
changed.</p>
<p>That is the list of different groups available We&#8217;ll discuss more about these
rendering groups in the next section. There&#8217;s nothing stopping you from
creating your own Group classes as well. They are just python code, so you can
inherit from one of these and add/change whatever you want. In the future I
hope we can add a couple more <tt class="docutils literal"><span class="pre">Groups</span></tt> to this list. A <tt class="docutils literal"><span class="pre">GroupMulti</span></tt> which
is like the <tt class="docutils literal"><span class="pre">GroupSingle</span></tt>, but can hold up to a given number of sprites (in
some sort of circular buffer?). Also a super-render group that can clear the
position of the old sprites without needing a background image to do it (by
grabbing a copy of the screen before blitting). Who knows really, but in the
future we can add more useful classes to this list.</p>
</div>
</div>
<div class="section" id="the-rendering-groups">
<h2>The Rendering Groups<a class="headerlink" href="#the-rendering-groups" title="Permalink to this headline">¶</a></h2>
<p>From above we can see there are three different rendering groups. We could
probably just get away with the <tt class="docutils literal"><span class="pre">RenderUpdates</span></tt> one, but it adds overhead not
really needed for something like a scrolling game. So we have a couple tools
here, pick the right one for the right job.</p>
<p>For a scrolling type game, where the background completely changes every frame.
We obviously don&#8217;t need to worry about python&#8217;s update rectangles in the call
to <tt class="docutils literal"><span class="pre">display.update()</span></tt>. You should definitely go with the <tt class="docutils literal"><span class="pre">RenderPlain</span></tt>
group here to manage your rendering.</p>
<p>For games where the background is more stationary, you definitely don&#8217;t want
pygame updating the entire screen (since it doesn&#8217;t need to). This type of game
usually involves erasing the old position of each object, then drawing it in a
new place for each frame. This way we are only changing what is necessary.
Most of the time you will just want to use the <tt class="docutils literal"><span class="pre">RenderUpdates</span></tt> class here.
Since you will also want to pass this list of changes to the
<tt class="docutils literal"><span class="pre">display.update()</span></tt> function.</p>
<p>The <tt class="docutils literal"><span class="pre">RenderUpdates</span></tt> class also does a good job an minimizing overlapping
areas in the list of updated rectangles. If the previous position and current
position of an object overlap, it will merge them into a single rectangle.
Combine this with the fact that is properly handles deleted objects and this is
one powerful <tt class="docutils literal"><span class="pre">Group</span></tt> class. If you&#8217;ve written a game that manages the changed
rectangles for the objects in a game, you know this the cause for a lot of
messy code in your game. Especially once you start to throw in objects that can
be deleted at anytime. All this work is reduced down to a <tt class="docutils literal"><span class="pre">clear()</span></tt> and
<tt class="docutils literal"><span class="pre">draw()</span></tt> method with this monster class. Plus with the overlap checking, it
is likely faster than if you did it yourself.</p>
<p>Also note that there&#8217;s nothing stopping you from mixing and matching these
render groups in your game. You should definitely use multiple rendering groups
when you want to do layering with your sprites. Also if the screen is split
into multiple sections, perhaps each section of the screen should use an
appropriate render group?</p>
</div>
<div class="section" id="collision-detection">
<h2>Collision Detection<a class="headerlink" href="#collision-detection" title="Permalink to this headline">¶</a></h2>
<p>The sprite module also comes with two very generic collision detection
functions.  For more complex games, these really won&#8217;t work for you, but you
can easily grab the source code for them, and modify them as needed.</p>
<p>Here&#8217;s a summary of what they are, and what they do.</p>
<div class="section" id="spritecollide-sprite-group-dokill-list">
<h3><tt class="docutils literal"><span class="pre">spritecollide(sprite,</span> <span class="pre">group,</span> <span class="pre">dokill)</span> <span class="pre">-&gt;</span> <span class="pre">list</span></tt><a class="headerlink" href="#spritecollide-sprite-group-dokill-list" title="Permalink to this headline">¶</a></h3>
<p>This checks for collisions between a single sprite and the sprites in a group.
It requires a &#8220;rect&#8221; attribute for all the sprites used. It returns a list of
all the sprites that overlap with the first sprite. The &#8220;dokill&#8221; argument is a
boolean argument. If it is true, the function will call the <tt class="docutils literal"><span class="pre">kill()</span></tt> method
on all the sprites. This means the last reference to each sprite is probably in
the returned list. Once the list goes away so do the sprites.  A quick example
of using this in a loop:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">bomb</span> <span class="ow">in</span> <span class="n">sprite</span><span class="o">.</span><span class="n">spritecollide</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">bombs</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">boom_sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">Explosion</span><span class="p">(</span><span class="n">bomb</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>This finds all the sprites in the &#8220;bomb&#8221; group that collide with the player.
Because of the &#8220;dokill&#8221; argument it deletes all the crashed bombs. For each
bomb that did collide, it plays a &#8220;boom&#8221; sound effect, and creates a new
<tt class="docutils literal"><span class="pre">Explosion</span></tt> where the bomb was. (Note, the <tt class="docutils literal"><span class="pre">Explosion</span></tt> class here knows to
add each instance to the appropriate class, so we don&#8217;t need to store it in a
variable, that last line might feel a little &#8220;funny&#8221; to you python programmers.</p>
</div>
<div class="section" id="groupcollide-group1-group2-dokill1-dokill2-dictionary">
<h3><tt class="docutils literal"><span class="pre">groupcollide(group1,</span> <span class="pre">group2,</span> <span class="pre">dokill1,</span> <span class="pre">dokill2)</span> <span class="pre">-&gt;</span> <span class="pre">dictionary</span></tt><a class="headerlink" href="#groupcollide-group1-group2-dokill1-dokill2-dictionary" title="Permalink to this headline">¶</a></h3>
<p>This is similar to the <tt class="docutils literal"><span class="pre">spritecollide</span></tt> function, but a little more complex.
It checks for collisions for all the sprites in one group, to the sprites in
another. There is a <tt class="docutils literal"><span class="pre">dokill</span></tt> argument for the sprites in each list. When
<tt class="docutils literal"><span class="pre">dokill1</span></tt> is true, the colliding sprites in <tt class="docutils literal"><span class="pre">group1</span></tt> will be <tt class="docutils literal"><span class="pre">kill()``ed.</span>
<span class="pre">When</span> <span class="pre">``dokill2</span></tt> is true, we get the same results for <tt class="docutils literal"><span class="pre">group2</span></tt>. The
dictionary it returns works like this; each key in the dictionary is a sprite
from <tt class="docutils literal"><span class="pre">group1</span></tt> that had a collision.  The value for that key is a list of the
sprites that it collided with. Perhaps another quick code sample explains it
best:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">alien</span> <span class="ow">in</span> <span class="n">sprite</span><span class="o">.</span><span class="n">groupcollide</span><span class="p">(</span><span class="n">aliens</span><span class="p">,</span> <span class="n">shots</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">boom_sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">Explosion</span><span class="p">(</span><span class="n">alien</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">kills</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This code checks for the collisions between player bullets and all the aliens
they might intersect. In this case we only loop over the dictionary keys, but
we could loop over the <tt class="docutils literal"><span class="pre">values()</span></tt> or <tt class="docutils literal"><span class="pre">items()</span></tt> if we wanted to do something
to the specific shots that collided with aliens. If we did loop over the
<tt class="docutils literal"><span class="pre">values()</span></tt> we would be looping through lists that contain sprites. The same
sprite may even appear more than once in these different loops, since the same
&#8220;shot&#8221; could have collided against multiple &#8220;aliens&#8221;.</p>
<p>Those are the basic collision functions that come with pygame. It should be
easy to roll your own that perhaps use something different than the &#8220;rect&#8221;
attribute. Or maybe try to fine-tweak your code a little more by directly
effecting the collision object, instead of building a list of the collision?
The code in the sprite collision functions is very optimized, but you could
speed it up slightly by taking out some functionality you don&#8217;t need.</p>
</div>
</div>
<div class="section" id="common-problems">
<h2>Common Problems<a class="headerlink" href="#common-problems" title="Permalink to this headline">¶</a></h2>
<p>Currently there is one main problem that catches new users. When you derive
your new sprite class with the Sprite base, you <strong>must</strong> call the
<tt class="docutils literal"><span class="pre">Sprite.__init__()</span></tt> method from your own class <tt class="docutils literal"><span class="pre">__init__()</span></tt> method.  If you
forget to call the <tt class="docutils literal"><span class="pre">Sprite.__init__()</span></tt> method, you get a cryptic error, like
this:</p>
<div class="highlight-python"><pre>AttributeError: 'mysprite' instance has no attribute '_Sprite__g'.</pre>
</div>
</div>
<div class="section" id="extending-your-own-classes-advanced">
<h2>Extending Your Own Classes <em>(Advanced)</em><a class="headerlink" href="#extending-your-own-classes-advanced" title="Permalink to this headline">¶</a></h2>
<p>Because of speed concerns, the current <tt class="docutils literal"><span class="pre">Group</span></tt> classes try to only do exactly
what they need, and not handle a lot of general situations. If you decide you
need extra features, you may want to create your own <tt class="docutils literal"><span class="pre">Group</span></tt> class.</p>
<p>The <tt class="docutils literal"><span class="pre">Sprite</span></tt> and <tt class="docutils literal"><span class="pre">Group</span></tt> classes were designed to be extended, so feel free
to create your own <tt class="docutils literal"><span class="pre">Group</span></tt> classes to do specialized things. The best place
to start is probably the actual python source code for the sprite module.
Looking at the current <tt class="docutils literal"><span class="pre">Sprite</span></tt> groups should be enough example on how to
create your own.</p>
<p>For example, here is the source code for a rendering <tt class="docutils literal"><span class="pre">Group</span></tt> that calls a
<tt class="docutils literal"><span class="pre">render()</span></tt> method for each sprite, instead of just blitting an &#8220;image&#8221;
variable from it.  Since we want it to also handle updated areas, we will start
with a copy of the original <tt class="docutils literal"><span class="pre">RenderUpdates</span></tt> group, here is the code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">RenderUpdatesDraw</span><span class="p">(</span><span class="n">RenderClear</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;call sprite.draw(screen) to render sprites&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surface</span><span class="p">):</span>
        <span class="n">dirty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lostsprites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lostsprites</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spritedict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">newrect</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">screen</span><span class="p">)</span> <span class="c">#Here&#39;s the big change</span>
            <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dirty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newrect</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dirty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newrect</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spritedict</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">newrect</span>
        <span class="k">return</span> <span class="n">dirty</span>
</pre></div>
</div>
<p>Following is more information on how you could create your own <tt class="docutils literal"><span class="pre">Sprite</span></tt> and
<tt class="docutils literal"><span class="pre">Group</span></tt> objects from scratch.</p>
<p>The <tt class="docutils literal"><span class="pre">Sprite</span></tt> objects only &#8220;require&#8221; two methods. &#8220;add_internal()&#8221; and
&#8220;remove_internal()&#8221;.  These are called by the <tt class="docutils literal"><span class="pre">Group</span></tt> classes when they are
removing a sprite from themselves. The <tt class="docutils literal"><span class="pre">add_internal()</span></tt> and
<tt class="docutils literal"><span class="pre">remove_internal()</span></tt> have a single argument which is a group. Your <tt class="docutils literal"><span class="pre">Sprite</span></tt>
will need some way to also keep track of the <tt class="docutils literal"><span class="pre">Groups</span></tt> it belongs to. You will
likely want to try to match the other methods and arguments to the real
<tt class="docutils literal"><span class="pre">Sprite</span></tt> class, but if you&#8217;re not going to use those methods, you sure don&#8217;t
need them.</p>
<p>It is almost the same requirements for creating your own <tt class="docutils literal"><span class="pre">Group</span></tt>. In fact, if
you look at the source you&#8217;ll see the <tt class="docutils literal"><span class="pre">GroupSingle</span></tt> isn&#8217;t derived from the
<tt class="docutils literal"><span class="pre">Group</span></tt> class, it just implements the same methods so you can&#8217;t really tell
the difference. Again you need an &#8220;add_internal()&#8221; and &#8220;remove_internal()&#8221;
method that the sprites call when they want to belong or remove themselves from
the group. The <tt class="docutils literal"><span class="pre">add_internal()</span></tt> and <tt class="docutils literal"><span class="pre">remove_internal()</span></tt> have a single
argument which is a sprite. The only other requirement for the <tt class="docutils literal"><span class="pre">Group</span></tt>
classes is they have a dummy attribute named &#8220;_spritegroup&#8221;. It doesn&#8217;t matter
what the value is, as long as the attribute is present. The Sprite classes can
look for this attribute to determine the difference between a &#8220;group&#8221; and any
ordinary python container. (This is important, because several sprite methods
can take an argument of a single group, or a sequence of groups. Since they
both look similar, this is the most flexible way to &#8220;see&#8221; the difference.)</p>
<p>You should through the code for the sprite module. While the code is a bit
&#8220;tuned&#8221;, it&#8217;s got enough comments to help you follow along.  There&#8217;s even a
todo section in the source if you feel like contributing.</p>
</div>
</div>

  </div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">Pygame v1.9.2 documentation</a> &raquo;</li>
    <script type="text/javascript" src="jquery.plugin.docscomments.js"></script>

      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Pygame Developers.
    </div>
  </body>
</html>
------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline
Content-Type: text/css
Content-Location: http://pygame.info/docs/_static/reset.css
Content-Transfer-Encoding: 8bit

/* Set browser to a known state to get around browser incompatibilities.
 * Copied from http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/
 */
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, font, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-weight: inherit;
	font-style: inherit;
	font-size: 100%;
	font-family: inherit;
	vertical-align: baseline;
}
/* remember to define focus styles! */
:focus {
	outline: 0;
}
body {
	line-height: 1;
	color: black;
	background: white;
}
ol, ul {
	list-style: none;
}
/* tables still need 'cellspacing="0"' in the markup */
table {
	border-collapse: separate;
	border-spacing: 0;
}
caption, th, td {
	text-align: left;
	font-weight: normal;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: "";
}
blockquote, q {
	quotes: "" "";
}

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline
Content-Type: text/css
Content-Location: http://pygame.info/docs/_static/tooltip.css
Content-Transfer-Encoding: 8bit

/* Implement hyperlink tooltips
 *
 * Adapted from "Sexy Tooltips with Just CSS"
 * http://sixrevisions.com/css/css-only-tooltips/
 */

.tooltip {
  cursor: help; text-decoration: none;
  position: relative;
}

.tooltip span.tooltip-content {
  margin-left: -999em;
  position: absolute;
}

.tooltip:hover span.tooltip-content {
  position: absolute;
  left: 1em;
  top: 2em;
  z-index: 99;
  margin-left: 0;
}

.tooltip:hover img {
  border: 0;
  margin: -10px 0 0 -55px;
  float: left;
  position: absolute;
}

.tooltip:hover em {
  font-family: Candara, Tahoma, Geneva, sans-serif;
  font-size: 1.2em;
  font-weight: bold;
  display: block;
  padding: 0.2em 0 0.6em 0;
}

.classic { padding: 0.8em 1em; }

.custom { padding: 0.5em 0.8em 0.8em 2em; }

* html a:hover { background: transparent; }

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=pygame.css
Content-Type: text/css; name=pygame.css
Content-Location: http://pygame.info/docs/_static/pygame.css
Content-Transfer-Encoding: 8bit

/**
 * Pygame stylesheet -- original theme
 * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 */

@import url("reset.css");
@import url("tooltip.css");

/* -- main layout ----------------------------------------------------------- */

div.clearer {
    clear: both;
}

/* -- relbar ---------------------------------------------------------------- */

div.related {
    width: 100%;
    font-size: 90%;
}

div.related h3 {
    display: none;
}

div.related ul {
    margin: 0;
    padding: 0 0 0 10px;
    list-style: none;
}

div.related li {
    display: inline;
}

div.related li.right {
    float: right;
    margin-right: 5px;
}

/* -- search page ----------------------------------------------------------- */

ul.search {
    margin: 10px 0 0 20px;
    padding: 0;
}

ul.search li {
    padding: 5px 0 5px 20px;
    background-image: url(file.png);
    background-repeat: no-repeat;
    background-position: 0 7px;
}

ul.search li a {
    font-weight: bold;
}

ul.search li div.context {
    color: #888;
    margin: 2px 0 0 30px;
    text-align: left;
}

ul.keywordmatches li.goodmatch a {
    font-weight: bold;
}

/* -- index page ------------------------------------------------------------ */

table.contentstable {
    width: 90%;
}

table.contentstable p.biglink {
    line-height: 150%;
}

a.biglink {
    font-size: 1.3em;
}

span.linkdescr {
    font-style: italic;
    padding-top: 5px;
    font-size: 90%;
}

#pygame-front-page dt {
    padding-top: 1em;
}

#pygame-front-page dl {
    padding: 0 0 0 1em;
}

#pygame-front-page h2 {
    padding: 1em 0 0 0;
}

/* -- general index --------------------------------------------------------- */

table.indextable td {
    text-align: left;
    vertical-align: top;
}

table.indextable dl, table.indextable dd {
    margin-top: 0;
    margin-bottom: 0;
}

table.indextable tr.pcap {
    height: 10px;
}

table.indextable tr.cap {
    margin-top: 10px;
    background-color: #f2f2f2;
}

img.toggler {
    margin-right: 3px;
    margin-top: 3px;
    cursor: pointer;
}

/* -- page layout ----------------------------------------------------------- */

body {
    font-family: sans-serif;
    color: #000000;
    font-style: normal;
    text-decoration: none;
    text-align: left;
    border-style: none;
}

div.header {
    padding: 0.5em;
    background-color: #aaeebb;
    color: ;
    line-height: 1.2em;
}

div.header table {
    border: 3px solid black;
    border-collapse: collapse;
    background-color: #6aee28;
}

div.header td {
    border-right: 3px solid black;
}

div.header .logo {
    background-color: #c2fc20;
    text-align: center;
    vertical-align: middle;
    padding: 0.3em;
}

div.header .logo img {
    min-width: 200px;
    min-height: 60px;
    border-style: none;
}

div.header .logo strong {
    weight: bold;
}

dev.header .logo a {
    visibility: hidden;
}

div.header .pagelinks {
    padding: 0.3em;
    text-align: center;
    vertical-align: middle;
}

div.header p.top {
    margin-top: 0;
    margin-bottom: 1em;
}

div.header p.bottom {
    margin-bottom: 0;
}

div.header .pagelinks a {
    text-decoration: underline;
}    

div.header .pagelinks a:hover {
    text-decoration: none;
}

div.document {
    background-color: #aaeebb;
}

div.documentwrapper {
    float: left;
    width: 100%;
    padding: 0.5em;
}

div.bodywrapper {
    margin: 0 0 0 230px;
}

div.body {
}

div.heading {
    padding: 0 0 0 0.5em;
}

div.sectionwrapper {
}

div.footer {
    display: none;
    color: #000000;
    width: 100%;
    padding: 9px 0 9px 0;
    text-align: center;
    font-size: 75%;
}

div.footer a {
    background-color: #11303d
    color: #000000;
    text-decoration: underline;
}

div.related {
    background-color: #6aee28;
    line-height: 30px;
    color: #000000;
    border-top: 3px solid black;
    border-bottom: 3px solid black;
}

div.related a {
    color: #000000;
}

div.sphinxsidebar {
}

div.sphinxsidebar h3 {
    font-family: sans-serif;
    color: #ffffff;
    font-size: 1.4em;
    font-weight: normal;
    margin: 0;
    padding: 0;
}

div.sphinxsidebar h3 a {
    color: #ffffff;
}

div.sphinxsidebar h4 {
    font-family: sans-serif;
    color: #ffffff;
    font-size: 1.3em;
    font-weight: normal;
    margin: 5px 0 0 0;
    padding: 0;
}

div.sphinxsidebar p {
    color: #ffffff;
}

div.sphinxsidebar p.topless {
    margin: 5px 10px 10px 10px;
}

div.sphinxsidebar ul {
    margin: 10px;
    padding: 0;
    color: #ffffff;
}

div.sphinxsidebar a {
    color: #98dbcc;
}

div.sphinxsidebar input {
    border: 1px solid #98dbcc;
    font-family: sans-serif;
    font-size: 1em;
}

/* -- body styles ----------------------------------------------------------- */

a {
    color: #000000;
    background-color: transparent;
    text-decoration: underline;
}

a:hover {
    color: #000000;
    background-color: transparent;
    text-decoration: none;
}

p {
    margin: 0.5em 0;
}

strong {
    font-weight: bold;
}

em {
    font-style: italic;
}

dl.definition {
    padding-top: 0.7em;
    padding-bottom: 0.7em;
}

dd {
    margin-left: 30px;
}
 
dt tt {
    font-weight: bold;
    font-size: 1.1em;
}

dt.module {
    margin-bottom: 1em;
}

table.toc {
    margin-left: 2em;
    margin-bottom: 0.5em;
}

table.toc td {
    border-style: none;
    padding-right: 10px;
}

dt.module {
    margin-bottom: 1em;
}

span.summaryline {
    font-style: italic;
}

span.signature {
    font-family: monospace;
    margin-bottom: 0.5em;
}

table.docutils td.toc {
    border-style: none;
}

dl.class em.property {
/*    display: none;*/
}

dl.argsig tt.descclassname {
/*    display: none;*/
}

div.body p, div.body dd, div.body li {
    text-align: left;
    line-height: 130%;
}

div.body h1,
div.body h2,
div.body h3,
div.body h4,
div.body h5,
div.body h6 {
    font-family: sans-serif;
    font-weight: bold;
    margin: 1em 0 0.5em;
    text-align: left;
}

div.body h6 {
    font-weight: normal;
    font-style: italic;
    margin: 0;
    padding: 0;
    line-height: 130%;
}

div.body h1 { font-size: 1.5em; }
div.body h2 { font-size: 1.4em; }
div.body h3 { font-size: 1.3em; }
div.body h4 { font-size: 1.2em; }
div.body h5 { font-size: 1.1em; }
div.body h6 { font-size: 1.0em; }

a.headerlink {
    color: #c60f0f;
    font-size: 0.8em;
    padding: 0 4px 0 4px;
    text-decoration: none;
}

a.headerlink:hover {
    background-color: #c60f0f;
    color: white;
}

a.headerlink {
    visibility: hidden;
}

dt:hover > a.headerlink {
    visibility: visible;
}

div.body p, div.body dd, div.body li {
    text-align: left;
    line-height: 130%;
}

blockquote {
    margin-left: 2em;
}

div.admonition p.admonition-title + p {
    display: inline;
}

div.admonition p {
    margin-bottom: 5px;
}

div.admonition pre {
    margin-bottom: 5px;
}

div.admonition ul, div.admonition ol {
    margin-bottom: 5px;
}

div.note {
    background-color: #eee;
    border: 1px solid #ccc;
}

div.seealso {
    background-color: #ffc;
    border: 1px solid #ff6;
}

div.topic {
    background-color: #eee;
}

div.warning {
    background-color: #ffe4e4;
    border: 1px solid #f66;
}

p.admonition-title {
    display: inline;
}

p.admonition-title:after {
    content: ":";
}

p.linklist {
    text-align: center;
}

pre {
    font-family: monospace;
    padding: 5px;
    padding-left: 15px;
    margin-bottom: 1em;
    background-color: #eeffcc;
    color: #333333;
    line-height: 120%;
    border: 1px solid #ac9;
    border-left: none;
    border-right: none;
}

.warning tt {
    background: #efc2c2;
}

.note tt {
    background: #d6d6d6;
}

ul.simple {
    list-style-type: circle;
    list-style-position: inside;
    margin-bottom: 1em;
}

/* -- tooltip style --------------------------------------------------------- */

a.tooltip {
    text-decoration: underline;
}

a.tooltip:hover {
    text-decoration: none;
}

.tooltip-content {
    width: 250px;
    background-color: #c2fc20;
    border: 1px solid #ace01C;
    padding: 3px;
    border-radius: 5px 5px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.1);
    -webkit-box-shadow: 5px 5px rgba(0, 0, 0, 0.1);
    -moz-box-shadow: 5px 5px rgba(0, 0, 0, 0.1);
}



/* -- comments style --------------------------------------------------------- */

form.addcomment {
    display:inline;
}
.addcomment input,
a.commentButton {
    background-color: #6AEE28;
    border: 1px solid #000000;
    color: #000000;
    font-family: Arial,Helvetica,sans-serif;
    font-size: 12px;
    font-weight: bold;
    padding: 6px;
    margin-right: 4px;
}

article.commentsArticle {
    background: none repeat scroll 0 0 #FEF790;
    border: 1px solid black;
    margin-bottom: 12px;
    margin-top: 12px;
    padding: 4px;

}

article.hidden {
    display:none;
}

section.commentPart {
}

header.commentHeading {
    background: none repeat scroll 0 0 #FDE42D;
    text-align: center;
}
pre.commentContent {
    overflow: auto; 
    max-width; 800px;
    margin-left:0px;
    border: 0;
}


------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=pygments.css
Content-Type: text/css; name=pygments.css
Content-Location: http://pygame.info/docs/_static/pygments.css
Content-Transfer-Encoding: 8bit

.highlight .hll { background-color: #ffffcc }
.highlight  { background: #eeffcc; }
.highlight .c { color: #408090; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408090; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #408090; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408090; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #303030 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #208050 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #208050 } /* Literal.Number.Float */
.highlight .mh { color: #208050 } /* Literal.Number.Hex */
.highlight .mi { color: #208050 } /* Literal.Number.Integer */
.highlight .mo { color: #208050 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #208050 } /* Literal.Number.Integer.Long */
------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=jquery.js
Content-Type: application/javascript; name=jquery.js
Content-Location: http://pygame.info/docs/_static/jquery.js
Content-Transfer-Encoding: Base64

LyohCiAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuNy4yCiAqIGh0dHA6
Ly9qcXVlcnkuY29tLwogKgogKiBDb3B5cmlnaHQgMjAxMSwgSm9obiBSZXNpZwog
KiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgb3IgR1BMIFZlcnNpb24gMiBs
aWNlbnNlcy4KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQogKgogKiBJbmNs
dWRlcyBTaXp6bGUuanMKICogaHR0cDovL3NpenpsZWpzLmNvbS8KICogQ29weXJp
Z2h0IDIwMTEsIFRoZSBEb2pvIEZvdW5kYXRpb24KICogUmVsZWFzZWQgdW5kZXIg
dGhlIE1JVCwgQlNELCBhbmQgR1BMIExpY2Vuc2VzLgogKgogKiBEYXRlOiBUaHUg
Tm92IDE1IDE4OjI4OjI0IEJSU1QgMjAxMgogKi8KKGZ1bmN0aW9uKCB3aW5kb3cs
IHVuZGVmaW5lZCApIHsKCi8vIFVzZSB0aGUgY29ycmVjdCBkb2N1bWVudCBhY2Nv
cmRpbmdseSB3aXRoIHdpbmRvdyBhcmd1bWVudCAoc2FuZGJveCkKdmFyIGRvY3Vt
ZW50ID0gd2luZG93LmRvY3VtZW50LAoJbmF2aWdhdG9yID0gd2luZG93Lm5hdmln
YXRvciwKCWxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uOwp2YXIgalF1ZXJ5ID0g
KGZ1bmN0aW9uKCkgewoKLy8gRGVmaW5lIGEgbG9jYWwgY29weSBvZiBqUXVlcnkK
dmFyIGpRdWVyeSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHsKCQkv
LyBUaGUgalF1ZXJ5IG9iamVjdCBpcyBhY3R1YWxseSBqdXN0IHRoZSBpbml0IGNv
bnN0cnVjdG9yICdlbmhhbmNlZCcKCQlyZXR1cm4gbmV3IGpRdWVyeS5mbi5pbml0
KCBzZWxlY3RvciwgY29udGV4dCwgcm9vdGpRdWVyeSApOwoJfSwKCgkvLyBNYXAg
b3ZlciBqUXVlcnkgaW4gY2FzZSBvZiBvdmVyd3JpdGUKCV9qUXVlcnkgPSB3aW5k
b3cualF1ZXJ5LAoKCS8vIE1hcCBvdmVyIHRoZSAkIGluIGNhc2Ugb2Ygb3Zlcndy
aXRlCglfJCA9IHdpbmRvdy4kLAoKCS8vIEEgY2VudHJhbCByZWZlcmVuY2UgdG8g
dGhlIHJvb3QgalF1ZXJ5KGRvY3VtZW50KQoJcm9vdGpRdWVyeSwKCgkvLyBBIHNp
bXBsZSB3YXkgdG8gY2hlY2sgZm9yIEhUTUwgc3RyaW5ncyBvciBJRCBzdHJpbmdz
CgkvLyBQcmlvcml0aXplICNpZCBvdmVyIDx0YWc+IHRvIGF2b2lkIFhTUyB2aWEg
bG9jYXRpb24uaGFzaCAoIzk1MjEpCglxdWlja0V4cHIgPSAvXig/OlteIzxdKig8
W1x3XFddKz4pW14+XSokfCMoW1x3XC1dKikkKS8sCgoJLy8gQ2hlY2sgaWYgYSBz
dHJpbmcgaGFzIGEgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVyIGluIGl0Cglybm90
d2hpdGUgPSAvXFMvLAoKCS8vIFVzZWQgZm9yIHRyaW1taW5nIHdoaXRlc3BhY2UK
CXRyaW1MZWZ0ID0gL15ccysvLAoJdHJpbVJpZ2h0ID0gL1xzKyQvLAoKCS8vIE1h
dGNoIGEgc3RhbmRhbG9uZSB0YWcKCXJzaW5nbGVUYWcgPSAvXjwoXHcrKVxzKlwv
Pz4oPzo8XC9cMT4pPyQvLAoKCS8vIEpTT04gUmVnRXhwCglydmFsaWRjaGFycyA9
IC9eW1xdLDp7fVxzXSokLywKCXJ2YWxpZGVzY2FwZSA9IC9cXCg/OlsiXFxcL2Jm
bnJ0XXx1WzAtOWEtZkEtRl17NH0pL2csCglydmFsaWR0b2tlbnMgPSAvIlteIlxc
XG5ccl0qInx0cnVlfGZhbHNlfG51bGx8LT9cZCsoPzpcLlxkKik/KD86W2VFXVsr
XC1dP1xkKyk/L2csCglydmFsaWRicmFjZXMgPSAvKD86Xnw6fCwpKD86XHMqXFsp
Ky9nLAoKCS8vIFVzZXJhZ2VudCBSZWdFeHAKCXJ3ZWJraXQgPSAvKHdlYmtpdClb
IFwvXShbXHcuXSspLywKCXJvcGVyYSA9IC8ob3BlcmEpKD86Lip2ZXJzaW9uKT9b
IFwvXShbXHcuXSspLywKCXJtc2llID0gLyhtc2llKSAoW1x3Ll0rKS8sCglybW96
aWxsYSA9IC8obW96aWxsYSkoPzouKj8gcnY6KFtcdy5dKykpPy8sCgoJLy8gTWF0
Y2hlcyBkYXNoZWQgc3RyaW5nIGZvciBjYW1lbGl6aW5nCglyZGFzaEFscGhhID0g
Ly0oW2Etel18WzAtOV0pL2lnLAoJcm1zUHJlZml4ID0gL14tbXMtLywKCgkvLyBV
c2VkIGJ5IGpRdWVyeS5jYW1lbENhc2UgYXMgY2FsbGJhY2sgdG8gcmVwbGFjZSgp
CglmY2FtZWxDYXNlID0gZnVuY3Rpb24oIGFsbCwgbGV0dGVyICkgewoJCXJldHVy
biAoIGxldHRlciArICIiICkudG9VcHBlckNhc2UoKTsKCX0sCgoJLy8gS2VlcCBh
IFVzZXJBZ2VudCBzdHJpbmcgZm9yIHVzZSB3aXRoIGpRdWVyeS5icm93c2VyCgl1
c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50LAoKCS8vIEZvciBtYXRjaGlu
ZyB0aGUgZW5naW5lIGFuZCB2ZXJzaW9uIG9mIHRoZSBicm93c2VyCglicm93c2Vy
TWF0Y2gsCgoJLy8gVGhlIGRlZmVycmVkIHVzZWQgb24gRE9NIHJlYWR5CglyZWFk
eUxpc3QsCgoJLy8gVGhlIHJlYWR5IGV2ZW50IGhhbmRsZXIKCURPTUNvbnRlbnRM
b2FkZWQsCgoJLy8gU2F2ZSBhIHJlZmVyZW5jZSB0byBzb21lIGNvcmUgbWV0aG9k
cwoJdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLAoJaGFzT3du
ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSwKCXB1c2ggPSBBcnJh
eS5wcm90b3R5cGUucHVzaCwKCXNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNl
LAoJdHJpbSA9IFN0cmluZy5wcm90b3R5cGUudHJpbSwKCWluZGV4T2YgPSBBcnJh
eS5wcm90b3R5cGUuaW5kZXhPZiwKCgkvLyBbW0NsYXNzXV0gLT4gdHlwZSBwYWly
cwoJY2xhc3MydHlwZSA9IHt9OwoKalF1ZXJ5LmZuID0galF1ZXJ5LnByb3RvdHlw
ZSA9IHsKCWNvbnN0cnVjdG9yOiBqUXVlcnksCglpbml0OiBmdW5jdGlvbiggc2Vs
ZWN0b3IsIGNvbnRleHQsIHJvb3RqUXVlcnkgKSB7CgkJdmFyIG1hdGNoLCBlbGVt
LCByZXQsIGRvYzsKCgkJLy8gSGFuZGxlICQoIiIpLCAkKG51bGwpLCBvciAkKHVu
ZGVmaW5lZCkKCQlpZiAoICFzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXM7CgkJ
fQoKCQkvLyBIYW5kbGUgJChET01FbGVtZW50KQoJCWlmICggc2VsZWN0b3Iubm9k
ZVR5cGUgKSB7CgkJCXRoaXMuY29udGV4dCA9IHRoaXNbMF0gPSBzZWxlY3RvcjsK
CQkJdGhpcy5sZW5ndGggPSAxOwoJCQlyZXR1cm4gdGhpczsKCQl9CgoJCS8vIFRo
ZSBib2R5IGVsZW1lbnQgb25seSBleGlzdHMgb25jZSwgb3B0aW1pemUgZmluZGlu
ZyBpdAoJCWlmICggc2VsZWN0b3IgPT09ICJib2R5IiAmJiAhY29udGV4dCAmJiBk
b2N1bWVudC5ib2R5ICkgewoJCQl0aGlzLmNvbnRleHQgPSBkb2N1bWVudDsKCQkJ
dGhpc1swXSA9IGRvY3VtZW50LmJvZHk7CgkJCXRoaXMuc2VsZWN0b3IgPSBzZWxl
Y3RvcjsKCQkJdGhpcy5sZW5ndGggPSAxOwoJCQlyZXR1cm4gdGhpczsKCQl9CgoJ
CS8vIEhhbmRsZSBIVE1MIHN0cmluZ3MKCQlpZiAoIHR5cGVvZiBzZWxlY3RvciA9
PT0gInN0cmluZyIgKSB7CgkJCS8vIEFyZSB3ZSBkZWFsaW5nIHdpdGggSFRNTCBz
dHJpbmcgb3IgYW4gSUQ/CgkJCWlmICggc2VsZWN0b3IuY2hhckF0KDApID09PSAi
PCIgJiYgc2VsZWN0b3IuY2hhckF0KCBzZWxlY3Rvci5sZW5ndGggLSAxICkgPT09
ICI+IiAmJiBzZWxlY3Rvci5sZW5ndGggPj0gMyApIHsKCQkJCS8vIEFzc3VtZSB0
aGF0IHN0cmluZ3MgdGhhdCBzdGFydCBhbmQgZW5kIHdpdGggPD4gYXJlIEhUTUwg
YW5kIHNraXAgdGhlIHJlZ2V4IGNoZWNrCgkJCQltYXRjaCA9IFsgbnVsbCwgc2Vs
ZWN0b3IsIG51bGwgXTsKCgkJCX0gZWxzZSB7CgkJCQltYXRjaCA9IHF1aWNrRXhw
ci5leGVjKCBzZWxlY3RvciApOwoJCQl9CgoJCQkvLyBWZXJpZnkgYSBtYXRjaCwg
YW5kIHRoYXQgbm8gY29udGV4dCB3YXMgc3BlY2lmaWVkIGZvciAjaWQKCQkJaWYg
KCBtYXRjaCAmJiAobWF0Y2hbMV0gfHwgIWNvbnRleHQpICkgewoKCQkJCS8vIEhB
TkRMRTogJChodG1sKSAtPiAkKGFycmF5KQoJCQkJaWYgKCBtYXRjaFsxXSApIHsK
CQkJCQljb250ZXh0ID0gY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSA/IGNvbnRl
eHRbMF0gOiBjb250ZXh0OwoJCQkJCWRvYyA9ICggY29udGV4dCA/IGNvbnRleHQu
b3duZXJEb2N1bWVudCB8fCBjb250ZXh0IDogZG9jdW1lbnQgKTsKCgkJCQkJLy8g
SWYgYSBzaW5nbGUgc3RyaW5nIGlzIHBhc3NlZCBpbiBhbmQgaXQncyBhIHNpbmds
ZSB0YWcKCQkJCQkvLyBqdXN0IGRvIGEgY3JlYXRlRWxlbWVudCBhbmQgc2tpcCB0
aGUgcmVzdAoJCQkJCXJldCA9IHJzaW5nbGVUYWcuZXhlYyggc2VsZWN0b3IgKTsK
CgkJCQkJaWYgKCByZXQgKSB7CgkJCQkJCWlmICggalF1ZXJ5LmlzUGxhaW5PYmpl
Y3QoIGNvbnRleHQgKSApIHsKCQkJCQkJCXNlbGVjdG9yID0gWyBkb2N1bWVudC5j
cmVhdGVFbGVtZW50KCByZXRbMV0gKSBdOwoJCQkJCQkJalF1ZXJ5LmZuLmF0dHIu
Y2FsbCggc2VsZWN0b3IsIGNvbnRleHQsIHRydWUgKTsKCgkJCQkJCX0gZWxzZSB7
CgkJCQkJCQlzZWxlY3RvciA9IFsgZG9jLmNyZWF0ZUVsZW1lbnQoIHJldFsxXSAp
IF07CgkJCQkJCX0KCgkJCQkJfSBlbHNlIHsKCQkJCQkJcmV0ID0galF1ZXJ5LmJ1
aWxkRnJhZ21lbnQoIFsgbWF0Y2hbMV0gXSwgWyBkb2MgXSApOwoJCQkJCQlzZWxl
Y3RvciA9ICggcmV0LmNhY2hlYWJsZSA/IGpRdWVyeS5jbG9uZShyZXQuZnJhZ21l
bnQpIDogcmV0LmZyYWdtZW50ICkuY2hpbGROb2RlczsKCQkJCQl9CgoJCQkJCXJl
dHVybiBqUXVlcnkubWVyZ2UoIHRoaXMsIHNlbGVjdG9yICk7CgoJCQkJLy8gSEFO
RExFOiAkKCIjaWQiKQoJCQkJfSBlbHNlIHsKCQkJCQllbGVtID0gZG9jdW1lbnQu
Z2V0RWxlbWVudEJ5SWQoIG1hdGNoWzJdICk7CgoJCQkJCS8vIENoZWNrIHBhcmVu
dE5vZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zCgkJCQkJ
Ly8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2
MwoJCQkJCWlmICggZWxlbSAmJiBlbGVtLnBhcmVudE5vZGUgKSB7CgkJCQkJCS8v
IEhhbmRsZSB0aGUgY2FzZSB3aGVyZSBJRSBhbmQgT3BlcmEgcmV0dXJuIGl0ZW1z
CgkJCQkJCS8vIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAoJCQkJCQlpZiAoIGVsZW0u
aWQgIT09IG1hdGNoWzJdICkgewoJCQkJCQkJcmV0dXJuIHJvb3RqUXVlcnkuZmlu
ZCggc2VsZWN0b3IgKTsKCQkJCQkJfQoKCQkJCQkJLy8gT3RoZXJ3aXNlLCB3ZSBp
bmplY3QgdGhlIGVsZW1lbnQgZGlyZWN0bHkgaW50byB0aGUgalF1ZXJ5IG9iamVj
dAoJCQkJCQl0aGlzLmxlbmd0aCA9IDE7CgkJCQkJCXRoaXNbMF0gPSBlbGVtOwoJ
CQkJCX0KCgkJCQkJdGhpcy5jb250ZXh0ID0gZG9jdW1lbnQ7CgkJCQkJdGhpcy5z
ZWxlY3RvciA9IHNlbGVjdG9yOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfQoKCQkJ
Ly8gSEFORExFOiAkKGV4cHIsICQoLi4uKSkKCQkJfSBlbHNlIGlmICggIWNvbnRl
eHQgfHwgY29udGV4dC5qcXVlcnkgKSB7CgkJCQlyZXR1cm4gKCBjb250ZXh0IHx8
IHJvb3RqUXVlcnkgKS5maW5kKCBzZWxlY3RvciApOwoKCQkJLy8gSEFORExFOiAk
KGV4cHIsIGNvbnRleHQpCgkJCS8vICh3aGljaCBpcyBqdXN0IGVxdWl2YWxlbnQg
dG86ICQoY29udGV4dCkuZmluZChleHByKQoJCQl9IGVsc2UgewoJCQkJcmV0dXJu
IHRoaXMuY29uc3RydWN0b3IoIGNvbnRleHQgKS5maW5kKCBzZWxlY3RvciApOwoJ
CQl9CgoJCS8vIEhBTkRMRTogJChmdW5jdGlvbikKCQkvLyBTaG9ydGN1dCBmb3Ig
ZG9jdW1lbnQgcmVhZHkKCQl9IGVsc2UgaWYgKCBqUXVlcnkuaXNGdW5jdGlvbigg
c2VsZWN0b3IgKSApIHsKCQkJcmV0dXJuIHJvb3RqUXVlcnkucmVhZHkoIHNlbGVj
dG9yICk7CgkJfQoKCQlpZiAoIHNlbGVjdG9yLnNlbGVjdG9yICE9PSB1bmRlZmlu
ZWQgKSB7CgkJCXRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvci5zZWxlY3RvcjsKCQkJ
dGhpcy5jb250ZXh0ID0gc2VsZWN0b3IuY29udGV4dDsKCQl9CgoJCXJldHVybiBq
UXVlcnkubWFrZUFycmF5KCBzZWxlY3RvciwgdGhpcyApOwoJfSwKCgkvLyBTdGFy
dCB3aXRoIGFuIGVtcHR5IHNlbGVjdG9yCglzZWxlY3RvcjogIiIsCgoJLy8gVGhl
IGN1cnJlbnQgdmVyc2lvbiBvZiBqUXVlcnkgYmVpbmcgdXNlZAoJanF1ZXJ5OiAi
MS43LjIiLAoKCS8vIFRoZSBkZWZhdWx0IGxlbmd0aCBvZiBhIGpRdWVyeSBvYmpl
Y3QgaXMgMAoJbGVuZ3RoOiAwLAoKCS8vIFRoZSBudW1iZXIgb2YgZWxlbWVudHMg
Y29udGFpbmVkIGluIHRoZSBtYXRjaGVkIGVsZW1lbnQgc2V0CglzaXplOiBmdW5j
dGlvbigpIHsKCQlyZXR1cm4gdGhpcy5sZW5ndGg7Cgl9LAoKCXRvQXJyYXk6IGZ1
bmN0aW9uKCkgewoJCXJldHVybiBzbGljZS5jYWxsKCB0aGlzLCAwICk7Cgl9LAoK
CS8vIEdldCB0aGUgTnRoIGVsZW1lbnQgaW4gdGhlIG1hdGNoZWQgZWxlbWVudCBz
ZXQgT1IKCS8vIEdldCB0aGUgd2hvbGUgbWF0Y2hlZCBlbGVtZW50IHNldCBhcyBh
IGNsZWFuIGFycmF5CglnZXQ6IGZ1bmN0aW9uKCBudW0gKSB7CgkJcmV0dXJuIG51
bSA9PSBudWxsID8KCgkJCS8vIFJldHVybiBhICdjbGVhbicgYXJyYXkKCQkJdGhp
cy50b0FycmF5KCkgOgoKCQkJLy8gUmV0dXJuIGp1c3QgdGhlIG9iamVjdAoJCQko
IG51bSA8IDAgPyB0aGlzWyB0aGlzLmxlbmd0aCArIG51bSBdIDogdGhpc1sgbnVt
IF0gKTsKCX0sCgoJLy8gVGFrZSBhbiBhcnJheSBvZiBlbGVtZW50cyBhbmQgcHVz
aCBpdCBvbnRvIHRoZSBzdGFjawoJLy8gKHJldHVybmluZyB0aGUgbmV3IG1hdGNo
ZWQgZWxlbWVudCBzZXQpCglwdXNoU3RhY2s6IGZ1bmN0aW9uKCBlbGVtcywgbmFt
ZSwgc2VsZWN0b3IgKSB7CgkJLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQg
ZWxlbWVudCBzZXQKCQl2YXIgcmV0ID0gdGhpcy5jb25zdHJ1Y3RvcigpOwoKCQlp
ZiAoIGpRdWVyeS5pc0FycmF5KCBlbGVtcyApICkgewoJCQlwdXNoLmFwcGx5KCBy
ZXQsIGVsZW1zICk7CgoJCX0gZWxzZSB7CgkJCWpRdWVyeS5tZXJnZSggcmV0LCBl
bGVtcyApOwoJCX0KCgkJLy8gQWRkIHRoZSBvbGQgb2JqZWN0IG9udG8gdGhlIHN0
YWNrIChhcyBhIHJlZmVyZW5jZSkKCQlyZXQucHJldk9iamVjdCA9IHRoaXM7CgoJ
CXJldC5jb250ZXh0ID0gdGhpcy5jb250ZXh0OwoKCQlpZiAoIG5hbWUgPT09ICJm
aW5kIiApIHsKCQkJcmV0LnNlbGVjdG9yID0gdGhpcy5zZWxlY3RvciArICggdGhp
cy5zZWxlY3RvciA/ICIgIiA6ICIiICkgKyBzZWxlY3RvcjsKCQl9IGVsc2UgaWYg
KCBuYW1lICkgewoJCQlyZXQuc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yICsgIi4i
ICsgbmFtZSArICIoIiArIHNlbGVjdG9yICsgIikiOwoJCX0KCgkJLy8gUmV0dXJu
IHRoZSBuZXdseS1mb3JtZWQgZWxlbWVudCBzZXQKCQlyZXR1cm4gcmV0OwoJfSwK
CgkvLyBFeGVjdXRlIGEgY2FsbGJhY2sgZm9yIGV2ZXJ5IGVsZW1lbnQgaW4gdGhl
IG1hdGNoZWQgc2V0LgoJLy8gKFlvdSBjYW4gc2VlZCB0aGUgYXJndW1lbnRzIHdp
dGggYW4gYXJyYXkgb2YgYXJncywgYnV0IHRoaXMgaXMKCS8vIG9ubHkgdXNlZCBp
bnRlcm5hbGx5LikKCWVhY2g6IGZ1bmN0aW9uKCBjYWxsYmFjaywgYXJncyApIHsK
CQlyZXR1cm4galF1ZXJ5LmVhY2goIHRoaXMsIGNhbGxiYWNrLCBhcmdzICk7Cgl9
LAoKCXJlYWR5OiBmdW5jdGlvbiggZm4gKSB7CgkJLy8gQXR0YWNoIHRoZSBsaXN0
ZW5lcnMKCQlqUXVlcnkuYmluZFJlYWR5KCk7CgoJCS8vIEFkZCB0aGUgY2FsbGJh
Y2sKCQlyZWFkeUxpc3QuYWRkKCBmbiApOwoKCQlyZXR1cm4gdGhpczsKCX0sCgoJ
ZXE6IGZ1bmN0aW9uKCBpICkgewoJCWkgPSAraTsKCQlyZXR1cm4gaSA9PT0gLTEg
PwoJCQl0aGlzLnNsaWNlKCBpICkgOgoJCQl0aGlzLnNsaWNlKCBpLCBpICsgMSAp
OwoJfSwKCglmaXJzdDogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHRoaXMuZXEoIDAg
KTsKCX0sCgoJbGFzdDogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHRoaXMuZXEoIC0x
ICk7Cgl9LAoKCXNsaWNlOiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gdGhpcy5wdXNo
U3RhY2soIHNsaWNlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSwKCQkJInNsaWNl
Iiwgc2xpY2UuY2FsbChhcmd1bWVudHMpLmpvaW4oIiwiKSApOwoJfSwKCgltYXA6
IGZ1bmN0aW9uKCBjYWxsYmFjayApIHsKCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2so
IGpRdWVyeS5tYXAodGhpcywgZnVuY3Rpb24oIGVsZW0sIGkgKSB7CgkJCXJldHVy
biBjYWxsYmFjay5jYWxsKCBlbGVtLCBpLCBlbGVtICk7CgkJfSkpOwoJfSwKCgll
bmQ6IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLnByZXZPYmplY3QgfHwgdGhp
cy5jb25zdHJ1Y3RvcihudWxsKTsKCX0sCgoJLy8gRm9yIGludGVybmFsIHVzZSBv
bmx5LgoJLy8gQmVoYXZlcyBsaWtlIGFuIEFycmF5J3MgbWV0aG9kLCBub3QgbGlr
ZSBhIGpRdWVyeSBtZXRob2QuCglwdXNoOiBwdXNoLAoJc29ydDogW10uc29ydCwK
CXNwbGljZTogW10uc3BsaWNlCn07CgovLyBHaXZlIHRoZSBpbml0IGZ1bmN0aW9u
IHRoZSBqUXVlcnkgcHJvdG90eXBlIGZvciBsYXRlciBpbnN0YW50aWF0aW9uCmpR
dWVyeS5mbi5pbml0LnByb3RvdHlwZSA9IGpRdWVyeS5mbjsKCmpRdWVyeS5leHRl
bmQgPSBqUXVlcnkuZm4uZXh0ZW5kID0gZnVuY3Rpb24oKSB7Cgl2YXIgb3B0aW9u
cywgbmFtZSwgc3JjLCBjb3B5LCBjb3B5SXNBcnJheSwgY2xvbmUsCgkJdGFyZ2V0
ID0gYXJndW1lbnRzWzBdIHx8IHt9LAoJCWkgPSAxLAoJCWxlbmd0aCA9IGFyZ3Vt
ZW50cy5sZW5ndGgsCgkJZGVlcCA9IGZhbHNlOwoKCS8vIEhhbmRsZSBhIGRlZXAg
Y29weSBzaXR1YXRpb24KCWlmICggdHlwZW9mIHRhcmdldCA9PT0gImJvb2xlYW4i
ICkgewoJCWRlZXAgPSB0YXJnZXQ7CgkJdGFyZ2V0ID0gYXJndW1lbnRzWzFdIHx8
IHt9OwoJCS8vIHNraXAgdGhlIGJvb2xlYW4gYW5kIHRoZSB0YXJnZXQKCQlpID0g
MjsKCX0KCgkvLyBIYW5kbGUgY2FzZSB3aGVuIHRhcmdldCBpcyBhIHN0cmluZyBv
ciBzb21ldGhpbmcgKHBvc3NpYmxlIGluIGRlZXAgY29weSkKCWlmICggdHlwZW9m
IHRhcmdldCAhPT0gIm9iamVjdCIgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKHRhcmdl
dCkgKSB7CgkJdGFyZ2V0ID0ge307Cgl9CgoJLy8gZXh0ZW5kIGpRdWVyeSBpdHNl
bGYgaWYgb25seSBvbmUgYXJndW1lbnQgaXMgcGFzc2VkCglpZiAoIGxlbmd0aCA9
PT0gaSApIHsKCQl0YXJnZXQgPSB0aGlzOwoJCS0taTsKCX0KCglmb3IgKCA7IGkg
PCBsZW5ndGg7IGkrKyApIHsKCQkvLyBPbmx5IGRlYWwgd2l0aCBub24tbnVsbC91
bmRlZmluZWQgdmFsdWVzCgkJaWYgKCAob3B0aW9ucyA9IGFyZ3VtZW50c1sgaSBd
KSAhPSBudWxsICkgewoJCQkvLyBFeHRlbmQgdGhlIGJhc2Ugb2JqZWN0CgkJCWZv
ciAoIG5hbWUgaW4gb3B0aW9ucyApIHsKCQkJCXNyYyA9IHRhcmdldFsgbmFtZSBd
OwoJCQkJY29weSA9IG9wdGlvbnNbIG5hbWUgXTsKCgkJCQkvLyBQcmV2ZW50IG5l
dmVyLWVuZGluZyBsb29wCgkJCQlpZiAoIHRhcmdldCA9PT0gY29weSApIHsKCQkJ
CQljb250aW51ZTsKCQkJCX0KCgkJCQkvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdp
bmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXMKCQkJCWlmICggZGVlcCAmJiBjb3B5
ICYmICggalF1ZXJ5LmlzUGxhaW5PYmplY3QoY29weSkgfHwgKGNvcHlJc0FycmF5
ID0galF1ZXJ5LmlzQXJyYXkoY29weSkpICkgKSB7CgkJCQkJaWYgKCBjb3B5SXNB
cnJheSApIHsKCQkJCQkJY29weUlzQXJyYXkgPSBmYWxzZTsKCQkJCQkJY2xvbmUg
PSBzcmMgJiYgalF1ZXJ5LmlzQXJyYXkoc3JjKSA/IHNyYyA6IFtdOwoKCQkJCQl9
IGVsc2UgewoJCQkJCQljbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNQbGFpbk9iamVj
dChzcmMpID8gc3JjIDoge307CgkJCQkJfQoKCQkJCQkvLyBOZXZlciBtb3ZlIG9y
aWdpbmFsIG9iamVjdHMsIGNsb25lIHRoZW0KCQkJCQl0YXJnZXRbIG5hbWUgXSA9
IGpRdWVyeS5leHRlbmQoIGRlZXAsIGNsb25lLCBjb3B5ICk7CgoJCQkJLy8gRG9u
J3QgYnJpbmcgaW4gdW5kZWZpbmVkIHZhbHVlcwoJCQkJfSBlbHNlIGlmICggY29w
eSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXRhcmdldFsgbmFtZSBdID0gY29weTsK
CQkJCX0KCQkJfQoJCX0KCX0KCgkvLyBSZXR1cm4gdGhlIG1vZGlmaWVkIG9iamVj
dAoJcmV0dXJuIHRhcmdldDsKfTsKCmpRdWVyeS5leHRlbmQoewoJbm9Db25mbGlj
dDogZnVuY3Rpb24oIGRlZXAgKSB7CgkJaWYgKCB3aW5kb3cuJCA9PT0galF1ZXJ5
ICkgewoJCQl3aW5kb3cuJCA9IF8kOwoJCX0KCgkJaWYgKCBkZWVwICYmIHdpbmRv
dy5qUXVlcnkgPT09IGpRdWVyeSApIHsKCQkJd2luZG93LmpRdWVyeSA9IF9qUXVl
cnk7CgkJfQoKCQlyZXR1cm4galF1ZXJ5OwoJfSwKCgkvLyBJcyB0aGUgRE9NIHJl
YWR5IHRvIGJlIHVzZWQ/IFNldCB0byB0cnVlIG9uY2UgaXQgb2NjdXJzLgoJaXNS
ZWFkeTogZmFsc2UsCgoJLy8gQSBjb3VudGVyIHRvIHRyYWNrIGhvdyBtYW55IGl0
ZW1zIHRvIHdhaXQgZm9yIGJlZm9yZQoJLy8gdGhlIHJlYWR5IGV2ZW50IGZpcmVz
LiBTZWUgIzY3ODEKCXJlYWR5V2FpdDogMSwKCgkvLyBIb2xkIChvciByZWxlYXNl
KSB0aGUgcmVhZHkgZXZlbnQKCWhvbGRSZWFkeTogZnVuY3Rpb24oIGhvbGQgKSB7
CgkJaWYgKCBob2xkICkgewoJCQlqUXVlcnkucmVhZHlXYWl0Kys7CgkJfSBlbHNl
IHsKCQkJalF1ZXJ5LnJlYWR5KCB0cnVlICk7CgkJfQoJfSwKCgkvLyBIYW5kbGUg
d2hlbiB0aGUgRE9NIGlzIHJlYWR5CglyZWFkeTogZnVuY3Rpb24oIHdhaXQgKSB7
CgkJLy8gRWl0aGVyIGEgcmVsZWFzZWQgaG9sZCBvciBhbiBET01yZWFkeS9sb2Fk
IGV2ZW50IGFuZCBub3QgeWV0IHJlYWR5CgkJaWYgKCAod2FpdCA9PT0gdHJ1ZSAm
JiAhLS1qUXVlcnkucmVhZHlXYWl0KSB8fCAod2FpdCAhPT0gdHJ1ZSAmJiAhalF1
ZXJ5LmlzUmVhZHkpICkgewoJCQkvLyBNYWtlIHN1cmUgYm9keSBleGlzdHMsIGF0
IGxlYXN0LCBpbiBjYXNlIElFIGdldHMgYSBsaXR0bGUgb3ZlcnplYWxvdXMgKHRp
Y2tldCAjNTQ0MykuCgkJCWlmICggIWRvY3VtZW50LmJvZHkgKSB7CgkJCQlyZXR1
cm4gc2V0VGltZW91dCggalF1ZXJ5LnJlYWR5LCAxICk7CgkJCX0KCgkJCS8vIFJl
bWVtYmVyIHRoYXQgdGhlIERPTSBpcyByZWFkeQoJCQlqUXVlcnkuaXNSZWFkeSA9
IHRydWU7CgoJCQkvLyBJZiBhIG5vcm1hbCBET00gUmVhZHkgZXZlbnQgZmlyZWQs
IGRlY3JlbWVudCwgYW5kIHdhaXQgaWYgbmVlZCBiZQoJCQlpZiAoIHdhaXQgIT09
IHRydWUgJiYgLS1qUXVlcnkucmVhZHlXYWl0ID4gMCApIHsKCQkJCXJldHVybjsK
CQkJfQoKCQkJLy8gSWYgdGhlcmUgYXJlIGZ1bmN0aW9ucyBib3VuZCwgdG8gZXhl
Y3V0ZQoJCQlyZWFkeUxpc3QuZmlyZVdpdGgoIGRvY3VtZW50LCBbIGpRdWVyeSBd
ICk7CgoJCQkvLyBUcmlnZ2VyIGFueSBib3VuZCByZWFkeSBldmVudHMKCQkJaWYg
KCBqUXVlcnkuZm4udHJpZ2dlciApIHsKCQkJCWpRdWVyeSggZG9jdW1lbnQgKS50
cmlnZ2VyKCAicmVhZHkiICkub2ZmKCAicmVhZHkiICk7CgkJCX0KCQl9Cgl9LAoK
CWJpbmRSZWFkeTogZnVuY3Rpb24oKSB7CgkJaWYgKCByZWFkeUxpc3QgKSB7CgkJ
CXJldHVybjsKCQl9CgoJCXJlYWR5TGlzdCA9IGpRdWVyeS5DYWxsYmFja3MoICJv
bmNlIG1lbW9yeSIgKTsKCgkJLy8gQ2F0Y2ggY2FzZXMgd2hlcmUgJChkb2N1bWVu
dCkucmVhZHkoKSBpcyBjYWxsZWQgYWZ0ZXIgdGhlCgkJLy8gYnJvd3NlciBldmVu
dCBoYXMgYWxyZWFkeSBvY2N1cnJlZC4KCQlpZiAoIGRvY3VtZW50LnJlYWR5U3Rh
dGUgPT09ICJjb21wbGV0ZSIgKSB7CgkJCS8vIEhhbmRsZSBpdCBhc3luY2hyb25v
dXNseSB0byBhbGxvdyBzY3JpcHRzIHRoZSBvcHBvcnR1bml0eSB0byBkZWxheSBy
ZWFkeQoJCQlyZXR1cm4gc2V0VGltZW91dCggalF1ZXJ5LnJlYWR5LCAxICk7CgkJ
fQoKCQkvLyBNb3ppbGxhLCBPcGVyYSBhbmQgd2Via2l0IG5pZ2h0bGllcyBjdXJy
ZW50bHkgc3VwcG9ydCB0aGlzIGV2ZW50CgkJaWYgKCBkb2N1bWVudC5hZGRFdmVu
dExpc3RlbmVyICkgewoJCQkvLyBVc2UgdGhlIGhhbmR5IGV2ZW50IGNhbGxiYWNr
CgkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICJET01Db250ZW50TG9hZGVk
IiwgRE9NQ29udGVudExvYWRlZCwgZmFsc2UgKTsKCgkJCS8vIEEgZmFsbGJhY2sg
dG8gd2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrCgkJCXdpbmRv
dy5hZGRFdmVudExpc3RlbmVyKCAibG9hZCIsIGpRdWVyeS5yZWFkeSwgZmFsc2Ug
KTsKCgkJLy8gSWYgSUUgZXZlbnQgbW9kZWwgaXMgdXNlZAoJCX0gZWxzZSBpZiAo
IGRvY3VtZW50LmF0dGFjaEV2ZW50ICkgewoJCQkvLyBlbnN1cmUgZmlyaW5nIGJl
Zm9yZSBvbmxvYWQsCgkJCS8vIG1heWJlIGxhdGUgYnV0IHNhZmUgYWxzbyBmb3Ig
aWZyYW1lcwoJCQlkb2N1bWVudC5hdHRhY2hFdmVudCggIm9ucmVhZHlzdGF0ZWNo
YW5nZSIsIERPTUNvbnRlbnRMb2FkZWQgKTsKCgkJCS8vIEEgZmFsbGJhY2sgdG8g
d2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrCgkJCXdpbmRvdy5h
dHRhY2hFdmVudCggIm9ubG9hZCIsIGpRdWVyeS5yZWFkeSApOwoKCQkJLy8gSWYg
SUUgYW5kIG5vdCBhIGZyYW1lCgkJCS8vIGNvbnRpbnVhbGx5IGNoZWNrIHRvIHNl
ZSBpZiB0aGUgZG9jdW1lbnQgaXMgcmVhZHkKCQkJdmFyIHRvcGxldmVsID0gZmFs
c2U7CgoJCQl0cnkgewoJCQkJdG9wbGV2ZWwgPSB3aW5kb3cuZnJhbWVFbGVtZW50
ID09IG51bGw7CgkJCX0gY2F0Y2goZSkge30KCgkJCWlmICggZG9jdW1lbnQuZG9j
dW1lbnRFbGVtZW50LmRvU2Nyb2xsICYmIHRvcGxldmVsICkgewoJCQkJZG9TY3Jv
bGxDaGVjaygpOwoJCQl9CgkJfQoJfSwKCgkvLyBTZWUgdGVzdC91bml0L2NvcmUu
anMgZm9yIGRldGFpbHMgY29uY2VybmluZyBpc0Z1bmN0aW9uLgoJLy8gU2luY2Ug
dmVyc2lvbiAxLjMsIERPTSBtZXRob2RzIGFuZCBmdW5jdGlvbnMgbGlrZSBhbGVy
dAoJLy8gYXJlbid0IHN1cHBvcnRlZC4gVGhleSByZXR1cm4gZmFsc2Ugb24gSUUg
KCMyOTY4KS4KCWlzRnVuY3Rpb246IGZ1bmN0aW9uKCBvYmogKSB7CgkJcmV0dXJu
IGpRdWVyeS50eXBlKG9iaikgPT09ICJmdW5jdGlvbiI7Cgl9LAoKCWlzQXJyYXk6
IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24oIG9iaiApIHsKCQlyZXR1cm4galF1
ZXJ5LnR5cGUob2JqKSA9PT0gImFycmF5IjsKCX0sCgoJaXNXaW5kb3c6IGZ1bmN0
aW9uKCBvYmogKSB7CgkJcmV0dXJuIG9iaiAhPSBudWxsICYmIG9iaiA9PSBvYmou
d2luZG93OwoJfSwKCglpc051bWVyaWM6IGZ1bmN0aW9uKCBvYmogKSB7CgkJcmV0
dXJuICFpc05hTiggcGFyc2VGbG9hdChvYmopICkgJiYgaXNGaW5pdGUoIG9iaiAp
OwoJfSwKCgl0eXBlOiBmdW5jdGlvbiggb2JqICkgewoJCXJldHVybiBvYmogPT0g
bnVsbCA/CgkJCVN0cmluZyggb2JqICkgOgoJCQljbGFzczJ0eXBlWyB0b1N0cmlu
Zy5jYWxsKG9iaikgXSB8fCAib2JqZWN0IjsKCX0sCgoJaXNQbGFpbk9iamVjdDog
ZnVuY3Rpb24oIG9iaiApIHsKCQkvLyBNdXN0IGJlIGFuIE9iamVjdC4KCQkvLyBC
ZWNhdXNlIG9mIElFLCB3ZSBhbHNvIGhhdmUgdG8gY2hlY2sgdGhlIHByZXNlbmNl
IG9mIHRoZSBjb25zdHJ1Y3RvciBwcm9wZXJ0eS4KCQkvLyBNYWtlIHN1cmUgdGhh
dCBET00gbm9kZXMgYW5kIHdpbmRvdyBvYmplY3RzIGRvbid0IHBhc3MgdGhyb3Vn
aCwgYXMgd2VsbAoJCWlmICggIW9iaiB8fCBqUXVlcnkudHlwZShvYmopICE9PSAi
b2JqZWN0IiB8fCBvYmoubm9kZVR5cGUgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmog
KSApIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJdHJ5IHsKCQkJLy8gTm90IG93
biBjb25zdHJ1Y3RvciBwcm9wZXJ0eSBtdXN0IGJlIE9iamVjdAoJCQlpZiAoIG9i
ai5jb25zdHJ1Y3RvciAmJgoJCQkJIWhhc093bi5jYWxsKG9iaiwgImNvbnN0cnVj
dG9yIikgJiYKCQkJCSFoYXNPd24uY2FsbChvYmouY29uc3RydWN0b3IucHJvdG90
eXBlLCAiaXNQcm90b3R5cGVPZiIpICkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9
CgkJfSBjYXRjaCAoIGUgKSB7CgkJCS8vIElFOCw5IFdpbGwgdGhyb3cgZXhjZXB0
aW9ucyBvbiBjZXJ0YWluIGhvc3Qgb2JqZWN0cyAjOTg5NwoJCQlyZXR1cm4gZmFs
c2U7CgkJfQoKCQkvLyBPd24gcHJvcGVydGllcyBhcmUgZW51bWVyYXRlZCBmaXJz
dGx5LCBzbyB0byBzcGVlZCB1cCwKCQkvLyBpZiBsYXN0IG9uZSBpcyBvd24sIHRo
ZW4gYWxsIHByb3BlcnRpZXMgYXJlIG93bi4KCgkJdmFyIGtleTsKCQlmb3IgKCBr
ZXkgaW4gb2JqICkge30KCgkJcmV0dXJuIGtleSA9PT0gdW5kZWZpbmVkIHx8IGhh
c093bi5jYWxsKCBvYmosIGtleSApOwoJfSwKCglpc0VtcHR5T2JqZWN0OiBmdW5j
dGlvbiggb2JqICkgewoJCWZvciAoIHZhciBuYW1lIGluIG9iaiApIHsKCQkJcmV0
dXJuIGZhbHNlOwoJCX0KCQlyZXR1cm4gdHJ1ZTsKCX0sCgoJZXJyb3I6IGZ1bmN0
aW9uKCBtc2cgKSB7CgkJdGhyb3cgbmV3IEVycm9yKCBtc2cgKTsKCX0sCgoJcGFy
c2VKU09OOiBmdW5jdGlvbiggZGF0YSApIHsKCQlpZiAoIHR5cGVvZiBkYXRhICE9
PSAic3RyaW5nIiB8fCAhZGF0YSApIHsKCQkJcmV0dXJuIG51bGw7CgkJfQoKCQkv
LyBNYWtlIHN1cmUgbGVhZGluZy90cmFpbGluZyB3aGl0ZXNwYWNlIGlzIHJlbW92
ZWQgKElFIGNhbid0IGhhbmRsZSBpdCkKCQlkYXRhID0galF1ZXJ5LnRyaW0oIGRh
dGEgKTsKCgkJLy8gQXR0ZW1wdCB0byBwYXJzZSB1c2luZyB0aGUgbmF0aXZlIEpT
T04gcGFyc2VyIGZpcnN0CgkJaWYgKCB3aW5kb3cuSlNPTiAmJiB3aW5kb3cuSlNP
Ti5wYXJzZSApIHsKCQkJcmV0dXJuIHdpbmRvdy5KU09OLnBhcnNlKCBkYXRhICk7
CgkJfQoKCQkvLyBNYWtlIHN1cmUgdGhlIGluY29taW5nIGRhdGEgaXMgYWN0dWFs
IEpTT04KCQkvLyBMb2dpYyBib3Jyb3dlZCBmcm9tIGh0dHA6Ly9qc29uLm9yZy9q
c29uMi5qcwoJCWlmICggcnZhbGlkY2hhcnMudGVzdCggZGF0YS5yZXBsYWNlKCBy
dmFsaWRlc2NhcGUsICJAIiApCgkJCS5yZXBsYWNlKCBydmFsaWR0b2tlbnMsICJd
IiApCgkJCS5yZXBsYWNlKCBydmFsaWRicmFjZXMsICIiKSkgKSB7CgoJCQlyZXR1
cm4gKCBuZXcgRnVuY3Rpb24oICJyZXR1cm4gIiArIGRhdGEgKSApKCk7CgoJCX0K
CQlqUXVlcnkuZXJyb3IoICJJbnZhbGlkIEpTT046ICIgKyBkYXRhICk7Cgl9LAoK
CS8vIENyb3NzLWJyb3dzZXIgeG1sIHBhcnNpbmcKCXBhcnNlWE1MOiBmdW5jdGlv
biggZGF0YSApIHsKCQlpZiAoIHR5cGVvZiBkYXRhICE9PSAic3RyaW5nIiB8fCAh
ZGF0YSApIHsKCQkJcmV0dXJuIG51bGw7CgkJfQoJCXZhciB4bWwsIHRtcDsKCQl0
cnkgewoJCQlpZiAoIHdpbmRvdy5ET01QYXJzZXIgKSB7IC8vIFN0YW5kYXJkCgkJ
CQl0bXAgPSBuZXcgRE9NUGFyc2VyKCk7CgkJCQl4bWwgPSB0bXAucGFyc2VGcm9t
U3RyaW5nKCBkYXRhICwgInRleHQveG1sIiApOwoJCQl9IGVsc2UgeyAvLyBJRQoJ
CQkJeG1sID0gbmV3IEFjdGl2ZVhPYmplY3QoICJNaWNyb3NvZnQuWE1MRE9NIiAp
OwoJCQkJeG1sLmFzeW5jID0gImZhbHNlIjsKCQkJCXhtbC5sb2FkWE1MKCBkYXRh
ICk7CgkJCX0KCQl9IGNhdGNoKCBlICkgewoJCQl4bWwgPSB1bmRlZmluZWQ7CgkJ
fQoJCWlmICggIXhtbCB8fCAheG1sLmRvY3VtZW50RWxlbWVudCB8fCB4bWwuZ2V0
RWxlbWVudHNCeVRhZ05hbWUoICJwYXJzZXJlcnJvciIgKS5sZW5ndGggKSB7CgkJ
CWpRdWVyeS5lcnJvciggIkludmFsaWQgWE1MOiAiICsgZGF0YSApOwoJCX0KCQly
ZXR1cm4geG1sOwoJfSwKCglub29wOiBmdW5jdGlvbigpIHt9LAoKCS8vIEV2YWx1
YXRlcyBhIHNjcmlwdCBpbiBhIGdsb2JhbCBjb250ZXh0CgkvLyBXb3JrYXJvdW5k
cyBiYXNlZCBvbiBmaW5kaW5ncyBieSBKaW0gRHJpc2NvbGwKCS8vIGh0dHA6Ly93
ZWJsb2dzLmphdmEubmV0L2Jsb2cvZHJpc2NvbGwvYXJjaGl2ZS8yMDA5LzA5LzA4
L2V2YWwtamF2YXNjcmlwdC1nbG9iYWwtY29udGV4dAoJZ2xvYmFsRXZhbDogZnVu
Y3Rpb24oIGRhdGEgKSB7CgkJaWYgKCBkYXRhICYmIHJub3R3aGl0ZS50ZXN0KCBk
YXRhICkgKSB7CgkJCS8vIFdlIHVzZSBleGVjU2NyaXB0IG9uIEludGVybmV0IEV4
cGxvcmVyCgkJCS8vIFdlIHVzZSBhbiBhbm9ueW1vdXMgZnVuY3Rpb24gc28gdGhh
dCBjb250ZXh0IGlzIHdpbmRvdwoJCQkvLyByYXRoZXIgdGhhbiBqUXVlcnkgaW4g
RmlyZWZveAoJCQkoIHdpbmRvdy5leGVjU2NyaXB0IHx8IGZ1bmN0aW9uKCBkYXRh
ICkgewoJCQkJd2luZG93WyAiZXZhbCIgXS5jYWxsKCB3aW5kb3csIGRhdGEgKTsK
CQkJfSApKCBkYXRhICk7CgkJfQoJfSwKCgkvLyBDb252ZXJ0IGRhc2hlZCB0byBj
YW1lbENhc2U7IHVzZWQgYnkgdGhlIGNzcyBhbmQgZGF0YSBtb2R1bGVzCgkvLyBN
aWNyb3NvZnQgZm9yZ290IHRvIGh1bXAgdGhlaXIgdmVuZG9yIHByZWZpeCAoIzk1
NzIpCgljYW1lbENhc2U6IGZ1bmN0aW9uKCBzdHJpbmcgKSB7CgkJcmV0dXJuIHN0
cmluZy5yZXBsYWNlKCBybXNQcmVmaXgsICJtcy0iICkucmVwbGFjZSggcmRhc2hB
bHBoYSwgZmNhbWVsQ2FzZSApOwoJfSwKCglub2RlTmFtZTogZnVuY3Rpb24oIGVs
ZW0sIG5hbWUgKSB7CgkJcmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2Rl
TmFtZS50b1VwcGVyQ2FzZSgpID09PSBuYW1lLnRvVXBwZXJDYXNlKCk7Cgl9LAoK
CS8vIGFyZ3MgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHkKCWVhY2g6IGZ1bmN0
aW9uKCBvYmplY3QsIGNhbGxiYWNrLCBhcmdzICkgewoJCXZhciBuYW1lLCBpID0g
MCwKCQkJbGVuZ3RoID0gb2JqZWN0Lmxlbmd0aCwKCQkJaXNPYmogPSBsZW5ndGgg
PT09IHVuZGVmaW5lZCB8fCBqUXVlcnkuaXNGdW5jdGlvbiggb2JqZWN0ICk7CgoJ
CWlmICggYXJncyApIHsKCQkJaWYgKCBpc09iaiApIHsKCQkJCWZvciAoIG5hbWUg
aW4gb2JqZWN0ICkgewoJCQkJCWlmICggY2FsbGJhY2suYXBwbHkoIG9iamVjdFsg
bmFtZSBdLCBhcmdzICkgPT09IGZhbHNlICkgewoJCQkJCQlicmVhazsKCQkJCQl9
CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQlmb3IgKCA7IGkgPCBsZW5ndGg7ICkgewoJ
CQkJCWlmICggY2FsbGJhY2suYXBwbHkoIG9iamVjdFsgaSsrIF0sIGFyZ3MgKSA9
PT0gZmFsc2UgKSB7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkv
LyBBIHNwZWNpYWwsIGZhc3QsIGNhc2UgZm9yIHRoZSBtb3N0IGNvbW1vbiB1c2Ug
b2YgZWFjaAoJCX0gZWxzZSB7CgkJCWlmICggaXNPYmogKSB7CgkJCQlmb3IgKCBu
YW1lIGluIG9iamVjdCApIHsKCQkJCQlpZiAoIGNhbGxiYWNrLmNhbGwoIG9iamVj
dFsgbmFtZSBdLCBuYW1lLCBvYmplY3RbIG5hbWUgXSApID09PSBmYWxzZSApIHsK
CQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9IGVsc2UgewoJCQkJZm9yICgg
OyBpIDwgbGVuZ3RoOyApIHsKCQkJCQlpZiAoIGNhbGxiYWNrLmNhbGwoIG9iamVj
dFsgaSBdLCBpLCBvYmplY3RbIGkrKyBdICkgPT09IGZhbHNlICkgewoJCQkJCQli
cmVhazsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBvYmplY3Q7Cgl9
LAoKCS8vIFVzZSBuYXRpdmUgU3RyaW5nLnRyaW0gZnVuY3Rpb24gd2hlcmV2ZXIg
cG9zc2libGUKCXRyaW06IHRyaW0gPwoJCWZ1bmN0aW9uKCB0ZXh0ICkgewoJCQly
ZXR1cm4gdGV4dCA9PSBudWxsID8KCQkJCSIiIDoKCQkJCXRyaW0uY2FsbCggdGV4
dCApOwoJCX0gOgoKCQkvLyBPdGhlcndpc2UgdXNlIG91ciBvd24gdHJpbW1pbmcg
ZnVuY3Rpb25hbGl0eQoJCWZ1bmN0aW9uKCB0ZXh0ICkgewoJCQlyZXR1cm4gdGV4
dCA9PSBudWxsID8KCQkJCSIiIDoKCQkJCXRleHQudG9TdHJpbmcoKS5yZXBsYWNl
KCB0cmltTGVmdCwgIiIgKS5yZXBsYWNlKCB0cmltUmlnaHQsICIiICk7CgkJfSwK
CgkvLyByZXN1bHRzIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CgltYWtlQXJy
YXk6IGZ1bmN0aW9uKCBhcnJheSwgcmVzdWx0cyApIHsKCQl2YXIgcmV0ID0gcmVz
dWx0cyB8fCBbXTsKCgkJaWYgKCBhcnJheSAhPSBudWxsICkgewoJCQkvLyBUaGUg
d2luZG93LCBzdHJpbmdzIChhbmQgZnVuY3Rpb25zKSBhbHNvIGhhdmUgJ2xlbmd0
aCcKCQkJLy8gVHdlYWtlZCBsb2dpYyBzbGlnaHRseSB0byBoYW5kbGUgQmxhY2ti
ZXJyeSA0LjcgUmVnRXhwIGlzc3VlcyAjNjkzMAoJCQl2YXIgdHlwZSA9IGpRdWVy
eS50eXBlKCBhcnJheSApOwoKCQkJaWYgKCBhcnJheS5sZW5ndGggPT0gbnVsbCB8
fCB0eXBlID09PSAic3RyaW5nIiB8fCB0eXBlID09PSAiZnVuY3Rpb24iIHx8IHR5
cGUgPT09ICJyZWdleHAiIHx8IGpRdWVyeS5pc1dpbmRvdyggYXJyYXkgKSApIHsK
CQkJCXB1c2guY2FsbCggcmV0LCBhcnJheSApOwoJCQl9IGVsc2UgewoJCQkJalF1
ZXJ5Lm1lcmdlKCByZXQsIGFycmF5ICk7CgkJCX0KCQl9CgoJCXJldHVybiByZXQ7
Cgl9LAoKCWluQXJyYXk6IGZ1bmN0aW9uKCBlbGVtLCBhcnJheSwgaSApIHsKCQl2
YXIgbGVuOwoKCQlpZiAoIGFycmF5ICkgewoJCQlpZiAoIGluZGV4T2YgKSB7CgkJ
CQlyZXR1cm4gaW5kZXhPZi5jYWxsKCBhcnJheSwgZWxlbSwgaSApOwoJCQl9CgoJ
CQlsZW4gPSBhcnJheS5sZW5ndGg7CgkJCWkgPSBpID8gaSA8IDAgPyBNYXRoLm1h
eCggMCwgbGVuICsgaSApIDogaSA6IDA7CgoJCQlmb3IgKCA7IGkgPCBsZW47IGkr
KyApIHsKCQkJCS8vIFNraXAgYWNjZXNzaW5nIGluIHNwYXJzZSBhcnJheXMKCQkJ
CWlmICggaSBpbiBhcnJheSAmJiBhcnJheVsgaSBdID09PSBlbGVtICkgewoJCQkJ
CXJldHVybiBpOwoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4gLTE7Cgl9LAoKCW1l
cmdlOiBmdW5jdGlvbiggZmlyc3QsIHNlY29uZCApIHsKCQl2YXIgaSA9IGZpcnN0
Lmxlbmd0aCwKCQkJaiA9IDA7CgoJCWlmICggdHlwZW9mIHNlY29uZC5sZW5ndGgg
PT09ICJudW1iZXIiICkgewoJCQlmb3IgKCB2YXIgbCA9IHNlY29uZC5sZW5ndGg7
IGogPCBsOyBqKysgKSB7CgkJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGogXTsK
CQkJfQoKCQl9IGVsc2UgewoJCQl3aGlsZSAoIHNlY29uZFtqXSAhPT0gdW5kZWZp
bmVkICkgewoJCQkJZmlyc3RbIGkrKyBdID0gc2Vjb25kWyBqKysgXTsKCQkJfQoJ
CX0KCgkJZmlyc3QubGVuZ3RoID0gaTsKCgkJcmV0dXJuIGZpcnN0OwoJfSwKCgln
cmVwOiBmdW5jdGlvbiggZWxlbXMsIGNhbGxiYWNrLCBpbnYgKSB7CgkJdmFyIHJl
dCA9IFtdLCByZXRWYWw7CgkJaW52ID0gISFpbnY7CgoJCS8vIEdvIHRocm91Z2gg
dGhlIGFycmF5LCBvbmx5IHNhdmluZyB0aGUgaXRlbXMKCQkvLyB0aGF0IHBhc3Mg
dGhlIHZhbGlkYXRvciBmdW5jdGlvbgoJCWZvciAoIHZhciBpID0gMCwgbGVuZ3Ro
ID0gZWxlbXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCXJldFZhbCA9
ICEhY2FsbGJhY2soIGVsZW1zWyBpIF0sIGkgKTsKCQkJaWYgKCBpbnYgIT09IHJl
dFZhbCApIHsKCQkJCXJldC5wdXNoKCBlbGVtc1sgaSBdICk7CgkJCX0KCQl9CgoJ
CXJldHVybiByZXQ7Cgl9LAoKCS8vIGFyZyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ug
b25seQoJbWFwOiBmdW5jdGlvbiggZWxlbXMsIGNhbGxiYWNrLCBhcmcgKSB7CgkJ
dmFyIHZhbHVlLCBrZXksIHJldCA9IFtdLAoJCQlpID0gMCwKCQkJbGVuZ3RoID0g
ZWxlbXMubGVuZ3RoLAoJCQkvLyBqcXVlcnkgb2JqZWN0cyBhcmUgdHJlYXRlZCBh
cyBhcnJheXMKCQkJaXNBcnJheSA9IGVsZW1zIGluc3RhbmNlb2YgalF1ZXJ5IHx8
IGxlbmd0aCAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBsZW5ndGggPT09ICJudW1i
ZXIiICYmICggKCBsZW5ndGggPiAwICYmIGVsZW1zWyAwIF0gJiYgZWxlbXNbIGxl
bmd0aCAtMSBdICkgfHwgbGVuZ3RoID09PSAwIHx8IGpRdWVyeS5pc0FycmF5KCBl
bGVtcyApICkgOwoKCQkvLyBHbyB0aHJvdWdoIHRoZSBhcnJheSwgdHJhbnNsYXRp
bmcgZWFjaCBvZiB0aGUgaXRlbXMgdG8gdGhlaXIKCQlpZiAoIGlzQXJyYXkgKSB7
CgkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJdmFsdWUgPSBjYWxs
YmFjayggZWxlbXNbIGkgXSwgaSwgYXJnICk7CgoJCQkJaWYgKCB2YWx1ZSAhPSBu
dWxsICkgewoJCQkJCXJldFsgcmV0Lmxlbmd0aCBdID0gdmFsdWU7CgkJCQl9CgkJ
CX0KCgkJLy8gR28gdGhyb3VnaCBldmVyeSBrZXkgb24gdGhlIG9iamVjdCwKCQl9
IGVsc2UgewoJCQlmb3IgKCBrZXkgaW4gZWxlbXMgKSB7CgkJCQl2YWx1ZSA9IGNh
bGxiYWNrKCBlbGVtc1sga2V5IF0sIGtleSwgYXJnICk7CgoJCQkJaWYgKCB2YWx1
ZSAhPSBudWxsICkgewoJCQkJCXJldFsgcmV0Lmxlbmd0aCBdID0gdmFsdWU7CgkJ
CQl9CgkJCX0KCQl9CgoJCS8vIEZsYXR0ZW4gYW55IG5lc3RlZCBhcnJheXMKCQly
ZXR1cm4gcmV0LmNvbmNhdC5hcHBseSggW10sIHJldCApOwoJfSwKCgkvLyBBIGds
b2JhbCBHVUlEIGNvdW50ZXIgZm9yIG9iamVjdHMKCWd1aWQ6IDEsCgoJLy8gQmlu
ZCBhIGZ1bmN0aW9uIHRvIGEgY29udGV4dCwgb3B0aW9uYWxseSBwYXJ0aWFsbHkg
YXBwbHlpbmcgYW55CgkvLyBhcmd1bWVudHMuCglwcm94eTogZnVuY3Rpb24oIGZu
LCBjb250ZXh0ICkgewoJCWlmICggdHlwZW9mIGNvbnRleHQgPT09ICJzdHJpbmci
ICkgewoJCQl2YXIgdG1wID0gZm5bIGNvbnRleHQgXTsKCQkJY29udGV4dCA9IGZu
OwoJCQlmbiA9IHRtcDsKCQl9CgoJCS8vIFF1aWNrIGNoZWNrIHRvIGRldGVybWlu
ZSBpZiB0YXJnZXQgaXMgY2FsbGFibGUsIGluIHRoZSBzcGVjCgkJLy8gdGhpcyB0
aHJvd3MgYSBUeXBlRXJyb3IsIGJ1dCB3ZSB3aWxsIGp1c3QgcmV0dXJuIHVuZGVm
aW5lZC4KCQlpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggZm4gKSApIHsKCQkJcmV0
dXJuIHVuZGVmaW5lZDsKCQl9CgoJCS8vIFNpbXVsYXRlZCBiaW5kCgkJdmFyIGFy
Z3MgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMsIDIgKSwKCQkJcHJveHkgPSBmdW5j
dGlvbigpIHsKCQkJCXJldHVybiBmbi5hcHBseSggY29udGV4dCwgYXJncy5jb25j
YXQoIHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApICkgKTsKCQkJfTsKCgkJLy8gU2V0
IHRoZSBndWlkIG9mIHVuaXF1ZSBoYW5kbGVyIHRvIHRoZSBzYW1lIG9mIG9yaWdp
bmFsIGhhbmRsZXIsIHNvIGl0IGNhbiBiZSByZW1vdmVkCgkJcHJveHkuZ3VpZCA9
IGZuLmd1aWQgPSBmbi5ndWlkIHx8IHByb3h5Lmd1aWQgfHwgalF1ZXJ5Lmd1aWQr
KzsKCgkJcmV0dXJuIHByb3h5OwoJfSwKCgkvLyBNdXRpZnVuY3Rpb25hbCBtZXRo
b2QgdG8gZ2V0IGFuZCBzZXQgdmFsdWVzIHRvIGEgY29sbGVjdGlvbgoJLy8gVGhl
IHZhbHVlL3MgY2FuIG9wdGlvbmFsbHkgYmUgZXhlY3V0ZWQgaWYgaXQncyBhIGZ1
bmN0aW9uCglhY2Nlc3M6IGZ1bmN0aW9uKCBlbGVtcywgZm4sIGtleSwgdmFsdWUs
IGNoYWluYWJsZSwgZW1wdHlHZXQsIHBhc3MgKSB7CgkJdmFyIGV4ZWMsCgkJCWJ1
bGsgPSBrZXkgPT0gbnVsbCwKCQkJaSA9IDAsCgkJCWxlbmd0aCA9IGVsZW1zLmxl
bmd0aDsKCgkJLy8gU2V0cyBtYW55IHZhbHVlcwoJCWlmICgga2V5ICYmIHR5cGVv
ZiBrZXkgPT09ICJvYmplY3QiICkgewoJCQlmb3IgKCBpIGluIGtleSApIHsKCQkJ
CWpRdWVyeS5hY2Nlc3MoIGVsZW1zLCBmbiwgaSwga2V5W2ldLCAxLCBlbXB0eUdl
dCwgdmFsdWUgKTsKCQkJfQoJCQljaGFpbmFibGUgPSAxOwoKCQkvLyBTZXRzIG9u
ZSB2YWx1ZQoJCX0gZWxzZSBpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7CgkJ
CS8vIE9wdGlvbmFsbHksIGZ1bmN0aW9uIHZhbHVlcyBnZXQgZXhlY3V0ZWQgaWYg
ZXhlYyBpcyB0cnVlCgkJCWV4ZWMgPSBwYXNzID09PSB1bmRlZmluZWQgJiYgalF1
ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICk7CgoJCQlpZiAoIGJ1bGsgKSB7CgkJCQkv
LyBCdWxrIG9wZXJhdGlvbnMgb25seSBpdGVyYXRlIHdoZW4gZXhlY3V0aW5nIGZ1
bmN0aW9uIHZhbHVlcwoJCQkJaWYgKCBleGVjICkgewoJCQkJCWV4ZWMgPSBmbjsK
CQkJCQlmbiA9IGZ1bmN0aW9uKCBlbGVtLCBrZXksIHZhbHVlICkgewoJCQkJCQly
ZXR1cm4gZXhlYy5jYWxsKCBqUXVlcnkoIGVsZW0gKSwgdmFsdWUgKTsKCQkJCQl9
OwoKCQkJCS8vIE90aGVyd2lzZSB0aGV5IHJ1biBhZ2FpbnN0IHRoZSBlbnRpcmUg
c2V0CgkJCQl9IGVsc2UgewoJCQkJCWZuLmNhbGwoIGVsZW1zLCB2YWx1ZSApOwoJ
CQkJCWZuID0gbnVsbDsKCQkJCX0KCQkJfQoKCQkJaWYgKCBmbiApIHsKCQkJCWZv
ciAoOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQkJZm4oIGVsZW1zW2ldLCBrZXks
IGV4ZWMgPyB2YWx1ZS5jYWxsKCBlbGVtc1tpXSwgaSwgZm4oIGVsZW1zW2ldLCBr
ZXkgKSApIDogdmFsdWUsIHBhc3MgKTsKCQkJCX0KCQkJfQoKCQkJY2hhaW5hYmxl
ID0gMTsKCQl9CgoJCXJldHVybiBjaGFpbmFibGUgPwoJCQllbGVtcyA6CgoJCQkv
LyBHZXRzCgkJCWJ1bGsgPwoJCQkJZm4uY2FsbCggZWxlbXMgKSA6CgkJCQlsZW5n
dGggPyBmbiggZWxlbXNbMF0sIGtleSApIDogZW1wdHlHZXQ7Cgl9LAoKCW5vdzog
ZnVuY3Rpb24oKSB7CgkJcmV0dXJuICggbmV3IERhdGUoKSApLmdldFRpbWUoKTsK
CX0sCgoJLy8gVXNlIG9mIGpRdWVyeS5icm93c2VyIGlzIGZyb3duZWQgdXBvbi4K
CS8vIE1vcmUgZGV0YWlsczogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VdGlsaXRp
ZXMvalF1ZXJ5LmJyb3dzZXIKCXVhTWF0Y2g6IGZ1bmN0aW9uKCB1YSApIHsKCQl1
YSA9IHVhLnRvTG93ZXJDYXNlKCk7CgoJCXZhciBtYXRjaCA9IHJ3ZWJraXQuZXhl
YyggdWEgKSB8fAoJCQlyb3BlcmEuZXhlYyggdWEgKSB8fAoJCQlybXNpZS5leGVj
KCB1YSApIHx8CgkJCXVhLmluZGV4T2YoImNvbXBhdGlibGUiKSA8IDAgJiYgcm1v
emlsbGEuZXhlYyggdWEgKSB8fAoJCQlbXTsKCgkJcmV0dXJuIHsgYnJvd3Nlcjog
bWF0Y2hbMV0gfHwgIiIsIHZlcnNpb246IG1hdGNoWzJdIHx8ICIwIiB9OwoJfSwK
CglzdWI6IGZ1bmN0aW9uKCkgewoJCWZ1bmN0aW9uIGpRdWVyeVN1Yiggc2VsZWN0
b3IsIGNvbnRleHQgKSB7CgkJCXJldHVybiBuZXcgalF1ZXJ5U3ViLmZuLmluaXQo
IHNlbGVjdG9yLCBjb250ZXh0ICk7CgkJfQoJCWpRdWVyeS5leHRlbmQoIHRydWUs
IGpRdWVyeVN1YiwgdGhpcyApOwoJCWpRdWVyeVN1Yi5zdXBlcmNsYXNzID0gdGhp
czsKCQlqUXVlcnlTdWIuZm4gPSBqUXVlcnlTdWIucHJvdG90eXBlID0gdGhpcygp
OwoJCWpRdWVyeVN1Yi5mbi5jb25zdHJ1Y3RvciA9IGpRdWVyeVN1YjsKCQlqUXVl
cnlTdWIuc3ViID0gdGhpcy5zdWI7CgkJalF1ZXJ5U3ViLmZuLmluaXQgPSBmdW5j
dGlvbiBpbml0KCBzZWxlY3RvciwgY29udGV4dCApIHsKCQkJaWYgKCBjb250ZXh0
ICYmIGNvbnRleHQgaW5zdGFuY2VvZiBqUXVlcnkgJiYgIShjb250ZXh0IGluc3Rh
bmNlb2YgalF1ZXJ5U3ViKSApIHsKCQkJCWNvbnRleHQgPSBqUXVlcnlTdWIoIGNv
bnRleHQgKTsKCQkJfQoKCQkJcmV0dXJuIGpRdWVyeS5mbi5pbml0LmNhbGwoIHRo
aXMsIHNlbGVjdG9yLCBjb250ZXh0LCByb290alF1ZXJ5U3ViICk7CgkJfTsKCQlq
UXVlcnlTdWIuZm4uaW5pdC5wcm90b3R5cGUgPSBqUXVlcnlTdWIuZm47CgkJdmFy
IHJvb3RqUXVlcnlTdWIgPSBqUXVlcnlTdWIoZG9jdW1lbnQpOwoJCXJldHVybiBq
UXVlcnlTdWI7Cgl9LAoKCWJyb3dzZXI6IHt9Cn0pOwoKLy8gUG9wdWxhdGUgdGhl
IGNsYXNzMnR5cGUgbWFwCmpRdWVyeS5lYWNoKCJCb29sZWFuIE51bWJlciBTdHJp
bmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0Ii5zcGxpdCgiICIp
LCBmdW5jdGlvbihpLCBuYW1lKSB7CgljbGFzczJ0eXBlWyAiW29iamVjdCAiICsg
bmFtZSArICJdIiBdID0gbmFtZS50b0xvd2VyQ2FzZSgpOwp9KTsKCmJyb3dzZXJN
YXRjaCA9IGpRdWVyeS51YU1hdGNoKCB1c2VyQWdlbnQgKTsKaWYgKCBicm93c2Vy
TWF0Y2guYnJvd3NlciApIHsKCWpRdWVyeS5icm93c2VyWyBicm93c2VyTWF0Y2gu
YnJvd3NlciBdID0gdHJ1ZTsKCWpRdWVyeS5icm93c2VyLnZlcnNpb24gPSBicm93
c2VyTWF0Y2gudmVyc2lvbjsKfQoKLy8gRGVwcmVjYXRlZCwgdXNlIGpRdWVyeS5i
cm93c2VyLndlYmtpdCBpbnN0ZWFkCmlmICggalF1ZXJ5LmJyb3dzZXIud2Via2l0
ICkgewoJalF1ZXJ5LmJyb3dzZXIuc2FmYXJpID0gdHJ1ZTsKfQoKLy8gSUUgZG9l
c24ndCBtYXRjaCBub24tYnJlYWtpbmcgc3BhY2VzIHdpdGggXHMKaWYgKCBybm90
d2hpdGUudGVzdCggIlx4QTAiICkgKSB7Cgl0cmltTGVmdCA9IC9eW1xzXHhBMF0r
LzsKCXRyaW1SaWdodCA9IC9bXHNceEEwXSskLzsKfQoKLy8gQWxsIGpRdWVyeSBv
YmplY3RzIHNob3VsZCBwb2ludCBiYWNrIHRvIHRoZXNlCnJvb3RqUXVlcnkgPSBq
UXVlcnkoZG9jdW1lbnQpOwoKLy8gQ2xlYW51cCBmdW5jdGlvbnMgZm9yIHRoZSBk
b2N1bWVudCByZWFkeSBtZXRob2QKaWYgKCBkb2N1bWVudC5hZGRFdmVudExpc3Rl
bmVyICkgewoJRE9NQ29udGVudExvYWRlZCA9IGZ1bmN0aW9uKCkgewoJCWRvY3Vt
ZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICJET01Db250ZW50TG9hZGVkIiwgRE9N
Q29udGVudExvYWRlZCwgZmFsc2UgKTsKCQlqUXVlcnkucmVhZHkoKTsKCX07Cgp9
IGVsc2UgaWYgKCBkb2N1bWVudC5hdHRhY2hFdmVudCApIHsKCURPTUNvbnRlbnRM
b2FkZWQgPSBmdW5jdGlvbigpIHsKCQkvLyBNYWtlIHN1cmUgYm9keSBleGlzdHMs
IGF0IGxlYXN0LCBpbiBjYXNlIElFIGdldHMgYSBsaXR0bGUgb3ZlcnplYWxvdXMg
KHRpY2tldCAjNTQ0MykuCgkJaWYgKCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAi
Y29tcGxldGUiICkgewoJCQlkb2N1bWVudC5kZXRhY2hFdmVudCggIm9ucmVhZHlz
dGF0ZWNoYW5nZSIsIERPTUNvbnRlbnRMb2FkZWQgKTsKCQkJalF1ZXJ5LnJlYWR5
KCk7CgkJfQoJfTsKfQoKLy8gVGhlIERPTSByZWFkeSBjaGVjayBmb3IgSW50ZXJu
ZXQgRXhwbG9yZXIKZnVuY3Rpb24gZG9TY3JvbGxDaGVjaygpIHsKCWlmICggalF1
ZXJ5LmlzUmVhZHkgKSB7CgkJcmV0dXJuOwoJfQoKCXRyeSB7CgkJLy8gSWYgSUUg
aXMgdXNlZCwgdXNlIHRoZSB0cmljayBieSBEaWVnbyBQZXJpbmkKCQkvLyBodHRw
Oi8vamF2YXNjcmlwdC5ud2JveC5jb20vSUVDb250ZW50TG9hZGVkLwoJCWRvY3Vt
ZW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbCgibGVmdCIpOwoJfSBjYXRjaChl
KSB7CgkJc2V0VGltZW91dCggZG9TY3JvbGxDaGVjaywgMSApOwoJCXJldHVybjsK
CX0KCgkvLyBhbmQgZXhlY3V0ZSBhbnkgd2FpdGluZyBmdW5jdGlvbnMKCWpRdWVy
eS5yZWFkeSgpOwp9CgpyZXR1cm4galF1ZXJ5OwoKfSkoKTsKCgovLyBTdHJpbmcg
dG8gT2JqZWN0IGZsYWdzIGZvcm1hdCBjYWNoZQp2YXIgZmxhZ3NDYWNoZSA9IHt9
OwoKLy8gQ29udmVydCBTdHJpbmctZm9ybWF0dGVkIGZsYWdzIGludG8gT2JqZWN0
LWZvcm1hdHRlZCBvbmVzIGFuZCBzdG9yZSBpbiBjYWNoZQpmdW5jdGlvbiBjcmVh
dGVGbGFncyggZmxhZ3MgKSB7Cgl2YXIgb2JqZWN0ID0gZmxhZ3NDYWNoZVsgZmxh
Z3MgXSA9IHt9LAoJCWksIGxlbmd0aDsKCWZsYWdzID0gZmxhZ3Muc3BsaXQoIC9c
cysvICk7Cglmb3IgKCBpID0gMCwgbGVuZ3RoID0gZmxhZ3MubGVuZ3RoOyBpIDwg
bGVuZ3RoOyBpKysgKSB7CgkJb2JqZWN0WyBmbGFnc1tpXSBdID0gdHJ1ZTsKCX0K
CXJldHVybiBvYmplY3Q7Cn0KCi8qCiAqIENyZWF0ZSBhIGNhbGxiYWNrIGxpc3Qg
dXNpbmcgdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgogKgogKglmbGFnczoJYW4g
b3B0aW9uYWwgbGlzdCBvZiBzcGFjZS1zZXBhcmF0ZWQgZmxhZ3MgdGhhdCB3aWxs
IGNoYW5nZSBob3cKICoJCQl0aGUgY2FsbGJhY2sgbGlzdCBiZWhhdmVzCiAqCiAq
IEJ5IGRlZmF1bHQgYSBjYWxsYmFjayBsaXN0IHdpbGwgYWN0IGxpa2UgYW4gZXZl
bnQgY2FsbGJhY2sgbGlzdCBhbmQgY2FuIGJlCiAqICJmaXJlZCIgbXVsdGlwbGUg
dGltZXMuCiAqCiAqIFBvc3NpYmxlIGZsYWdzOgogKgogKglvbmNlOgkJCXdpbGwg
ZW5zdXJlIHRoZSBjYWxsYmFjayBsaXN0IGNhbiBvbmx5IGJlIGZpcmVkIG9uY2Ug
KGxpa2UgYSBEZWZlcnJlZCkKICoKICoJbWVtb3J5OgkJCXdpbGwga2VlcCB0cmFj
ayBvZiBwcmV2aW91cyB2YWx1ZXMgYW5kIHdpbGwgY2FsbCBhbnkgY2FsbGJhY2sg
YWRkZWQKICoJCQkJCWFmdGVyIHRoZSBsaXN0IGhhcyBiZWVuIGZpcmVkIHJpZ2h0
IGF3YXkgd2l0aCB0aGUgbGF0ZXN0ICJtZW1vcml6ZWQiCiAqCQkJCQl2YWx1ZXMg
KGxpa2UgYSBEZWZlcnJlZCkKICoKICoJdW5pcXVlOgkJCXdpbGwgZW5zdXJlIGEg
Y2FsbGJhY2sgY2FuIG9ubHkgYmUgYWRkZWQgb25jZSAobm8gZHVwbGljYXRlIGlu
IHRoZSBsaXN0KQogKgogKglzdG9wT25GYWxzZToJaW50ZXJydXB0IGNhbGxpbmdz
IHdoZW4gYSBjYWxsYmFjayByZXR1cm5zIGZhbHNlCiAqCiAqLwpqUXVlcnkuQ2Fs
bGJhY2tzID0gZnVuY3Rpb24oIGZsYWdzICkgewoKCS8vIENvbnZlcnQgZmxhZ3Mg
ZnJvbSBTdHJpbmctZm9ybWF0dGVkIHRvIE9iamVjdC1mb3JtYXR0ZWQKCS8vICh3
ZSBjaGVjayBpbiBjYWNoZSBmaXJzdCkKCWZsYWdzID0gZmxhZ3MgPyAoIGZsYWdz
Q2FjaGVbIGZsYWdzIF0gfHwgY3JlYXRlRmxhZ3MoIGZsYWdzICkgKSA6IHt9OwoK
CXZhciAvLyBBY3R1YWwgY2FsbGJhY2sgbGlzdAoJCWxpc3QgPSBbXSwKCQkvLyBT
dGFjayBvZiBmaXJlIGNhbGxzIGZvciByZXBlYXRhYmxlIGxpc3RzCgkJc3RhY2sg
PSBbXSwKCQkvLyBMYXN0IGZpcmUgdmFsdWUgKGZvciBub24tZm9yZ2V0dGFibGUg
bGlzdHMpCgkJbWVtb3J5LAoJCS8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IHdhcyBh
bHJlYWR5IGZpcmVkCgkJZmlyZWQsCgkJLy8gRmxhZyB0byBrbm93IGlmIGxpc3Qg
aXMgY3VycmVudGx5IGZpcmluZwoJCWZpcmluZywKCQkvLyBGaXJzdCBjYWxsYmFj
ayB0byBmaXJlICh1c2VkIGludGVybmFsbHkgYnkgYWRkIGFuZCBmaXJlV2l0aCkK
CQlmaXJpbmdTdGFydCwKCQkvLyBFbmQgb2YgdGhlIGxvb3Agd2hlbiBmaXJpbmcK
CQlmaXJpbmdMZW5ndGgsCgkJLy8gSW5kZXggb2YgY3VycmVudGx5IGZpcmluZyBj
YWxsYmFjayAobW9kaWZpZWQgYnkgcmVtb3ZlIGlmIG5lZWRlZCkKCQlmaXJpbmdJ
bmRleCwKCQkvLyBBZGQgb25lIG9yIHNldmVyYWwgY2FsbGJhY2tzIHRvIHRoZSBs
aXN0CgkJYWRkID0gZnVuY3Rpb24oIGFyZ3MgKSB7CgkJCXZhciBpLAoJCQkJbGVu
Z3RoLAoJCQkJZWxlbSwKCQkJCXR5cGUsCgkJCQlhY3R1YWw7CgkJCWZvciAoIGkg
PSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrICkgewoJ
CQkJZWxlbSA9IGFyZ3NbIGkgXTsKCQkJCXR5cGUgPSBqUXVlcnkudHlwZSggZWxl
bSApOwoJCQkJaWYgKCB0eXBlID09PSAiYXJyYXkiICkgewoJCQkJCS8vIEluc3Bl
Y3QgcmVjdXJzaXZlbHkKCQkJCQlhZGQoIGVsZW0gKTsKCQkJCX0gZWxzZSBpZiAo
IHR5cGUgPT09ICJmdW5jdGlvbiIgKSB7CgkJCQkJLy8gQWRkIGlmIG5vdCBpbiB1
bmlxdWUgbW9kZSBhbmQgY2FsbGJhY2sgaXMgbm90IGluCgkJCQkJaWYgKCAhZmxh
Z3MudW5pcXVlIHx8ICFzZWxmLmhhcyggZWxlbSApICkgewoJCQkJCQlsaXN0LnB1
c2goIGVsZW0gKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9LAoJCS8vIEZpcmUgY2Fs
bGJhY2tzCgkJZmlyZSA9IGZ1bmN0aW9uKCBjb250ZXh0LCBhcmdzICkgewoJCQlh
cmdzID0gYXJncyB8fCBbXTsKCQkJbWVtb3J5ID0gIWZsYWdzLm1lbW9yeSB8fCBb
IGNvbnRleHQsIGFyZ3MgXTsKCQkJZmlyZWQgPSB0cnVlOwoJCQlmaXJpbmcgPSB0
cnVlOwoJCQlmaXJpbmdJbmRleCA9IGZpcmluZ1N0YXJ0IHx8IDA7CgkJCWZpcmlu
Z1N0YXJ0ID0gMDsKCQkJZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7CgkJCWZv
ciAoIDsgbGlzdCAmJiBmaXJpbmdJbmRleCA8IGZpcmluZ0xlbmd0aDsgZmlyaW5n
SW5kZXgrKyApIHsKCQkJCWlmICggbGlzdFsgZmlyaW5nSW5kZXggXS5hcHBseSgg
Y29udGV4dCwgYXJncyApID09PSBmYWxzZSAmJiBmbGFncy5zdG9wT25GYWxzZSAp
IHsKCQkJCQltZW1vcnkgPSB0cnVlOyAvLyBNYXJrIGFzIGhhbHRlZAoJCQkJCWJy
ZWFrOwoJCQkJfQoJCQl9CgkJCWZpcmluZyA9IGZhbHNlOwoJCQlpZiAoIGxpc3Qg
KSB7CgkJCQlpZiAoICFmbGFncy5vbmNlICkgewoJCQkJCWlmICggc3RhY2sgJiYg
c3RhY2subGVuZ3RoICkgewoJCQkJCQltZW1vcnkgPSBzdGFjay5zaGlmdCgpOwoJ
CQkJCQlzZWxmLmZpcmVXaXRoKCBtZW1vcnlbIDAgXSwgbWVtb3J5WyAxIF0gKTsK
CQkJCQl9CgkJCQl9IGVsc2UgaWYgKCBtZW1vcnkgPT09IHRydWUgKSB7CgkJCQkJ
c2VsZi5kaXNhYmxlKCk7CgkJCQl9IGVsc2UgewoJCQkJCWxpc3QgPSBbXTsKCQkJ
CX0KCQkJfQoJCX0sCgkJLy8gQWN0dWFsIENhbGxiYWNrcyBvYmplY3QKCQlzZWxm
ID0gewoJCQkvLyBBZGQgYSBjYWxsYmFjayBvciBhIGNvbGxlY3Rpb24gb2YgY2Fs
bGJhY2tzIHRvIHRoZSBsaXN0CgkJCWFkZDogZnVuY3Rpb24oKSB7CgkJCQlpZiAo
IGxpc3QgKSB7CgkJCQkJdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoOwoJCQkJCWFk
ZCggYXJndW1lbnRzICk7CgkJCQkJLy8gRG8gd2UgbmVlZCB0byBhZGQgdGhlIGNh
bGxiYWNrcyB0byB0aGUKCQkJCQkvLyBjdXJyZW50IGZpcmluZyBiYXRjaD8KCQkJ
CQlpZiAoIGZpcmluZyApIHsKCQkJCQkJZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5n
dGg7CgkJCQkJLy8gV2l0aCBtZW1vcnksIGlmIHdlJ3JlIG5vdCBmaXJpbmcgdGhl
bgoJCQkJCS8vIHdlIHNob3VsZCBjYWxsIHJpZ2h0IGF3YXksIHVubGVzcyBwcmV2
aW91cwoJCQkJCS8vIGZpcmluZyB3YXMgaGFsdGVkIChzdG9wT25GYWxzZSkKCQkJ
CQl9IGVsc2UgaWYgKCBtZW1vcnkgJiYgbWVtb3J5ICE9PSB0cnVlICkgewoJCQkJ
CQlmaXJpbmdTdGFydCA9IGxlbmd0aDsKCQkJCQkJZmlyZSggbWVtb3J5WyAwIF0s
IG1lbW9yeVsgMSBdICk7CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIHRoaXM7CgkJ
CX0sCgkJCS8vIFJlbW92ZSBhIGNhbGxiYWNrIGZyb20gdGhlIGxpc3QKCQkJcmVt
b3ZlOiBmdW5jdGlvbigpIHsKCQkJCWlmICggbGlzdCApIHsKCQkJCQl2YXIgYXJn
cyA9IGFyZ3VtZW50cywKCQkJCQkJYXJnSW5kZXggPSAwLAoJCQkJCQlhcmdMZW5n
dGggPSBhcmdzLmxlbmd0aDsKCQkJCQlmb3IgKCA7IGFyZ0luZGV4IDwgYXJnTGVu
Z3RoIDsgYXJnSW5kZXgrKyApIHsKCQkJCQkJZm9yICggdmFyIGkgPSAwOyBpIDwg
bGlzdC5sZW5ndGg7IGkrKyApIHsKCQkJCQkJCWlmICggYXJnc1sgYXJnSW5kZXgg
XSA9PT0gbGlzdFsgaSBdICkgewoJCQkJCQkJCS8vIEhhbmRsZSBmaXJpbmdJbmRl
eCBhbmQgZmlyaW5nTGVuZ3RoCgkJCQkJCQkJaWYgKCBmaXJpbmcgKSB7CgkJCQkJ
CQkJCWlmICggaSA8PSBmaXJpbmdMZW5ndGggKSB7CgkJCQkJCQkJCQlmaXJpbmdM
ZW5ndGgtLTsKCQkJCQkJCQkJCWlmICggaSA8PSBmaXJpbmdJbmRleCApIHsKCQkJ
CQkJCQkJCQlmaXJpbmdJbmRleC0tOwoJCQkJCQkJCQkJfQoJCQkJCQkJCQl9CgkJ
CQkJCQkJfQoJCQkJCQkJCS8vIFJlbW92ZSB0aGUgZWxlbWVudAoJCQkJCQkJCWxp
c3Quc3BsaWNlKCBpLS0sIDEgKTsKCQkJCQkJCQkvLyBJZiB3ZSBoYXZlIHNvbWUg
dW5pY2l0eSBwcm9wZXJ0eSB0aGVuCgkJCQkJCQkJLy8gd2Ugb25seSBuZWVkIHRv
IGRvIHRoaXMgb25jZQoJCQkJCQkJCWlmICggZmxhZ3MudW5pcXVlICkgewoJCQkJ
CQkJCQlicmVhazsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJ
CQl9CgkJCQlyZXR1cm4gdGhpczsKCQkJfSwKCQkJLy8gQ29udHJvbCBpZiBhIGdp
dmVuIGNhbGxiYWNrIGlzIGluIHRoZSBsaXN0CgkJCWhhczogZnVuY3Rpb24oIGZu
ICkgewoJCQkJaWYgKCBsaXN0ICkgewoJCQkJCXZhciBpID0gMCwKCQkJCQkJbGVu
Z3RoID0gbGlzdC5sZW5ndGg7CgkJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysg
KSB7CgkJCQkJCWlmICggZm4gPT09IGxpc3RbIGkgXSApIHsKCQkJCQkJCXJldHVy
biB0cnVlOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIGZhbHNlOwoJ
CQl9LAoJCQkvLyBSZW1vdmUgYWxsIGNhbGxiYWNrcyBmcm9tIHRoZSBsaXN0CgkJ
CWVtcHR5OiBmdW5jdGlvbigpIHsKCQkJCWxpc3QgPSBbXTsKCQkJCXJldHVybiB0
aGlzOwoJCQl9LAoJCQkvLyBIYXZlIHRoZSBsaXN0IGRvIG5vdGhpbmcgYW55bW9y
ZQoJCQlkaXNhYmxlOiBmdW5jdGlvbigpIHsKCQkJCWxpc3QgPSBzdGFjayA9IG1l
bW9yeSA9IHVuZGVmaW5lZDsKCQkJCXJldHVybiB0aGlzOwoJCQl9LAoJCQkvLyBJ
cyBpdCBkaXNhYmxlZD8KCQkJZGlzYWJsZWQ6IGZ1bmN0aW9uKCkgewoJCQkJcmV0
dXJuICFsaXN0OwoJCQl9LAoJCQkvLyBMb2NrIHRoZSBsaXN0IGluIGl0cyBjdXJy
ZW50IHN0YXRlCgkJCWxvY2s6IGZ1bmN0aW9uKCkgewoJCQkJc3RhY2sgPSB1bmRl
ZmluZWQ7CgkJCQlpZiAoICFtZW1vcnkgfHwgbWVtb3J5ID09PSB0cnVlICkgewoJ
CQkJCXNlbGYuZGlzYWJsZSgpOwoJCQkJfQoJCQkJcmV0dXJuIHRoaXM7CgkJCX0s
CgkJCS8vIElzIGl0IGxvY2tlZD8KCQkJbG9ja2VkOiBmdW5jdGlvbigpIHsKCQkJ
CXJldHVybiAhc3RhY2s7CgkJCX0sCgkJCS8vIENhbGwgYWxsIGNhbGxiYWNrcyB3
aXRoIHRoZSBnaXZlbiBjb250ZXh0IGFuZCBhcmd1bWVudHMKCQkJZmlyZVdpdGg6
IGZ1bmN0aW9uKCBjb250ZXh0LCBhcmdzICkgewoJCQkJaWYgKCBzdGFjayApIHsK
CQkJCQlpZiAoIGZpcmluZyApIHsKCQkJCQkJaWYgKCAhZmxhZ3Mub25jZSApIHsK
CQkJCQkJCXN0YWNrLnB1c2goIFsgY29udGV4dCwgYXJncyBdICk7CgkJCQkJCX0K
CQkJCQl9IGVsc2UgaWYgKCAhKCBmbGFncy5vbmNlICYmIG1lbW9yeSApICkgewoJ
CQkJCQlmaXJlKCBjb250ZXh0LCBhcmdzICk7CgkJCQkJfQoJCQkJfQoJCQkJcmV0
dXJuIHRoaXM7CgkJCX0sCgkJCS8vIENhbGwgYWxsIHRoZSBjYWxsYmFja3Mgd2l0
aCB0aGUgZ2l2ZW4gYXJndW1lbnRzCgkJCWZpcmU6IGZ1bmN0aW9uKCkgewoJCQkJ
c2VsZi5maXJlV2l0aCggdGhpcywgYXJndW1lbnRzICk7CgkJCQlyZXR1cm4gdGhp
czsKCQkJfSwKCQkJLy8gVG8ga25vdyBpZiB0aGUgY2FsbGJhY2tzIGhhdmUgYWxy
ZWFkeSBiZWVuIGNhbGxlZCBhdCBsZWFzdCBvbmNlCgkJCWZpcmVkOiBmdW5jdGlv
bigpIHsKCQkJCXJldHVybiAhIWZpcmVkOwoJCQl9CgkJfTsKCglyZXR1cm4gc2Vs
ZjsKfTsKCgoKCnZhciAvLyBTdGF0aWMgcmVmZXJlbmNlIHRvIHNsaWNlCglzbGlj
ZURlZmVycmVkID0gW10uc2xpY2U7CgpqUXVlcnkuZXh0ZW5kKHsKCglEZWZlcnJl
ZDogZnVuY3Rpb24oIGZ1bmMgKSB7CgkJdmFyIGRvbmVMaXN0ID0galF1ZXJ5LkNh
bGxiYWNrcyggIm9uY2UgbWVtb3J5IiApLAoJCQlmYWlsTGlzdCA9IGpRdWVyeS5D
YWxsYmFja3MoICJvbmNlIG1lbW9yeSIgKSwKCQkJcHJvZ3Jlc3NMaXN0ID0galF1
ZXJ5LkNhbGxiYWNrcyggIm1lbW9yeSIgKSwKCQkJc3RhdGUgPSAicGVuZGluZyIs
CgkJCWxpc3RzID0gewoJCQkJcmVzb2x2ZTogZG9uZUxpc3QsCgkJCQlyZWplY3Q6
IGZhaWxMaXN0LAoJCQkJbm90aWZ5OiBwcm9ncmVzc0xpc3QKCQkJfSwKCQkJcHJv
bWlzZSA9IHsKCQkJCWRvbmU6IGRvbmVMaXN0LmFkZCwKCQkJCWZhaWw6IGZhaWxM
aXN0LmFkZCwKCQkJCXByb2dyZXNzOiBwcm9ncmVzc0xpc3QuYWRkLAoKCQkJCXN0
YXRlOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gc3RhdGU7CgkJCQl9LAoKCQkJ
CS8vIERlcHJlY2F0ZWQKCQkJCWlzUmVzb2x2ZWQ6IGRvbmVMaXN0LmZpcmVkLAoJ
CQkJaXNSZWplY3RlZDogZmFpbExpc3QuZmlyZWQsCgoJCQkJdGhlbjogZnVuY3Rp
b24oIGRvbmVDYWxsYmFja3MsIGZhaWxDYWxsYmFja3MsIHByb2dyZXNzQ2FsbGJh
Y2tzICkgewoJCQkJCWRlZmVycmVkLmRvbmUoIGRvbmVDYWxsYmFja3MgKS5mYWls
KCBmYWlsQ2FsbGJhY2tzICkucHJvZ3Jlc3MoIHByb2dyZXNzQ2FsbGJhY2tzICk7
CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJYWx3YXlzOiBmdW5jdGlvbigp
IHsKCQkJCQlkZWZlcnJlZC5kb25lLmFwcGx5KCBkZWZlcnJlZCwgYXJndW1lbnRz
ICkuZmFpbC5hcHBseSggZGVmZXJyZWQsIGFyZ3VtZW50cyApOwoJCQkJCXJldHVy
biB0aGlzOwoJCQkJfSwKCQkJCXBpcGU6IGZ1bmN0aW9uKCBmbkRvbmUsIGZuRmFp
bCwgZm5Qcm9ncmVzcyApIHsKCQkJCQlyZXR1cm4galF1ZXJ5LkRlZmVycmVkKGZ1
bmN0aW9uKCBuZXdEZWZlciApIHsKCQkJCQkJalF1ZXJ5LmVhY2goIHsKCQkJCQkJ
CWRvbmU6IFsgZm5Eb25lLCAicmVzb2x2ZSIgXSwKCQkJCQkJCWZhaWw6IFsgZm5G
YWlsLCAicmVqZWN0IiBdLAoJCQkJCQkJcHJvZ3Jlc3M6IFsgZm5Qcm9ncmVzcywg
Im5vdGlmeSIgXQoJCQkJCQl9LCBmdW5jdGlvbiggaGFuZGxlciwgZGF0YSApIHsK
CQkJCQkJCXZhciBmbiA9IGRhdGFbIDAgXSwKCQkJCQkJCQlhY3Rpb24gPSBkYXRh
WyAxIF0sCgkJCQkJCQkJcmV0dXJuZWQ7CgkJCQkJCQlpZiAoIGpRdWVyeS5pc0Z1
bmN0aW9uKCBmbiApICkgewoJCQkJCQkJCWRlZmVycmVkWyBoYW5kbGVyIF0oZnVu
Y3Rpb24oKSB7CgkJCQkJCQkJCXJldHVybmVkID0gZm4uYXBwbHkoIHRoaXMsIGFy
Z3VtZW50cyApOwoJCQkJCQkJCQlpZiAoIHJldHVybmVkICYmIGpRdWVyeS5pc0Z1
bmN0aW9uKCByZXR1cm5lZC5wcm9taXNlICkgKSB7CgkJCQkJCQkJCQlyZXR1cm5l
ZC5wcm9taXNlKCkudGhlbiggbmV3RGVmZXIucmVzb2x2ZSwgbmV3RGVmZXIucmVq
ZWN0LCBuZXdEZWZlci5ub3RpZnkgKTsKCQkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJ
CQkJCW5ld0RlZmVyWyBhY3Rpb24gKyAiV2l0aCIgXSggdGhpcyA9PT0gZGVmZXJy
ZWQgPyBuZXdEZWZlciA6IHRoaXMsIFsgcmV0dXJuZWQgXSApOwoJCQkJCQkJCQl9
CgkJCQkJCQkJfSk7CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCWRlZmVycmVkWyBo
YW5kbGVyIF0oIG5ld0RlZmVyWyBhY3Rpb24gXSApOwoJCQkJCQkJfQoJCQkJCQl9
KTsKCQkJCQl9KS5wcm9taXNlKCk7CgkJCQl9LAoJCQkJLy8gR2V0IGEgcHJvbWlz
ZSBmb3IgdGhpcyBkZWZlcnJlZAoJCQkJLy8gSWYgb2JqIGlzIHByb3ZpZGVkLCB0
aGUgcHJvbWlzZSBhc3BlY3QgaXMgYWRkZWQgdG8gdGhlIG9iamVjdAoJCQkJcHJv
bWlzZTogZnVuY3Rpb24oIG9iaiApIHsKCQkJCQlpZiAoIG9iaiA9PSBudWxsICkg
ewoJCQkJCQlvYmogPSBwcm9taXNlOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWZvciAo
IHZhciBrZXkgaW4gcHJvbWlzZSApIHsKCQkJCQkJCW9ialsga2V5IF0gPSBwcm9t
aXNlWyBrZXkgXTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlyZXR1cm4gb2JqOwoJCQkJ
fQoJCQl9LAoJCQlkZWZlcnJlZCA9IHByb21pc2UucHJvbWlzZSh7fSksCgkJCWtl
eTsKCgkJZm9yICgga2V5IGluIGxpc3RzICkgewoJCQlkZWZlcnJlZFsga2V5IF0g
PSBsaXN0c1sga2V5IF0uZmlyZTsKCQkJZGVmZXJyZWRbIGtleSArICJXaXRoIiBd
ID0gbGlzdHNbIGtleSBdLmZpcmVXaXRoOwoJCX0KCgkJLy8gSGFuZGxlIHN0YXRl
CgkJZGVmZXJyZWQuZG9uZSggZnVuY3Rpb24oKSB7CgkJCXN0YXRlID0gInJlc29s
dmVkIjsKCQl9LCBmYWlsTGlzdC5kaXNhYmxlLCBwcm9ncmVzc0xpc3QubG9jayAp
LmZhaWwoIGZ1bmN0aW9uKCkgewoJCQlzdGF0ZSA9ICJyZWplY3RlZCI7CgkJfSwg
ZG9uZUxpc3QuZGlzYWJsZSwgcHJvZ3Jlc3NMaXN0LmxvY2sgKTsKCgkJLy8gQ2Fs
bCBnaXZlbiBmdW5jIGlmIGFueQoJCWlmICggZnVuYyApIHsKCQkJZnVuYy5jYWxs
KCBkZWZlcnJlZCwgZGVmZXJyZWQgKTsKCQl9CgoJCS8vIEFsbCBkb25lIQoJCXJl
dHVybiBkZWZlcnJlZDsKCX0sCgoJLy8gRGVmZXJyZWQgaGVscGVyCgl3aGVuOiBm
dW5jdGlvbiggZmlyc3RQYXJhbSApIHsKCQl2YXIgYXJncyA9IHNsaWNlRGVmZXJy
ZWQuY2FsbCggYXJndW1lbnRzLCAwICksCgkJCWkgPSAwLAoJCQlsZW5ndGggPSBh
cmdzLmxlbmd0aCwKCQkJcFZhbHVlcyA9IG5ldyBBcnJheSggbGVuZ3RoICksCgkJ
CWNvdW50ID0gbGVuZ3RoLAoJCQlwQ291bnQgPSBsZW5ndGgsCgkJCWRlZmVycmVk
ID0gbGVuZ3RoIDw9IDEgJiYgZmlyc3RQYXJhbSAmJiBqUXVlcnkuaXNGdW5jdGlv
biggZmlyc3RQYXJhbS5wcm9taXNlICkgPwoJCQkJZmlyc3RQYXJhbSA6CgkJCQlq
UXVlcnkuRGVmZXJyZWQoKSwKCQkJcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2Uo
KTsKCQlmdW5jdGlvbiByZXNvbHZlRnVuYyggaSApIHsKCQkJcmV0dXJuIGZ1bmN0
aW9uKCB2YWx1ZSApIHsKCQkJCWFyZ3NbIGkgXSA9IGFyZ3VtZW50cy5sZW5ndGgg
PiAxID8gc2xpY2VEZWZlcnJlZC5jYWxsKCBhcmd1bWVudHMsIDAgKSA6IHZhbHVl
OwoJCQkJaWYgKCAhKCAtLWNvdW50ICkgKSB7CgkJCQkJZGVmZXJyZWQucmVzb2x2
ZVdpdGgoIGRlZmVycmVkLCBhcmdzICk7CgkJCQl9CgkJCX07CgkJfQoJCWZ1bmN0
aW9uIHByb2dyZXNzRnVuYyggaSApIHsKCQkJcmV0dXJuIGZ1bmN0aW9uKCB2YWx1
ZSApIHsKCQkJCXBWYWx1ZXNbIGkgXSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8g
c2xpY2VEZWZlcnJlZC5jYWxsKCBhcmd1bWVudHMsIDAgKSA6IHZhbHVlOwoJCQkJ
ZGVmZXJyZWQubm90aWZ5V2l0aCggcHJvbWlzZSwgcFZhbHVlcyApOwoJCQl9OwoJ
CX0KCQlpZiAoIGxlbmd0aCA+IDEgKSB7CgkJCWZvciAoIDsgaSA8IGxlbmd0aDsg
aSsrICkgewoJCQkJaWYgKCBhcmdzWyBpIF0gJiYgYXJnc1sgaSBdLnByb21pc2Ug
JiYgalF1ZXJ5LmlzRnVuY3Rpb24oIGFyZ3NbIGkgXS5wcm9taXNlICkgKSB7CgkJ
CQkJYXJnc1sgaSBdLnByb21pc2UoKS50aGVuKCByZXNvbHZlRnVuYyhpKSwgZGVm
ZXJyZWQucmVqZWN0LCBwcm9ncmVzc0Z1bmMoaSkgKTsKCQkJCX0gZWxzZSB7CgkJ
CQkJLS1jb3VudDsKCQkJCX0KCQkJfQoJCQlpZiAoICFjb3VudCApIHsKCQkJCWRl
ZmVycmVkLnJlc29sdmVXaXRoKCBkZWZlcnJlZCwgYXJncyApOwoJCQl9CgkJfSBl
bHNlIGlmICggZGVmZXJyZWQgIT09IGZpcnN0UGFyYW0gKSB7CgkJCWRlZmVycmVk
LnJlc29sdmVXaXRoKCBkZWZlcnJlZCwgbGVuZ3RoID8gWyBmaXJzdFBhcmFtIF0g
OiBbXSApOwoJCX0KCQlyZXR1cm4gcHJvbWlzZTsKCX0KfSk7CgoKCgpqUXVlcnku
c3VwcG9ydCA9IChmdW5jdGlvbigpIHsKCgl2YXIgc3VwcG9ydCwKCQlhbGwsCgkJ
YSwKCQlzZWxlY3QsCgkJb3B0LAoJCWlucHV0LAoJCWZyYWdtZW50LAoJCXRkcywK
CQlldmVudHMsCgkJZXZlbnROYW1lLAoJCWksCgkJaXNTdXBwb3J0ZWQsCgkJZGl2
ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSwKCQlkb2N1bWVudEVs
ZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgoJLy8gUHJlbGltaW5h
cnkgdGVzdHMKCWRpdi5zZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIsICJ0Iik7Cglk
aXYuaW5uZXJIVE1MID0gIiAgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVm
PScvYScgc3R5bGU9J3RvcDoxcHg7ZmxvYXQ6bGVmdDtvcGFjaXR5Oi41NTsnPmE8
L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IjsKCglhbGwgPSBkaXYuZ2V0RWxl
bWVudHNCeVRhZ05hbWUoICIqIiApOwoJYSA9IGRpdi5nZXRFbGVtZW50c0J5VGFn
TmFtZSggImEiIClbIDAgXTsKCgkvLyBDYW4ndCBnZXQgYmFzaWMgdGVzdCBzdXBw
b3J0CglpZiAoICFhbGwgfHwgIWFsbC5sZW5ndGggfHwgIWEgKSB7CgkJcmV0dXJu
IHt9OwoJfQoKCS8vIEZpcnN0IGJhdGNoIG9mIHN1cHBvcnRzIHRlc3RzCglzZWxl
Y3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAic2VsZWN0IiApOwoJb3B0ID0g
c2VsZWN0LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRp
b24iKSApOwoJaW5wdXQgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJpbnB1
dCIgKVsgMCBdOwoKCXN1cHBvcnQgPSB7CgkJLy8gSUUgc3RyaXBzIGxlYWRpbmcg
d2hpdGVzcGFjZSB3aGVuIC5pbm5lckhUTUwgaXMgdXNlZAoJCWxlYWRpbmdXaGl0
ZXNwYWNlOiAoIGRpdi5maXJzdENoaWxkLm5vZGVUeXBlID09PSAzICksCgoJCS8v
IE1ha2Ugc3VyZSB0aGF0IHRib2R5IGVsZW1lbnRzIGFyZW4ndCBhdXRvbWF0aWNh
bGx5IGluc2VydGVkCgkJLy8gSUUgd2lsbCBpbnNlcnQgdGhlbSBpbnRvIGVtcHR5
IHRhYmxlcwoJCXRib2R5OiAhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9k
eSIpLmxlbmd0aCwKCgkJLy8gTWFrZSBzdXJlIHRoYXQgbGluayBlbGVtZW50cyBn
ZXQgc2VyaWFsaXplZCBjb3JyZWN0bHkgYnkgaW5uZXJIVE1MCgkJLy8gVGhpcyBy
ZXF1aXJlcyBhIHdyYXBwZXIgZWxlbWVudCBpbiBJRQoJCWh0bWxTZXJpYWxpemU6
ICEhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJsaW5rIikubGVuZ3RoLAoKCQkv
LyBHZXQgdGhlIHN0eWxlIGluZm9ybWF0aW9uIGZyb20gZ2V0QXR0cmlidXRlCgkJ
Ly8gKElFIHVzZXMgLmNzc1RleHQgaW5zdGVhZCkKCQlzdHlsZTogL3RvcC8udGVz
dCggYS5nZXRBdHRyaWJ1dGUoInN0eWxlIikgKSwKCgkJLy8gTWFrZSBzdXJlIHRo
YXQgVVJMcyBhcmVuJ3QgbWFuaXB1bGF0ZWQKCQkvLyAoSUUgbm9ybWFsaXplcyBp
dCBieSBkZWZhdWx0KQoJCWhyZWZOb3JtYWxpemVkOiAoIGEuZ2V0QXR0cmlidXRl
KCJocmVmIikgPT09ICIvYSIgKSwKCgkJLy8gTWFrZSBzdXJlIHRoYXQgZWxlbWVu
dCBvcGFjaXR5IGV4aXN0cwoJCS8vIChJRSB1c2VzIGZpbHRlciBpbnN0ZWFkKQoJ
CS8vIFVzZSBhIHJlZ2V4IHRvIHdvcmsgYXJvdW5kIGEgV2ViS2l0IGlzc3VlLiBT
ZWUgIzUxNDUKCQlvcGFjaXR5OiAvXjAuNTUvLnRlc3QoIGEuc3R5bGUub3BhY2l0
eSApLAoKCQkvLyBWZXJpZnkgc3R5bGUgZmxvYXQgZXhpc3RlbmNlCgkJLy8gKElF
IHVzZXMgc3R5bGVGbG9hdCBpbnN0ZWFkIG9mIGNzc0Zsb2F0KQoJCWNzc0Zsb2F0
OiAhIWEuc3R5bGUuY3NzRmxvYXQsCgoJCS8vIE1ha2Ugc3VyZSB0aGF0IGlmIG5v
IHZhbHVlIGlzIHNwZWNpZmllZCBmb3IgYSBjaGVja2JveAoJCS8vIHRoYXQgaXQg
ZGVmYXVsdHMgdG8gIm9uIi4KCQkvLyAoV2ViS2l0IGRlZmF1bHRzIHRvICIiIGlu
c3RlYWQpCgkJY2hlY2tPbjogKCBpbnB1dC52YWx1ZSA9PT0gIm9uIiApLAoKCQkv
LyBNYWtlIHN1cmUgdGhhdCBhIHNlbGVjdGVkLWJ5LWRlZmF1bHQgb3B0aW9uIGhh
cyBhIHdvcmtpbmcgc2VsZWN0ZWQgcHJvcGVydHkuCgkJLy8gKFdlYktpdCBkZWZh
dWx0cyB0byBmYWxzZSBpbnN0ZWFkIG9mIHRydWUsIElFIHRvbywgaWYgaXQncyBp
biBhbiBvcHRncm91cCkKCQlvcHRTZWxlY3RlZDogb3B0LnNlbGVjdGVkLAoKCQkv
LyBUZXN0IHNldEF0dHJpYnV0ZSBvbiBjYW1lbENhc2UgY2xhc3MuIElmIGl0IHdv
cmtzLCB3ZSBuZWVkIGF0dHJGaXhlcyB3aGVuIGRvaW5nIGdldC9zZXRBdHRyaWJ1
dGUgKGllNi83KQoJCWdldFNldEF0dHJpYnV0ZTogZGl2LmNsYXNzTmFtZSAhPT0g
InQiLAoKCQkvLyBUZXN0cyBmb3IgZW5jdHlwZSBzdXBwb3J0IG9uIGEgZm9ybSgj
Njc0MykKCQllbmN0eXBlOiAhIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImZvcm0i
KS5lbmN0eXBlLAoKCQkvLyBNYWtlcyBzdXJlIGNsb25pbmcgYW4gaHRtbDUgZWxl
bWVudCBkb2VzIG5vdCBjYXVzZSBwcm9ibGVtcwoJCS8vIFdoZXJlIG91dGVySFRN
TCBpcyB1bmRlZmluZWQsIHRoaXMgc3RpbGwgd29ya3MKCQlodG1sNUNsb25lOiBk
b2N1bWVudC5jcmVhdGVFbGVtZW50KCJuYXYiKS5jbG9uZU5vZGUoIHRydWUgKS5v
dXRlckhUTUwgIT09ICI8Om5hdj48LzpuYXY+IiwKCgkJLy8gV2lsbCBiZSBkZWZp
bmVkIGxhdGVyCgkJc3VibWl0QnViYmxlczogdHJ1ZSwKCQljaGFuZ2VCdWJibGVz
OiB0cnVlLAoJCWZvY3VzaW5CdWJibGVzOiBmYWxzZSwKCQlkZWxldGVFeHBhbmRv
OiB0cnVlLAoJCW5vQ2xvbmVFdmVudDogdHJ1ZSwKCQlpbmxpbmVCbG9ja05lZWRz
TGF5b3V0OiBmYWxzZSwKCQlzaHJpbmtXcmFwQmxvY2tzOiBmYWxzZSwKCQlyZWxp
YWJsZU1hcmdpblJpZ2h0OiB0cnVlLAoJCXBpeGVsTWFyZ2luOiB0cnVlCgl9OwoK
CS8vIGpRdWVyeS5ib3hNb2RlbCBERVBSRUNBVEVEIGluIDEuMywgdXNlIGpRdWVy
eS5zdXBwb3J0LmJveE1vZGVsIGluc3RlYWQKCWpRdWVyeS5ib3hNb2RlbCA9IHN1
cHBvcnQuYm94TW9kZWwgPSAoZG9jdW1lbnQuY29tcGF0TW9kZSA9PT0gIkNTUzFD
b21wYXQiKTsKCgkvLyBNYWtlIHN1cmUgY2hlY2tlZCBzdGF0dXMgaXMgcHJvcGVy
bHkgY2xvbmVkCglpbnB1dC5jaGVja2VkID0gdHJ1ZTsKCXN1cHBvcnQubm9DbG9u
ZUNoZWNrZWQgPSBpbnB1dC5jbG9uZU5vZGUoIHRydWUgKS5jaGVja2VkOwoKCS8v
IE1ha2Ugc3VyZSB0aGF0IHRoZSBvcHRpb25zIGluc2lkZSBkaXNhYmxlZCBzZWxl
Y3RzIGFyZW4ndCBtYXJrZWQgYXMgZGlzYWJsZWQKCS8vIChXZWJLaXQgbWFya3Mg
dGhlbSBhcyBkaXNhYmxlZCkKCXNlbGVjdC5kaXNhYmxlZCA9IHRydWU7CglzdXBw
b3J0Lm9wdERpc2FibGVkID0gIW9wdC5kaXNhYmxlZDsKCgkvLyBUZXN0IHRvIHNl
ZSBpZiBpdCdzIHBvc3NpYmxlIHRvIGRlbGV0ZSBhbiBleHBhbmRvIGZyb20gYW4g
ZWxlbWVudAoJLy8gRmFpbHMgaW4gSW50ZXJuZXQgRXhwbG9yZXIKCXRyeSB7CgkJ
ZGVsZXRlIGRpdi50ZXN0OwoJfSBjYXRjaCggZSApIHsKCQlzdXBwb3J0LmRlbGV0
ZUV4cGFuZG8gPSBmYWxzZTsKCX0KCglpZiAoICFkaXYuYWRkRXZlbnRMaXN0ZW5l
ciAmJiBkaXYuYXR0YWNoRXZlbnQgJiYgZGl2LmZpcmVFdmVudCApIHsKCQlkaXYu
YXR0YWNoRXZlbnQoICJvbmNsaWNrIiwgZnVuY3Rpb24oKSB7CgkJCS8vIENsb25p
bmcgYSBub2RlIHNob3VsZG4ndCBjb3B5IG92ZXIgYW55CgkJCS8vIGJvdW5kIGV2
ZW50IGhhbmRsZXJzIChJRSBkb2VzIHRoaXMpCgkJCXN1cHBvcnQubm9DbG9uZUV2
ZW50ID0gZmFsc2U7CgkJfSk7CgkJZGl2LmNsb25lTm9kZSggdHJ1ZSApLmZpcmVF
dmVudCggIm9uY2xpY2siICk7Cgl9CgoJLy8gQ2hlY2sgaWYgYSByYWRpbyBtYWlu
dGFpbnMgaXRzIHZhbHVlCgkvLyBhZnRlciBiZWluZyBhcHBlbmRlZCB0byB0aGUg
RE9NCglpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7Cglp
bnB1dC52YWx1ZSA9ICJ0IjsKCWlucHV0LnNldEF0dHJpYnV0ZSgidHlwZSIsICJy
YWRpbyIpOwoJc3VwcG9ydC5yYWRpb1ZhbHVlID0gaW5wdXQudmFsdWUgPT09ICJ0
IjsKCglpbnB1dC5zZXRBdHRyaWJ1dGUoImNoZWNrZWQiLCAiY2hlY2tlZCIpOwoK
CS8vICMxMTIxNyAtIFdlYktpdCBsb3NlcyBjaGVjayB3aGVuIHRoZSBuYW1lIGlz
IGFmdGVyIHRoZSBjaGVja2VkIGF0dHJpYnV0ZQoJaW5wdXQuc2V0QXR0cmlidXRl
KCAibmFtZSIsICJ0IiApOwoKCWRpdi5hcHBlbmRDaGlsZCggaW5wdXQgKTsKCWZy
YWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpOwoJZnJh
Z21lbnQuYXBwZW5kQ2hpbGQoIGRpdi5sYXN0Q2hpbGQgKTsKCgkvLyBXZWJLaXQg
ZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVu
dHMKCXN1cHBvcnQuY2hlY2tDbG9uZSA9IGZyYWdtZW50LmNsb25lTm9kZSggdHJ1
ZSApLmNsb25lTm9kZSggdHJ1ZSApLmxhc3RDaGlsZC5jaGVja2VkOwoKCS8vIENo
ZWNrIGlmIGEgZGlzY29ubmVjdGVkIGNoZWNrYm94IHdpbGwgcmV0YWluIGl0cyBj
aGVja2VkCgkvLyB2YWx1ZSBvZiB0cnVlIGFmdGVyIGFwcGVuZGVkIHRvIHRoZSBE
T00gKElFNi83KQoJc3VwcG9ydC5hcHBlbmRDaGVja2VkID0gaW5wdXQuY2hlY2tl
ZDsKCglmcmFnbWVudC5yZW1vdmVDaGlsZCggaW5wdXQgKTsKCWZyYWdtZW50LmFw
cGVuZENoaWxkKCBkaXYgKTsKCgkvLyBUZWNobmlxdWUgZnJvbSBKdXJpeSBaYXl0
c2V2CgkvLyBodHRwOi8vcGVyZmVjdGlvbmtpbGxzLmNvbS9kZXRlY3RpbmctZXZl
bnQtc3VwcG9ydC13aXRob3V0LWJyb3dzZXItc25pZmZpbmcvCgkvLyBXZSBvbmx5
IGNhcmUgYWJvdXQgdGhlIGNhc2Ugd2hlcmUgbm9uLXN0YW5kYXJkIGV2ZW50IHN5
c3RlbXMKCS8vIGFyZSB1c2VkLCBuYW1lbHkgaW4gSUUuIFNob3J0LWNpcmN1aXRp
bmcgaGVyZSBoZWxwcyB1cyB0bwoJLy8gYXZvaWQgYW4gZXZhbCBjYWxsIChpbiBz
ZXRBdHRyaWJ1dGUpIHdoaWNoIGNhbiBjYXVzZSBDU1AKCS8vIHRvIGdvIGhheXdp
cmUuIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vU2VjdXJp
dHkvQ1NQCglpZiAoIGRpdi5hdHRhY2hFdmVudCApIHsKCQlmb3IgKCBpIGluIHsK
CQkJc3VibWl0OiAxLAoJCQljaGFuZ2U6IDEsCgkJCWZvY3VzaW46IDEKCQl9KSB7
CgkJCWV2ZW50TmFtZSA9ICJvbiIgKyBpOwoJCQlpc1N1cHBvcnRlZCA9ICggZXZl
bnROYW1lIGluIGRpdiApOwoJCQlpZiAoICFpc1N1cHBvcnRlZCApIHsKCQkJCWRp
di5zZXRBdHRyaWJ1dGUoIGV2ZW50TmFtZSwgInJldHVybjsiICk7CgkJCQlpc1N1
cHBvcnRlZCA9ICggdHlwZW9mIGRpdlsgZXZlbnROYW1lIF0gPT09ICJmdW5jdGlv
biIgKTsKCQkJfQoJCQlzdXBwb3J0WyBpICsgIkJ1YmJsZXMiIF0gPSBpc1N1cHBv
cnRlZDsKCQl9Cgl9CgoJZnJhZ21lbnQucmVtb3ZlQ2hpbGQoIGRpdiApOwoKCS8v
IE51bGwgZWxlbWVudHMgdG8gYXZvaWQgbGVha3MgaW4gSUUKCWZyYWdtZW50ID0g
c2VsZWN0ID0gb3B0ID0gZGl2ID0gaW5wdXQgPSBudWxsOwoKCS8vIFJ1biB0ZXN0
cyB0aGF0IG5lZWQgYSBib2R5IGF0IGRvYyByZWFkeQoJalF1ZXJ5KGZ1bmN0aW9u
KCkgewoJCXZhciBjb250YWluZXIsIG91dGVyLCBpbm5lciwgdGFibGUsIHRkLCBv
ZmZzZXRTdXBwb3J0LAoJCQltYXJnaW5EaXYsIGNvbk1hcmdpblRvcCwgc3R5bGUs
IGh0bWwsIHBvc2l0aW9uVG9wTGVmdFdpZHRoSGVpZ2h0LAoJCQlwYWRkaW5nTWFy
Z2luQm9yZGVyVmlzaWJpbGl0eSwgcGFkZGluZ01hcmdpbkJvcmRlciwKCQkJYm9k
eSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07CgoJ
CWlmICggIWJvZHkgKSB7CgkJCS8vIFJldHVybiBmb3IgZnJhbWVzZXQgZG9jcyB0
aGF0IGRvbid0IGhhdmUgYSBib2R5CgkJCXJldHVybjsKCQl9CgoJCWNvbk1hcmdp
blRvcCA9IDE7CgkJcGFkZGluZ01hcmdpbkJvcmRlciA9ICJwYWRkaW5nOjA7bWFy
Z2luOjA7Ym9yZGVyOiI7CgkJcG9zaXRpb25Ub3BMZWZ0V2lkdGhIZWlnaHQgPSAi
cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOjFweDtoZWlnaHQ6
MXB4OyI7CgkJcGFkZGluZ01hcmdpbkJvcmRlclZpc2liaWxpdHkgPSBwYWRkaW5n
TWFyZ2luQm9yZGVyICsgIjA7dmlzaWJpbGl0eTpoaWRkZW47IjsKCQlzdHlsZSA9
ICJzdHlsZT0nIiArIHBvc2l0aW9uVG9wTGVmdFdpZHRoSGVpZ2h0ICsgcGFkZGlu
Z01hcmdpbkJvcmRlciArICI1cHggc29saWQgIzAwMDsiOwoJCWh0bWwgPSAiPGRp
diAiICsgc3R5bGUgKyAiZGlzcGxheTpibG9jazsnPjxkaXYgc3R5bGU9JyIgKyBw
YWRkaW5nTWFyZ2luQm9yZGVyICsgIjA7ZGlzcGxheTpibG9jaztvdmVyZmxvdzpo
aWRkZW47Jz48L2Rpdj48L2Rpdj4iICsKCQkJIjx0YWJsZSAiICsgc3R5bGUgKyAi
JyBjZWxscGFkZGluZz0nMCcgY2VsbHNwYWNpbmc9JzAnPiIgKwoJCQkiPHRyPjx0
ZD48L3RkPjwvdHI+PC90YWJsZT4iOwoKCQljb250YWluZXIgPSBkb2N1bWVudC5j
cmVhdGVFbGVtZW50KCJkaXYiKTsKCQljb250YWluZXIuc3R5bGUuY3NzVGV4dCA9
IHBhZGRpbmdNYXJnaW5Cb3JkZXJWaXNpYmlsaXR5ICsgIndpZHRoOjA7aGVpZ2h0
OjA7cG9zaXRpb246c3RhdGljO3RvcDowO21hcmdpbi10b3A6IiArIGNvbk1hcmdp
blRvcCArICJweCI7CgkJYm9keS5pbnNlcnRCZWZvcmUoIGNvbnRhaW5lciwgYm9k
eS5maXJzdENoaWxkICk7CgoJCS8vIENvbnN0cnVjdCB0aGUgdGVzdCBlbGVtZW50
CgkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CgkJY29udGFp
bmVyLmFwcGVuZENoaWxkKCBkaXYgKTsKCgkJLy8gQ2hlY2sgaWYgdGFibGUgY2Vs
bHMgc3RpbGwgaGF2ZSBvZmZzZXRXaWR0aC9IZWlnaHQgd2hlbiB0aGV5IGFyZSBz
ZXQKCQkvLyB0byBkaXNwbGF5Om5vbmUgYW5kIHRoZXJlIGFyZSBzdGlsbCBvdGhl
ciB2aXNpYmxlIHRhYmxlIGNlbGxzIGluIGEKCQkvLyB0YWJsZSByb3c7IGlmIHNv
LCBvZmZzZXRXaWR0aC9IZWlnaHQgYXJlIG5vdCByZWxpYWJsZSBmb3IgdXNlIHdo
ZW4KCQkvLyBkZXRlcm1pbmluZyBpZiBhbiBlbGVtZW50IGhhcyBiZWVuIGhpZGRl
biBkaXJlY3RseSB1c2luZwoJCS8vIGRpc3BsYXk6bm9uZSAoaXQgaXMgc3RpbGwg
c2FmZSB0byB1c2Ugb2Zmc2V0cyBpZiBhIHBhcmVudCBlbGVtZW50IGlzCgkJLy8g
aGlkZGVuOyBkb24gc2FmZXR5IGdvZ2dsZXMgYW5kIHNlZSBidWcgIzQ1MTIgZm9y
IG1vcmUgaW5mb3JtYXRpb24pLgoJCS8vIChvbmx5IElFIDggZmFpbHMgdGhpcyB0
ZXN0KQoJCWRpdi5pbm5lckhUTUwgPSAiPHRhYmxlPjx0cj48dGQgc3R5bGU9JyIg
KyBwYWRkaW5nTWFyZ2luQm9yZGVyICsgIjA7ZGlzcGxheTpub25lJz48L3RkPjx0
ZD50PC90ZD48L3RyPjwvdGFibGU+IjsKCQl0ZHMgPSBkaXYuZ2V0RWxlbWVudHNC
eVRhZ05hbWUoICJ0ZCIgKTsKCQlpc1N1cHBvcnRlZCA9ICggdGRzWyAwIF0ub2Zm
c2V0SGVpZ2h0ID09PSAwICk7CgoJCXRkc1sgMCBdLnN0eWxlLmRpc3BsYXkgPSAi
IjsKCQl0ZHNbIDEgXS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoKCQkvLyBDaGVj
ayBpZiBlbXB0eSB0YWJsZSBjZWxscyBzdGlsbCBoYXZlIG9mZnNldFdpZHRoL0hl
aWdodAoJCS8vIChJRSA8PSA4IGZhaWwgdGhpcyB0ZXN0KQoJCXN1cHBvcnQucmVs
aWFibGVIaWRkZW5PZmZzZXRzID0gaXNTdXBwb3J0ZWQgJiYgKCB0ZHNbIDAgXS5v
ZmZzZXRIZWlnaHQgPT09IDAgKTsKCgkJLy8gQ2hlY2sgaWYgZGl2IHdpdGggZXhw
bGljaXQgd2lkdGggYW5kIG5vIG1hcmdpbi1yaWdodCBpbmNvcnJlY3RseQoJCS8v
IGdldHMgY29tcHV0ZWQgbWFyZ2luLXJpZ2h0IGJhc2VkIG9uIHdpZHRoIG9mIGNv
bnRhaW5lci4gRm9yIG1vcmUKCQkvLyBpbmZvIHNlZSBidWcgIzMzMzMKCQkvLyBG
YWlscyBpbiBXZWJLaXQgYmVmb3JlIEZlYiAyMDExIG5pZ2h0bGllcwoJCS8vIFdl
YktpdCBCdWcgMTMzNDMgLSBnZXRDb21wdXRlZFN0eWxlIHJldHVybnMgd3Jvbmcg
dmFsdWUgZm9yIG1hcmdpbi1yaWdodAoJCWlmICggd2luZG93LmdldENvbXB1dGVk
U3R5bGUgKSB7CgkJCWRpdi5pbm5lckhUTUwgPSAiIjsKCQkJbWFyZ2luRGl2ID0g
ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQkJbWFyZ2luRGl2LnN0
eWxlLndpZHRoID0gIjAiOwoJCQltYXJnaW5EaXYuc3R5bGUubWFyZ2luUmlnaHQg
PSAiMCI7CgkJCWRpdi5zdHlsZS53aWR0aCA9ICIycHgiOwoJCQlkaXYuYXBwZW5k
Q2hpbGQoIG1hcmdpbkRpdiApOwoJCQlzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmln
aHQgPQoJCQkJKCBwYXJzZUludCggKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSgg
bWFyZ2luRGl2LCBudWxsICkgfHwgeyBtYXJnaW5SaWdodDogMCB9ICkubWFyZ2lu
UmlnaHQsIDEwICkgfHwgMCApID09PSAwOwoJCX0KCgkJaWYgKCB0eXBlb2YgZGl2
LnN0eWxlLnpvb20gIT09ICJ1bmRlZmluZWQiICkgewoJCQkvLyBDaGVjayBpZiBu
YXRpdmVseSBibG9jay1sZXZlbCBlbGVtZW50cyBhY3QgbGlrZSBpbmxpbmUtYmxv
Y2sKCQkJLy8gZWxlbWVudHMgd2hlbiBzZXR0aW5nIHRoZWlyIGRpc3BsYXkgdG8g
J2lubGluZScgYW5kIGdpdmluZwoJCQkvLyB0aGVtIGxheW91dAoJCQkvLyAoSUUg
PCA4IGRvZXMgdGhpcykKCQkJZGl2LmlubmVySFRNTCA9ICIiOwoJCQlkaXYuc3R5
bGUud2lkdGggPSBkaXYuc3R5bGUucGFkZGluZyA9ICIxcHgiOwoJCQlkaXYuc3R5
bGUuYm9yZGVyID0gMDsKCQkJZGl2LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7
CgkJCWRpdi5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CgkJCWRpdi5zdHlsZS56
b29tID0gMTsKCQkJc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0ID0gKCBk
aXYub2Zmc2V0V2lkdGggPT09IDMgKTsKCgkJCS8vIENoZWNrIGlmIGVsZW1lbnRz
IHdpdGggbGF5b3V0IHNocmluay13cmFwIHRoZWlyIGNoaWxkcmVuCgkJCS8vIChJ
RSA2IGRvZXMgdGhpcykKCQkJZGl2LnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwoJ
CQlkaXYuc3R5bGUub3ZlcmZsb3cgPSAidmlzaWJsZSI7CgkJCWRpdi5pbm5lckhU
TUwgPSAiPGRpdiBzdHlsZT0nd2lkdGg6NXB4Oyc+PC9kaXY+IjsKCQkJc3VwcG9y
dC5zaHJpbmtXcmFwQmxvY2tzID0gKCBkaXYub2Zmc2V0V2lkdGggIT09IDMgKTsK
CQl9CgoJCWRpdi5zdHlsZS5jc3NUZXh0ID0gcG9zaXRpb25Ub3BMZWZ0V2lkdGhI
ZWlnaHQgKyBwYWRkaW5nTWFyZ2luQm9yZGVyVmlzaWJpbGl0eTsKCQlkaXYuaW5u
ZXJIVE1MID0gaHRtbDsKCgkJb3V0ZXIgPSBkaXYuZmlyc3RDaGlsZDsKCQlpbm5l
ciA9IG91dGVyLmZpcnN0Q2hpbGQ7CgkJdGQgPSBvdXRlci5uZXh0U2libGluZy5m
aXJzdENoaWxkLmZpcnN0Q2hpbGQ7CgoJCW9mZnNldFN1cHBvcnQgPSB7CgkJCWRv
ZXNOb3RBZGRCb3JkZXI6ICggaW5uZXIub2Zmc2V0VG9wICE9PSA1ICksCgkJCWRv
ZXNBZGRCb3JkZXJGb3JUYWJsZUFuZENlbGxzOiAoIHRkLm9mZnNldFRvcCA9PT0g
NSApCgkJfTsKCgkJaW5uZXIuc3R5bGUucG9zaXRpb24gPSAiZml4ZWQiOwoJCWlu
bmVyLnN0eWxlLnRvcCA9ICIyMHB4IjsKCgkJLy8gc2FmYXJpIHN1YnRyYWN0cyBw
YXJlbnQgYm9yZGVyIHdpZHRoIGhlcmUgd2hpY2ggaXMgNXB4CgkJb2Zmc2V0U3Vw
cG9ydC5maXhlZFBvc2l0aW9uID0gKCBpbm5lci5vZmZzZXRUb3AgPT09IDIwIHx8
IGlubmVyLm9mZnNldFRvcCA9PT0gMTUgKTsKCQlpbm5lci5zdHlsZS5wb3NpdGlv
biA9IGlubmVyLnN0eWxlLnRvcCA9ICIiOwoKCQlvdXRlci5zdHlsZS5vdmVyZmxv
dyA9ICJoaWRkZW4iOwoJCW91dGVyLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZl
IjsKCgkJb2Zmc2V0U3VwcG9ydC5zdWJ0cmFjdHNCb3JkZXJGb3JPdmVyZmxvd05v
dFZpc2libGUgPSAoIGlubmVyLm9mZnNldFRvcCA9PT0gLTUgKTsKCQlvZmZzZXRT
dXBwb3J0LmRvZXNOb3RJbmNsdWRlTWFyZ2luSW5Cb2R5T2Zmc2V0ID0gKCBib2R5
Lm9mZnNldFRvcCAhPT0gY29uTWFyZ2luVG9wICk7CgoJCWlmICggd2luZG93Lmdl
dENvbXB1dGVkU3R5bGUgKSB7CgkJCWRpdi5zdHlsZS5tYXJnaW5Ub3AgPSAiMSUi
OwoJCQlzdXBwb3J0LnBpeGVsTWFyZ2luID0gKCB3aW5kb3cuZ2V0Q29tcHV0ZWRT
dHlsZSggZGl2LCBudWxsICkgfHwgeyBtYXJnaW5Ub3A6IDAgfSApLm1hcmdpblRv
cCAhPT0gIjElIjsKCQl9CgoJCWlmICggdHlwZW9mIGNvbnRhaW5lci5zdHlsZS56
b29tICE9PSAidW5kZWZpbmVkIiApIHsKCQkJY29udGFpbmVyLnN0eWxlLnpvb20g
PSAxOwoJCX0KCgkJYm9keS5yZW1vdmVDaGlsZCggY29udGFpbmVyICk7CgkJbWFy
Z2luRGl2ID0gZGl2ID0gY29udGFpbmVyID0gbnVsbDsKCgkJalF1ZXJ5LmV4dGVu
ZCggc3VwcG9ydCwgb2Zmc2V0U3VwcG9ydCApOwoJfSk7CgoJcmV0dXJuIHN1cHBv
cnQ7Cn0pKCk7CgoKCgp2YXIgcmJyYWNlID0gL14oPzpcey4qXH18XFsuKlxdKSQv
LAoJcm11bHRpRGFzaCA9IC8oW0EtWl0pL2c7CgpqUXVlcnkuZXh0ZW5kKHsKCWNh
Y2hlOiB7fSwKCgkvLyBQbGVhc2UgdXNlIHdpdGggY2F1dGlvbgoJdXVpZDogMCwK
CgkvLyBVbmlxdWUgZm9yIGVhY2ggY29weSBvZiBqUXVlcnkgb24gdGhlIHBhZ2UK
CS8vIE5vbi1kaWdpdHMgcmVtb3ZlZCB0byBtYXRjaCByaW5saW5lalF1ZXJ5Cgll
eHBhbmRvOiAialF1ZXJ5IiArICggalF1ZXJ5LmZuLmpxdWVyeSArIE1hdGgucmFu
ZG9tKCkgKS5yZXBsYWNlKCAvXEQvZywgIiIgKSwKCgkvLyBUaGUgZm9sbG93aW5n
IGVsZW1lbnRzIHRocm93IHVuY2F0Y2hhYmxlIGV4Y2VwdGlvbnMgaWYgeW91Cgkv
LyBhdHRlbXB0IHRvIGFkZCBleHBhbmRvIHByb3BlcnRpZXMgdG8gdGhlbS4KCW5v
RGF0YTogewoJCSJlbWJlZCI6IHRydWUsCgkJLy8gQmFuIGFsbCBvYmplY3RzIGV4
Y2VwdCBmb3IgRmxhc2ggKHdoaWNoIGhhbmRsZSBleHBhbmRvcykKCQkib2JqZWN0
IjogImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMCIs
CgkJImFwcGxldCI6IHRydWUKCX0sCgoJaGFzRGF0YTogZnVuY3Rpb24oIGVsZW0g
KSB7CgkJZWxlbSA9IGVsZW0ubm9kZVR5cGUgPyBqUXVlcnkuY2FjaGVbIGVsZW1b
alF1ZXJ5LmV4cGFuZG9dIF0gOiBlbGVtWyBqUXVlcnkuZXhwYW5kbyBdOwoJCXJl
dHVybiAhIWVsZW0gJiYgIWlzRW1wdHlEYXRhT2JqZWN0KCBlbGVtICk7Cgl9LAoK
CWRhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBkYXRhLCBwdnQgLyogSW50ZXJu
YWwgVXNlIE9ubHkgKi8gKSB7CgkJaWYgKCAhalF1ZXJ5LmFjY2VwdERhdGEoIGVs
ZW0gKSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIHByaXZhdGVDYWNoZSwgdGhp
c0NhY2hlLCByZXQsCgkJCWludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCgkJ
CWdldEJ5TmFtZSA9IHR5cGVvZiBuYW1lID09PSAic3RyaW5nIiwKCgkJCS8vIFdl
IGhhdmUgdG8gaGFuZGxlIERPTSBub2RlcyBhbmQgSlMgb2JqZWN0cyBkaWZmZXJl
bnRseSBiZWNhdXNlIElFNi03CgkJCS8vIGNhbid0IEdDIG9iamVjdCByZWZlcmVu
Y2VzIHByb3Blcmx5IGFjcm9zcyB0aGUgRE9NLUpTIGJvdW5kYXJ5CgkJCWlzTm9k
ZSA9IGVsZW0ubm9kZVR5cGUsCgoJCQkvLyBPbmx5IERPTSBub2RlcyBuZWVkIHRo
ZSBnbG9iYWwgalF1ZXJ5IGNhY2hlOyBKUyBvYmplY3QgZGF0YSBpcwoJCQkvLyBh
dHRhY2hlZCBkaXJlY3RseSB0byB0aGUgb2JqZWN0IHNvIEdDIGNhbiBvY2N1ciBh
dXRvbWF0aWNhbGx5CgkJCWNhY2hlID0gaXNOb2RlID8galF1ZXJ5LmNhY2hlIDog
ZWxlbSwKCgkJCS8vIE9ubHkgZGVmaW5pbmcgYW4gSUQgZm9yIEpTIG9iamVjdHMg
aWYgaXRzIGNhY2hlIGFscmVhZHkgZXhpc3RzIGFsbG93cwoJCQkvLyB0aGUgY29k
ZSB0byBzaG9ydGN1dCBvbiB0aGUgc2FtZSBwYXRoIGFzIGEgRE9NIG5vZGUgd2l0
aCBubyBjYWNoZQoJCQlpZCA9IGlzTm9kZSA/IGVsZW1bIGludGVybmFsS2V5IF0g
OiBlbGVtWyBpbnRlcm5hbEtleSBdICYmIGludGVybmFsS2V5LAoJCQlpc0V2ZW50
cyA9IG5hbWUgPT09ICJldmVudHMiOwoKCQkvLyBBdm9pZCBkb2luZyBhbnkgbW9y
ZSB3b3JrIHRoYW4gd2UgbmVlZCB0byB3aGVuIHRyeWluZyB0byBnZXQgZGF0YSBv
biBhbgoJCS8vIG9iamVjdCB0aGF0IGhhcyBubyBkYXRhIGF0IGFsbAoJCWlmICgg
KCFpZCB8fCAhY2FjaGVbaWRdIHx8ICghaXNFdmVudHMgJiYgIXB2dCAmJiAhY2Fj
aGVbaWRdLmRhdGEpKSAmJiBnZXRCeU5hbWUgJiYgZGF0YSA9PT0gdW5kZWZpbmVk
ICkgewoJCQlyZXR1cm47CgkJfQoKCQlpZiAoICFpZCApIHsKCQkJLy8gT25seSBE
T00gbm9kZXMgbmVlZCBhIG5ldyB1bmlxdWUgSUQgZm9yIGVhY2ggZWxlbWVudCBz
aW5jZSB0aGVpciBkYXRhCgkJCS8vIGVuZHMgdXAgaW4gdGhlIGdsb2JhbCBjYWNo
ZQoJCQlpZiAoIGlzTm9kZSApIHsKCQkJCWVsZW1bIGludGVybmFsS2V5IF0gPSBp
ZCA9ICsralF1ZXJ5LnV1aWQ7CgkJCX0gZWxzZSB7CgkJCQlpZCA9IGludGVybmFs
S2V5OwoJCQl9CgkJfQoKCQlpZiAoICFjYWNoZVsgaWQgXSApIHsKCQkJY2FjaGVb
IGlkIF0gPSB7fTsKCgkJCS8vIEF2b2lkcyBleHBvc2luZyBqUXVlcnkgbWV0YWRh
dGEgb24gcGxhaW4gSlMgb2JqZWN0cyB3aGVuIHRoZSBvYmplY3QKCQkJLy8gaXMg
c2VyaWFsaXplZCB1c2luZyBKU09OLnN0cmluZ2lmeQoJCQlpZiAoICFpc05vZGUg
KSB7CgkJCQljYWNoZVsgaWQgXS50b0pTT04gPSBqUXVlcnkubm9vcDsKCQkJfQoJ
CX0KCgkJLy8gQW4gb2JqZWN0IGNhbiBiZSBwYXNzZWQgdG8galF1ZXJ5LmRhdGEg
aW5zdGVhZCBvZiBhIGtleS92YWx1ZSBwYWlyOyB0aGlzIGdldHMKCQkvLyBzaGFs
bG93IGNvcGllZCBvdmVyIG9udG8gdGhlIGV4aXN0aW5nIGNhY2hlCgkJaWYgKCB0
eXBlb2YgbmFtZSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIG5hbWUgPT09ICJmdW5j
dGlvbiIgKSB7CgkJCWlmICggcHZ0ICkgewoJCQkJY2FjaGVbIGlkIF0gPSBqUXVl
cnkuZXh0ZW5kKCBjYWNoZVsgaWQgXSwgbmFtZSApOwoJCQl9IGVsc2UgewoJCQkJ
Y2FjaGVbIGlkIF0uZGF0YSA9IGpRdWVyeS5leHRlbmQoIGNhY2hlWyBpZCBdLmRh
dGEsIG5hbWUgKTsKCQkJfQoJCX0KCgkJcHJpdmF0ZUNhY2hlID0gdGhpc0NhY2hl
ID0gY2FjaGVbIGlkIF07CgoJCS8vIGpRdWVyeSBkYXRhKCkgaXMgc3RvcmVkIGlu
IGEgc2VwYXJhdGUgb2JqZWN0IGluc2lkZSB0aGUgb2JqZWN0J3MgaW50ZXJuYWwg
ZGF0YQoJCS8vIGNhY2hlIGluIG9yZGVyIHRvIGF2b2lkIGtleSBjb2xsaXNpb25z
IGJldHdlZW4gaW50ZXJuYWwgZGF0YSBhbmQgdXNlci1kZWZpbmVkCgkJLy8gZGF0
YS4KCQlpZiAoICFwdnQgKSB7CgkJCWlmICggIXRoaXNDYWNoZS5kYXRhICkgewoJ
CQkJdGhpc0NhY2hlLmRhdGEgPSB7fTsKCQkJfQoKCQkJdGhpc0NhY2hlID0gdGhp
c0NhY2hlLmRhdGE7CgkJfQoKCQlpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHsK
CQkJdGhpc0NhY2hlWyBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICkgXSA9IGRhdGE7
CgkJfQoKCQkvLyBVc2VycyBzaG91bGQgbm90IGF0dGVtcHQgdG8gaW5zcGVjdCB0
aGUgaW50ZXJuYWwgZXZlbnRzIG9iamVjdCB1c2luZyBqUXVlcnkuZGF0YSwKCQkv
LyBpdCBpcyB1bmRvY3VtZW50ZWQgYW5kIHN1YmplY3QgdG8gY2hhbmdlLiBCdXQg
ZG9lcyBhbnlvbmUgbGlzdGVuPyBOby4KCQlpZiAoIGlzRXZlbnRzICYmICF0aGlz
Q2FjaGVbIG5hbWUgXSApIHsKCQkJcmV0dXJuIHByaXZhdGVDYWNoZS5ldmVudHM7
CgkJfQoKCQkvLyBDaGVjayBmb3IgYm90aCBjb252ZXJ0ZWQtdG8tY2FtZWwgYW5k
IG5vbi1jb252ZXJ0ZWQgZGF0YSBwcm9wZXJ0eSBuYW1lcwoJCS8vIElmIGEgZGF0
YSBwcm9wZXJ0eSB3YXMgc3BlY2lmaWVkCgkJaWYgKCBnZXRCeU5hbWUgKSB7CgoJ
CQkvLyBGaXJzdCBUcnkgdG8gZmluZCBhcy1pcyBwcm9wZXJ0eSBkYXRhCgkJCXJl
dCA9IHRoaXNDYWNoZVsgbmFtZSBdOwoKCQkJLy8gVGVzdCBmb3IgbnVsbHx1bmRl
ZmluZWQgcHJvcGVydHkgZGF0YQoJCQlpZiAoIHJldCA9PSBudWxsICkgewoKCQkJ
CS8vIFRyeSB0byBmaW5kIHRoZSBjYW1lbENhc2VkIHByb3BlcnR5CgkJCQlyZXQg
PSB0aGlzQ2FjaGVbIGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKSBdOwoJCQl9CgkJ
fSBlbHNlIHsKCQkJcmV0ID0gdGhpc0NhY2hlOwoJCX0KCgkJcmV0dXJuIHJldDsK
CX0sCgoJcmVtb3ZlRGF0YTogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIHB2dCAvKiBJ
bnRlcm5hbCBVc2UgT25seSAqLyApIHsKCQlpZiAoICFqUXVlcnkuYWNjZXB0RGF0
YSggZWxlbSApICkgewoJCQlyZXR1cm47CgkJfQoKCQl2YXIgdGhpc0NhY2hlLCBp
LCBsLAoKCQkJLy8gUmVmZXJlbmNlIHRvIGludGVybmFsIGRhdGEgY2FjaGUga2V5
CgkJCWludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCgoJCQlpc05vZGUgPSBl
bGVtLm5vZGVUeXBlLAoKCQkJLy8gU2VlIGpRdWVyeS5kYXRhIGZvciBtb3JlIGlu
Zm9ybWF0aW9uCgkJCWNhY2hlID0gaXNOb2RlID8galF1ZXJ5LmNhY2hlIDogZWxl
bSwKCgkJCS8vIFNlZSBqUXVlcnkuZGF0YSBmb3IgbW9yZSBpbmZvcm1hdGlvbgoJ
CQlpZCA9IGlzTm9kZSA/IGVsZW1bIGludGVybmFsS2V5IF0gOiBpbnRlcm5hbEtl
eTsKCgkJLy8gSWYgdGhlcmUgaXMgYWxyZWFkeSBubyBjYWNoZSBlbnRyeSBmb3Ig
dGhpcyBvYmplY3QsIHRoZXJlIGlzIG5vCgkJLy8gcHVycG9zZSBpbiBjb250aW51
aW5nCgkJaWYgKCAhY2FjaGVbIGlkIF0gKSB7CgkJCXJldHVybjsKCQl9CgoJCWlm
ICggbmFtZSApIHsKCgkJCXRoaXNDYWNoZSA9IHB2dCA/IGNhY2hlWyBpZCBdIDog
Y2FjaGVbIGlkIF0uZGF0YTsKCgkJCWlmICggdGhpc0NhY2hlICkgewoKCQkJCS8v
IFN1cHBvcnQgYXJyYXkgb3Igc3BhY2Ugc2VwYXJhdGVkIHN0cmluZyBuYW1lcyBm
b3IgZGF0YSBrZXlzCgkJCQlpZiAoICFqUXVlcnkuaXNBcnJheSggbmFtZSApICkg
ewoKCQkJCQkvLyB0cnkgdGhlIHN0cmluZyBhcyBhIGtleSBiZWZvcmUgYW55IG1h
bmlwdWxhdGlvbgoJCQkJCWlmICggbmFtZSBpbiB0aGlzQ2FjaGUgKSB7CgkJCQkJ
CW5hbWUgPSBbIG5hbWUgXTsKCQkJCQl9IGVsc2UgewoKCQkJCQkJLy8gc3BsaXQg
dGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gYnkgc3BhY2VzIHVubGVzcyBhIGtleSB3
aXRoIHRoZSBzcGFjZXMgZXhpc3RzCgkJCQkJCW5hbWUgPSBqUXVlcnkuY2FtZWxD
YXNlKCBuYW1lICk7CgkJCQkJCWlmICggbmFtZSBpbiB0aGlzQ2FjaGUgKSB7CgkJ
CQkJCQluYW1lID0gWyBuYW1lIF07CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQluYW1l
ID0gbmFtZS5zcGxpdCggIiAiICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJ
Zm9yICggaSA9IDAsIGwgPSBuYW1lLmxlbmd0aDsgaSA8IGw7IGkrKyApIHsKCQkJ
CQlkZWxldGUgdGhpc0NhY2hlWyBuYW1lW2ldIF07CgkJCQl9CgoJCQkJLy8gSWYg
dGhlcmUgaXMgbm8gZGF0YSBsZWZ0IGluIHRoZSBjYWNoZSwgd2Ugd2FudCB0byBj
b250aW51ZQoJCQkJLy8gYW5kIGxldCB0aGUgY2FjaGUgb2JqZWN0IGl0c2VsZiBn
ZXQgZGVzdHJveWVkCgkJCQlpZiAoICEoIHB2dCA/IGlzRW1wdHlEYXRhT2JqZWN0
IDogalF1ZXJ5LmlzRW1wdHlPYmplY3QgKSggdGhpc0NhY2hlICkgKSB7CgkJCQkJ
cmV0dXJuOwoJCQkJfQoJCQl9CgkJfQoKCQkvLyBTZWUgalF1ZXJ5LmRhdGEgZm9y
IG1vcmUgaW5mb3JtYXRpb24KCQlpZiAoICFwdnQgKSB7CgkJCWRlbGV0ZSBjYWNo
ZVsgaWQgXS5kYXRhOwoKCQkJLy8gRG9uJ3QgZGVzdHJveSB0aGUgcGFyZW50IGNh
Y2hlIHVubGVzcyB0aGUgaW50ZXJuYWwgZGF0YSBvYmplY3QKCQkJLy8gaGFkIGJl
ZW4gdGhlIG9ubHkgdGhpbmcgbGVmdCBpbiBpdAoJCQlpZiAoICFpc0VtcHR5RGF0
YU9iamVjdChjYWNoZVsgaWQgXSkgKSB7CgkJCQlyZXR1cm47CgkJCX0KCQl9CgoJ
CS8vIEJyb3dzZXJzIHRoYXQgZmFpbCBleHBhbmRvIGRlbGV0aW9uIGFsc28gcmVm
dXNlIHRvIGRlbGV0ZSBleHBhbmRvcyBvbgoJCS8vIHRoZSB3aW5kb3csIGJ1dCBp
dCB3aWxsIGFsbG93IGl0IG9uIGFsbCBvdGhlciBKUyBvYmplY3RzOyBvdGhlciBi
cm93c2VycwoJCS8vIGRvbid0IGNhcmUKCQkvLyBFbnN1cmUgdGhhdCBgY2FjaGVg
IGlzIG5vdCBhIHdpbmRvdyBvYmplY3QgIzEwMDgwCgkJaWYgKCBqUXVlcnkuc3Vw
cG9ydC5kZWxldGVFeHBhbmRvIHx8ICFjYWNoZS5zZXRJbnRlcnZhbCApIHsKCQkJ
ZGVsZXRlIGNhY2hlWyBpZCBdOwoJCX0gZWxzZSB7CgkJCWNhY2hlWyBpZCBdID0g
bnVsbDsKCQl9CgoJCS8vIFdlIGRlc3Ryb3llZCB0aGUgY2FjaGUgYW5kIG5lZWQg
dG8gZWxpbWluYXRlIHRoZSBleHBhbmRvIG9uIHRoZSBub2RlIHRvIGF2b2lkCgkJ
Ly8gZmFsc2UgbG9va3VwcyBpbiB0aGUgY2FjaGUgZm9yIGVudHJpZXMgdGhhdCBu
byBsb25nZXIgZXhpc3QKCQlpZiAoIGlzTm9kZSApIHsKCQkJLy8gSUUgZG9lcyBu
b3QgYWxsb3cgdXMgdG8gZGVsZXRlIGV4cGFuZG8gcHJvcGVydGllcyBmcm9tIG5v
ZGVzLAoJCQkvLyBub3IgZG9lcyBpdCBoYXZlIGEgcmVtb3ZlQXR0cmlidXRlIGZ1
bmN0aW9uIG9uIERvY3VtZW50IG5vZGVzOwoJCQkvLyB3ZSBtdXN0IGhhbmRsZSBh
bGwgb2YgdGhlc2UgY2FzZXMKCQkJaWYgKCBqUXVlcnkuc3VwcG9ydC5kZWxldGVF
eHBhbmRvICkgewoJCQkJZGVsZXRlIGVsZW1bIGludGVybmFsS2V5IF07CgkJCX0g
ZWxzZSBpZiAoIGVsZW0ucmVtb3ZlQXR0cmlidXRlICkgewoJCQkJZWxlbS5yZW1v
dmVBdHRyaWJ1dGUoIGludGVybmFsS2V5ICk7CgkJCX0gZWxzZSB7CgkJCQllbGVt
WyBpbnRlcm5hbEtleSBdID0gbnVsbDsKCQkJfQoJCX0KCX0sCgoJLy8gRm9yIGlu
dGVybmFsIHVzZSBvbmx5LgoJX2RhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBk
YXRhICkgewoJCXJldHVybiBqUXVlcnkuZGF0YSggZWxlbSwgbmFtZSwgZGF0YSwg
dHJ1ZSApOwoJfSwKCgkvLyBBIG1ldGhvZCBmb3IgZGV0ZXJtaW5pbmcgaWYgYSBE
T00gbm9kZSBjYW4gaGFuZGxlIHRoZSBkYXRhIGV4cGFuZG8KCWFjY2VwdERhdGE6
IGZ1bmN0aW9uKCBlbGVtICkgewoJCWlmICggZWxlbS5ub2RlTmFtZSApIHsKCQkJ
dmFyIG1hdGNoID0galF1ZXJ5Lm5vRGF0YVsgZWxlbS5ub2RlTmFtZS50b0xvd2Vy
Q2FzZSgpIF07CgoJCQlpZiAoIG1hdGNoICkgewoJCQkJcmV0dXJuICEobWF0Y2gg
PT09IHRydWUgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoImNsYXNzaWQiKSAhPT0gbWF0
Y2gpOwoJCQl9CgkJfQoKCQlyZXR1cm4gdHJ1ZTsKCX0KfSk7CgpqUXVlcnkuZm4u
ZXh0ZW5kKHsKCWRhdGE6IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgewoJCXZhciBw
YXJ0cywgcGFydCwgYXR0ciwgbmFtZSwgbCwKCQkJZWxlbSA9IHRoaXNbMF0sCgkJ
CWkgPSAwLAoJCQlkYXRhID0gbnVsbDsKCgkJLy8gR2V0cyBhbGwgdmFsdWVzCgkJ
aWYgKCBrZXkgPT09IHVuZGVmaW5lZCApIHsKCQkJaWYgKCB0aGlzLmxlbmd0aCAp
IHsKCQkJCWRhdGEgPSBqUXVlcnkuZGF0YSggZWxlbSApOwoKCQkJCWlmICggZWxl
bS5ub2RlVHlwZSA9PT0gMSAmJiAhalF1ZXJ5Ll9kYXRhKCBlbGVtLCAicGFyc2Vk
QXR0cnMiICkgKSB7CgkJCQkJYXR0ciA9IGVsZW0uYXR0cmlidXRlczsKCQkJCQlm
b3IgKCBsID0gYXR0ci5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJCQkJCW5hbWUg
PSBhdHRyW2ldLm5hbWU7CgoJCQkJCQlpZiAoIG5hbWUuaW5kZXhPZiggImRhdGEt
IiApID09PSAwICkgewoJCQkJCQkJbmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5h
bWUuc3Vic3RyaW5nKDUpICk7CgoJCQkJCQkJZGF0YUF0dHIoIGVsZW0sIG5hbWUs
IGRhdGFbIG5hbWUgXSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWpRdWVyeS5fZGF0
YSggZWxlbSwgInBhcnNlZEF0dHJzIiwgdHJ1ZSApOwoJCQkJfQoJCQl9CgoJCQly
ZXR1cm4gZGF0YTsKCQl9CgoJCS8vIFNldHMgbXVsdGlwbGUgdmFsdWVzCgkJaWYg
KCB0eXBlb2Yga2V5ID09PSAib2JqZWN0IiApIHsKCQkJcmV0dXJuIHRoaXMuZWFj
aChmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5kYXRhKCB0aGlzLCBrZXkgKTsKCQkJ
fSk7CgkJfQoKCQlwYXJ0cyA9IGtleS5zcGxpdCggIi4iLCAyICk7CgkJcGFydHNb
MV0gPSBwYXJ0c1sxXSA/ICIuIiArIHBhcnRzWzFdIDogIiI7CgkJcGFydCA9IHBh
cnRzWzFdICsgIiEiOwoKCQlyZXR1cm4galF1ZXJ5LmFjY2VzcyggdGhpcywgZnVu
Y3Rpb24oIHZhbHVlICkgewoKCQkJaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICkg
ewoJCQkJZGF0YSA9IHRoaXMudHJpZ2dlckhhbmRsZXIoICJnZXREYXRhIiArIHBh
cnQsIFsgcGFydHNbMF0gXSApOwoKCQkJCS8vIFRyeSB0byBmZXRjaCBhbnkgaW50
ZXJuYWxseSBzdG9yZWQgZGF0YSBmaXJzdAoJCQkJaWYgKCBkYXRhID09PSB1bmRl
ZmluZWQgJiYgZWxlbSApIHsKCQkJCQlkYXRhID0galF1ZXJ5LmRhdGEoIGVsZW0s
IGtleSApOwoJCQkJCWRhdGEgPSBkYXRhQXR0ciggZWxlbSwga2V5LCBkYXRhICk7
CgkJCQl9CgoJCQkJcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCAmJiBwYXJ0c1sx
XSA/CgkJCQkJdGhpcy5kYXRhKCBwYXJ0c1swXSApIDoKCQkJCQlkYXRhOwoJCQl9
CgoJCQlwYXJ0c1sxXSA9IHZhbHVlOwoJCQl0aGlzLmVhY2goZnVuY3Rpb24oKSB7
CgkJCQl2YXIgc2VsZiA9IGpRdWVyeSggdGhpcyApOwoKCQkJCXNlbGYudHJpZ2dl
ckhhbmRsZXIoICJzZXREYXRhIiArIHBhcnQsIHBhcnRzICk7CgkJCQlqUXVlcnku
ZGF0YSggdGhpcywga2V5LCB2YWx1ZSApOwoJCQkJc2VsZi50cmlnZ2VySGFuZGxl
ciggImNoYW5nZURhdGEiICsgcGFydCwgcGFydHMgKTsKCQkJfSk7CgkJfSwgbnVs
bCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxLCBudWxsLCBmYWxzZSApOwoJ
fSwKCglyZW1vdmVEYXRhOiBmdW5jdGlvbigga2V5ICkgewoJCXJldHVybiB0aGlz
LmVhY2goZnVuY3Rpb24oKSB7CgkJCWpRdWVyeS5yZW1vdmVEYXRhKCB0aGlzLCBr
ZXkgKTsKCQl9KTsKCX0KfSk7CgpmdW5jdGlvbiBkYXRhQXR0ciggZWxlbSwga2V5
LCBkYXRhICkgewoJLy8gSWYgbm90aGluZyB3YXMgZm91bmQgaW50ZXJuYWxseSwg
dHJ5IHRvIGZldGNoIGFueQoJLy8gZGF0YSBmcm9tIHRoZSBIVE1MNSBkYXRhLSog
YXR0cmlidXRlCglpZiAoIGRhdGEgPT09IHVuZGVmaW5lZCAmJiBlbGVtLm5vZGVU
eXBlID09PSAxICkgewoKCQl2YXIgbmFtZSA9ICJkYXRhLSIgKyBrZXkucmVwbGFj
ZSggcm11bHRpRGFzaCwgIi0kMSIgKS50b0xvd2VyQ2FzZSgpOwoKCQlkYXRhID0g
ZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKTsKCgkJaWYgKCB0eXBlb2YgZGF0YSA9
PT0gInN0cmluZyIgKSB7CgkJCXRyeSB7CgkJCQlkYXRhID0gZGF0YSA9PT0gInRy
dWUiID8gdHJ1ZSA6CgkJCQlkYXRhID09PSAiZmFsc2UiID8gZmFsc2UgOgoJCQkJ
ZGF0YSA9PT0gIm51bGwiID8gbnVsbCA6CgkJCQlqUXVlcnkuaXNOdW1lcmljKCBk
YXRhICkgPyArZGF0YSA6CgkJCQkJcmJyYWNlLnRlc3QoIGRhdGEgKSA/IGpRdWVy
eS5wYXJzZUpTT04oIGRhdGEgKSA6CgkJCQkJZGF0YTsKCQkJfSBjYXRjaCggZSAp
IHt9CgoJCQkvLyBNYWtlIHN1cmUgd2Ugc2V0IHRoZSBkYXRhIHNvIGl0IGlzbid0
IGNoYW5nZWQgbGF0ZXIKCQkJalF1ZXJ5LmRhdGEoIGVsZW0sIGtleSwgZGF0YSAp
OwoKCQl9IGVsc2UgewoJCQlkYXRhID0gdW5kZWZpbmVkOwoJCX0KCX0KCglyZXR1
cm4gZGF0YTsKfQoKLy8gY2hlY2tzIGEgY2FjaGUgb2JqZWN0IGZvciBlbXB0aW5l
c3MKZnVuY3Rpb24gaXNFbXB0eURhdGFPYmplY3QoIG9iaiApIHsKCWZvciAoIHZh
ciBuYW1lIGluIG9iaiApIHsKCgkJLy8gaWYgdGhlIHB1YmxpYyBkYXRhIG9iamVj
dCBpcyBlbXB0eSwgdGhlIHByaXZhdGUgaXMgc3RpbGwgZW1wdHkKCQlpZiAoIG5h
bWUgPT09ICJkYXRhIiAmJiBqUXVlcnkuaXNFbXB0eU9iamVjdCggb2JqW25hbWVd
ICkgKSB7CgkJCWNvbnRpbnVlOwoJCX0KCQlpZiAoIG5hbWUgIT09ICJ0b0pTT04i
ICkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJfQoKCXJldHVybiB0cnVlOwp9CgoK
CgpmdW5jdGlvbiBoYW5kbGVRdWV1ZU1hcmtEZWZlciggZWxlbSwgdHlwZSwgc3Jj
ICkgewoJdmFyIGRlZmVyRGF0YUtleSA9IHR5cGUgKyAiZGVmZXIiLAoJCXF1ZXVl
RGF0YUtleSA9IHR5cGUgKyAicXVldWUiLAoJCW1hcmtEYXRhS2V5ID0gdHlwZSAr
ICJtYXJrIiwKCQlkZWZlciA9IGpRdWVyeS5fZGF0YSggZWxlbSwgZGVmZXJEYXRh
S2V5ICk7CglpZiAoIGRlZmVyICYmCgkJKCBzcmMgPT09ICJxdWV1ZSIgfHwgIWpR
dWVyeS5fZGF0YShlbGVtLCBxdWV1ZURhdGFLZXkpICkgJiYKCQkoIHNyYyA9PT0g
Im1hcmsiIHx8ICFqUXVlcnkuX2RhdGEoZWxlbSwgbWFya0RhdGFLZXkpICkgKSB7
CgkJLy8gR2l2ZSByb29tIGZvciBoYXJkLWNvZGVkIGNhbGxiYWNrcyB0byBmaXJl
IGZpcnN0CgkJLy8gYW5kIGV2ZW50dWFsbHkgbWFyay9xdWV1ZSBzb21ldGhpbmcg
ZWxzZSBvbiB0aGUgZWxlbWVudAoJCXNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJ
CQlpZiAoICFqUXVlcnkuX2RhdGEoIGVsZW0sIHF1ZXVlRGF0YUtleSApICYmCgkJ
CQkhalF1ZXJ5Ll9kYXRhKCBlbGVtLCBtYXJrRGF0YUtleSApICkgewoJCQkJalF1
ZXJ5LnJlbW92ZURhdGEoIGVsZW0sIGRlZmVyRGF0YUtleSwgdHJ1ZSApOwoJCQkJ
ZGVmZXIuZmlyZSgpOwoJCQl9CgkJfSwgMCApOwoJfQp9CgpqUXVlcnkuZXh0ZW5k
KHsKCglfbWFyazogZnVuY3Rpb24oIGVsZW0sIHR5cGUgKSB7CgkJaWYgKCBlbGVt
ICkgewoJCQl0eXBlID0gKCB0eXBlIHx8ICJmeCIgKSArICJtYXJrIjsKCQkJalF1
ZXJ5Ll9kYXRhKCBlbGVtLCB0eXBlLCAoalF1ZXJ5Ll9kYXRhKCBlbGVtLCB0eXBl
ICkgfHwgMCkgKyAxICk7CgkJfQoJfSwKCglfdW5tYXJrOiBmdW5jdGlvbiggZm9y
Y2UsIGVsZW0sIHR5cGUgKSB7CgkJaWYgKCBmb3JjZSAhPT0gdHJ1ZSApIHsKCQkJ
dHlwZSA9IGVsZW07CgkJCWVsZW0gPSBmb3JjZTsKCQkJZm9yY2UgPSBmYWxzZTsK
CQl9CgkJaWYgKCBlbGVtICkgewoJCQl0eXBlID0gdHlwZSB8fCAiZngiOwoJCQl2
YXIga2V5ID0gdHlwZSArICJtYXJrIiwKCQkJCWNvdW50ID0gZm9yY2UgPyAwIDog
KCAoalF1ZXJ5Ll9kYXRhKCBlbGVtLCBrZXkgKSB8fCAxKSAtIDEgKTsKCQkJaWYg
KCBjb3VudCApIHsKCQkJCWpRdWVyeS5fZGF0YSggZWxlbSwga2V5LCBjb3VudCAp
OwoJCQl9IGVsc2UgewoJCQkJalF1ZXJ5LnJlbW92ZURhdGEoIGVsZW0sIGtleSwg
dHJ1ZSApOwoJCQkJaGFuZGxlUXVldWVNYXJrRGVmZXIoIGVsZW0sIHR5cGUsICJt
YXJrIiApOwoJCQl9CgkJfQoJfSwKCglxdWV1ZTogZnVuY3Rpb24oIGVsZW0sIHR5
cGUsIGRhdGEgKSB7CgkJdmFyIHE7CgkJaWYgKCBlbGVtICkgewoJCQl0eXBlID0g
KCB0eXBlIHx8ICJmeCIgKSArICJxdWV1ZSI7CgkJCXEgPSBqUXVlcnkuX2RhdGEo
IGVsZW0sIHR5cGUgKTsKCgkJCS8vIFNwZWVkIHVwIGRlcXVldWUgYnkgZ2V0dGlu
ZyBvdXQgcXVpY2tseSBpZiB0aGlzIGlzIGp1c3QgYSBsb29rdXAKCQkJaWYgKCBk
YXRhICkgewoJCQkJaWYgKCAhcSB8fCBqUXVlcnkuaXNBcnJheShkYXRhKSApIHsK
CQkJCQlxID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCB0eXBlLCBqUXVlcnkubWFrZUFy
cmF5KGRhdGEpICk7CgkJCQl9IGVsc2UgewoJCQkJCXEucHVzaCggZGF0YSApOwoJ
CQkJfQoJCQl9CgkJCXJldHVybiBxIHx8IFtdOwoJCX0KCX0sCgoJZGVxdWV1ZTog
ZnVuY3Rpb24oIGVsZW0sIHR5cGUgKSB7CgkJdHlwZSA9IHR5cGUgfHwgImZ4IjsK
CgkJdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCBlbGVtLCB0eXBlICksCgkJCWZu
ID0gcXVldWUuc2hpZnQoKSwKCQkJaG9va3MgPSB7fTsKCgkJLy8gSWYgdGhlIGZ4
IHF1ZXVlIGlzIGRlcXVldWVkLCBhbHdheXMgcmVtb3ZlIHRoZSBwcm9ncmVzcyBz
ZW50aW5lbAoJCWlmICggZm4gPT09ICJpbnByb2dyZXNzIiApIHsKCQkJZm4gPSBx
dWV1ZS5zaGlmdCgpOwoJCX0KCgkJaWYgKCBmbiApIHsKCQkJLy8gQWRkIGEgcHJv
Z3Jlc3Mgc2VudGluZWwgdG8gcHJldmVudCB0aGUgZnggcXVldWUgZnJvbSBiZWlu
ZwoJCQkvLyBhdXRvbWF0aWNhbGx5IGRlcXVldWVkCgkJCWlmICggdHlwZSA9PT0g
ImZ4IiApIHsKCQkJCXF1ZXVlLnVuc2hpZnQoICJpbnByb2dyZXNzIiApOwoJCQl9
CgoJCQlqUXVlcnkuX2RhdGEoIGVsZW0sIHR5cGUgKyAiLnJ1biIsIGhvb2tzICk7
CgkJCWZuLmNhbGwoIGVsZW0sIGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmRlcXVl
dWUoIGVsZW0sIHR5cGUgKTsKCQkJfSwgaG9va3MgKTsKCQl9CgoJCWlmICggIXF1
ZXVlLmxlbmd0aCApIHsKCQkJalF1ZXJ5LnJlbW92ZURhdGEoIGVsZW0sIHR5cGUg
KyAicXVldWUgIiArIHR5cGUgKyAiLnJ1biIsIHRydWUgKTsKCQkJaGFuZGxlUXVl
dWVNYXJrRGVmZXIoIGVsZW0sIHR5cGUsICJxdWV1ZSIgKTsKCQl9Cgl9Cn0pOwoK
alF1ZXJ5LmZuLmV4dGVuZCh7CglxdWV1ZTogZnVuY3Rpb24oIHR5cGUsIGRhdGEg
KSB7CgkJdmFyIHNldHRlciA9IDI7CgoJCWlmICggdHlwZW9mIHR5cGUgIT09ICJz
dHJpbmciICkgewoJCQlkYXRhID0gdHlwZTsKCQkJdHlwZSA9ICJmeCI7CgkJCXNl
dHRlci0tOwoJCX0KCgkJaWYgKCBhcmd1bWVudHMubGVuZ3RoIDwgc2V0dGVyICkg
ewoJCQlyZXR1cm4galF1ZXJ5LnF1ZXVlKCB0aGlzWzBdLCB0eXBlICk7CgkJfQoK
CQlyZXR1cm4gZGF0YSA9PT0gdW5kZWZpbmVkID8KCQkJdGhpcyA6CgkJCXRoaXMu
ZWFjaChmdW5jdGlvbigpIHsKCQkJCXZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZSgg
dGhpcywgdHlwZSwgZGF0YSApOwoKCQkJCWlmICggdHlwZSA9PT0gImZ4IiAmJiBx
dWV1ZVswXSAhPT0gImlucHJvZ3Jlc3MiICkgewoJCQkJCWpRdWVyeS5kZXF1ZXVl
KCB0aGlzLCB0eXBlICk7CgkJCQl9CgkJCX0pOwoJfSwKCWRlcXVldWU6IGZ1bmN0
aW9uKCB0eXBlICkgewoJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJ
CWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJfSk7Cgl9LAoJLy8gQmFz
ZWQgb2ZmIG9mIHRoZSBwbHVnaW4gYnkgQ2xpbnQgSGVsZmVycywgd2l0aCBwZXJt
aXNzaW9uLgoJLy8gaHR0cDovL2JsaW5kc2lnbmFscy5jb20vaW5kZXgucGhwLzIw
MDkvMDcvanF1ZXJ5LWRlbGF5LwoJZGVsYXk6IGZ1bmN0aW9uKCB0aW1lLCB0eXBl
ICkgewoJCXRpbWUgPSBqUXVlcnkuZnggPyBqUXVlcnkuZnguc3BlZWRzWyB0aW1l
IF0gfHwgdGltZSA6IHRpbWU7CgkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCgkJcmV0
dXJuIHRoaXMucXVldWUoIHR5cGUsIGZ1bmN0aW9uKCBuZXh0LCBob29rcyApIHsK
CQkJdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KCBuZXh0LCB0aW1lICk7CgkJCWhv
b2tzLnN0b3AgPSBmdW5jdGlvbigpIHsKCQkJCWNsZWFyVGltZW91dCggdGltZW91
dCApOwoJCQl9OwoJCX0pOwoJfSwKCWNsZWFyUXVldWU6IGZ1bmN0aW9uKCB0eXBl
ICkgewoJCXJldHVybiB0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7Cgl9
LAoJLy8gR2V0IGEgcHJvbWlzZSByZXNvbHZlZCB3aGVuIHF1ZXVlcyBvZiBhIGNl
cnRhaW4gdHlwZQoJLy8gYXJlIGVtcHRpZWQgKGZ4IGlzIHRoZSB0eXBlIGJ5IGRl
ZmF1bHQpCglwcm9taXNlOiBmdW5jdGlvbiggdHlwZSwgb2JqZWN0ICkgewoJCWlm
ICggdHlwZW9mIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQlvYmplY3QgPSB0eXBl
OwoJCQl0eXBlID0gdW5kZWZpbmVkOwoJCX0KCQl0eXBlID0gdHlwZSB8fCAiZngi
OwoJCXZhciBkZWZlciA9IGpRdWVyeS5EZWZlcnJlZCgpLAoJCQllbGVtZW50cyA9
IHRoaXMsCgkJCWkgPSBlbGVtZW50cy5sZW5ndGgsCgkJCWNvdW50ID0gMSwKCQkJ
ZGVmZXJEYXRhS2V5ID0gdHlwZSArICJkZWZlciIsCgkJCXF1ZXVlRGF0YUtleSA9
IHR5cGUgKyAicXVldWUiLAoJCQltYXJrRGF0YUtleSA9IHR5cGUgKyAibWFyayIs
CgkJCXRtcDsKCQlmdW5jdGlvbiByZXNvbHZlKCkgewoJCQlpZiAoICEoIC0tY291
bnQgKSApIHsKCQkJCWRlZmVyLnJlc29sdmVXaXRoKCBlbGVtZW50cywgWyBlbGVt
ZW50cyBdICk7CgkJCX0KCQl9CgkJd2hpbGUoIGktLSApIHsKCQkJaWYgKCggdG1w
ID0galF1ZXJ5LmRhdGEoIGVsZW1lbnRzWyBpIF0sIGRlZmVyRGF0YUtleSwgdW5k
ZWZpbmVkLCB0cnVlICkgfHwKCQkJCQkoIGpRdWVyeS5kYXRhKCBlbGVtZW50c1sg
aSBdLCBxdWV1ZURhdGFLZXksIHVuZGVmaW5lZCwgdHJ1ZSApIHx8CgkJCQkJCWpR
dWVyeS5kYXRhKCBlbGVtZW50c1sgaSBdLCBtYXJrRGF0YUtleSwgdW5kZWZpbmVk
LCB0cnVlICkgKSAmJgoJCQkJCWpRdWVyeS5kYXRhKCBlbGVtZW50c1sgaSBdLCBk
ZWZlckRhdGFLZXksIGpRdWVyeS5DYWxsYmFja3MoICJvbmNlIG1lbW9yeSIgKSwg
dHJ1ZSApICkpIHsKCQkJCWNvdW50Kys7CgkJCQl0bXAuYWRkKCByZXNvbHZlICk7
CgkJCX0KCQl9CgkJcmVzb2x2ZSgpOwoJCXJldHVybiBkZWZlci5wcm9taXNlKCBv
YmplY3QgKTsKCX0KfSk7CgoKCgp2YXIgcmNsYXNzID0gL1tcblx0XHJdL2csCgly
c3BhY2UgPSAvXHMrLywKCXJyZXR1cm4gPSAvXHIvZywKCXJ0eXBlID0gL14oPzpi
dXR0b258aW5wdXQpJC9pLAoJcmZvY3VzYWJsZSA9IC9eKD86YnV0dG9ufGlucHV0
fG9iamVjdHxzZWxlY3R8dGV4dGFyZWEpJC9pLAoJcmNsaWNrYWJsZSA9IC9eYSg/
OnJlYSk/JC9pLAoJcmJvb2xlYW4gPSAvXig/OmF1dG9mb2N1c3xhdXRvcGxheXxh
c3luY3xjaGVja2VkfGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxsb29w
fG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkfHNlbGVjdGVk
KSQvaSwKCWdldFNldEF0dHJpYnV0ZSA9IGpRdWVyeS5zdXBwb3J0LmdldFNldEF0
dHJpYnV0ZSwKCW5vZGVIb29rLCBib29sSG9vaywgZml4U3BlY2lmaWVkOwoKalF1
ZXJ5LmZuLmV4dGVuZCh7CglhdHRyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7
CgkJcmV0dXJuIGpRdWVyeS5hY2Nlc3MoIHRoaXMsIGpRdWVyeS5hdHRyLCBuYW1l
LCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCX0sCgoJcmVtb3ZlQXR0
cjogZnVuY3Rpb24oIG5hbWUgKSB7CgkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlv
bigpIHsKCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIHRoaXMsIG5hbWUgKTsKCQl9KTsK
CX0sCgoJcHJvcDogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkgewoJCXJldHVybiBq
UXVlcnkuYWNjZXNzKCB0aGlzLCBqUXVlcnkucHJvcCwgbmFtZSwgdmFsdWUsIGFy
Z3VtZW50cy5sZW5ndGggPiAxICk7Cgl9LAoKCXJlbW92ZVByb3A6IGZ1bmN0aW9u
KCBuYW1lICkgewoJCW5hbWUgPSBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5h
bWU7CgkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJLy8gdHJ5L2Nh
dGNoIGhhbmRsZXMgY2FzZXMgd2hlcmUgSUUgYmFsa3MgKHN1Y2ggYXMgcmVtb3Zp
bmcgYSBwcm9wZXJ0eSBvbiB3aW5kb3cpCgkJCXRyeSB7CgkJCQl0aGlzWyBuYW1l
IF0gPSB1bmRlZmluZWQ7CgkJCQlkZWxldGUgdGhpc1sgbmFtZSBdOwoJCQl9IGNh
dGNoKCBlICkge30KCQl9KTsKCX0sCgoJYWRkQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1
ZSApIHsKCQl2YXIgY2xhc3NOYW1lcywgaSwgbCwgZWxlbSwKCQkJc2V0Q2xhc3Ms
IGMsIGNsOwoKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJ
CQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBqICkgewoJCQkJalF1ZXJ5KCB0
aGlzICkuYWRkQ2xhc3MoIHZhbHVlLmNhbGwodGhpcywgaiwgdGhpcy5jbGFzc05h
bWUpICk7CgkJCX0pOwoJCX0KCgkJaWYgKCB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUg
PT09ICJzdHJpbmciICkgewoJCQljbGFzc05hbWVzID0gdmFsdWUuc3BsaXQoIHJz
cGFjZSApOwoKCQkJZm9yICggaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7
IGkrKyApIHsKCQkJCWVsZW0gPSB0aGlzWyBpIF07CgoJCQkJaWYgKCBlbGVtLm5v
ZGVUeXBlID09PSAxICkgewoJCQkJCWlmICggIWVsZW0uY2xhc3NOYW1lICYmIGNs
YXNzTmFtZXMubGVuZ3RoID09PSAxICkgewoJCQkJCQllbGVtLmNsYXNzTmFtZSA9
IHZhbHVlOwoKCQkJCQl9IGVsc2UgewoJCQkJCQlzZXRDbGFzcyA9ICIgIiArIGVs
ZW0uY2xhc3NOYW1lICsgIiAiOwoKCQkJCQkJZm9yICggYyA9IDAsIGNsID0gY2xh
c3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrICkgewoJCQkJCQkJaWYgKCAhfnNl
dENsYXNzLmluZGV4T2YoICIgIiArIGNsYXNzTmFtZXNbIGMgXSArICIgIiApICkg
ewoJCQkJCQkJCXNldENsYXNzICs9IGNsYXNzTmFtZXNbIGMgXSArICIgIjsKCQkJ
CQkJCX0KCQkJCQkJfQoJCQkJCQllbGVtLmNsYXNzTmFtZSA9IGpRdWVyeS50cmlt
KCBzZXRDbGFzcyApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHRo
aXM7Cgl9LAoKCXJlbW92ZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJdmFy
IGNsYXNzTmFtZXMsIGksIGwsIGVsZW0sIGNsYXNzTmFtZSwgYywgY2w7CgoJCWlm
ICggalF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7CgkJCXJldHVybiB0aGlz
LmVhY2goZnVuY3Rpb24oIGogKSB7CgkJCQlqUXVlcnkoIHRoaXMgKS5yZW1vdmVD
bGFzcyggdmFsdWUuY2FsbCh0aGlzLCBqLCB0aGlzLmNsYXNzTmFtZSkgKTsKCQkJ
fSk7CgkJfQoKCQlpZiAoICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJp
bmciKSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkICkgewoJCQljbGFzc05hbWVzID0g
KCB2YWx1ZSB8fCAiIiApLnNwbGl0KCByc3BhY2UgKTsKCgkJCWZvciAoIGkgPSAw
LCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJCQllbGVtID0gdGhp
c1sgaSBdOwoKCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiBlbGVtLmNs
YXNzTmFtZSApIHsKCQkJCQlpZiAoIHZhbHVlICkgewoJCQkJCQljbGFzc05hbWUg
PSAoIiAiICsgZWxlbS5jbGFzc05hbWUgKyAiICIpLnJlcGxhY2UoIHJjbGFzcywg
IiAiICk7CgkJCQkJCWZvciAoIGMgPSAwLCBjbCA9IGNsYXNzTmFtZXMubGVuZ3Ro
OyBjIDwgY2w7IGMrKyApIHsKCQkJCQkJCWNsYXNzTmFtZSA9IGNsYXNzTmFtZS5y
ZXBsYWNlKCIgIiArIGNsYXNzTmFtZXNbIGMgXSArICIgIiwgIiAiKTsKCQkJCQkJ
fQoJCQkJCQllbGVtLmNsYXNzTmFtZSA9IGpRdWVyeS50cmltKCBjbGFzc05hbWUg
KTsKCgkJCQkJfSBlbHNlIHsKCQkJCQkJZWxlbS5jbGFzc05hbWUgPSAiIjsKCQkJ
CQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiB0aGlzOwoJfSwKCgl0b2dnbGVD
bGFzczogZnVuY3Rpb24oIHZhbHVlLCBzdGF0ZVZhbCApIHsKCQl2YXIgdHlwZSA9
IHR5cGVvZiB2YWx1ZSwKCQkJaXNCb29sID0gdHlwZW9mIHN0YXRlVmFsID09PSAi
Ym9vbGVhbiI7CgoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7
CgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7CgkJCQlqUXVlcnko
IHRoaXMgKS50b2dnbGVDbGFzcyggdmFsdWUuY2FsbCh0aGlzLCBpLCB0aGlzLmNs
YXNzTmFtZSwgc3RhdGVWYWwpLCBzdGF0ZVZhbCApOwoJCQl9KTsKCQl9CgoJCXJl
dHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCWlmICggdHlwZSA9PT0gInN0
cmluZyIgKSB7CgkJCQkvLyB0b2dnbGUgaW5kaXZpZHVhbCBjbGFzcyBuYW1lcwoJ
CQkJdmFyIGNsYXNzTmFtZSwKCQkJCQlpID0gMCwKCQkJCQlzZWxmID0galF1ZXJ5
KCB0aGlzICksCgkJCQkJc3RhdGUgPSBzdGF0ZVZhbCwKCQkJCQljbGFzc05hbWVz
ID0gdmFsdWUuc3BsaXQoIHJzcGFjZSApOwoKCQkJCXdoaWxlICggKGNsYXNzTmFt
ZSA9IGNsYXNzTmFtZXNbIGkrKyBdKSApIHsKCQkJCQkvLyBjaGVjayBlYWNoIGNs
YXNzTmFtZSBnaXZlbiwgc3BhY2Ugc2VwZXJhdGVkIGxpc3QKCQkJCQlzdGF0ZSA9
IGlzQm9vbCA/IHN0YXRlIDogIXNlbGYuaGFzQ2xhc3MoIGNsYXNzTmFtZSApOwoJ
CQkJCXNlbGZbIHN0YXRlID8gImFkZENsYXNzIiA6ICJyZW1vdmVDbGFzcyIgXSgg
Y2xhc3NOYW1lICk7CgkJCQl9CgoJCQl9IGVsc2UgaWYgKCB0eXBlID09PSAidW5k
ZWZpbmVkIiB8fCB0eXBlID09PSAiYm9vbGVhbiIgKSB7CgkJCQlpZiAoIHRoaXMu
Y2xhc3NOYW1lICkgewoJCQkJCS8vIHN0b3JlIGNsYXNzTmFtZSBpZiBzZXQKCQkJ
CQlqUXVlcnkuX2RhdGEoIHRoaXMsICJfX2NsYXNzTmFtZV9fIiwgdGhpcy5jbGFz
c05hbWUgKTsKCQkJCX0KCgkJCQkvLyB0b2dnbGUgd2hvbGUgY2xhc3NOYW1lCgkJ
CQl0aGlzLmNsYXNzTmFtZSA9IHRoaXMuY2xhc3NOYW1lIHx8IHZhbHVlID09PSBm
YWxzZSA/ICIiIDogalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiX19jbGFzc05hbWVfXyIg
KSB8fCAiIjsKCQkJfQoJCX0pOwoJfSwKCgloYXNDbGFzczogZnVuY3Rpb24oIHNl
bGVjdG9yICkgewoJCXZhciBjbGFzc05hbWUgPSAiICIgKyBzZWxlY3RvciArICIg
IiwKCQkJaSA9IDAsCgkJCWwgPSB0aGlzLmxlbmd0aDsKCQlmb3IgKCA7IGkgPCBs
OyBpKysgKSB7CgkJCWlmICggdGhpc1tpXS5ub2RlVHlwZSA9PT0gMSAmJiAoIiAi
ICsgdGhpc1tpXS5jbGFzc05hbWUgKyAiICIpLnJlcGxhY2UocmNsYXNzLCAiICIp
LmluZGV4T2YoIGNsYXNzTmFtZSApID4gLTEgKSB7CgkJCQlyZXR1cm4gdHJ1ZTsK
CQkJfQoJCX0KCgkJcmV0dXJuIGZhbHNlOwoJfSwKCgl2YWw6IGZ1bmN0aW9uKCB2
YWx1ZSApIHsKCQl2YXIgaG9va3MsIHJldCwgaXNGdW5jdGlvbiwKCQkJZWxlbSA9
IHRoaXNbMF07CgoJCWlmICggIWFyZ3VtZW50cy5sZW5ndGggKSB7CgkJCWlmICgg
ZWxlbSApIHsKCQkJCWhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyBlbGVtLnR5cGUg
XSB8fCBqUXVlcnkudmFsSG9va3NbIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2Uo
KSBdOwoKCQkJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9
IGhvb2tzLmdldCggZWxlbSwgInZhbHVlIiApKSAhPT0gdW5kZWZpbmVkICkgewoJ
CQkJCXJldHVybiByZXQ7CgkJCQl9CgoJCQkJcmV0ID0gZWxlbS52YWx1ZTsKCgkJ
CQlyZXR1cm4gdHlwZW9mIHJldCA9PT0gInN0cmluZyIgPwoJCQkJCS8vIGhhbmRs
ZSBtb3N0IGNvbW1vbiBzdHJpbmcgY2FzZXMKCQkJCQlyZXQucmVwbGFjZShycmV0
dXJuLCAiIikgOgoJCQkJCS8vIGhhbmRsZSBjYXNlcyB3aGVyZSB2YWx1ZSBpcyBu
dWxsL3VuZGVmIG9yIG51bWJlcgoJCQkJCXJldCA9PSBudWxsID8gIiIgOiByZXQ7
CgkJCX0KCgkJCXJldHVybjsKCQl9CgoJCWlzRnVuY3Rpb24gPSBqUXVlcnkuaXNG
dW5jdGlvbiggdmFsdWUgKTsKCgkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigg
aSApIHsKCQkJdmFyIHNlbGYgPSBqUXVlcnkodGhpcyksIHZhbDsKCgkJCWlmICgg
dGhpcy5ub2RlVHlwZSAhPT0gMSApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJaWYg
KCBpc0Z1bmN0aW9uICkgewoJCQkJdmFsID0gdmFsdWUuY2FsbCggdGhpcywgaSwg
c2VsZi52YWwoKSApOwoJCQl9IGVsc2UgewoJCQkJdmFsID0gdmFsdWU7CgkJCX0K
CgkJCS8vIFRyZWF0IG51bGwvdW5kZWZpbmVkIGFzICIiOyBjb252ZXJ0IG51bWJl
cnMgdG8gc3RyaW5nCgkJCWlmICggdmFsID09IG51bGwgKSB7CgkJCQl2YWwgPSAi
IjsKCQkJfSBlbHNlIGlmICggdHlwZW9mIHZhbCA9PT0gIm51bWJlciIgKSB7CgkJ
CQl2YWwgKz0gIiI7CgkJCX0gZWxzZSBpZiAoIGpRdWVyeS5pc0FycmF5KCB2YWwg
KSApIHsKCQkJCXZhbCA9IGpRdWVyeS5tYXAodmFsLCBmdW5jdGlvbiAoIHZhbHVl
ICkgewoJCQkJCXJldHVybiB2YWx1ZSA9PSBudWxsID8gIiIgOiB2YWx1ZSArICIi
OwoJCQkJfSk7CgkJCX0KCgkJCWhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyB0aGlz
LnR5cGUgXSB8fCBqUXVlcnkudmFsSG9va3NbIHRoaXMubm9kZU5hbWUudG9Mb3dl
ckNhc2UoKSBdOwoKCQkJLy8gSWYgc2V0IHJldHVybnMgdW5kZWZpbmVkLCBmYWxs
IGJhY2sgdG8gbm9ybWFsIHNldHRpbmcKCQkJaWYgKCAhaG9va3MgfHwgISgic2V0
IiBpbiBob29rcykgfHwgaG9va3Muc2V0KCB0aGlzLCB2YWwsICJ2YWx1ZSIgKSA9
PT0gdW5kZWZpbmVkICkgewoJCQkJdGhpcy52YWx1ZSA9IHZhbDsKCQkJfQoJCX0p
OwoJfQp9KTsKCmpRdWVyeS5leHRlbmQoewoJdmFsSG9va3M6IHsKCQlvcHRpb246
IHsKCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCS8vIGF0dHJpYnV0ZXMu
dmFsdWUgaXMgdW5kZWZpbmVkIGluIEJsYWNrYmVycnkgNC43IGJ1dAoJCQkJLy8g
dXNlcyAudmFsdWUuIFNlZSAjNjkzMgoJCQkJdmFyIHZhbCA9IGVsZW0uYXR0cmli
dXRlcy52YWx1ZTsKCQkJCXJldHVybiAhdmFsIHx8IHZhbC5zcGVjaWZpZWQgPyBl
bGVtLnZhbHVlIDogZWxlbS50ZXh0OwoJCQl9CgkJfSwKCQlzZWxlY3Q6IHsKCQkJ
Z2V0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciB2YWx1ZSwgaSwgbWF4LCBv
cHRpb24sCgkJCQkJaW5kZXggPSBlbGVtLnNlbGVjdGVkSW5kZXgsCgkJCQkJdmFs
dWVzID0gW10sCgkJCQkJb3B0aW9ucyA9IGVsZW0ub3B0aW9ucywKCQkJCQlvbmUg
PSBlbGVtLnR5cGUgPT09ICJzZWxlY3Qtb25lIjsKCgkJCQkvLyBOb3RoaW5nIHdh
cyBzZWxlY3RlZAoJCQkJaWYgKCBpbmRleCA8IDAgKSB7CgkJCQkJcmV0dXJuIG51
bGw7CgkJCQl9CgoJCQkJLy8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgc2VsZWN0ZWQg
b3B0aW9ucwoJCQkJaSA9IG9uZSA/IGluZGV4IDogMDsKCQkJCW1heCA9IG9uZSA/
IGluZGV4ICsgMSA6IG9wdGlvbnMubGVuZ3RoOwoJCQkJZm9yICggOyBpIDwgbWF4
OyBpKysgKSB7CgkJCQkJb3B0aW9uID0gb3B0aW9uc1sgaSBdOwoKCQkJCQkvLyBE
b24ndCByZXR1cm4gb3B0aW9ucyB0aGF0IGFyZSBkaXNhYmxlZCBvciBpbiBhIGRp
c2FibGVkIG9wdGdyb3VwCgkJCQkJaWYgKCBvcHRpb24uc2VsZWN0ZWQgJiYgKGpR
dWVyeS5zdXBwb3J0Lm9wdERpc2FibGVkID8gIW9wdGlvbi5kaXNhYmxlZCA6IG9w
dGlvbi5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIikgPT09IG51bGwpICYmCgkJCQkJ
CQkoIW9wdGlvbi5wYXJlbnROb2RlLmRpc2FibGVkIHx8ICFqUXVlcnkubm9kZU5h
bWUoIG9wdGlvbi5wYXJlbnROb2RlLCAib3B0Z3JvdXAiICkpICkgewoKCQkJCQkJ
Ly8gR2V0IHRoZSBzcGVjaWZpYyB2YWx1ZSBmb3IgdGhlIG9wdGlvbgoJCQkJCQl2
YWx1ZSA9IGpRdWVyeSggb3B0aW9uICkudmFsKCk7CgoJCQkJCQkvLyBXZSBkb24n
dCBuZWVkIGFuIGFycmF5IGZvciBvbmUgc2VsZWN0cwoJCQkJCQlpZiAoIG9uZSAp
IHsKCQkJCQkJCXJldHVybiB2YWx1ZTsKCQkJCQkJfQoKCQkJCQkJLy8gTXVsdGkt
U2VsZWN0cyByZXR1cm4gYW4gYXJyYXkKCQkJCQkJdmFsdWVzLnB1c2goIHZhbHVl
ICk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEZpeGVzIEJ1ZyAjMjU1MSAtLSBzZWxl
Y3QudmFsKCkgYnJva2VuIGluIElFIGFmdGVyIGZvcm0ucmVzZXQoKQoJCQkJaWYg
KCBvbmUgJiYgIXZhbHVlcy5sZW5ndGggJiYgb3B0aW9ucy5sZW5ndGggKSB7CgkJ
CQkJcmV0dXJuIGpRdWVyeSggb3B0aW9uc1sgaW5kZXggXSApLnZhbCgpOwoJCQkJ
fQoKCQkJCXJldHVybiB2YWx1ZXM7CgkJCX0sCgoJCQlzZXQ6IGZ1bmN0aW9uKCBl
bGVtLCB2YWx1ZSApIHsKCQkJCXZhciB2YWx1ZXMgPSBqUXVlcnkubWFrZUFycmF5
KCB2YWx1ZSApOwoKCQkJCWpRdWVyeShlbGVtKS5maW5kKCJvcHRpb24iKS5lYWNo
KGZ1bmN0aW9uKCkgewoJCQkJCXRoaXMuc2VsZWN0ZWQgPSBqUXVlcnkuaW5BcnJh
eSggalF1ZXJ5KHRoaXMpLnZhbCgpLCB2YWx1ZXMgKSA+PSAwOwoJCQkJfSk7CgoJ
CQkJaWYgKCAhdmFsdWVzLmxlbmd0aCApIHsKCQkJCQllbGVtLnNlbGVjdGVkSW5k
ZXggPSAtMTsKCQkJCX0KCQkJCXJldHVybiB2YWx1ZXM7CgkJCX0KCQl9Cgl9LAoK
CWF0dHJGbjogewoJCXZhbDogdHJ1ZSwKCQljc3M6IHRydWUsCgkJaHRtbDogdHJ1
ZSwKCQl0ZXh0OiB0cnVlLAoJCWRhdGE6IHRydWUsCgkJd2lkdGg6IHRydWUsCgkJ
aGVpZ2h0OiB0cnVlLAoJCW9mZnNldDogdHJ1ZQoJfSwKCglhdHRyOiBmdW5jdGlv
biggZWxlbSwgbmFtZSwgdmFsdWUsIHBhc3MgKSB7CgkJdmFyIHJldCwgaG9va3Ms
IG5vdHhtbCwKCQkJblR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKCQkvLyBkb24ndCBn
ZXQvc2V0IGF0dHJpYnV0ZXMgb24gdGV4dCwgY29tbWVudCBhbmQgYXR0cmlidXRl
IG5vZGVzCgkJaWYgKCAhZWxlbSB8fCBuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0g
OCB8fCBuVHlwZSA9PT0gMiApIHsKCQkJcmV0dXJuOwoJCX0KCgkJaWYgKCBwYXNz
ICYmIG5hbWUgaW4galF1ZXJ5LmF0dHJGbiApIHsKCQkJcmV0dXJuIGpRdWVyeSgg
ZWxlbSApWyBuYW1lIF0oIHZhbHVlICk7CgkJfQoKCQkvLyBGYWxsYmFjayB0byBw
cm9wIHdoZW4gYXR0cmlidXRlcyBhcmUgbm90IHN1cHBvcnRlZAoJCWlmICggdHlw
ZW9mIGVsZW0uZ2V0QXR0cmlidXRlID09PSAidW5kZWZpbmVkIiApIHsKCQkJcmV0
dXJuIGpRdWVyeS5wcm9wKCBlbGVtLCBuYW1lLCB2YWx1ZSApOwoJCX0KCgkJbm90
eG1sID0gblR5cGUgIT09IDEgfHwgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApOwoK
CQkvLyBBbGwgYXR0cmlidXRlcyBhcmUgbG93ZXJjYXNlCgkJLy8gR3JhYiBuZWNl
c3NhcnkgaG9vayBpZiBvbmUgaXMgZGVmaW5lZAoJCWlmICggbm90eG1sICkgewoJ
CQluYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlob29rcyA9IGpRdWVyeS5h
dHRySG9va3NbIG5hbWUgXSB8fCAoIHJib29sZWFuLnRlc3QoIG5hbWUgKSA/IGJv
b2xIb29rIDogbm9kZUhvb2sgKTsKCQl9CgoJCWlmICggdmFsdWUgIT09IHVuZGVm
aW5lZCApIHsKCgkJCWlmICggdmFsdWUgPT09IG51bGwgKSB7CgkJCQlqUXVlcnku
cmVtb3ZlQXR0ciggZWxlbSwgbmFtZSApOwoJCQkJcmV0dXJuOwoKCQkJfSBlbHNl
IGlmICggaG9va3MgJiYgInNldCIgaW4gaG9va3MgJiYgbm90eG1sICYmIChyZXQg
PSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBuYW1lICkpICE9PSB1bmRlZmluZWQg
KSB7CgkJCQlyZXR1cm4gcmV0OwoKCQkJfSBlbHNlIHsKCQkJCWVsZW0uc2V0QXR0
cmlidXRlKCBuYW1lLCAiIiArIHZhbHVlICk7CgkJCQlyZXR1cm4gdmFsdWU7CgkJ
CX0KCgkJfSBlbHNlIGlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgbm90
eG1sICYmIChyZXQgPSBob29rcy5nZXQoIGVsZW0sIG5hbWUgKSkgIT09IG51bGwg
KSB7CgkJCXJldHVybiByZXQ7CgoJCX0gZWxzZSB7CgoJCQlyZXQgPSBlbGVtLmdl
dEF0dHJpYnV0ZSggbmFtZSApOwoKCQkJLy8gTm9uLWV4aXN0ZW50IGF0dHJpYnV0
ZXMgcmV0dXJuIG51bGwsIHdlIG5vcm1hbGl6ZSB0byB1bmRlZmluZWQKCQkJcmV0
dXJuIHJldCA9PT0gbnVsbCA/CgkJCQl1bmRlZmluZWQgOgoJCQkJcmV0OwoJCX0K
CX0sCgoJcmVtb3ZlQXR0cjogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCXZh
ciBwcm9wTmFtZSwgYXR0ck5hbWVzLCBuYW1lLCBsLCBpc0Jvb2wsCgkJCWkgPSAw
OwoKCQlpZiAoIHZhbHVlICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCWF0
dHJOYW1lcyA9IHZhbHVlLnRvTG93ZXJDYXNlKCkuc3BsaXQoIHJzcGFjZSApOwoJ
CQlsID0gYXR0ck5hbWVzLmxlbmd0aDsKCgkJCWZvciAoIDsgaSA8IGw7IGkrKyAp
IHsKCQkJCW5hbWUgPSBhdHRyTmFtZXNbIGkgXTsKCgkJCQlpZiAoIG5hbWUgKSB7
CgkJCQkJcHJvcE5hbWUgPSBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWU7
CgkJCQkJaXNCb29sID0gcmJvb2xlYW4udGVzdCggbmFtZSApOwoKCQkJCQkvLyBT
ZWUgIzk2OTkgZm9yIGV4cGxhbmF0aW9uIG9mIHRoaXMgYXBwcm9hY2ggKHNldHRp
bmcgZmlyc3QsIHRoZW4gcmVtb3ZhbCkKCQkJCQkvLyBEbyBub3QgZG8gdGhpcyBm
b3IgYm9vbGVhbiBhdHRyaWJ1dGVzIChzZWUgIzEwODcwKQoJCQkJCWlmICggIWlz
Qm9vbCApIHsKCQkJCQkJalF1ZXJ5LmF0dHIoIGVsZW0sIG5hbWUsICIiICk7CgkJ
CQkJfQoJCQkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCBnZXRTZXRBdHRyaWJ1dGUg
PyBuYW1lIDogcHJvcE5hbWUgKTsKCgkJCQkJLy8gU2V0IGNvcnJlc3BvbmRpbmcg
cHJvcGVydHkgdG8gZmFsc2UgZm9yIGJvb2xlYW4gYXR0cmlidXRlcwoJCQkJCWlm
ICggaXNCb29sICYmIHByb3BOYW1lIGluIGVsZW0gKSB7CgkJCQkJCWVsZW1bIHBy
b3BOYW1lIF0gPSBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9Cgl9LAoKCWF0
dHJIb29rczogewoJCXR5cGU6IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFs
dWUgKSB7CgkJCQkvLyBXZSBjYW4ndCBhbGxvdyB0aGUgdHlwZSBwcm9wZXJ0eSB0
byBiZSBjaGFuZ2VkIChzaW5jZSBpdCBjYXVzZXMgcHJvYmxlbXMgaW4gSUUpCgkJ
CQlpZiAoIHJ0eXBlLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSAmJiBlbGVtLnBhcmVu
dE5vZGUgKSB7CgkJCQkJalF1ZXJ5LmVycm9yKCAidHlwZSBwcm9wZXJ0eSBjYW4n
dCBiZSBjaGFuZ2VkIiApOwoJCQkJfSBlbHNlIGlmICggIWpRdWVyeS5zdXBwb3J0
LnJhZGlvVmFsdWUgJiYgdmFsdWUgPT09ICJyYWRpbyIgJiYgalF1ZXJ5Lm5vZGVO
YW1lKGVsZW0sICJpbnB1dCIpICkgewoJCQkJCS8vIFNldHRpbmcgdGhlIHR5cGUg
b24gYSByYWRpbyBidXR0b24gYWZ0ZXIgdGhlIHZhbHVlIHJlc2V0cyB0aGUgdmFs
dWUgaW4gSUU2LTkKCQkJCQkvLyBSZXNldCB2YWx1ZSB0byBpdCdzIGRlZmF1bHQg
aW4gY2FzZSB0eXBlIGlzIHNldCBhZnRlciB2YWx1ZQoJCQkJCS8vIFRoaXMgaXMg
Zm9yIGVsZW1lbnQgY3JlYXRpb24KCQkJCQl2YXIgdmFsID0gZWxlbS52YWx1ZTsK
CQkJCQllbGVtLnNldEF0dHJpYnV0ZSggInR5cGUiLCB2YWx1ZSApOwoJCQkJCWlm
ICggdmFsICkgewoJCQkJCQllbGVtLnZhbHVlID0gdmFsOwoJCQkJCX0KCQkJCQly
ZXR1cm4gdmFsdWU7CgkJCQl9CgkJCX0KCQl9LAoJCS8vIFVzZSB0aGUgdmFsdWUg
cHJvcGVydHkgZm9yIGJhY2sgY29tcGF0CgkJLy8gVXNlIHRoZSBub2RlSG9vayBm
b3IgYnV0dG9uIGVsZW1lbnRzIGluIElFNi83ICgjMTk1NCkKCQl2YWx1ZTogewoJ
CQlnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQkJaWYgKCBub2RlSG9v
ayAmJiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJidXR0b24iICkgKSB7CgkJCQkJ
cmV0dXJuIG5vZGVIb29rLmdldCggZWxlbSwgbmFtZSApOwoJCQkJfQoJCQkJcmV0
dXJuIG5hbWUgaW4gZWxlbSA/CgkJCQkJZWxlbS52YWx1ZSA6CgkJCQkJbnVsbDsK
CQkJfSwKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJ
CQlpZiAoIG5vZGVIb29rICYmIGpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImJ1dHRv
biIgKSApIHsKCQkJCQlyZXR1cm4gbm9kZUhvb2suc2V0KCBlbGVtLCB2YWx1ZSwg
bmFtZSApOwoJCQkJfQoJCQkJLy8gRG9lcyBub3QgcmV0dXJuIHNvIHRoYXQgc2V0
QXR0cmlidXRlIGlzIGFsc28gdXNlZAoJCQkJZWxlbS52YWx1ZSA9IHZhbHVlOwoJ
CQl9CgkJfQoJfSwKCglwcm9wRml4OiB7CgkJdGFiaW5kZXg6ICJ0YWJJbmRleCIs
CgkJcmVhZG9ubHk6ICJyZWFkT25seSIsCgkJImZvciI6ICJodG1sRm9yIiwKCQki
Y2xhc3MiOiAiY2xhc3NOYW1lIiwKCQltYXhsZW5ndGg6ICJtYXhMZW5ndGgiLAoJ
CWNlbGxzcGFjaW5nOiAiY2VsbFNwYWNpbmciLAoJCWNlbGxwYWRkaW5nOiAiY2Vs
bFBhZGRpbmciLAoJCXJvd3NwYW46ICJyb3dTcGFuIiwKCQljb2xzcGFuOiAiY29s
U3BhbiIsCgkJdXNlbWFwOiAidXNlTWFwIiwKCQlmcmFtZWJvcmRlcjogImZyYW1l
Qm9yZGVyIiwKCQljb250ZW50ZWRpdGFibGU6ICJjb250ZW50RWRpdGFibGUiCgl9
LAoKCXByb3A6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHsKCQl2YXIg
cmV0LCBob29rcywgbm90eG1sLAoJCQluVHlwZSA9IGVsZW0ubm9kZVR5cGU7CgoJ
CS8vIGRvbid0IGdldC9zZXQgcHJvcGVydGllcyBvbiB0ZXh0LCBjb21tZW50IGFu
ZCBhdHRyaWJ1dGUgbm9kZXMKCQlpZiAoICFlbGVtIHx8IG5UeXBlID09PSAzIHx8
IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyICkgewoJCQlyZXR1cm47CgkJfQoK
CQlub3R4bWwgPSBuVHlwZSAhPT0gMSB8fCAhalF1ZXJ5LmlzWE1MRG9jKCBlbGVt
ICk7CgoJCWlmICggbm90eG1sICkgewoJCQkvLyBGaXggbmFtZSBhbmQgYXR0YWNo
IGhvb2tzCgkJCW5hbWUgPSBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWU7
CgkJCWhvb2tzID0galF1ZXJ5LnByb3BIb29rc1sgbmFtZSBdOwoJCX0KCgkJaWYg
KCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkgewoJCQlpZiAoIGhvb2tzICYmICJzZXQi
IGluIGhvb2tzICYmIChyZXQgPSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBuYW1l
ICkpICE9PSB1bmRlZmluZWQgKSB7CgkJCQlyZXR1cm4gcmV0OwoKCQkJfSBlbHNl
IHsKCQkJCXJldHVybiAoIGVsZW1bIG5hbWUgXSA9IHZhbHVlICk7CgkJCX0KCgkJ
fSBlbHNlIHsKCQkJaWYgKCBob29rcyAmJiAiZ2V0IiBpbiBob29rcyAmJiAocmV0
ID0gaG9va3MuZ2V0KCBlbGVtLCBuYW1lICkpICE9PSBudWxsICkgewoJCQkJcmV0
dXJuIHJldDsKCgkJCX0gZWxzZSB7CgkJCQlyZXR1cm4gZWxlbVsgbmFtZSBdOwoJ
CQl9CgkJfQoJfSwKCglwcm9wSG9va3M6IHsKCQl0YWJJbmRleDogewoJCQlnZXQ6
IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJLy8gZWxlbS50YWJJbmRleCBkb2Vzbid0
IGFsd2F5cyByZXR1cm4gdGhlIGNvcnJlY3QgdmFsdWUgd2hlbiBpdCBoYXNuJ3Qg
YmVlbiBleHBsaWNpdGx5IHNldAoJCQkJLy8gaHR0cDovL2ZsdWlkcHJvamVjdC5v
cmcvYmxvZy8yMDA4LzAxLzA5L2dldHRpbmctc2V0dGluZy1hbmQtcmVtb3Zpbmct
dGFiaW5kZXgtdmFsdWVzLXdpdGgtamF2YXNjcmlwdC8KCQkJCXZhciBhdHRyaWJ1
dGVOb2RlID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCJ0YWJpbmRleCIpOwoKCQkJ
CXJldHVybiBhdHRyaWJ1dGVOb2RlICYmIGF0dHJpYnV0ZU5vZGUuc3BlY2lmaWVk
ID8KCQkJCQlwYXJzZUludCggYXR0cmlidXRlTm9kZS52YWx1ZSwgMTAgKSA6CgkJ
CQkJcmZvY3VzYWJsZS50ZXN0KCBlbGVtLm5vZGVOYW1lICkgfHwgcmNsaWNrYWJs
ZS50ZXN0KCBlbGVtLm5vZGVOYW1lICkgJiYgZWxlbS5ocmVmID8KCQkJCQkJMCA6
CgkJCQkJCXVuZGVmaW5lZDsKCQkJfQoJCX0KCX0KfSk7CgovLyBBZGQgdGhlIHRh
YkluZGV4IHByb3BIb29rIHRvIGF0dHJIb29rcyBmb3IgYmFjay1jb21wYXQgKGRp
ZmZlcmVudCBjYXNlIGlzIGludGVudGlvbmFsKQpqUXVlcnkuYXR0ckhvb2tzLnRh
YmluZGV4ID0galF1ZXJ5LnByb3BIb29rcy50YWJJbmRleDsKCi8vIEhvb2sgZm9y
IGJvb2xlYW4gYXR0cmlidXRlcwpib29sSG9vayA9IHsKCWdldDogZnVuY3Rpb24o
IGVsZW0sIG5hbWUgKSB7CgkJLy8gQWxpZ24gYm9vbGVhbiBhdHRyaWJ1dGVzIHdp
dGggY29ycmVzcG9uZGluZyBwcm9wZXJ0aWVzCgkJLy8gRmFsbCBiYWNrIHRvIGF0
dHJpYnV0ZSBwcmVzZW5jZSB3aGVyZSBzb21lIGJvb2xlYW5zIGFyZSBub3Qgc3Vw
cG9ydGVkCgkJdmFyIGF0dHJOb2RlLAoJCQlwcm9wZXJ0eSA9IGpRdWVyeS5wcm9w
KCBlbGVtLCBuYW1lICk7CgkJcmV0dXJuIHByb3BlcnR5ID09PSB0cnVlIHx8IHR5
cGVvZiBwcm9wZXJ0eSAhPT0gImJvb2xlYW4iICYmICggYXR0ck5vZGUgPSBlbGVt
LmdldEF0dHJpYnV0ZU5vZGUobmFtZSkgKSAmJiBhdHRyTm9kZS5ub2RlVmFsdWUg
IT09IGZhbHNlID8KCQkJbmFtZS50b0xvd2VyQ2FzZSgpIDoKCQkJdW5kZWZpbmVk
OwoJfSwKCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBuYW1lICkgewoJCXZh
ciBwcm9wTmFtZTsKCQlpZiAoIHZhbHVlID09PSBmYWxzZSApIHsKCQkJLy8gUmVt
b3ZlIGJvb2xlYW4gYXR0cmlidXRlcyB3aGVuIHNldCB0byBmYWxzZQoJCQlqUXVl
cnkucmVtb3ZlQXR0ciggZWxlbSwgbmFtZSApOwoJCX0gZWxzZSB7CgkJCS8vIHZh
bHVlIGlzIHRydWUgc2luY2Ugd2Uga25vdyBhdCB0aGlzIHBvaW50IGl0J3MgdHlw
ZSBib29sZWFuIGFuZCBub3QgZmFsc2UKCQkJLy8gU2V0IGJvb2xlYW4gYXR0cmli
dXRlcyB0byB0aGUgc2FtZSBuYW1lIGFuZCBzZXQgdGhlIERPTSBwcm9wZXJ0eQoJ
CQlwcm9wTmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCQkJ
aWYgKCBwcm9wTmFtZSBpbiBlbGVtICkgewoJCQkJLy8gT25seSBzZXQgdGhlIElE
TCBzcGVjaWZpY2FsbHkgaWYgaXQgYWxyZWFkeSBleGlzdHMgb24gdGhlIGVsZW1l
bnQKCQkJCWVsZW1bIHByb3BOYW1lIF0gPSB0cnVlOwoJCQl9CgoJCQllbGVtLnNl
dEF0dHJpYnV0ZSggbmFtZSwgbmFtZS50b0xvd2VyQ2FzZSgpICk7CgkJfQoJCXJl
dHVybiBuYW1lOwoJfQp9OwoKLy8gSUU2LzcgZG8gbm90IHN1cHBvcnQgZ2V0dGlu
Zy9zZXR0aW5nIHNvbWUgYXR0cmlidXRlcyB3aXRoIGdldC9zZXRBdHRyaWJ1dGUK
aWYgKCAhZ2V0U2V0QXR0cmlidXRlICkgewoKCWZpeFNwZWNpZmllZCA9IHsKCQlu
YW1lOiB0cnVlLAoJCWlkOiB0cnVlLAoJCWNvb3JkczogdHJ1ZQoJfTsKCgkvLyBV
c2UgdGhpcyBmb3IgYW55IGF0dHJpYnV0ZSBpbiBJRTYvNwoJLy8gVGhpcyBmaXhl
cyBhbG1vc3QgZXZlcnkgSUU2LzcgaXNzdWUKCW5vZGVIb29rID0galF1ZXJ5LnZh
bEhvb2tzLmJ1dHRvbiA9IHsKCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkg
ewoJCQl2YXIgcmV0OwoJCQlyZXQgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5h
bWUgKTsKCQkJcmV0dXJuIHJldCAmJiAoIGZpeFNwZWNpZmllZFsgbmFtZSBdID8g
cmV0Lm5vZGVWYWx1ZSAhPT0gIiIgOiByZXQuc3BlY2lmaWVkICkgPwoJCQkJcmV0
Lm5vZGVWYWx1ZSA6CgkJCQl1bmRlZmluZWQ7CgkJfSwKCQlzZXQ6IGZ1bmN0aW9u
KCBlbGVtLCB2YWx1ZSwgbmFtZSApIHsKCQkJLy8gU2V0IHRoZSBleGlzdGluZyBv
ciBjcmVhdGUgYSBuZXcgYXR0cmlidXRlIG5vZGUKCQkJdmFyIHJldCA9IGVsZW0u
Z2V0QXR0cmlidXRlTm9kZSggbmFtZSApOwoJCQlpZiAoICFyZXQgKSB7CgkJCQly
ZXQgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoIG5hbWUgKTsKCQkJCWVsZW0u
c2V0QXR0cmlidXRlTm9kZSggcmV0ICk7CgkJCX0KCQkJcmV0dXJuICggcmV0Lm5v
ZGVWYWx1ZSA9IHZhbHVlICsgIiIgKTsKCQl9Cgl9OwoKCS8vIEFwcGx5IHRoZSBu
b2RlSG9vayB0byB0YWJpbmRleAoJalF1ZXJ5LmF0dHJIb29rcy50YWJpbmRleC5z
ZXQgPSBub2RlSG9vay5zZXQ7CgoJLy8gU2V0IHdpZHRoIGFuZCBoZWlnaHQgdG8g
YXV0byBpbnN0ZWFkIG9mIDAgb24gZW1wdHkgc3RyaW5nKCBCdWcgIzgxNTAgKQoJ
Ly8gVGhpcyBpcyBmb3IgcmVtb3ZhbHMKCWpRdWVyeS5lYWNoKFsgIndpZHRoIiwg
ImhlaWdodCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJalF1ZXJ5LmF0dHJI
b29rc1sgbmFtZSBdID0galF1ZXJ5LmV4dGVuZCggalF1ZXJ5LmF0dHJIb29rc1sg
bmFtZSBdLCB7CgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJ
aWYgKCB2YWx1ZSA9PT0gIiIgKSB7CgkJCQkJZWxlbS5zZXRBdHRyaWJ1dGUoIG5h
bWUsICJhdXRvIiApOwoJCQkJCXJldHVybiB2YWx1ZTsKCQkJCX0KCQkJfQoJCX0p
OwoJfSk7CgoJLy8gU2V0IGNvbnRlbnRlZGl0YWJsZSB0byBmYWxzZSBvbiByZW1v
dmFscygjMTA0MjkpCgkvLyBTZXR0aW5nIHRvIGVtcHR5IHN0cmluZyB0aHJvd3Mg
YW4gZXJyb3IgYXMgYW4gaW52YWxpZCB2YWx1ZQoJalF1ZXJ5LmF0dHJIb29rcy5j
b250ZW50ZWRpdGFibGUgPSB7CgkJZ2V0OiBub2RlSG9vay5nZXQsCgkJc2V0OiBm
dW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJCWlmICggdmFsdWUgPT09
ICIiICkgewoJCQkJdmFsdWUgPSAiZmFsc2UiOwoJCQl9CgkJCW5vZGVIb29rLnNl
dCggZWxlbSwgdmFsdWUsIG5hbWUgKTsKCQl9Cgl9Owp9CgoKLy8gU29tZSBhdHRy
aWJ1dGVzIHJlcXVpcmUgYSBzcGVjaWFsIGNhbGwgb24gSUUKaWYgKCAhalF1ZXJ5
LnN1cHBvcnQuaHJlZk5vcm1hbGl6ZWQgKSB7CglqUXVlcnkuZWFjaChbICJocmVm
IiwgInNyYyIsICJ3aWR0aCIsICJoZWlnaHQiIF0sIGZ1bmN0aW9uKCBpLCBuYW1l
ICkgewoJCWpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSA9IGpRdWVyeS5leHRlbmQo
IGpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSwgewoJCQlnZXQ6IGZ1bmN0aW9uKCBl
bGVtICkgewoJCQkJdmFyIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lLCAy
ICk7CgkJCQlyZXR1cm4gcmV0ID09PSBudWxsID8gdW5kZWZpbmVkIDogcmV0OwoJ
CQl9CgkJfSk7Cgl9KTsKfQoKaWYgKCAhalF1ZXJ5LnN1cHBvcnQuc3R5bGUgKSB7
CglqUXVlcnkuYXR0ckhvb2tzLnN0eWxlID0gewoJCWdldDogZnVuY3Rpb24oIGVs
ZW0gKSB7CgkJCS8vIFJldHVybiB1bmRlZmluZWQgaW4gdGhlIGNhc2Ugb2YgZW1w
dHkgc3RyaW5nCgkJCS8vIE5vcm1hbGl6ZSB0byBsb3dlcmNhc2Ugc2luY2UgSUUg
dXBwZXJjYXNlcyBjc3MgcHJvcGVydHkgbmFtZXMKCQkJcmV0dXJuIGVsZW0uc3R5
bGUuY3NzVGV4dC50b0xvd2VyQ2FzZSgpIHx8IHVuZGVmaW5lZDsKCQl9LAoJCXNl
dDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQlyZXR1cm4gKCBlbGVtLnN0
eWxlLmNzc1RleHQgPSAiIiArIHZhbHVlICk7CgkJfQoJfTsKfQoKLy8gU2FmYXJp
IG1pcy1yZXBvcnRzIHRoZSBkZWZhdWx0IHNlbGVjdGVkIHByb3BlcnR5IG9mIGFu
IG9wdGlvbgovLyBBY2Nlc3NpbmcgdGhlIHBhcmVudCdzIHNlbGVjdGVkSW5kZXgg
cHJvcGVydHkgZml4ZXMgaXQKaWYgKCAhalF1ZXJ5LnN1cHBvcnQub3B0U2VsZWN0
ZWQgKSB7CglqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkID0galF1ZXJ5LmV4dGVu
ZCggalF1ZXJ5LnByb3BIb29rcy5zZWxlY3RlZCwgewoJCWdldDogZnVuY3Rpb24o
IGVsZW0gKSB7CgkJCXZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7CgoJCQlp
ZiAoIHBhcmVudCApIHsKCQkJCXBhcmVudC5zZWxlY3RlZEluZGV4OwoKCQkJCS8v
IE1ha2Ugc3VyZSB0aGF0IGl0IGFsc28gd29ya3Mgd2l0aCBvcHRncm91cHMsIHNl
ZSAjNTcwMQoJCQkJaWYgKCBwYXJlbnQucGFyZW50Tm9kZSApIHsKCQkJCQlwYXJl
bnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4OwoJCQkJfQoJCQl9CgkJCXJldHVy
biBudWxsOwoJCX0KCX0pOwp9CgovLyBJRTYvNyBjYWxsIGVuY3R5cGUgZW5jb2Rp
bmcKaWYgKCAhalF1ZXJ5LnN1cHBvcnQuZW5jdHlwZSApIHsKCWpRdWVyeS5wcm9w
Rml4LmVuY3R5cGUgPSAiZW5jb2RpbmciOwp9CgovLyBSYWRpb3MgYW5kIGNoZWNr
Ym94ZXMgZ2V0dGVyL3NldHRlcgppZiAoICFqUXVlcnkuc3VwcG9ydC5jaGVja09u
ICkgewoJalF1ZXJ5LmVhY2goWyAicmFkaW8iLCAiY2hlY2tib3giIF0sIGZ1bmN0
aW9uKCkgewoJCWpRdWVyeS52YWxIb29rc1sgdGhpcyBdID0gewoJCQlnZXQ6IGZ1
bmN0aW9uKCBlbGVtICkgewoJCQkJLy8gSGFuZGxlIHRoZSBjYXNlIHdoZXJlIGlu
IFdlYmtpdCAiIiBpcyByZXR1cm5lZCBpbnN0ZWFkIG9mICJvbiIgaWYgYSB2YWx1
ZSBpc24ndCBzcGVjaWZpZWQKCQkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgi
dmFsdWUiKSA9PT0gbnVsbCA/ICJvbiIgOiBlbGVtLnZhbHVlOwoJCQl9CgkJfTsK
CX0pOwp9CmpRdWVyeS5lYWNoKFsgInJhZGlvIiwgImNoZWNrYm94IiBdLCBmdW5j
dGlvbigpIHsKCWpRdWVyeS52YWxIb29rc1sgdGhpcyBdID0galF1ZXJ5LmV4dGVu
ZCggalF1ZXJ5LnZhbEhvb2tzWyB0aGlzIF0sIHsKCQlzZXQ6IGZ1bmN0aW9uKCBl
bGVtLCB2YWx1ZSApIHsKCQkJaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsdWUgKSAp
IHsKCQkJCXJldHVybiAoIGVsZW0uY2hlY2tlZCA9IGpRdWVyeS5pbkFycmF5KCBq
UXVlcnkoZWxlbSkudmFsKCksIHZhbHVlICkgPj0gMCApOwoJCQl9CgkJfQoJfSk7
Cn0pOwoKCgoKdmFyIHJmb3JtRWxlbXMgPSAvXig/OnRleHRhcmVhfGlucHV0fHNl
bGVjdCkkL2ksCglydHlwZW5hbWVzcGFjZSA9IC9eKFteXC5dKik/KD86XC4oLisp
KT8kLywKCXJob3ZlckhhY2sgPSAvKD86Xnxccylob3ZlcihcLlxTKyk/XGIvLAoJ
cmtleUV2ZW50ID0gL15rZXkvLAoJcm1vdXNlRXZlbnQgPSAvXig/Om1vdXNlfGNv
bnRleHRtZW51KXxjbGljay8sCglyZm9jdXNNb3JwaCA9IC9eKD86Zm9jdXNpbmZv
Y3VzfGZvY3Vzb3V0Ymx1cikkLywKCXJxdWlja0lzID0gL14oXHcqKSg/OiMoW1x3
XC1dKykpPyg/OlwuKFtcd1wtXSspKT8kLywKCXF1aWNrUGFyc2UgPSBmdW5jdGlv
biggc2VsZWN0b3IgKSB7CgkJdmFyIHF1aWNrID0gcnF1aWNrSXMuZXhlYyggc2Vs
ZWN0b3IgKTsKCQlpZiAoIHF1aWNrICkgewoJCQkvLyAgIDAgIDEgICAgMiAgIDMK
CQkJLy8gWyBfLCB0YWcsIGlkLCBjbGFzcyBdCgkJCXF1aWNrWzFdID0gKCBxdWlj
a1sxXSB8fCAiIiApLnRvTG93ZXJDYXNlKCk7CgkJCXF1aWNrWzNdID0gcXVpY2tb
M10gJiYgbmV3IFJlZ0V4cCggIig/Ol58XFxzKSIgKyBxdWlja1szXSArICIoPzpc
XHN8JCkiICk7CgkJfQoJCXJldHVybiBxdWljazsKCX0sCglxdWlja0lzID0gZnVu
Y3Rpb24oIGVsZW0sIG0gKSB7CgkJdmFyIGF0dHJzID0gZWxlbS5hdHRyaWJ1dGVz
IHx8IHt9OwoJCXJldHVybiAoCgkJCSghbVsxXSB8fCBlbGVtLm5vZGVOYW1lLnRv
TG93ZXJDYXNlKCkgPT09IG1bMV0pICYmCgkJCSghbVsyXSB8fCAoYXR0cnMuaWQg
fHwge30pLnZhbHVlID09PSBtWzJdKSAmJgoJCQkoIW1bM10gfHwgbVszXS50ZXN0
KCAoYXR0cnNbICJjbGFzcyIgXSB8fCB7fSkudmFsdWUgKSkKCQkpOwoJfSwKCWhv
dmVySGFjayA9IGZ1bmN0aW9uKCBldmVudHMgKSB7CgkJcmV0dXJuIGpRdWVyeS5l
dmVudC5zcGVjaWFsLmhvdmVyID8gZXZlbnRzIDogZXZlbnRzLnJlcGxhY2UoIHJo
b3ZlckhhY2ssICJtb3VzZWVudGVyJDEgbW91c2VsZWF2ZSQxIiApOwoJfTsKCi8q
CiAqIEhlbHBlciBmdW5jdGlvbnMgZm9yIG1hbmFnaW5nIGV2ZW50cyAtLSBub3Qg
cGFydCBvZiB0aGUgcHVibGljIGludGVyZmFjZS4KICogUHJvcHMgdG8gRGVhbiBF
ZHdhcmRzJyBhZGRFdmVudCBsaWJyYXJ5IGZvciBtYW55IG9mIHRoZSBpZGVhcy4K
ICovCmpRdWVyeS5ldmVudCA9IHsKCglhZGQ6IGZ1bmN0aW9uKCBlbGVtLCB0eXBl
cywgaGFuZGxlciwgZGF0YSwgc2VsZWN0b3IgKSB7CgoJCXZhciBlbGVtRGF0YSwg
ZXZlbnRIYW5kbGUsIGV2ZW50cywKCQkJdCwgdG5zLCB0eXBlLCBuYW1lc3BhY2Vz
LCBoYW5kbGVPYmosCgkJCWhhbmRsZU9iakluLCBxdWljaywgaGFuZGxlcnMsIHNw
ZWNpYWw7CgoJCS8vIERvbid0IGF0dGFjaCBldmVudHMgdG8gbm9EYXRhIG9yIHRl
eHQvY29tbWVudCBub2RlcyAoYWxsb3cgcGxhaW4gb2JqZWN0cyB0aG8pCgkJaWYg
KCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggfHwg
IXR5cGVzIHx8ICFoYW5kbGVyIHx8ICEoZWxlbURhdGEgPSBqUXVlcnkuX2RhdGEo
IGVsZW0gKSkgKSB7CgkJCXJldHVybjsKCQl9CgoJCS8vIENhbGxlciBjYW4gcGFz
cyBpbiBhbiBvYmplY3Qgb2YgY3VzdG9tIGRhdGEgaW4gbGlldSBvZiB0aGUgaGFu
ZGxlcgoJCWlmICggaGFuZGxlci5oYW5kbGVyICkgewoJCQloYW5kbGVPYmpJbiA9
IGhhbmRsZXI7CgkJCWhhbmRsZXIgPSBoYW5kbGVPYmpJbi5oYW5kbGVyOwoJCQlz
ZWxlY3RvciA9IGhhbmRsZU9iakluLnNlbGVjdG9yOwoJCX0KCgkJLy8gTWFrZSBz
dXJlIHRoYXQgdGhlIGhhbmRsZXIgaGFzIGEgdW5pcXVlIElELCB1c2VkIHRvIGZp
bmQvcmVtb3ZlIGl0IGxhdGVyCgkJaWYgKCAhaGFuZGxlci5ndWlkICkgewoJCQlo
YW5kbGVyLmd1aWQgPSBqUXVlcnkuZ3VpZCsrOwoJCX0KCgkJLy8gSW5pdCB0aGUg
ZWxlbWVudCdzIGV2ZW50IHN0cnVjdHVyZSBhbmQgbWFpbiBoYW5kbGVyLCBpZiB0
aGlzIGlzIHRoZSBmaXJzdAoJCWV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50czsKCQlp
ZiAoICFldmVudHMgKSB7CgkJCWVsZW1EYXRhLmV2ZW50cyA9IGV2ZW50cyA9IHt9
OwoJCX0KCQlldmVudEhhbmRsZSA9IGVsZW1EYXRhLmhhbmRsZTsKCQlpZiAoICFl
dmVudEhhbmRsZSApIHsKCQkJZWxlbURhdGEuaGFuZGxlID0gZXZlbnRIYW5kbGUg
PSBmdW5jdGlvbiggZSApIHsKCQkJCS8vIERpc2NhcmQgdGhlIHNlY29uZCBldmVu
dCBvZiBhIGpRdWVyeS5ldmVudC50cmlnZ2VyKCkgYW5kCgkJCQkvLyB3aGVuIGFu
IGV2ZW50IGlzIGNhbGxlZCBhZnRlciBhIHBhZ2UgaGFzIHVubG9hZGVkCgkJCQly
ZXR1cm4gdHlwZW9mIGpRdWVyeSAhPT0gInVuZGVmaW5lZCIgJiYgKCFlIHx8IGpR
dWVyeS5ldmVudC50cmlnZ2VyZWQgIT09IGUudHlwZSkgPwoJCQkJCWpRdWVyeS5l
dmVudC5kaXNwYXRjaC5hcHBseSggZXZlbnRIYW5kbGUuZWxlbSwgYXJndW1lbnRz
ICkgOgoJCQkJCXVuZGVmaW5lZDsKCQkJfTsKCQkJLy8gQWRkIGVsZW0gYXMgYSBw
cm9wZXJ0eSBvZiB0aGUgaGFuZGxlIGZuIHRvIHByZXZlbnQgYSBtZW1vcnkgbGVh
ayB3aXRoIElFIG5vbi1uYXRpdmUgZXZlbnRzCgkJCWV2ZW50SGFuZGxlLmVsZW0g
PSBlbGVtOwoJCX0KCgkJLy8gSGFuZGxlIG11bHRpcGxlIGV2ZW50cyBzZXBhcmF0
ZWQgYnkgYSBzcGFjZQoJCS8vIGpRdWVyeSguLi4pLmJpbmQoIm1vdXNlb3ZlciBt
b3VzZW91dCIsIGZuKTsKCQl0eXBlcyA9IGpRdWVyeS50cmltKCBob3ZlckhhY2so
dHlwZXMpICkuc3BsaXQoICIgIiApOwoJCWZvciAoIHQgPSAwOyB0IDwgdHlwZXMu
bGVuZ3RoOyB0KysgKSB7CgoJCQl0bnMgPSBydHlwZW5hbWVzcGFjZS5leGVjKCB0
eXBlc1t0XSApIHx8IFtdOwoJCQl0eXBlID0gdG5zWzFdOwoJCQluYW1lc3BhY2Vz
ID0gKCB0bnNbMl0gfHwgIiIgKS5zcGxpdCggIi4iICkuc29ydCgpOwoKCQkJLy8g
SWYgZXZlbnQgY2hhbmdlcyBpdHMgdHlwZSwgdXNlIHRoZSBzcGVjaWFsIGV2ZW50
IGhhbmRsZXJzIGZvciB0aGUgY2hhbmdlZCB0eXBlCgkJCXNwZWNpYWwgPSBqUXVl
cnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9OwoKCQkJLy8gSWYgc2VsZWN0
b3IgZGVmaW5lZCwgZGV0ZXJtaW5lIHNwZWNpYWwgZXZlbnQgYXBpIHR5cGUsIG90
aGVyd2lzZSBnaXZlbiB0eXBlCgkJCXR5cGUgPSAoIHNlbGVjdG9yID8gc3BlY2lh
bC5kZWxlZ2F0ZVR5cGUgOiBzcGVjaWFsLmJpbmRUeXBlICkgfHwgdHlwZTsKCgkJ
CS8vIFVwZGF0ZSBzcGVjaWFsIGJhc2VkIG9uIG5ld2x5IHJlc2V0IHR5cGUKCQkJ
c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgoJ
CQkvLyBoYW5kbGVPYmogaXMgcGFzc2VkIHRvIGFsbCBldmVudCBoYW5kbGVycwoJ
CQloYW5kbGVPYmogPSBqUXVlcnkuZXh0ZW5kKHsKCQkJCXR5cGU6IHR5cGUsCgkJ
CQlvcmlnVHlwZTogdG5zWzFdLAoJCQkJZGF0YTogZGF0YSwKCQkJCWhhbmRsZXI6
IGhhbmRsZXIsCgkJCQlndWlkOiBoYW5kbGVyLmd1aWQsCgkJCQlzZWxlY3Rvcjog
c2VsZWN0b3IsCgkJCQlxdWljazogc2VsZWN0b3IgJiYgcXVpY2tQYXJzZSggc2Vs
ZWN0b3IgKSwKCQkJCW5hbWVzcGFjZTogbmFtZXNwYWNlcy5qb2luKCIuIikKCQkJ
fSwgaGFuZGxlT2JqSW4gKTsKCgkJCS8vIEluaXQgdGhlIGV2ZW50IGhhbmRsZXIg
cXVldWUgaWYgd2UncmUgdGhlIGZpcnN0CgkJCWhhbmRsZXJzID0gZXZlbnRzWyB0
eXBlIF07CgkJCWlmICggIWhhbmRsZXJzICkgewoJCQkJaGFuZGxlcnMgPSBldmVu
dHNbIHR5cGUgXSA9IFtdOwoJCQkJaGFuZGxlcnMuZGVsZWdhdGVDb3VudCA9IDA7
CgoJCQkJLy8gT25seSB1c2UgYWRkRXZlbnRMaXN0ZW5lci9hdHRhY2hFdmVudCBp
ZiB0aGUgc3BlY2lhbCBldmVudHMgaGFuZGxlciByZXR1cm5zIGZhbHNlCgkJCQlp
ZiAoICFzcGVjaWFsLnNldHVwIHx8IHNwZWNpYWwuc2V0dXAuY2FsbCggZWxlbSwg
ZGF0YSwgbmFtZXNwYWNlcywgZXZlbnRIYW5kbGUgKSA9PT0gZmFsc2UgKSB7CgkJ
CQkJLy8gQmluZCB0aGUgZ2xvYmFsIGV2ZW50IGhhbmRsZXIgdG8gdGhlIGVsZW1l
bnQKCQkJCQlpZiAoIGVsZW0uYWRkRXZlbnRMaXN0ZW5lciApIHsKCQkJCQkJZWxl
bS5hZGRFdmVudExpc3RlbmVyKCB0eXBlLCBldmVudEhhbmRsZSwgZmFsc2UgKTsK
CgkJCQkJfSBlbHNlIGlmICggZWxlbS5hdHRhY2hFdmVudCApIHsKCQkJCQkJZWxl
bS5hdHRhY2hFdmVudCggIm9uIiArIHR5cGUsIGV2ZW50SGFuZGxlICk7CgkJCQkJ
fQoJCQkJfQoJCQl9CgoJCQlpZiAoIHNwZWNpYWwuYWRkICkgewoJCQkJc3BlY2lh
bC5hZGQuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7CgoJCQkJaWYgKCAhaGFuZGxl
T2JqLmhhbmRsZXIuZ3VpZCApIHsKCQkJCQloYW5kbGVPYmouaGFuZGxlci5ndWlk
ID0gaGFuZGxlci5ndWlkOwoJCQkJfQoJCQl9CgoJCQkvLyBBZGQgdG8gdGhlIGVs
ZW1lbnQncyBoYW5kbGVyIGxpc3QsIGRlbGVnYXRlcyBpbiBmcm9udAoJCQlpZiAo
IHNlbGVjdG9yICkgewoJCQkJaGFuZGxlcnMuc3BsaWNlKCBoYW5kbGVycy5kZWxl
Z2F0ZUNvdW50KyssIDAsIGhhbmRsZU9iaiApOwoJCQl9IGVsc2UgewoJCQkJaGFu
ZGxlcnMucHVzaCggaGFuZGxlT2JqICk7CgkJCX0KCgkJCS8vIEtlZXAgdHJhY2sg
b2Ygd2hpY2ggZXZlbnRzIGhhdmUgZXZlciBiZWVuIHVzZWQsIGZvciBldmVudCBv
cHRpbWl6YXRpb24KCQkJalF1ZXJ5LmV2ZW50Lmdsb2JhbFsgdHlwZSBdID0gdHJ1
ZTsKCQl9CgoJCS8vIE51bGxpZnkgZWxlbSB0byBwcmV2ZW50IG1lbW9yeSBsZWFr
cyBpbiBJRQoJCWVsZW0gPSBudWxsOwoJfSwKCglnbG9iYWw6IHt9LAoKCS8vIERl
dGFjaCBhbiBldmVudCBvciBzZXQgb2YgZXZlbnRzIGZyb20gYW4gZWxlbWVudAoJ
cmVtb3ZlOiBmdW5jdGlvbiggZWxlbSwgdHlwZXMsIGhhbmRsZXIsIHNlbGVjdG9y
LCBtYXBwZWRUeXBlcyApIHsKCgkJdmFyIGVsZW1EYXRhID0galF1ZXJ5Lmhhc0Rh
dGEoIGVsZW0gKSAmJiBqUXVlcnkuX2RhdGEoIGVsZW0gKSwKCQkJdCwgdG5zLCB0
eXBlLCBvcmlnVHlwZSwgbmFtZXNwYWNlcywgb3JpZ0NvdW50LAoJCQlqLCBldmVu
dHMsIHNwZWNpYWwsIGhhbmRsZSwgZXZlbnRUeXBlLCBoYW5kbGVPYmo7CgoJCWlm
ICggIWVsZW1EYXRhIHx8ICEoZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzKSApIHsK
CQkJcmV0dXJuOwoJCX0KCgkJLy8gT25jZSBmb3IgZWFjaCB0eXBlLm5hbWVzcGFj
ZSBpbiB0eXBlczsgdHlwZSBtYXkgYmUgb21pdHRlZAoJCXR5cGVzID0galF1ZXJ5
LnRyaW0oIGhvdmVySGFjayggdHlwZXMgfHwgIiIgKSApLnNwbGl0KCIgIik7CgkJ
Zm9yICggdCA9IDA7IHQgPCB0eXBlcy5sZW5ndGg7IHQrKyApIHsKCQkJdG5zID0g
cnR5cGVuYW1lc3BhY2UuZXhlYyggdHlwZXNbdF0gKSB8fCBbXTsKCQkJdHlwZSA9
IG9yaWdUeXBlID0gdG5zWzFdOwoJCQluYW1lc3BhY2VzID0gdG5zWzJdOwoKCQkJ
Ly8gVW5iaW5kIGFsbCBldmVudHMgKG9uIHRoaXMgbmFtZXNwYWNlLCBpZiBwcm92
aWRlZCkgZm9yIHRoZSBlbGVtZW50CgkJCWlmICggIXR5cGUgKSB7CgkJCQlmb3Ig
KCB0eXBlIGluIGV2ZW50cyApIHsKCQkJCQlqUXVlcnkuZXZlbnQucmVtb3ZlKCBl
bGVtLCB0eXBlICsgdHlwZXNbIHQgXSwgaGFuZGxlciwgc2VsZWN0b3IsIHRydWUg
KTsKCQkJCX0KCQkJCWNvbnRpbnVlOwoJCQl9CgoJCQlzcGVjaWFsID0galF1ZXJ5
LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTsKCQkJdHlwZSA9ICggc2VsZWN0
b3I/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8
IHR5cGU7CgkJCWV2ZW50VHlwZSA9IGV2ZW50c1sgdHlwZSBdIHx8IFtdOwoJCQlv
cmlnQ291bnQgPSBldmVudFR5cGUubGVuZ3RoOwoJCQluYW1lc3BhY2VzID0gbmFt
ZXNwYWNlcyA/IG5ldyBSZWdFeHAoIihefFxcLikiICsgbmFtZXNwYWNlcy5zcGxp
dCgiLiIpLnNvcnQoKS5qb2luKCJcXC4oPzouKlxcLik/IikgKyAiKFxcLnwkKSIp
IDogbnVsbDsKCgkJCS8vIFJlbW92ZSBtYXRjaGluZyBldmVudHMKCQkJZm9yICgg
aiA9IDA7IGogPCBldmVudFR5cGUubGVuZ3RoOyBqKysgKSB7CgkJCQloYW5kbGVP
YmogPSBldmVudFR5cGVbIGogXTsKCgkJCQlpZiAoICggbWFwcGVkVHlwZXMgfHwg
b3JpZ1R5cGUgPT09IGhhbmRsZU9iai5vcmlnVHlwZSApICYmCgkJCQkJICggIWhh
bmRsZXIgfHwgaGFuZGxlci5ndWlkID09PSBoYW5kbGVPYmouZ3VpZCApICYmCgkJ
CQkJICggIW5hbWVzcGFjZXMgfHwgbmFtZXNwYWNlcy50ZXN0KCBoYW5kbGVPYmou
bmFtZXNwYWNlICkgKSAmJgoJCQkJCSAoICFzZWxlY3RvciB8fCBzZWxlY3RvciA9
PT0gaGFuZGxlT2JqLnNlbGVjdG9yIHx8IHNlbGVjdG9yID09PSAiKioiICYmIGhh
bmRsZU9iai5zZWxlY3RvciApICkgewoJCQkJCWV2ZW50VHlwZS5zcGxpY2UoIGot
LSwgMSApOwoKCQkJCQlpZiAoIGhhbmRsZU9iai5zZWxlY3RvciApIHsKCQkJCQkJ
ZXZlbnRUeXBlLmRlbGVnYXRlQ291bnQtLTsKCQkJCQl9CgkJCQkJaWYgKCBzcGVj
aWFsLnJlbW92ZSApIHsKCQkJCQkJc3BlY2lhbC5yZW1vdmUuY2FsbCggZWxlbSwg
aGFuZGxlT2JqICk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBSZW1vdmUgZ2Vu
ZXJpYyBldmVudCBoYW5kbGVyIGlmIHdlIHJlbW92ZWQgc29tZXRoaW5nIGFuZCBu
byBtb3JlIGhhbmRsZXJzIGV4aXN0CgkJCS8vIChhdm9pZHMgcG90ZW50aWFsIGZv
ciBlbmRsZXNzIHJlY3Vyc2lvbiBkdXJpbmcgcmVtb3ZhbCBvZiBzcGVjaWFsIGV2
ZW50IGhhbmRsZXJzKQoJCQlpZiAoIGV2ZW50VHlwZS5sZW5ndGggPT09IDAgJiYg
b3JpZ0NvdW50ICE9PSBldmVudFR5cGUubGVuZ3RoICkgewoJCQkJaWYgKCAhc3Bl
Y2lhbC50ZWFyZG93biB8fCBzcGVjaWFsLnRlYXJkb3duLmNhbGwoIGVsZW0sIG5h
bWVzcGFjZXMgKSA9PT0gZmFsc2UgKSB7CgkJCQkJalF1ZXJ5LnJlbW92ZUV2ZW50
KCBlbGVtLCB0eXBlLCBlbGVtRGF0YS5oYW5kbGUgKTsKCQkJCX0KCgkJCQlkZWxl
dGUgZXZlbnRzWyB0eXBlIF07CgkJCX0KCQl9CgoJCS8vIFJlbW92ZSB0aGUgZXhw
YW5kbyBpZiBpdCdzIG5vIGxvbmdlciB1c2VkCgkJaWYgKCBqUXVlcnkuaXNFbXB0
eU9iamVjdCggZXZlbnRzICkgKSB7CgkJCWhhbmRsZSA9IGVsZW1EYXRhLmhhbmRs
ZTsKCQkJaWYgKCBoYW5kbGUgKSB7CgkJCQloYW5kbGUuZWxlbSA9IG51bGw7CgkJ
CX0KCgkJCS8vIHJlbW92ZURhdGEgYWxzbyBjaGVja3MgZm9yIGVtcHRpbmVzcyBh
bmQgY2xlYXJzIHRoZSBleHBhbmRvIGlmIGVtcHR5CgkJCS8vIHNvIHVzZSBpdCBp
bnN0ZWFkIG9mIGRlbGV0ZQoJCQlqUXVlcnkucmVtb3ZlRGF0YSggZWxlbSwgWyAi
ZXZlbnRzIiwgImhhbmRsZSIgXSwgdHJ1ZSApOwoJCX0KCX0sCgoJLy8gRXZlbnRz
IHRoYXQgYXJlIHNhZmUgdG8gc2hvcnQtY2lyY3VpdCBpZiBubyBoYW5kbGVycyBh
cmUgYXR0YWNoZWQuCgkvLyBOYXRpdmUgRE9NIGV2ZW50cyBzaG91bGQgbm90IGJl
IGFkZGVkLCB0aGV5IG1heSBoYXZlIGlubGluZSBoYW5kbGVycy4KCWN1c3RvbUV2
ZW50OiB7CgkJImdldERhdGEiOiB0cnVlLAoJCSJzZXREYXRhIjogdHJ1ZSwKCQki
Y2hhbmdlRGF0YSI6IHRydWUKCX0sCgoJdHJpZ2dlcjogZnVuY3Rpb24oIGV2ZW50
LCBkYXRhLCBlbGVtLCBvbmx5SGFuZGxlcnMgKSB7CgkJLy8gRG9uJ3QgZG8gZXZl
bnRzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXMKCQlpZiAoIGVsZW0gJiYgKGVs
ZW0ubm9kZVR5cGUgPT09IDMgfHwgZWxlbS5ub2RlVHlwZSA9PT0gOCkgKSB7CgkJ
CXJldHVybjsKCQl9CgoJCS8vIEV2ZW50IG9iamVjdCBvciBldmVudCB0eXBlCgkJ
dmFyIHR5cGUgPSBldmVudC50eXBlIHx8IGV2ZW50LAoJCQluYW1lc3BhY2VzID0g
W10sCgkJCWNhY2hlLCBleGNsdXNpdmUsIGksIGN1ciwgb2xkLCBvbnR5cGUsIHNw
ZWNpYWwsIGhhbmRsZSwgZXZlbnRQYXRoLCBidWJibGVUeXBlOwoKCQkvLyBmb2N1
cy9ibHVyIG1vcnBocyB0byBmb2N1c2luL291dDsgZW5zdXJlIHdlJ3JlIG5vdCBm
aXJpbmcgdGhlbSByaWdodCBub3cKCQlpZiAoIHJmb2N1c01vcnBoLnRlc3QoIHR5
cGUgKyBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkICkgKSB7CgkJCXJldHVybjsKCQl9
CgoJCWlmICggdHlwZS5pbmRleE9mKCAiISIgKSA+PSAwICkgewoJCQkvLyBFeGNs
dXNpdmUgZXZlbnRzIHRyaWdnZXIgb25seSBmb3IgdGhlIGV4YWN0IGV2ZW50IChu
byBuYW1lc3BhY2VzKQoJCQl0eXBlID0gdHlwZS5zbGljZSgwLCAtMSk7CgkJCWV4
Y2x1c2l2ZSA9IHRydWU7CgkJfQoKCQlpZiAoIHR5cGUuaW5kZXhPZiggIi4iICkg
Pj0gMCApIHsKCQkJLy8gTmFtZXNwYWNlZCB0cmlnZ2VyOyBjcmVhdGUgYSByZWdl
eHAgdG8gbWF0Y2ggZXZlbnQgdHlwZSBpbiBoYW5kbGUoKQoJCQluYW1lc3BhY2Vz
ID0gdHlwZS5zcGxpdCgiLiIpOwoJCQl0eXBlID0gbmFtZXNwYWNlcy5zaGlmdCgp
OwoJCQluYW1lc3BhY2VzLnNvcnQoKTsKCQl9CgoJCWlmICggKCFlbGVtIHx8IGpR
dWVyeS5ldmVudC5jdXN0b21FdmVudFsgdHlwZSBdKSAmJiAhalF1ZXJ5LmV2ZW50
Lmdsb2JhbFsgdHlwZSBdICkgewoJCQkvLyBObyBqUXVlcnkgaGFuZGxlcnMgZm9y
IHRoaXMgZXZlbnQgdHlwZSwgYW5kIGl0IGNhbid0IGhhdmUgaW5saW5lIGhhbmRs
ZXJzCgkJCXJldHVybjsKCQl9CgoJCS8vIENhbGxlciBjYW4gcGFzcyBpbiBhbiBF
dmVudCwgT2JqZWN0LCBvciBqdXN0IGFuIGV2ZW50IHR5cGUgc3RyaW5nCgkJZXZl
bnQgPSB0eXBlb2YgZXZlbnQgPT09ICJvYmplY3QiID8KCQkJLy8galF1ZXJ5LkV2
ZW50IG9iamVjdAoJCQlldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSA/IGV2ZW50IDoK
CQkJLy8gT2JqZWN0IGxpdGVyYWwKCQkJbmV3IGpRdWVyeS5FdmVudCggdHlwZSwg
ZXZlbnQgKSA6CgkJCS8vIEp1c3QgdGhlIGV2ZW50IHR5cGUgKHN0cmluZykKCQkJ
bmV3IGpRdWVyeS5FdmVudCggdHlwZSApOwoKCQlldmVudC50eXBlID0gdHlwZTsK
CQlldmVudC5pc1RyaWdnZXIgPSB0cnVlOwoJCWV2ZW50LmV4Y2x1c2l2ZSA9IGV4
Y2x1c2l2ZTsKCQlldmVudC5uYW1lc3BhY2UgPSBuYW1lc3BhY2VzLmpvaW4oICIu
IiApOwoJCWV2ZW50Lm5hbWVzcGFjZV9yZSA9IGV2ZW50Lm5hbWVzcGFjZT8gbmV3
IFJlZ0V4cCgiKF58XFwuKSIgKyBuYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwu
KT8iKSArICIoXFwufCQpIikgOiBudWxsOwoJCW9udHlwZSA9IHR5cGUuaW5kZXhP
ZiggIjoiICkgPCAwID8gIm9uIiArIHR5cGUgOiAiIjsKCgkJLy8gSGFuZGxlIGEg
Z2xvYmFsIHRyaWdnZXIKCQlpZiAoICFlbGVtICkgewoKCQkJLy8gVE9ETzogU3Rv
cCB0YXVudGluZyB0aGUgZGF0YSBjYWNoZTsgcmVtb3ZlIGdsb2JhbCBldmVudHMg
YW5kIGFsd2F5cyBhdHRhY2ggdG8gZG9jdW1lbnQKCQkJY2FjaGUgPSBqUXVlcnku
Y2FjaGU7CgkJCWZvciAoIGkgaW4gY2FjaGUgKSB7CgkJCQlpZiAoIGNhY2hlWyBp
IF0uZXZlbnRzICYmIGNhY2hlWyBpIF0uZXZlbnRzWyB0eXBlIF0gKSB7CgkJCQkJ
alF1ZXJ5LmV2ZW50LnRyaWdnZXIoIGV2ZW50LCBkYXRhLCBjYWNoZVsgaSBdLmhh
bmRsZS5lbGVtLCB0cnVlICk7CgkJCQl9CgkJCX0KCQkJcmV0dXJuOwoJCX0KCgkJ
Ly8gQ2xlYW4gdXAgdGhlIGV2ZW50IGluIGNhc2UgaXQgaXMgYmVpbmcgcmV1c2Vk
CgkJZXZlbnQucmVzdWx0ID0gdW5kZWZpbmVkOwoJCWlmICggIWV2ZW50LnRhcmdl
dCApIHsKCQkJZXZlbnQudGFyZ2V0ID0gZWxlbTsKCQl9CgoJCS8vIENsb25lIGFu
eSBpbmNvbWluZyBkYXRhIGFuZCBwcmVwZW5kIHRoZSBldmVudCwgY3JlYXRpbmcg
dGhlIGhhbmRsZXIgYXJnIGxpc3QKCQlkYXRhID0gZGF0YSAhPSBudWxsID8galF1
ZXJ5Lm1ha2VBcnJheSggZGF0YSApIDogW107CgkJZGF0YS51bnNoaWZ0KCBldmVu
dCApOwoKCQkvLyBBbGxvdyBzcGVjaWFsIGV2ZW50cyB0byBkcmF3IG91dHNpZGUg
dGhlIGxpbmVzCgkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBl
IF0gfHwge307CgkJaWYgKCBzcGVjaWFsLnRyaWdnZXIgJiYgc3BlY2lhbC50cmln
Z2VyLmFwcGx5KCBlbGVtLCBkYXRhICkgPT09IGZhbHNlICkgewoJCQlyZXR1cm47
CgkJfQoKCQkvLyBEZXRlcm1pbmUgZXZlbnQgcHJvcGFnYXRpb24gcGF0aCBpbiBh
ZHZhbmNlLCBwZXIgVzNDIGV2ZW50cyBzcGVjICgjOTk1MSkKCQkvLyBCdWJibGUg
dXAgdG8gZG9jdW1lbnQsIHRoZW4gdG8gd2luZG93OyB3YXRjaCBmb3IgYSBnbG9i
YWwgb3duZXJEb2N1bWVudCB2YXIgKCM5NzI0KQoJCWV2ZW50UGF0aCA9IFtbIGVs
ZW0sIHNwZWNpYWwuYmluZFR5cGUgfHwgdHlwZSBdXTsKCQlpZiAoICFvbmx5SGFu
ZGxlcnMgJiYgIXNwZWNpYWwubm9CdWJibGUgJiYgIWpRdWVyeS5pc1dpbmRvdygg
ZWxlbSApICkgewoKCQkJYnViYmxlVHlwZSA9IHNwZWNpYWwuZGVsZWdhdGVUeXBl
IHx8IHR5cGU7CgkJCWN1ciA9IHJmb2N1c01vcnBoLnRlc3QoIGJ1YmJsZVR5cGUg
KyB0eXBlICkgPyBlbGVtIDogZWxlbS5wYXJlbnROb2RlOwoJCQlvbGQgPSBudWxs
OwoJCQlmb3IgKCA7IGN1cjsgY3VyID0gY3VyLnBhcmVudE5vZGUgKSB7CgkJCQll
dmVudFBhdGgucHVzaChbIGN1ciwgYnViYmxlVHlwZSBdKTsKCQkJCW9sZCA9IGN1
cjsKCQkJfQoKCQkJLy8gT25seSBhZGQgd2luZG93IGlmIHdlIGdvdCB0byBkb2N1
bWVudCAoZS5nLiwgbm90IHBsYWluIG9iaiBvciBkZXRhY2hlZCBET00pCgkJCWlm
ICggb2xkICYmIG9sZCA9PT0gZWxlbS5vd25lckRvY3VtZW50ICkgewoJCQkJZXZl
bnRQYXRoLnB1c2goWyBvbGQuZGVmYXVsdFZpZXcgfHwgb2xkLnBhcmVudFdpbmRv
dyB8fCB3aW5kb3csIGJ1YmJsZVR5cGUgXSk7CgkJCX0KCQl9CgoJCS8vIEZpcmUg
aGFuZGxlcnMgb24gdGhlIGV2ZW50IHBhdGgKCQlmb3IgKCBpID0gMDsgaSA8IGV2
ZW50UGF0aC5sZW5ndGggJiYgIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCk7
IGkrKyApIHsKCgkJCWN1ciA9IGV2ZW50UGF0aFtpXVswXTsKCQkJZXZlbnQudHlw
ZSA9IGV2ZW50UGF0aFtpXVsxXTsKCgkJCWhhbmRsZSA9ICggalF1ZXJ5Ll9kYXRh
KCBjdXIsICJldmVudHMiICkgfHwge30gKVsgZXZlbnQudHlwZSBdICYmIGpRdWVy
eS5fZGF0YSggY3VyLCAiaGFuZGxlIiApOwoJCQlpZiAoIGhhbmRsZSApIHsKCQkJ
CWhhbmRsZS5hcHBseSggY3VyLCBkYXRhICk7CgkJCX0KCQkJLy8gTm90ZSB0aGF0
IHRoaXMgaXMgYSBiYXJlIEpTIGZ1bmN0aW9uIGFuZCBub3QgYSBqUXVlcnkgaGFu
ZGxlcgoJCQloYW5kbGUgPSBvbnR5cGUgJiYgY3VyWyBvbnR5cGUgXTsKCQkJaWYg
KCBoYW5kbGUgJiYgalF1ZXJ5LmFjY2VwdERhdGEoIGN1ciApICYmIGhhbmRsZS5h
cHBseSggY3VyLCBkYXRhICkgPT09IGZhbHNlICkgewoJCQkJZXZlbnQucHJldmVu
dERlZmF1bHQoKTsKCQkJfQoJCX0KCQlldmVudC50eXBlID0gdHlwZTsKCgkJLy8g
SWYgbm9ib2R5IHByZXZlbnRlZCB0aGUgZGVmYXVsdCBhY3Rpb24sIGRvIGl0IG5v
dwoJCWlmICggIW9ubHlIYW5kbGVycyAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVu
dGVkKCkgKSB7CgoJCQlpZiAoICghc3BlY2lhbC5fZGVmYXVsdCB8fCBzcGVjaWFs
Ll9kZWZhdWx0LmFwcGx5KCBlbGVtLm93bmVyRG9jdW1lbnQsIGRhdGEgKSA9PT0g
ZmFsc2UpICYmCgkJCQkhKHR5cGUgPT09ICJjbGljayIgJiYgalF1ZXJ5Lm5vZGVO
YW1lKCBlbGVtLCAiYSIgKSkgJiYgalF1ZXJ5LmFjY2VwdERhdGEoIGVsZW0gKSAp
IHsKCgkJCQkvLyBDYWxsIGEgbmF0aXZlIERPTSBtZXRob2Qgb24gdGhlIHRhcmdl
dCB3aXRoIHRoZSBzYW1lIG5hbWUgbmFtZSBhcyB0aGUgZXZlbnQuCgkJCQkvLyBD
YW4ndCB1c2UgYW4gLmlzRnVuY3Rpb24oKSBjaGVjayBoZXJlIGJlY2F1c2UgSUU2
LzcgZmFpbHMgdGhhdCB0ZXN0LgoJCQkJLy8gRG9uJ3QgZG8gZGVmYXVsdCBhY3Rp
b25zIG9uIHdpbmRvdywgdGhhdCdzIHdoZXJlIGdsb2JhbCB2YXJpYWJsZXMgYmUg
KCM2MTcwKQoJCQkJLy8gSUU8OSBkaWVzIG9uIGZvY3VzL2JsdXIgdG8gaGlkZGVu
IGVsZW1lbnQgKCMxNDg2KQoJCQkJaWYgKCBvbnR5cGUgJiYgZWxlbVsgdHlwZSBd
ICYmICgodHlwZSAhPT0gImZvY3VzIiAmJiB0eXBlICE9PSAiYmx1ciIpIHx8IGV2
ZW50LnRhcmdldC5vZmZzZXRXaWR0aCAhPT0gMCkgJiYgIWpRdWVyeS5pc1dpbmRv
dyggZWxlbSApICkgewoKCQkJCQkvLyBEb24ndCByZS10cmlnZ2VyIGFuIG9uRk9P
IGV2ZW50IHdoZW4gd2UgY2FsbCBpdHMgRk9PKCkgbWV0aG9kCgkJCQkJb2xkID0g
ZWxlbVsgb250eXBlIF07CgoJCQkJCWlmICggb2xkICkgewoJCQkJCQllbGVtWyBv
bnR5cGUgXSA9IG51bGw7CgkJCQkJfQoKCQkJCQkvLyBQcmV2ZW50IHJlLXRyaWdn
ZXJpbmcgb2YgdGhlIHNhbWUgZXZlbnQsIHNpbmNlIHdlIGFscmVhZHkgYnViYmxl
ZCBpdCBhYm92ZQoJCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyZWQgPSB0eXBlOwoJ
CQkJCWVsZW1bIHR5cGUgXSgpOwoJCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyZWQg
PSB1bmRlZmluZWQ7CgoJCQkJCWlmICggb2xkICkgewoJCQkJCQllbGVtWyBvbnR5
cGUgXSA9IG9sZDsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBldmVu
dC5yZXN1bHQ7Cgl9LAoKCWRpc3BhdGNoOiBmdW5jdGlvbiggZXZlbnQgKSB7CgoJ
CS8vIE1ha2UgYSB3cml0YWJsZSBqUXVlcnkuRXZlbnQgZnJvbSB0aGUgbmF0aXZl
IGV2ZW50IG9iamVjdAoJCWV2ZW50ID0galF1ZXJ5LmV2ZW50LmZpeCggZXZlbnQg
fHwgd2luZG93LmV2ZW50ICk7CgoJCXZhciBoYW5kbGVycyA9ICggKGpRdWVyeS5f
ZGF0YSggdGhpcywgImV2ZW50cyIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gfHwg
W10pLAoJCQlkZWxlZ2F0ZUNvdW50ID0gaGFuZGxlcnMuZGVsZWdhdGVDb3VudCwK
CQkJYXJncyA9IFtdLnNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMCApLAoJCQlydW5f
YWxsID0gIWV2ZW50LmV4Y2x1c2l2ZSAmJiAhZXZlbnQubmFtZXNwYWNlLAoJCQlz
cGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGV2ZW50LnR5cGUgXSB8fCB7
fSwKCQkJaGFuZGxlclF1ZXVlID0gW10sCgkJCWksIGosIGN1ciwganFjdXIsIHJl
dCwgc2VsTWF0Y2gsIG1hdGNoZWQsIG1hdGNoZXMsIGhhbmRsZU9iaiwgc2VsLCBy
ZWxhdGVkOwoKCQkvLyBVc2UgdGhlIGZpeC1lZCBqUXVlcnkuRXZlbnQgcmF0aGVy
IHRoYW4gdGhlIChyZWFkLW9ubHkpIG5hdGl2ZSBldmVudAoJCWFyZ3NbMF0gPSBl
dmVudDsKCQlldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7CgoJCS8vIENhbGwg
dGhlIHByZURpc3BhdGNoIGhvb2sgZm9yIHRoZSBtYXBwZWQgdHlwZSwgYW5kIGxl
dCBpdCBiYWlsIGlmIGRlc2lyZWQKCQlpZiAoIHNwZWNpYWwucHJlRGlzcGF0Y2gg
JiYgc3BlY2lhbC5wcmVEaXNwYXRjaC5jYWxsKCB0aGlzLCBldmVudCApID09PSBm
YWxzZSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gRGV0ZXJtaW5lIGhhbmRsZXJz
IHRoYXQgc2hvdWxkIHJ1biBpZiB0aGVyZSBhcmUgZGVsZWdhdGVkIGV2ZW50cwoJ
CS8vIEF2b2lkIG5vbi1sZWZ0LWNsaWNrIGJ1YmJsaW5nIGluIEZpcmVmb3ggKCMz
ODYxKQoJCWlmICggZGVsZWdhdGVDb3VudCAmJiAhKGV2ZW50LmJ1dHRvbiAmJiBl
dmVudC50eXBlID09PSAiY2xpY2siKSApIHsKCgkJCS8vIFByZWdlbmVyYXRlIGEg
c2luZ2xlIGpRdWVyeSBvYmplY3QgZm9yIHJldXNlIHdpdGggLmlzKCkKCQkJanFj
dXIgPSBqUXVlcnkodGhpcyk7CgkJCWpxY3VyLmNvbnRleHQgPSB0aGlzLm93bmVy
RG9jdW1lbnQgfHwgdGhpczsKCgkJCWZvciAoIGN1ciA9IGV2ZW50LnRhcmdldDsg
Y3VyICE9IHRoaXM7IGN1ciA9IGN1ci5wYXJlbnROb2RlIHx8IHRoaXMgKSB7CgoJ
CQkJLy8gRG9uJ3QgcHJvY2VzcyBldmVudHMgb24gZGlzYWJsZWQgZWxlbWVudHMg
KCM2OTExLCAjODE2NSkKCQkJCWlmICggY3VyLmRpc2FibGVkICE9PSB0cnVlICkg
ewoJCQkJCXNlbE1hdGNoID0ge307CgkJCQkJbWF0Y2hlcyA9IFtdOwoJCQkJCWpx
Y3VyWzBdID0gY3VyOwoJCQkJCWZvciAoIGkgPSAwOyBpIDwgZGVsZWdhdGVDb3Vu
dDsgaSsrICkgewoJCQkJCQloYW5kbGVPYmogPSBoYW5kbGVyc1sgaSBdOwoJCQkJ
CQlzZWwgPSBoYW5kbGVPYmouc2VsZWN0b3I7CgoJCQkJCQlpZiAoIHNlbE1hdGNo
WyBzZWwgXSA9PT0gdW5kZWZpbmVkICkgewoJCQkJCQkJc2VsTWF0Y2hbIHNlbCBd
ID0gKAoJCQkJCQkJCWhhbmRsZU9iai5xdWljayA/IHF1aWNrSXMoIGN1ciwgaGFu
ZGxlT2JqLnF1aWNrICkgOiBqcWN1ci5pcyggc2VsICkKCQkJCQkJCSk7CgkJCQkJ
CX0KCQkJCQkJaWYgKCBzZWxNYXRjaFsgc2VsIF0gKSB7CgkJCQkJCQltYXRjaGVz
LnB1c2goIGhhbmRsZU9iaiApOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWlmICggbWF0
Y2hlcy5sZW5ndGggKSB7CgkJCQkJCWhhbmRsZXJRdWV1ZS5wdXNoKHsgZWxlbTog
Y3VyLCBtYXRjaGVzOiBtYXRjaGVzIH0pOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0K
CgkJLy8gQWRkIHRoZSByZW1haW5pbmcgKGRpcmVjdGx5LWJvdW5kKSBoYW5kbGVy
cwoJCWlmICggaGFuZGxlcnMubGVuZ3RoID4gZGVsZWdhdGVDb3VudCApIHsKCQkJ
aGFuZGxlclF1ZXVlLnB1c2goeyBlbGVtOiB0aGlzLCBtYXRjaGVzOiBoYW5kbGVy
cy5zbGljZSggZGVsZWdhdGVDb3VudCApIH0pOwoJCX0KCgkJLy8gUnVuIGRlbGVn
YXRlcyBmaXJzdDsgdGhleSBtYXkgd2FudCB0byBzdG9wIHByb3BhZ2F0aW9uIGJl
bmVhdGggdXMKCQlmb3IgKCBpID0gMDsgaSA8IGhhbmRsZXJRdWV1ZS5sZW5ndGgg
JiYgIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCk7IGkrKyApIHsKCQkJbWF0
Y2hlZCA9IGhhbmRsZXJRdWV1ZVsgaSBdOwoJCQlldmVudC5jdXJyZW50VGFyZ2V0
ID0gbWF0Y2hlZC5lbGVtOwoKCQkJZm9yICggaiA9IDA7IGogPCBtYXRjaGVkLm1h
dGNoZXMubGVuZ3RoICYmICFldmVudC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3Rv
cHBlZCgpOyBqKysgKSB7CgkJCQloYW5kbGVPYmogPSBtYXRjaGVkLm1hdGNoZXNb
IGogXTsKCgkJCQkvLyBUcmlnZ2VyZWQgZXZlbnQgbXVzdCBlaXRoZXIgMSkgYmUg
bm9uLWV4Y2x1c2l2ZSBhbmQgaGF2ZSBubyBuYW1lc3BhY2UsIG9yCgkJCQkvLyAy
KSBoYXZlIG5hbWVzcGFjZShzKSBhIHN1YnNldCBvciBlcXVhbCB0byB0aG9zZSBp
biB0aGUgYm91bmQgZXZlbnQgKGJvdGggY2FuIGhhdmUgbm8gbmFtZXNwYWNlKS4K
CQkJCWlmICggcnVuX2FsbCB8fCAoIWV2ZW50Lm5hbWVzcGFjZSAmJiAhaGFuZGxl
T2JqLm5hbWVzcGFjZSkgfHwgZXZlbnQubmFtZXNwYWNlX3JlICYmIGV2ZW50Lm5h
bWVzcGFjZV9yZS50ZXN0KCBoYW5kbGVPYmoubmFtZXNwYWNlICkgKSB7CgoJCQkJ
CWV2ZW50LmRhdGEgPSBoYW5kbGVPYmouZGF0YTsKCQkJCQlldmVudC5oYW5kbGVP
YmogPSBoYW5kbGVPYmo7CgoJCQkJCXJldCA9ICggKGpRdWVyeS5ldmVudC5zcGVj
aWFsWyBoYW5kbGVPYmoub3JpZ1R5cGUgXSB8fCB7fSkuaGFuZGxlIHx8IGhhbmRs
ZU9iai5oYW5kbGVyICkKCQkJCQkJCS5hcHBseSggbWF0Y2hlZC5lbGVtLCBhcmdz
ICk7CgoJCQkJCWlmICggcmV0ICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCWV2ZW50
LnJlc3VsdCA9IHJldDsKCQkJCQkJaWYgKCByZXQgPT09IGZhbHNlICkgewoJCQkJ
CQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCQkJCWV2ZW50LnN0b3BQcm9w
YWdhdGlvbigpOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoKCQkvLyBD
YWxsIHRoZSBwb3N0RGlzcGF0Y2ggaG9vayBmb3IgdGhlIG1hcHBlZCB0eXBlCgkJ
aWYgKCBzcGVjaWFsLnBvc3REaXNwYXRjaCApIHsKCQkJc3BlY2lhbC5wb3N0RGlz
cGF0Y2guY2FsbCggdGhpcywgZXZlbnQgKTsKCQl9CgoJCXJldHVybiBldmVudC5y
ZXN1bHQ7Cgl9LAoKCS8vIEluY2x1ZGVzIHNvbWUgZXZlbnQgcHJvcHMgc2hhcmVk
IGJ5IEtleUV2ZW50IGFuZCBNb3VzZUV2ZW50CgkvLyAqKiogYXR0ckNoYW5nZSBh
dHRyTmFtZSByZWxhdGVkTm9kZSBzcmNFbGVtZW50ICBhcmUgbm90IG5vcm1hbGl6
ZWQsIG5vbi1XM0MsIGRlcHJlY2F0ZWQsIHdpbGwgYmUgcmVtb3ZlZCBpbiAxLjgg
KioqCglwcm9wczogImF0dHJDaGFuZ2UgYXR0ck5hbWUgcmVsYXRlZE5vZGUgc3Jj
RWxlbWVudCBhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVu
dFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtl
eSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2giLnNwbGl0KCIgIiksCgoJZml4
SG9va3M6IHt9LAoKCWtleUhvb2tzOiB7CgkJcHJvcHM6ICJjaGFyIGNoYXJDb2Rl
IGtleSBrZXlDb2RlIi5zcGxpdCgiICIpLAoJCWZpbHRlcjogZnVuY3Rpb24oIGV2
ZW50LCBvcmlnaW5hbCApIHsKCgkJCS8vIEFkZCB3aGljaCBmb3Iga2V5IGV2ZW50
cwoJCQlpZiAoIGV2ZW50LndoaWNoID09IG51bGwgKSB7CgkJCQlldmVudC53aGlj
aCA9IG9yaWdpbmFsLmNoYXJDb2RlICE9IG51bGwgPyBvcmlnaW5hbC5jaGFyQ29k
ZSA6IG9yaWdpbmFsLmtleUNvZGU7CgkJCX0KCgkJCXJldHVybiBldmVudDsKCQl9
Cgl9LAoKCW1vdXNlSG9va3M6IHsKCQlwcm9wczogImJ1dHRvbiBidXR0b25zIGNs
aWVudFggY2xpZW50WSBmcm9tRWxlbWVudCBvZmZzZXRYIG9mZnNldFkgcGFnZVgg
cGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIuc3BsaXQoIiAiKSwKCQlm
aWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7CgkJCXZhciBldmVu
dERvYywgZG9jLCBib2R5LAoJCQkJYnV0dG9uID0gb3JpZ2luYWwuYnV0dG9uLAoJ
CQkJZnJvbUVsZW1lbnQgPSBvcmlnaW5hbC5mcm9tRWxlbWVudDsKCgkJCS8vIENh
bGN1bGF0ZSBwYWdlWC9ZIGlmIG1pc3NpbmcgYW5kIGNsaWVudFgvWSBhdmFpbGFi
bGUKCQkJaWYgKCBldmVudC5wYWdlWCA9PSBudWxsICYmIG9yaWdpbmFsLmNsaWVu
dFggIT0gbnVsbCApIHsKCQkJCWV2ZW50RG9jID0gZXZlbnQudGFyZ2V0Lm93bmVy
RG9jdW1lbnQgfHwgZG9jdW1lbnQ7CgkJCQlkb2MgPSBldmVudERvYy5kb2N1bWVu
dEVsZW1lbnQ7CgkJCQlib2R5ID0gZXZlbnREb2MuYm9keTsKCgkJCQlldmVudC5w
YWdlWCA9IG9yaWdpbmFsLmNsaWVudFggKyAoIGRvYyAmJiBkb2Muc2Nyb2xsTGVm
dCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsTGVmdCB8fCAwICkgLSAoIGRvYyAmJiBk
b2MuY2xpZW50TGVmdCB8fCBib2R5ICYmIGJvZHkuY2xpZW50TGVmdCB8fCAwICk7
CgkJCQlldmVudC5wYWdlWSA9IG9yaWdpbmFsLmNsaWVudFkgKyAoIGRvYyAmJiBk
b2Muc2Nyb2xsVG9wICB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsVG9wICB8fCAwICkg
LSAoIGRvYyAmJiBkb2MuY2xpZW50VG9wICB8fCBib2R5ICYmIGJvZHkuY2xpZW50
VG9wICB8fCAwICk7CgkJCX0KCgkJCS8vIEFkZCByZWxhdGVkVGFyZ2V0LCBpZiBu
ZWNlc3NhcnkKCQkJaWYgKCAhZXZlbnQucmVsYXRlZFRhcmdldCAmJiBmcm9tRWxl
bWVudCApIHsKCQkJCWV2ZW50LnJlbGF0ZWRUYXJnZXQgPSBmcm9tRWxlbWVudCA9
PT0gZXZlbnQudGFyZ2V0ID8gb3JpZ2luYWwudG9FbGVtZW50IDogZnJvbUVsZW1l
bnQ7CgkJCX0KCgkJCS8vIEFkZCB3aGljaCBmb3IgY2xpY2s6IDEgPT09IGxlZnQ7
IDIgPT09IG1pZGRsZTsgMyA9PT0gcmlnaHQKCQkJLy8gTm90ZTogYnV0dG9uIGlz
IG5vdCBub3JtYWxpemVkLCBzbyBkb24ndCB1c2UgaXQKCQkJaWYgKCAhZXZlbnQu
d2hpY2ggJiYgYnV0dG9uICE9PSB1bmRlZmluZWQgKSB7CgkJCQlldmVudC53aGlj
aCA9ICggYnV0dG9uICYgMSA/IDEgOiAoIGJ1dHRvbiAmIDIgPyAzIDogKCBidXR0
b24gJiA0ID8gMiA6IDAgKSApICk7CgkJCX0KCgkJCXJldHVybiBldmVudDsKCQl9
Cgl9LAoKCWZpeDogZnVuY3Rpb24oIGV2ZW50ICkgewoJCWlmICggZXZlbnRbIGpR
dWVyeS5leHBhbmRvIF0gKSB7CgkJCXJldHVybiBldmVudDsKCQl9CgoJCS8vIENy
ZWF0ZSBhIHdyaXRhYmxlIGNvcHkgb2YgdGhlIGV2ZW50IG9iamVjdCBhbmQgbm9y
bWFsaXplIHNvbWUgcHJvcGVydGllcwoJCXZhciBpLCBwcm9wLAoJCQlvcmlnaW5h
bEV2ZW50ID0gZXZlbnQsCgkJCWZpeEhvb2sgPSBqUXVlcnkuZXZlbnQuZml4SG9v
a3NbIGV2ZW50LnR5cGUgXSB8fCB7fSwKCQkJY29weSA9IGZpeEhvb2sucHJvcHMg
PyB0aGlzLnByb3BzLmNvbmNhdCggZml4SG9vay5wcm9wcyApIDogdGhpcy5wcm9w
czsKCgkJZXZlbnQgPSBqUXVlcnkuRXZlbnQoIG9yaWdpbmFsRXZlbnQgKTsKCgkJ
Zm9yICggaSA9IGNvcHkubGVuZ3RoOyBpOyApIHsKCQkJcHJvcCA9IGNvcHlbIC0t
aSBdOwoJCQlldmVudFsgcHJvcCBdID0gb3JpZ2luYWxFdmVudFsgcHJvcCBdOwoJ
CX0KCgkJLy8gRml4IHRhcmdldCBwcm9wZXJ0eSwgaWYgbmVjZXNzYXJ5ICgjMTky
NSwgSUUgNi83LzggJiBTYWZhcmkyKQoJCWlmICggIWV2ZW50LnRhcmdldCApIHsK
CQkJZXZlbnQudGFyZ2V0ID0gb3JpZ2luYWxFdmVudC5zcmNFbGVtZW50IHx8IGRv
Y3VtZW50OwoJCX0KCgkJLy8gVGFyZ2V0IHNob3VsZCBub3QgYmUgYSB0ZXh0IG5v
ZGUgKCM1MDQsIFNhZmFyaSkKCQlpZiAoIGV2ZW50LnRhcmdldC5ub2RlVHlwZSA9
PT0gMyApIHsKCQkJZXZlbnQudGFyZ2V0ID0gZXZlbnQudGFyZ2V0LnBhcmVudE5v
ZGU7CgkJfQoKCQkvLyBGb3IgbW91c2Uva2V5IGV2ZW50czsgYWRkIG1ldGFLZXkg
aWYgaXQncyBub3QgdGhlcmUgKCMzMzY4LCBJRTYvNy84KQoJCWlmICggZXZlbnQu
bWV0YUtleSA9PT0gdW5kZWZpbmVkICkgewoJCQlldmVudC5tZXRhS2V5ID0gZXZl
bnQuY3RybEtleTsKCQl9CgoJCXJldHVybiBmaXhIb29rLmZpbHRlcj8gZml4SG9v
ay5maWx0ZXIoIGV2ZW50LCBvcmlnaW5hbEV2ZW50ICkgOiBldmVudDsKCX0sCgoJ
c3BlY2lhbDogewoJCXJlYWR5OiB7CgkJCS8vIE1ha2Ugc3VyZSB0aGUgcmVhZHkg
ZXZlbnQgaXMgc2V0dXAKCQkJc2V0dXA6IGpRdWVyeS5iaW5kUmVhZHkKCQl9LAoK
CQlsb2FkOiB7CgkJCS8vIFByZXZlbnQgdHJpZ2dlcmVkIGltYWdlLmxvYWQgZXZl
bnRzIGZyb20gYnViYmxpbmcgdG8gd2luZG93LmxvYWQKCQkJbm9CdWJibGU6IHRy
dWUKCQl9LAoKCQlmb2N1czogewoJCQlkZWxlZ2F0ZVR5cGU6ICJmb2N1c2luIgoJ
CX0sCgkJYmx1cjogewoJCQlkZWxlZ2F0ZVR5cGU6ICJmb2N1c291dCIKCQl9LAoK
CQliZWZvcmV1bmxvYWQ6IHsKCQkJc2V0dXA6IGZ1bmN0aW9uKCBkYXRhLCBuYW1l
c3BhY2VzLCBldmVudEhhbmRsZSApIHsKCQkJCS8vIFdlIG9ubHkgd2FudCB0byBk
byB0aGlzIHNwZWNpYWwgY2FzZSBvbiB3aW5kb3dzCgkJCQlpZiAoIGpRdWVyeS5p
c1dpbmRvdyggdGhpcyApICkgewoJCQkJCXRoaXMub25iZWZvcmV1bmxvYWQgPSBl
dmVudEhhbmRsZTsKCQkJCX0KCQkJfSwKCgkJCXRlYXJkb3duOiBmdW5jdGlvbigg
bmFtZXNwYWNlcywgZXZlbnRIYW5kbGUgKSB7CgkJCQlpZiAoIHRoaXMub25iZWZv
cmV1bmxvYWQgPT09IGV2ZW50SGFuZGxlICkgewoJCQkJCXRoaXMub25iZWZvcmV1
bmxvYWQgPSBudWxsOwoJCQkJfQoJCQl9CgkJfQoJfSwKCglzaW11bGF0ZTogZnVu
Y3Rpb24oIHR5cGUsIGVsZW0sIGV2ZW50LCBidWJibGUgKSB7CgkJLy8gUGlnZ3li
YWNrIG9uIGEgZG9ub3IgZXZlbnQgdG8gc2ltdWxhdGUgYSBkaWZmZXJlbnQgb25l
LgoJCS8vIEZha2Ugb3JpZ2luYWxFdmVudCB0byBhdm9pZCBkb25vcidzIHN0b3BQ
cm9wYWdhdGlvbiwgYnV0IGlmIHRoZQoJCS8vIHNpbXVsYXRlZCBldmVudCBwcmV2
ZW50cyBkZWZhdWx0IHRoZW4gd2UgZG8gdGhlIHNhbWUgb24gdGhlIGRvbm9yLgoJ
CXZhciBlID0galF1ZXJ5LmV4dGVuZCgKCQkJbmV3IGpRdWVyeS5FdmVudCgpLAoJ
CQlldmVudCwKCQkJeyB0eXBlOiB0eXBlLAoJCQkJaXNTaW11bGF0ZWQ6IHRydWUs
CgkJCQlvcmlnaW5hbEV2ZW50OiB7fQoJCQl9CgkJKTsKCQlpZiAoIGJ1YmJsZSAp
IHsKCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXIoIGUsIG51bGwsIGVsZW0gKTsKCQl9
IGVsc2UgewoJCQlqUXVlcnkuZXZlbnQuZGlzcGF0Y2guY2FsbCggZWxlbSwgZSAp
OwoJCX0KCQlpZiAoIGUuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7CgkJCWV2ZW50
LnByZXZlbnREZWZhdWx0KCk7CgkJfQoJfQp9OwoKLy8gU29tZSBwbHVnaW5zIGFy
ZSB1c2luZywgYnV0IGl0J3MgdW5kb2N1bWVudGVkL2RlcHJlY2F0ZWQgYW5kIHdp
bGwgYmUgcmVtb3ZlZC4KLy8gVGhlIDEuNyBzcGVjaWFsIGV2ZW50IGludGVyZmFj
ZSBzaG91bGQgcHJvdmlkZSBhbGwgdGhlIGhvb2tzIG5lZWRlZCBub3cuCmpRdWVy
eS5ldmVudC5oYW5kbGUgPSBqUXVlcnkuZXZlbnQuZGlzcGF0Y2g7CgpqUXVlcnku
cmVtb3ZlRXZlbnQgPSBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyID8KCWZ1
bmN0aW9uKCBlbGVtLCB0eXBlLCBoYW5kbGUgKSB7CgkJaWYgKCBlbGVtLnJlbW92
ZUV2ZW50TGlzdGVuZXIgKSB7CgkJCWVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcigg
dHlwZSwgaGFuZGxlLCBmYWxzZSApOwoJCX0KCX0gOgoJZnVuY3Rpb24oIGVsZW0s
IHR5cGUsIGhhbmRsZSApIHsKCQlpZiAoIGVsZW0uZGV0YWNoRXZlbnQgKSB7CgkJ
CWVsZW0uZGV0YWNoRXZlbnQoICJvbiIgKyB0eXBlLCBoYW5kbGUgKTsKCQl9Cgl9
OwoKalF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24oIHNyYywgcHJvcHMgKSB7CgkvLyBB
bGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgdGhlICduZXcnIGtleXdvcmQKCWlm
ICggISh0aGlzIGluc3RhbmNlb2YgalF1ZXJ5LkV2ZW50KSApIHsKCQlyZXR1cm4g
bmV3IGpRdWVyeS5FdmVudCggc3JjLCBwcm9wcyApOwoJfQoKCS8vIEV2ZW50IG9i
amVjdAoJaWYgKCBzcmMgJiYgc3JjLnR5cGUgKSB7CgkJdGhpcy5vcmlnaW5hbEV2
ZW50ID0gc3JjOwoJCXRoaXMudHlwZSA9IHNyYy50eXBlOwoKCQkvLyBFdmVudHMg
YnViYmxpbmcgdXAgdGhlIGRvY3VtZW50IG1heSBoYXZlIGJlZW4gbWFya2VkIGFz
IHByZXZlbnRlZAoJCS8vIGJ5IGEgaGFuZGxlciBsb3dlciBkb3duIHRoZSB0cmVl
OyByZWZsZWN0IHRoZSBjb3JyZWN0IHZhbHVlLgoJCXRoaXMuaXNEZWZhdWx0UHJl
dmVudGVkID0gKCBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fCBzcmMucmV0dXJuVmFs
dWUgPT09IGZhbHNlIHx8CgkJCXNyYy5nZXRQcmV2ZW50RGVmYXVsdCAmJiBzcmMu
Z2V0UHJldmVudERlZmF1bHQoKSApID8gcmV0dXJuVHJ1ZSA6IHJldHVybkZhbHNl
OwoKCS8vIEV2ZW50IHR5cGUKCX0gZWxzZSB7CgkJdGhpcy50eXBlID0gc3JjOwoJ
fQoKCS8vIFB1dCBleHBsaWNpdGx5IHByb3ZpZGVkIHByb3BlcnRpZXMgb250byB0
aGUgZXZlbnQgb2JqZWN0CglpZiAoIHByb3BzICkgewoJCWpRdWVyeS5leHRlbmQo
IHRoaXMsIHByb3BzICk7Cgl9CgoJLy8gQ3JlYXRlIGEgdGltZXN0YW1wIGlmIGlu
Y29taW5nIGV2ZW50IGRvZXNuJ3QgaGF2ZSBvbmUKCXRoaXMudGltZVN0YW1wID0g
c3JjICYmIHNyYy50aW1lU3RhbXAgfHwgalF1ZXJ5Lm5vdygpOwoKCS8vIE1hcmsg
aXQgYXMgZml4ZWQKCXRoaXNbIGpRdWVyeS5leHBhbmRvIF0gPSB0cnVlOwp9OwoK
ZnVuY3Rpb24gcmV0dXJuRmFsc2UoKSB7CglyZXR1cm4gZmFsc2U7Cn0KZnVuY3Rp
b24gcmV0dXJuVHJ1ZSgpIHsKCXJldHVybiB0cnVlOwp9CgovLyBqUXVlcnkuRXZl
bnQgaXMgYmFzZWQgb24gRE9NMyBFdmVudHMgYXMgc3BlY2lmaWVkIGJ5IHRoZSBF
Q01BU2NyaXB0IExhbmd1YWdlIEJpbmRpbmcKLy8gaHR0cDovL3d3dy53My5vcmcv
VFIvMjAwMy9XRC1ET00tTGV2ZWwtMy1FdmVudHMtMjAwMzAzMzEvZWNtYS1zY3Jp
cHQtYmluZGluZy5odG1sCmpRdWVyeS5FdmVudC5wcm90b3R5cGUgPSB7CglwcmV2
ZW50RGVmYXVsdDogZnVuY3Rpb24oKSB7CgkJdGhpcy5pc0RlZmF1bHRQcmV2ZW50
ZWQgPSByZXR1cm5UcnVlOwoKCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsK
CQlpZiAoICFlICkgewoJCQlyZXR1cm47CgkJfQoKCQkvLyBpZiBwcmV2ZW50RGVm
YXVsdCBleGlzdHMgcnVuIGl0IG9uIHRoZSBvcmlnaW5hbCBldmVudAoJCWlmICgg
ZS5wcmV2ZW50RGVmYXVsdCApIHsKCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoKCQkv
LyBvdGhlcndpc2Ugc2V0IHRoZSByZXR1cm5WYWx1ZSBwcm9wZXJ0eSBvZiB0aGUg
b3JpZ2luYWwgZXZlbnQgdG8gZmFsc2UgKElFKQoJCX0gZWxzZSB7CgkJCWUucmV0
dXJuVmFsdWUgPSBmYWxzZTsKCQl9Cgl9LAoJc3RvcFByb3BhZ2F0aW9uOiBmdW5j
dGlvbigpIHsKCQl0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1
ZTsKCgkJdmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7CgkJaWYgKCAhZSApIHsK
CQkJcmV0dXJuOwoJCX0KCQkvLyBpZiBzdG9wUHJvcGFnYXRpb24gZXhpc3RzIHJ1
biBpdCBvbiB0aGUgb3JpZ2luYWwgZXZlbnQKCQlpZiAoIGUuc3RvcFByb3BhZ2F0
aW9uICkgewoJCQllLnN0b3BQcm9wYWdhdGlvbigpOwoJCX0KCQkvLyBvdGhlcndp
c2Ugc2V0IHRoZSBjYW5jZWxCdWJibGUgcHJvcGVydHkgb2YgdGhlIG9yaWdpbmFs
IGV2ZW50IHRvIHRydWUgKElFKQoJCWUuY2FuY2VsQnViYmxlID0gdHJ1ZTsKCX0s
CglzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCXRoaXMu
aXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwoJCXRo
aXMuc3RvcFByb3BhZ2F0aW9uKCk7Cgl9LAoJaXNEZWZhdWx0UHJldmVudGVkOiBy
ZXR1cm5GYWxzZSwKCWlzUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSwK
CWlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZQp9OwoK
Ly8gQ3JlYXRlIG1vdXNlZW50ZXIvbGVhdmUgZXZlbnRzIHVzaW5nIG1vdXNlb3Zl
ci9vdXQgYW5kIGV2ZW50LXRpbWUgY2hlY2tzCmpRdWVyeS5lYWNoKHsKCW1vdXNl
ZW50ZXI6ICJtb3VzZW92ZXIiLAoJbW91c2VsZWF2ZTogIm1vdXNlb3V0Igp9LCBm
dW5jdGlvbiggb3JpZywgZml4ICkgewoJalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIG9y
aWcgXSA9IHsKCQlkZWxlZ2F0ZVR5cGU6IGZpeCwKCQliaW5kVHlwZTogZml4LAoK
CQloYW5kbGU6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJdmFyIHRhcmdldCA9IHRo
aXMsCgkJCQlyZWxhdGVkID0gZXZlbnQucmVsYXRlZFRhcmdldCwKCQkJCWhhbmRs
ZU9iaiA9IGV2ZW50LmhhbmRsZU9iaiwKCQkJCXNlbGVjdG9yID0gaGFuZGxlT2Jq
LnNlbGVjdG9yLAoJCQkJcmV0OwoKCQkJLy8gRm9yIG1vdXNlbnRlci9sZWF2ZSBj
YWxsIHRoZSBoYW5kbGVyIGlmIHJlbGF0ZWQgaXMgb3V0c2lkZSB0aGUgdGFyZ2V0
LgoJCQkvLyBOQjogTm8gcmVsYXRlZFRhcmdldCBpZiB0aGUgbW91c2UgbGVmdC9l
bnRlcmVkIHRoZSBicm93c2VyIHdpbmRvdwoJCQlpZiAoICFyZWxhdGVkIHx8IChy
ZWxhdGVkICE9PSB0YXJnZXQgJiYgIWpRdWVyeS5jb250YWlucyggdGFyZ2V0LCBy
ZWxhdGVkICkpICkgewoJCQkJZXZlbnQudHlwZSA9IGhhbmRsZU9iai5vcmlnVHlw
ZTsKCQkJCXJldCA9IGhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1
bWVudHMgKTsKCQkJCWV2ZW50LnR5cGUgPSBmaXg7CgkJCX0KCQkJcmV0dXJuIHJl
dDsKCQl9Cgl9Owp9KTsKCi8vIElFIHN1Ym1pdCBkZWxlZ2F0aW9uCmlmICggIWpR
dWVyeS5zdXBwb3J0LnN1Ym1pdEJ1YmJsZXMgKSB7CgoJalF1ZXJ5LmV2ZW50LnNw
ZWNpYWwuc3VibWl0ID0gewoJCXNldHVwOiBmdW5jdGlvbigpIHsKCQkJLy8gT25s
eSBuZWVkIHRoaXMgZm9yIGRlbGVnYXRlZCBmb3JtIHN1Ym1pdCBldmVudHMKCQkJ
aWYgKCBqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJmb3JtIiApICkgewoJCQkJcmV0
dXJuIGZhbHNlOwoJCQl9CgoJCQkvLyBMYXp5LWFkZCBhIHN1Ym1pdCBoYW5kbGVy
IHdoZW4gYSBkZXNjZW5kYW50IGZvcm0gbWF5IHBvdGVudGlhbGx5IGJlIHN1Ym1p
dHRlZAoJCQlqUXVlcnkuZXZlbnQuYWRkKCB0aGlzLCAiY2xpY2suX3N1Ym1pdCBr
ZXlwcmVzcy5fc3VibWl0IiwgZnVuY3Rpb24oIGUgKSB7CgkJCQkvLyBOb2RlIG5h
bWUgY2hlY2sgYXZvaWRzIGEgVk1MLXJlbGF0ZWQgY3Jhc2ggaW4gSUUgKCM5ODA3
KQoJCQkJdmFyIGVsZW0gPSBlLnRhcmdldCwKCQkJCQlmb3JtID0galF1ZXJ5Lm5v
ZGVOYW1lKCBlbGVtLCAiaW5wdXQiICkgfHwgalF1ZXJ5Lm5vZGVOYW1lKCBlbGVt
LCAiYnV0dG9uIiApID8gZWxlbS5mb3JtIDogdW5kZWZpbmVkOwoJCQkJaWYgKCBm
b3JtICYmICFmb3JtLl9zdWJtaXRfYXR0YWNoZWQgKSB7CgkJCQkJalF1ZXJ5LmV2
ZW50LmFkZCggZm9ybSwgInN1Ym1pdC5fc3VibWl0IiwgZnVuY3Rpb24oIGV2ZW50
ICkgewoJCQkJCQlldmVudC5fc3VibWl0X2J1YmJsZSA9IHRydWU7CgkJCQkJfSk7
CgkJCQkJZm9ybS5fc3VibWl0X2F0dGFjaGVkID0gdHJ1ZTsKCQkJCX0KCQkJfSk7
CgkJCS8vIHJldHVybiB1bmRlZmluZWQgc2luY2Ugd2UgZG9uJ3QgbmVlZCBhbiBl
dmVudCBsaXN0ZW5lcgoJCX0sCgkJCgkJcG9zdERpc3BhdGNoOiBmdW5jdGlvbigg
ZXZlbnQgKSB7CgkJCS8vIElmIGZvcm0gd2FzIHN1Ym1pdHRlZCBieSB0aGUgdXNl
ciwgYnViYmxlIHRoZSBldmVudCB1cCB0aGUgdHJlZQoJCQlpZiAoIGV2ZW50Ll9z
dWJtaXRfYnViYmxlICkgewoJCQkJZGVsZXRlIGV2ZW50Ll9zdWJtaXRfYnViYmxl
OwoJCQkJaWYgKCB0aGlzLnBhcmVudE5vZGUgJiYgIWV2ZW50LmlzVHJpZ2dlciAp
IHsKCQkJCQlqUXVlcnkuZXZlbnQuc2ltdWxhdGUoICJzdWJtaXQiLCB0aGlzLnBh
cmVudE5vZGUsIGV2ZW50LCB0cnVlICk7CgkJCQl9CgkJCX0KCQl9LAoKCQl0ZWFy
ZG93bjogZnVuY3Rpb24oKSB7CgkJCS8vIE9ubHkgbmVlZCB0aGlzIGZvciBkZWxl
Z2F0ZWQgZm9ybSBzdWJtaXQgZXZlbnRzCgkJCWlmICggalF1ZXJ5Lm5vZGVOYW1l
KCB0aGlzLCAiZm9ybSIgKSApIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoKCQkJ
Ly8gUmVtb3ZlIGRlbGVnYXRlZCBoYW5kbGVyczsgY2xlYW5EYXRhIGV2ZW50dWFs
bHkgcmVhcHMgc3VibWl0IGhhbmRsZXJzIGF0dGFjaGVkIGFib3ZlCgkJCWpRdWVy
eS5ldmVudC5yZW1vdmUoIHRoaXMsICIuX3N1Ym1pdCIgKTsKCQl9Cgl9Owp9Cgov
LyBJRSBjaGFuZ2UgZGVsZWdhdGlvbiBhbmQgY2hlY2tib3gvcmFkaW8gZml4Cmlm
ICggIWpRdWVyeS5zdXBwb3J0LmNoYW5nZUJ1YmJsZXMgKSB7CgoJalF1ZXJ5LmV2
ZW50LnNwZWNpYWwuY2hhbmdlID0gewoKCQlzZXR1cDogZnVuY3Rpb24oKSB7CgoJ
CQlpZiAoIHJmb3JtRWxlbXMudGVzdCggdGhpcy5ub2RlTmFtZSApICkgewoJCQkJ
Ly8gSUUgZG9lc24ndCBmaXJlIGNoYW5nZSBvbiBhIGNoZWNrL3JhZGlvIHVudGls
IGJsdXI7IHRyaWdnZXIgaXQgb24gY2xpY2sKCQkJCS8vIGFmdGVyIGEgcHJvcGVy
dHljaGFuZ2UuIEVhdCB0aGUgYmx1ci1jaGFuZ2UgaW4gc3BlY2lhbC5jaGFuZ2Uu
aGFuZGxlLgoJCQkJLy8gVGhpcyBzdGlsbCBmaXJlcyBvbmNoYW5nZSBhIHNlY29u
ZCB0aW1lIGZvciBjaGVjay9yYWRpbyBhZnRlciBibHVyLgoJCQkJaWYgKCB0aGlz
LnR5cGUgPT09ICJjaGVja2JveCIgfHwgdGhpcy50eXBlID09PSAicmFkaW8iICkg
ewoJCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsICJwcm9wZXJ0eWNoYW5nZS5f
Y2hhbmdlIiwgZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJCQlpZiAoIGV2ZW50Lm9y
aWdpbmFsRXZlbnQucHJvcGVydHlOYW1lID09PSAiY2hlY2tlZCIgKSB7CgkJCQkJ
CQl0aGlzLl9qdXN0X2NoYW5nZWQgPSB0cnVlOwoJCQkJCQl9CgkJCQkJfSk7CgkJ
CQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImNsaWNrLl9jaGFuZ2UiLCBmdW5j
dGlvbiggZXZlbnQgKSB7CgkJCQkJCWlmICggdGhpcy5fanVzdF9jaGFuZ2VkICYm
ICFldmVudC5pc1RyaWdnZXIgKSB7CgkJCQkJCQl0aGlzLl9qdXN0X2NoYW5nZWQg
PSBmYWxzZTsKCQkJCQkJCWpRdWVyeS5ldmVudC5zaW11bGF0ZSggImNoYW5nZSIs
IHRoaXMsIGV2ZW50LCB0cnVlICk7CgkJCQkJCX0KCQkJCQl9KTsKCQkJCX0KCQkJ
CXJldHVybiBmYWxzZTsKCQkJfQoJCQkvLyBEZWxlZ2F0ZWQgZXZlbnQ7IGxhenkt
YWRkIGEgY2hhbmdlIGhhbmRsZXIgb24gZGVzY2VuZGFudCBpbnB1dHMKCQkJalF1
ZXJ5LmV2ZW50LmFkZCggdGhpcywgImJlZm9yZWFjdGl2YXRlLl9jaGFuZ2UiLCBm
dW5jdGlvbiggZSApIHsKCQkJCXZhciBlbGVtID0gZS50YXJnZXQ7CgoJCQkJaWYg
KCByZm9ybUVsZW1zLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSAmJiAhZWxlbS5fY2hh
bmdlX2F0dGFjaGVkICkgewoJCQkJCWpRdWVyeS5ldmVudC5hZGQoIGVsZW0sICJj
aGFuZ2UuX2NoYW5nZSIsIGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQkJaWYgKCB0
aGlzLnBhcmVudE5vZGUgJiYgIWV2ZW50LmlzU2ltdWxhdGVkICYmICFldmVudC5p
c1RyaWdnZXIgKSB7CgkJCQkJCQlqUXVlcnkuZXZlbnQuc2ltdWxhdGUoICJjaGFu
Z2UiLCB0aGlzLnBhcmVudE5vZGUsIGV2ZW50LCB0cnVlICk7CgkJCQkJCX0KCQkJ
CQl9KTsKCQkJCQllbGVtLl9jaGFuZ2VfYXR0YWNoZWQgPSB0cnVlOwoJCQkJfQoJ
CQl9KTsKCQl9LAoKCQloYW5kbGU6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJdmFy
IGVsZW0gPSBldmVudC50YXJnZXQ7CgoJCQkvLyBTd2FsbG93IG5hdGl2ZSBjaGFu
Z2UgZXZlbnRzIGZyb20gY2hlY2tib3gvcmFkaW8sIHdlIGFscmVhZHkgdHJpZ2dl
cmVkIHRoZW0gYWJvdmUKCQkJaWYgKCB0aGlzICE9PSBlbGVtIHx8IGV2ZW50Lmlz
U2ltdWxhdGVkIHx8IGV2ZW50LmlzVHJpZ2dlciB8fCAoZWxlbS50eXBlICE9PSAi
cmFkaW8iICYmIGVsZW0udHlwZSAhPT0gImNoZWNrYm94IikgKSB7CgkJCQlyZXR1
cm4gZXZlbnQuaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkoIHRoaXMsIGFyZ3VtZW50
cyApOwoJCQl9CgkJfSwKCgkJdGVhcmRvd246IGZ1bmN0aW9uKCkgewoJCQlqUXVl
cnkuZXZlbnQucmVtb3ZlKCB0aGlzLCAiLl9jaGFuZ2UiICk7CgoJCQlyZXR1cm4g
cmZvcm1FbGVtcy50ZXN0KCB0aGlzLm5vZGVOYW1lICk7CgkJfQoJfTsKfQoKLy8g
Q3JlYXRlICJidWJibGluZyIgZm9jdXMgYW5kIGJsdXIgZXZlbnRzCmlmICggIWpR
dWVyeS5zdXBwb3J0LmZvY3VzaW5CdWJibGVzICkgewoJalF1ZXJ5LmVhY2goeyBm
b2N1czogImZvY3VzaW4iLCBibHVyOiAiZm9jdXNvdXQiIH0sIGZ1bmN0aW9uKCBv
cmlnLCBmaXggKSB7CgoJCS8vIEF0dGFjaCBhIHNpbmdsZSBjYXB0dXJpbmcgaGFu
ZGxlciB3aGlsZSBzb21lb25lIHdhbnRzIGZvY3VzaW4vZm9jdXNvdXQKCQl2YXIg
YXR0YWNoZXMgPSAwLAoJCQloYW5kbGVyID0gZnVuY3Rpb24oIGV2ZW50ICkgewoJ
CQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCBmaXgsIGV2ZW50LnRhcmdldCwgalF1
ZXJ5LmV2ZW50LmZpeCggZXZlbnQgKSwgdHJ1ZSApOwoJCQl9OwoKCQlqUXVlcnku
ZXZlbnQuc3BlY2lhbFsgZml4IF0gPSB7CgkJCXNldHVwOiBmdW5jdGlvbigpIHsK
CQkJCWlmICggYXR0YWNoZXMrKyA9PT0gMCApIHsKCQkJCQlkb2N1bWVudC5hZGRF
dmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7CgkJCQl9CgkJCX0s
CgkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCQkJCWlmICggLS1hdHRhY2hlcyA9
PT0gMCApIHsKCQkJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCBvcmln
LCBoYW5kbGVyLCB0cnVlICk7CgkJCQl9CgkJCX0KCQl9OwoJfSk7Cn0KCmpRdWVy
eS5mbi5leHRlbmQoewoKCW9uOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBk
YXRhLCBmbiwgLypJTlRFUk5BTCovIG9uZSApIHsKCQl2YXIgb3JpZ0ZuLCB0eXBl
OwoKCQkvLyBUeXBlcyBjYW4gYmUgYSBtYXAgb2YgdHlwZXMvaGFuZGxlcnMKCQlp
ZiAoIHR5cGVvZiB0eXBlcyA9PT0gIm9iamVjdCIgKSB7CgkJCS8vICggdHlwZXMt
T2JqZWN0LCBzZWxlY3RvciwgZGF0YSApCgkJCWlmICggdHlwZW9mIHNlbGVjdG9y
ICE9PSAic3RyaW5nIiApIHsgLy8gJiYgc2VsZWN0b3IgIT0gbnVsbAoJCQkJLy8g
KCB0eXBlcy1PYmplY3QsIGRhdGEgKQoJCQkJZGF0YSA9IGRhdGEgfHwgc2VsZWN0
b3I7CgkJCQlzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQkJfQoJCQlmb3IgKCB0eXBl
IGluIHR5cGVzICkgewoJCQkJdGhpcy5vbiggdHlwZSwgc2VsZWN0b3IsIGRhdGEs
IHR5cGVzWyB0eXBlIF0sIG9uZSApOwoJCQl9CgkJCXJldHVybiB0aGlzOwoJCX0K
CgkJaWYgKCBkYXRhID09IG51bGwgJiYgZm4gPT0gbnVsbCApIHsKCQkJLy8gKCB0
eXBlcywgZm4gKQoJCQlmbiA9IHNlbGVjdG9yOwoJCQlkYXRhID0gc2VsZWN0b3Ig
PSB1bmRlZmluZWQ7CgkJfSBlbHNlIGlmICggZm4gPT0gbnVsbCApIHsKCQkJaWYg
KCB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciICkgewoJCQkJLy8gKCB0eXBl
cywgc2VsZWN0b3IsIGZuICkKCQkJCWZuID0gZGF0YTsKCQkJCWRhdGEgPSB1bmRl
ZmluZWQ7CgkJCX0gZWxzZSB7CgkJCQkvLyAoIHR5cGVzLCBkYXRhLCBmbiApCgkJ
CQlmbiA9IGRhdGE7CgkJCQlkYXRhID0gc2VsZWN0b3I7CgkJCQlzZWxlY3RvciA9
IHVuZGVmaW5lZDsKCQkJfQoJCX0KCQlpZiAoIGZuID09PSBmYWxzZSApIHsKCQkJ
Zm4gPSByZXR1cm5GYWxzZTsKCQl9IGVsc2UgaWYgKCAhZm4gKSB7CgkJCXJldHVy
biB0aGlzOwoJCX0KCgkJaWYgKCBvbmUgPT09IDEgKSB7CgkJCW9yaWdGbiA9IGZu
OwoJCQlmbiA9IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCS8vIENhbiB1c2UgYW4g
ZW1wdHkgc2V0LCBzaW5jZSBldmVudCBjb250YWlucyB0aGUgaW5mbwoJCQkJalF1
ZXJ5KCkub2ZmKCBldmVudCApOwoJCQkJcmV0dXJuIG9yaWdGbi5hcHBseSggdGhp
cywgYXJndW1lbnRzICk7CgkJCX07CgkJCS8vIFVzZSBzYW1lIGd1aWQgc28gY2Fs
bGVyIGNhbiByZW1vdmUgdXNpbmcgb3JpZ0ZuCgkJCWZuLmd1aWQgPSBvcmlnRm4u
Z3VpZCB8fCAoIG9yaWdGbi5ndWlkID0galF1ZXJ5Lmd1aWQrKyApOwoJCX0KCQly
ZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJalF1ZXJ5LmV2ZW50LmFk
ZCggdGhpcywgdHlwZXMsIGZuLCBkYXRhLCBzZWxlY3RvciApOwoJCX0pOwoJfSwK
CW9uZTogZnVuY3Rpb24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKSB7CgkJ
cmV0dXJuIHRoaXMub24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4sIDEgKTsK
CX0sCglvZmY6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGZuICkgewoJCWlm
ICggdHlwZXMgJiYgdHlwZXMucHJldmVudERlZmF1bHQgJiYgdHlwZXMuaGFuZGxl
T2JqICkgewoJCQkvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50
CgkJCXZhciBoYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7CgkJCWpRdWVyeSgg
dHlwZXMuZGVsZWdhdGVUYXJnZXQgKS5vZmYoCgkJCQloYW5kbGVPYmoubmFtZXNw
YWNlID8gaGFuZGxlT2JqLm9yaWdUeXBlICsgIi4iICsgaGFuZGxlT2JqLm5hbWVz
cGFjZSA6IGhhbmRsZU9iai5vcmlnVHlwZSwKCQkJCWhhbmRsZU9iai5zZWxlY3Rv
ciwKCQkJCWhhbmRsZU9iai5oYW5kbGVyCgkJCSk7CgkJCXJldHVybiB0aGlzOwoJ
CX0KCQlpZiAoIHR5cGVvZiB0eXBlcyA9PT0gIm9iamVjdCIgKSB7CgkJCS8vICgg
dHlwZXMtb2JqZWN0IFssIHNlbGVjdG9yXSApCgkJCWZvciAoIHZhciB0eXBlIGlu
IHR5cGVzICkgewoJCQkJdGhpcy5vZmYoIHR5cGUsIHNlbGVjdG9yLCB0eXBlc1sg
dHlwZSBdICk7CgkJCX0KCQkJcmV0dXJuIHRoaXM7CgkJfQoJCWlmICggc2VsZWN0
b3IgPT09IGZhbHNlIHx8IHR5cGVvZiBzZWxlY3RvciA9PT0gImZ1bmN0aW9uIiAp
IHsKCQkJLy8gKCB0eXBlcyBbLCBmbl0gKQoJCQlmbiA9IHNlbGVjdG9yOwoJCQlz
ZWxlY3RvciA9IHVuZGVmaW5lZDsKCQl9CgkJaWYgKCBmbiA9PT0gZmFsc2UgKSB7
CgkJCWZuID0gcmV0dXJuRmFsc2U7CgkJfQoJCXJldHVybiB0aGlzLmVhY2goZnVu
Y3Rpb24oKSB7CgkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIHRoaXMsIHR5cGVzLCBm
biwgc2VsZWN0b3IgKTsKCQl9KTsKCX0sCgoJYmluZDogZnVuY3Rpb24oIHR5cGVz
LCBkYXRhLCBmbiApIHsKCQlyZXR1cm4gdGhpcy5vbiggdHlwZXMsIG51bGwsIGRh
dGEsIGZuICk7Cgl9LAoJdW5iaW5kOiBmdW5jdGlvbiggdHlwZXMsIGZuICkgewoJ
CXJldHVybiB0aGlzLm9mZiggdHlwZXMsIG51bGwsIGZuICk7Cgl9LAoKCWxpdmU6
IGZ1bmN0aW9uKCB0eXBlcywgZGF0YSwgZm4gKSB7CgkJalF1ZXJ5KCB0aGlzLmNv
bnRleHQgKS5vbiggdHlwZXMsIHRoaXMuc2VsZWN0b3IsIGRhdGEsIGZuICk7CgkJ
cmV0dXJuIHRoaXM7Cgl9LAoJZGllOiBmdW5jdGlvbiggdHlwZXMsIGZuICkgewoJ
CWpRdWVyeSggdGhpcy5jb250ZXh0ICkub2ZmKCB0eXBlcywgdGhpcy5zZWxlY3Rv
ciB8fCAiKioiLCBmbiApOwoJCXJldHVybiB0aGlzOwoJfSwKCglkZWxlZ2F0ZTog
ZnVuY3Rpb24oIHNlbGVjdG9yLCB0eXBlcywgZGF0YSwgZm4gKSB7CgkJcmV0dXJu
IHRoaXMub24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKTsKCX0sCgl1bmRl
bGVnYXRlOiBmdW5jdGlvbiggc2VsZWN0b3IsIHR5cGVzLCBmbiApIHsKCQkvLyAo
IG5hbWVzcGFjZSApIG9yICggc2VsZWN0b3IsIHR5cGVzIFssIGZuXSApCgkJcmV0
dXJuIGFyZ3VtZW50cy5sZW5ndGggPT0gMT8gdGhpcy5vZmYoIHNlbGVjdG9yLCAi
KioiICkgOiB0aGlzLm9mZiggdHlwZXMsIHNlbGVjdG9yLCBmbiApOwoJfSwKCgl0
cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHsKCQlyZXR1cm4gdGhpcy5l
YWNoKGZ1bmN0aW9uKCkgewoJCQlqUXVlcnkuZXZlbnQudHJpZ2dlciggdHlwZSwg
ZGF0YSwgdGhpcyApOwoJCX0pOwoJfSwKCXRyaWdnZXJIYW5kbGVyOiBmdW5jdGlv
biggdHlwZSwgZGF0YSApIHsKCQlpZiAoIHRoaXNbMF0gKSB7CgkJCXJldHVybiBq
UXVlcnkuZXZlbnQudHJpZ2dlciggdHlwZSwgZGF0YSwgdGhpc1swXSwgdHJ1ZSAp
OwoJCX0KCX0sCgoJdG9nZ2xlOiBmdW5jdGlvbiggZm4gKSB7CgkJLy8gU2F2ZSBy
ZWZlcmVuY2UgdG8gYXJndW1lbnRzIGZvciBhY2Nlc3MgaW4gY2xvc3VyZQoJCXZh
ciBhcmdzID0gYXJndW1lbnRzLAoJCQlndWlkID0gZm4uZ3VpZCB8fCBqUXVlcnku
Z3VpZCsrLAoJCQlpID0gMCwKCQkJdG9nZ2xlciA9IGZ1bmN0aW9uKCBldmVudCAp
IHsKCQkJCS8vIEZpZ3VyZSBvdXQgd2hpY2ggZnVuY3Rpb24gdG8gZXhlY3V0ZQoJ
CQkJdmFyIGxhc3RUb2dnbGUgPSAoIGpRdWVyeS5fZGF0YSggdGhpcywgImxhc3RU
b2dnbGUiICsgZm4uZ3VpZCApIHx8IDAgKSAlIGk7CgkJCQlqUXVlcnkuX2RhdGEo
IHRoaXMsICJsYXN0VG9nZ2xlIiArIGZuLmd1aWQsIGxhc3RUb2dnbGUgKyAxICk7
CgoJCQkJLy8gTWFrZSBzdXJlIHRoYXQgY2xpY2tzIHN0b3AKCQkJCWV2ZW50LnBy
ZXZlbnREZWZhdWx0KCk7CgoJCQkJLy8gYW5kIGV4ZWN1dGUgdGhlIGZ1bmN0aW9u
CgkJCQlyZXR1cm4gYXJnc1sgbGFzdFRvZ2dsZSBdLmFwcGx5KCB0aGlzLCBhcmd1
bWVudHMgKSB8fCBmYWxzZTsKCQkJfTsKCgkJLy8gbGluayBhbGwgdGhlIGZ1bmN0
aW9ucywgc28gYW55IG9mIHRoZW0gY2FuIHVuYmluZCB0aGlzIGNsaWNrIGhhbmRs
ZXIKCQl0b2dnbGVyLmd1aWQgPSBndWlkOwoJCXdoaWxlICggaSA8IGFyZ3MubGVu
Z3RoICkgewoJCQlhcmdzWyBpKysgXS5ndWlkID0gZ3VpZDsKCQl9CgoJCXJldHVy
biB0aGlzLmNsaWNrKCB0b2dnbGVyICk7Cgl9LAoKCWhvdmVyOiBmdW5jdGlvbigg
Zm5PdmVyLCBmbk91dCApIHsKCQlyZXR1cm4gdGhpcy5tb3VzZWVudGVyKCBmbk92
ZXIgKS5tb3VzZWxlYXZlKCBmbk91dCB8fCBmbk92ZXIgKTsKCX0KfSk7CgpqUXVl
cnkuZWFjaCggKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNp
emUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayAiICsKCSJtb3VzZWRvd24g
bW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIg
bW91c2VsZWF2ZSAiICsKCSJjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtl
eXByZXNzIGtleXVwIGVycm9yIGNvbnRleHRtZW51Iikuc3BsaXQoIiAiKSwgZnVu
Y3Rpb24oIGksIG5hbWUgKSB7CgoJLy8gSGFuZGxlIGV2ZW50IGJpbmRpbmcKCWpR
dWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIGRhdGEsIGZuICkgewoJCWlmICgg
Zm4gPT0gbnVsbCApIHsKCQkJZm4gPSBkYXRhOwoJCQlkYXRhID0gbnVsbDsKCQl9
CgoJCXJldHVybiBhcmd1bWVudHMubGVuZ3RoID4gMCA/CgkJCXRoaXMub24oIG5h
bWUsIG51bGwsIGRhdGEsIGZuICkgOgoJCQl0aGlzLnRyaWdnZXIoIG5hbWUgKTsK
CX07CgoJaWYgKCBqUXVlcnkuYXR0ckZuICkgewoJCWpRdWVyeS5hdHRyRm5bIG5h
bWUgXSA9IHRydWU7Cgl9CgoJaWYgKCBya2V5RXZlbnQudGVzdCggbmFtZSApICkg
ewoJCWpRdWVyeS5ldmVudC5maXhIb29rc1sgbmFtZSBdID0galF1ZXJ5LmV2ZW50
LmtleUhvb2tzOwoJfQoKCWlmICggcm1vdXNlRXZlbnQudGVzdCggbmFtZSApICkg
ewoJCWpRdWVyeS5ldmVudC5maXhIb29rc1sgbmFtZSBdID0galF1ZXJ5LmV2ZW50
Lm1vdXNlSG9va3M7Cgl9Cn0pOwoKCgovKiEKICogU2l6emxlIENTUyBTZWxlY3Rv
ciBFbmdpbmUKICogIENvcHlyaWdodCAyMDExLCBUaGUgRG9qbyBGb3VuZGF0aW9u
CiAqICBSZWxlYXNlZCB1bmRlciB0aGUgTUlULCBCU0QsIGFuZCBHUEwgTGljZW5z
ZXMuCiAqICBNb3JlIGluZm9ybWF0aW9uOiBodHRwOi8vc2l6emxlanMuY29tLwog
Ki8KKGZ1bmN0aW9uKCl7Cgp2YXIgY2h1bmtlciA9IC8oKD86XCgoPzpcKFteKCld
K1wpfFteKCldKykrXCl8XFsoPzpcW1teXFtcXV0qXF18WyciXVteJyJdKlsnIl18
W15cW1xdJyJdKykrXF18XFwufFteID4rfiwoXFtcXF0rKSt8Wz4rfl0pKFxzKixc
cyopPygoPzoufFxyfFxuKSopL2csCglleHBhbmRvID0gInNpemNhY2hlIiArIChN
YXRoLnJhbmRvbSgpICsgJycpLnJlcGxhY2UoJy4nLCAnJyksCglkb25lID0gMCwK
CXRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKCWhhc0R1cGxp
Y2F0ZSA9IGZhbHNlLAoJYmFzZUhhc0R1cGxpY2F0ZSA9IHRydWUsCglyQmFja3Ns
YXNoID0gL1xcL2csCglyUmV0dXJuID0gL1xyXG4vZywKCXJOb25Xb3JkID0gL1xX
LzsKCi8vIEhlcmUgd2UgY2hlY2sgaWYgdGhlIEphdmFTY3JpcHQgZW5naW5lIGlz
IHVzaW5nIHNvbWUgc29ydCBvZgovLyBvcHRpbWl6YXRpb24gd2hlcmUgaXQgZG9l
cyBub3QgYWx3YXlzIGNhbGwgb3VyIGNvbXBhcmlzaW9uCi8vIGZ1bmN0aW9uLiBJ
ZiB0aGF0IGlzIHRoZSBjYXNlLCBkaXNjYXJkIHRoZSBoYXNEdXBsaWNhdGUgdmFs
dWUuCi8vICAgVGh1cyBmYXIgdGhhdCBpbmNsdWRlcyBHb29nbGUgQ2hyb21lLgpb
MCwgMF0uc29ydChmdW5jdGlvbigpIHsKCWJhc2VIYXNEdXBsaWNhdGUgPSBmYWxz
ZTsKCXJldHVybiAwOwp9KTsKCnZhciBTaXp6bGUgPSBmdW5jdGlvbiggc2VsZWN0
b3IsIGNvbnRleHQsIHJlc3VsdHMsIHNlZWQgKSB7CglyZXN1bHRzID0gcmVzdWx0
cyB8fCBbXTsKCWNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50OwoKCXZhciBv
cmlnQ29udGV4dCA9IGNvbnRleHQ7CgoJaWYgKCBjb250ZXh0Lm5vZGVUeXBlICE9
PSAxICYmIGNvbnRleHQubm9kZVR5cGUgIT09IDkgKSB7CgkJcmV0dXJuIFtdOwoJ
fQoKCWlmICggIXNlbGVjdG9yIHx8IHR5cGVvZiBzZWxlY3RvciAhPT0gInN0cmlu
ZyIgKSB7CgkJcmV0dXJuIHJlc3VsdHM7Cgl9CgoJdmFyIG0sIHNldCwgY2hlY2tT
ZXQsIGV4dHJhLCByZXQsIGN1ciwgcG9wLCBpLAoJCXBydW5lID0gdHJ1ZSwKCQlj
b250ZXh0WE1MID0gU2l6emxlLmlzWE1MKCBjb250ZXh0ICksCgkJcGFydHMgPSBb
XSwKCQlzb0ZhciA9IHNlbGVjdG9yOwoKCS8vIFJlc2V0IHRoZSBwb3NpdGlvbiBv
ZiB0aGUgY2h1bmtlciByZWdleHAgKHN0YXJ0IGZyb20gaGVhZCkKCWRvIHsKCQlj
aHVua2VyLmV4ZWMoICIiICk7CgkJbSA9IGNodW5rZXIuZXhlYyggc29GYXIgKTsK
CgkJaWYgKCBtICkgewoJCQlzb0ZhciA9IG1bM107CgoJCQlwYXJ0cy5wdXNoKCBt
WzFdICk7CgoJCQlpZiAoIG1bMl0gKSB7CgkJCQlleHRyYSA9IG1bM107CgkJCQli
cmVhazsKCQkJfQoJCX0KCX0gd2hpbGUgKCBtICk7CgoJaWYgKCBwYXJ0cy5sZW5n
dGggPiAxICYmIG9yaWdQT1MuZXhlYyggc2VsZWN0b3IgKSApIHsKCgkJaWYgKCBw
YXJ0cy5sZW5ndGggPT09IDIgJiYgRXhwci5yZWxhdGl2ZVsgcGFydHNbMF0gXSAp
IHsKCQkJc2V0ID0gcG9zUHJvY2VzcyggcGFydHNbMF0gKyBwYXJ0c1sxXSwgY29u
dGV4dCwgc2VlZCApOwoKCQl9IGVsc2UgewoJCQlzZXQgPSBFeHByLnJlbGF0aXZl
WyBwYXJ0c1swXSBdID8KCQkJCVsgY29udGV4dCBdIDoKCQkJCVNpenpsZSggcGFy
dHMuc2hpZnQoKSwgY29udGV4dCApOwoKCQkJd2hpbGUgKCBwYXJ0cy5sZW5ndGgg
KSB7CgkJCQlzZWxlY3RvciA9IHBhcnRzLnNoaWZ0KCk7CgoJCQkJaWYgKCBFeHBy
LnJlbGF0aXZlWyBzZWxlY3RvciBdICkgewoJCQkJCXNlbGVjdG9yICs9IHBhcnRz
LnNoaWZ0KCk7CgkJCQl9CgoJCQkJc2V0ID0gcG9zUHJvY2Vzcyggc2VsZWN0b3Is
IHNldCwgc2VlZCApOwoJCQl9CgkJfQoKCX0gZWxzZSB7CgkJLy8gVGFrZSBhIHNo
b3J0Y3V0IGFuZCBzZXQgdGhlIGNvbnRleHQgaWYgdGhlIHJvb3Qgc2VsZWN0b3Ig
aXMgYW4gSUQKCQkvLyAoYnV0IG5vdCBpZiBpdCdsbCBiZSBmYXN0ZXIgaWYgdGhl
IGlubmVyIHNlbGVjdG9yIGlzIGFuIElEKQoJCWlmICggIXNlZWQgJiYgcGFydHMu
bGVuZ3RoID4gMSAmJiBjb250ZXh0Lm5vZGVUeXBlID09PSA5ICYmICFjb250ZXh0
WE1MICYmCgkJCQlFeHByLm1hdGNoLklELnRlc3QocGFydHNbMF0pICYmICFFeHBy
Lm1hdGNoLklELnRlc3QocGFydHNbcGFydHMubGVuZ3RoIC0gMV0pICkgewoKCQkJ
cmV0ID0gU2l6emxlLmZpbmQoIHBhcnRzLnNoaWZ0KCksIGNvbnRleHQsIGNvbnRl
eHRYTUwgKTsKCQkJY29udGV4dCA9IHJldC5leHByID8KCQkJCVNpenpsZS5maWx0
ZXIoIHJldC5leHByLCByZXQuc2V0IClbMF0gOgoJCQkJcmV0LnNldFswXTsKCQl9
CgoJCWlmICggY29udGV4dCApIHsKCQkJcmV0ID0gc2VlZCA/CgkJCQl7IGV4cHI6
IHBhcnRzLnBvcCgpLCBzZXQ6IG1ha2VBcnJheShzZWVkKSB9IDoKCQkJCVNpenps
ZS5maW5kKCBwYXJ0cy5wb3AoKSwgcGFydHMubGVuZ3RoID09PSAxICYmIChwYXJ0
c1swXSA9PT0gIn4iIHx8IHBhcnRzWzBdID09PSAiKyIpICYmIGNvbnRleHQucGFy
ZW50Tm9kZSA/IGNvbnRleHQucGFyZW50Tm9kZSA6IGNvbnRleHQsIGNvbnRleHRY
TUwgKTsKCgkJCXNldCA9IHJldC5leHByID8KCQkJCVNpenpsZS5maWx0ZXIoIHJl
dC5leHByLCByZXQuc2V0ICkgOgoJCQkJcmV0LnNldDsKCgkJCWlmICggcGFydHMu
bGVuZ3RoID4gMCApIHsKCQkJCWNoZWNrU2V0ID0gbWFrZUFycmF5KCBzZXQgKTsK
CgkJCX0gZWxzZSB7CgkJCQlwcnVuZSA9IGZhbHNlOwoJCQl9CgoJCQl3aGlsZSAo
IHBhcnRzLmxlbmd0aCApIHsKCQkJCWN1ciA9IHBhcnRzLnBvcCgpOwoJCQkJcG9w
ID0gY3VyOwoKCQkJCWlmICggIUV4cHIucmVsYXRpdmVbIGN1ciBdICkgewoJCQkJ
CWN1ciA9ICIiOwoJCQkJfSBlbHNlIHsKCQkJCQlwb3AgPSBwYXJ0cy5wb3AoKTsK
CQkJCX0KCgkJCQlpZiAoIHBvcCA9PSBudWxsICkgewoJCQkJCXBvcCA9IGNvbnRl
eHQ7CgkJCQl9CgoJCQkJRXhwci5yZWxhdGl2ZVsgY3VyIF0oIGNoZWNrU2V0LCBw
b3AsIGNvbnRleHRYTUwgKTsKCQkJfQoKCQl9IGVsc2UgewoJCQljaGVja1NldCA9
IHBhcnRzID0gW107CgkJfQoJfQoKCWlmICggIWNoZWNrU2V0ICkgewoJCWNoZWNr
U2V0ID0gc2V0OwoJfQoKCWlmICggIWNoZWNrU2V0ICkgewoJCVNpenpsZS5lcnJv
ciggY3VyIHx8IHNlbGVjdG9yICk7Cgl9CgoJaWYgKCB0b1N0cmluZy5jYWxsKGNo
ZWNrU2V0KSA9PT0gIltvYmplY3QgQXJyYXldIiApIHsKCQlpZiAoICFwcnVuZSAp
IHsKCQkJcmVzdWx0cy5wdXNoLmFwcGx5KCByZXN1bHRzLCBjaGVja1NldCApOwoK
CQl9IGVsc2UgaWYgKCBjb250ZXh0ICYmIGNvbnRleHQubm9kZVR5cGUgPT09IDEg
KSB7CgkJCWZvciAoIGkgPSAwOyBjaGVja1NldFtpXSAhPSBudWxsOyBpKysgKSB7
CgkJCQlpZiAoIGNoZWNrU2V0W2ldICYmIChjaGVja1NldFtpXSA9PT0gdHJ1ZSB8
fCBjaGVja1NldFtpXS5ub2RlVHlwZSA9PT0gMSAmJiBTaXp6bGUuY29udGFpbnMo
Y29udGV4dCwgY2hlY2tTZXRbaV0pKSApIHsKCQkJCQlyZXN1bHRzLnB1c2goIHNl
dFtpXSApOwoJCQkJfQoJCQl9CgoJCX0gZWxzZSB7CgkJCWZvciAoIGkgPSAwOyBj
aGVja1NldFtpXSAhPSBudWxsOyBpKysgKSB7CgkJCQlpZiAoIGNoZWNrU2V0W2ld
ICYmIGNoZWNrU2V0W2ldLm5vZGVUeXBlID09PSAxICkgewoJCQkJCXJlc3VsdHMu
cHVzaCggc2V0W2ldICk7CgkJCQl9CgkJCX0KCQl9CgoJfSBlbHNlIHsKCQltYWtl
QXJyYXkoIGNoZWNrU2V0LCByZXN1bHRzICk7Cgl9CgoJaWYgKCBleHRyYSApIHsK
CQlTaXp6bGUoIGV4dHJhLCBvcmlnQ29udGV4dCwgcmVzdWx0cywgc2VlZCApOwoJ
CVNpenpsZS51bmlxdWVTb3J0KCByZXN1bHRzICk7Cgl9CgoJcmV0dXJuIHJlc3Vs
dHM7Cn07CgpTaXp6bGUudW5pcXVlU29ydCA9IGZ1bmN0aW9uKCByZXN1bHRzICkg
ewoJaWYgKCBzb3J0T3JkZXIgKSB7CgkJaGFzRHVwbGljYXRlID0gYmFzZUhhc0R1
cGxpY2F0ZTsKCQlyZXN1bHRzLnNvcnQoIHNvcnRPcmRlciApOwoKCQlpZiAoIGhh
c0R1cGxpY2F0ZSApIHsKCQkJZm9yICggdmFyIGkgPSAxOyBpIDwgcmVzdWx0cy5s
ZW5ndGg7IGkrKyApIHsKCQkJCWlmICggcmVzdWx0c1tpXSA9PT0gcmVzdWx0c1sg
aSAtIDEgXSApIHsKCQkJCQlyZXN1bHRzLnNwbGljZSggaS0tLCAxICk7CgkJCQl9
CgkJCX0KCQl9Cgl9CgoJcmV0dXJuIHJlc3VsdHM7Cn07CgpTaXp6bGUubWF0Y2hl
cyA9IGZ1bmN0aW9uKCBleHByLCBzZXQgKSB7CglyZXR1cm4gU2l6emxlKCBleHBy
LCBudWxsLCBudWxsLCBzZXQgKTsKfTsKClNpenpsZS5tYXRjaGVzU2VsZWN0b3Ig
PSBmdW5jdGlvbiggbm9kZSwgZXhwciApIHsKCXJldHVybiBTaXp6bGUoIGV4cHIs
IG51bGwsIG51bGwsIFtub2RlXSApLmxlbmd0aCA+IDA7Cn07CgpTaXp6bGUuZmlu
ZCA9IGZ1bmN0aW9uKCBleHByLCBjb250ZXh0LCBpc1hNTCApIHsKCXZhciBzZXQs
IGksIGxlbiwgbWF0Y2gsIHR5cGUsIGxlZnQ7CgoJaWYgKCAhZXhwciApIHsKCQly
ZXR1cm4gW107Cgl9CgoJZm9yICggaSA9IDAsIGxlbiA9IEV4cHIub3JkZXIubGVu
Z3RoOyBpIDwgbGVuOyBpKysgKSB7CgkJdHlwZSA9IEV4cHIub3JkZXJbaV07CgoJ
CWlmICggKG1hdGNoID0gRXhwci5sZWZ0TWF0Y2hbIHR5cGUgXS5leGVjKCBleHBy
ICkpICkgewoJCQlsZWZ0ID0gbWF0Y2hbMV07CgkJCW1hdGNoLnNwbGljZSggMSwg
MSApOwoKCQkJaWYgKCBsZWZ0LnN1YnN0ciggbGVmdC5sZW5ndGggLSAxICkgIT09
ICJcXCIgKSB7CgkJCQltYXRjaFsxXSA9IChtYXRjaFsxXSB8fCAiIikucmVwbGFj
ZSggckJhY2tzbGFzaCwgIiIgKTsKCQkJCXNldCA9IEV4cHIuZmluZFsgdHlwZSBd
KCBtYXRjaCwgY29udGV4dCwgaXNYTUwgKTsKCgkJCQlpZiAoIHNldCAhPSBudWxs
ICkgewoJCQkJCWV4cHIgPSBleHByLnJlcGxhY2UoIEV4cHIubWF0Y2hbIHR5cGUg
XSwgIiIgKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCX0KCglpZiAoICFz
ZXQgKSB7CgkJc2V0ID0gdHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05h
bWUgIT09ICJ1bmRlZmluZWQiID8KCQkJY29udGV4dC5nZXRFbGVtZW50c0J5VGFn
TmFtZSggIioiICkgOgoJCQlbXTsKCX0KCglyZXR1cm4geyBzZXQ6IHNldCwgZXhw
cjogZXhwciB9Owp9OwoKU2l6emxlLmZpbHRlciA9IGZ1bmN0aW9uKCBleHByLCBz
ZXQsIGlucGxhY2UsIG5vdCApIHsKCXZhciBtYXRjaCwgYW55Rm91bmQsCgkJdHlw
ZSwgZm91bmQsIGl0ZW0sIGZpbHRlciwgbGVmdCwKCQlpLCBwYXNzLAoJCW9sZCA9
IGV4cHIsCgkJcmVzdWx0ID0gW10sCgkJY3VyTG9vcCA9IHNldCwKCQlpc1hNTEZp
bHRlciA9IHNldCAmJiBzZXRbMF0gJiYgU2l6emxlLmlzWE1MKCBzZXRbMF0gKTsK
Cgl3aGlsZSAoIGV4cHIgJiYgc2V0Lmxlbmd0aCApIHsKCQlmb3IgKCB0eXBlIGlu
IEV4cHIuZmlsdGVyICkgewoJCQlpZiAoIChtYXRjaCA9IEV4cHIubGVmdE1hdGNo
WyB0eXBlIF0uZXhlYyggZXhwciApKSAhPSBudWxsICYmIG1hdGNoWzJdICkgewoJ
CQkJZmlsdGVyID0gRXhwci5maWx0ZXJbIHR5cGUgXTsKCQkJCWxlZnQgPSBtYXRj
aFsxXTsKCgkJCQlhbnlGb3VuZCA9IGZhbHNlOwoKCQkJCW1hdGNoLnNwbGljZSgx
LDEpOwoKCQkJCWlmICggbGVmdC5zdWJzdHIoIGxlZnQubGVuZ3RoIC0gMSApID09
PSAiXFwiICkgewoJCQkJCWNvbnRpbnVlOwoJCQkJfQoKCQkJCWlmICggY3VyTG9v
cCA9PT0gcmVzdWx0ICkgewoJCQkJCXJlc3VsdCA9IFtdOwoJCQkJfQoKCQkJCWlm
ICggRXhwci5wcmVGaWx0ZXJbIHR5cGUgXSApIHsKCQkJCQltYXRjaCA9IEV4cHIu
cHJlRmlsdGVyWyB0eXBlIF0oIG1hdGNoLCBjdXJMb29wLCBpbnBsYWNlLCByZXN1
bHQsIG5vdCwgaXNYTUxGaWx0ZXIgKTsKCgkJCQkJaWYgKCAhbWF0Y2ggKSB7CgkJ
CQkJCWFueUZvdW5kID0gZm91bmQgPSB0cnVlOwoKCQkJCQl9IGVsc2UgaWYgKCBt
YXRjaCA9PT0gdHJ1ZSApIHsKCQkJCQkJY29udGludWU7CgkJCQkJfQoJCQkJfQoK
CQkJCWlmICggbWF0Y2ggKSB7CgkJCQkJZm9yICggaSA9IDA7IChpdGVtID0gY3Vy
TG9vcFtpXSkgIT0gbnVsbDsgaSsrICkgewoJCQkJCQlpZiAoIGl0ZW0gKSB7CgkJ
CQkJCQlmb3VuZCA9IGZpbHRlciggaXRlbSwgbWF0Y2gsIGksIGN1ckxvb3AgKTsK
CQkJCQkJCXBhc3MgPSBub3QgXiBmb3VuZDsKCgkJCQkJCQlpZiAoIGlucGxhY2Ug
JiYgZm91bmQgIT0gbnVsbCApIHsKCQkJCQkJCQlpZiAoIHBhc3MgKSB7CgkJCQkJ
CQkJCWFueUZvdW5kID0gdHJ1ZTsKCgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJ
Y3VyTG9vcFtpXSA9IGZhbHNlOwoJCQkJCQkJCX0KCgkJCQkJCQl9IGVsc2UgaWYg
KCBwYXNzICkgewoJCQkJCQkJCXJlc3VsdC5wdXNoKCBpdGVtICk7CgkJCQkJCQkJ
YW55Rm91bmQgPSB0cnVlOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoK
CQkJCWlmICggZm91bmQgIT09IHVuZGVmaW5lZCApIHsKCQkJCQlpZiAoICFpbnBs
YWNlICkgewoJCQkJCQljdXJMb29wID0gcmVzdWx0OwoJCQkJCX0KCgkJCQkJZXhw
ciA9IGV4cHIucmVwbGFjZSggRXhwci5tYXRjaFsgdHlwZSBdLCAiIiApOwoKCQkJ
CQlpZiAoICFhbnlGb3VuZCApIHsKCQkJCQkJcmV0dXJuIFtdOwoJCQkJCX0KCgkJ
CQkJYnJlYWs7CgkJCQl9CgkJCX0KCQl9CgoJCS8vIEltcHJvcGVyIGV4cHJlc3Np
b24KCQlpZiAoIGV4cHIgPT09IG9sZCApIHsKCQkJaWYgKCBhbnlGb3VuZCA9PSBu
dWxsICkgewoJCQkJU2l6emxlLmVycm9yKCBleHByICk7CgoJCQl9IGVsc2UgewoJ
CQkJYnJlYWs7CgkJCX0KCQl9CgoJCW9sZCA9IGV4cHI7Cgl9CgoJcmV0dXJuIGN1
ckxvb3A7Cn07CgpTaXp6bGUuZXJyb3IgPSBmdW5jdGlvbiggbXNnICkgewoJdGhy
b3cgbmV3IEVycm9yKCAiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVz
c2lvbjogIiArIG1zZyApOwp9OwoKLyoqCiAqIFV0aWxpdHkgZnVuY3Rpb24gZm9y
IHJldHJlaXZpbmcgdGhlIHRleHQgdmFsdWUgb2YgYW4gYXJyYXkgb2YgRE9NIG5v
ZGVzCiAqIEBwYXJhbSB7QXJyYXl8RWxlbWVudH0gZWxlbQogKi8KdmFyIGdldFRl
eHQgPSBTaXp6bGUuZ2V0VGV4dCA9IGZ1bmN0aW9uKCBlbGVtICkgewogICAgdmFy
IGksIG5vZGUsCgkJbm9kZVR5cGUgPSBlbGVtLm5vZGVUeXBlLAoJCXJldCA9ICIi
OwoKCWlmICggbm9kZVR5cGUgKSB7CgkJaWYgKCBub2RlVHlwZSA9PT0gMSB8fCBu
b2RlVHlwZSA9PT0gOSB8fCBub2RlVHlwZSA9PT0gMTEgKSB7CgkJCS8vIFVzZSB0
ZXh0Q29udGVudCB8fCBpbm5lclRleHQgZm9yIGVsZW1lbnRzCgkJCWlmICggdHlw
ZW9mIGVsZW0udGV4dENvbnRlbnQgPT09ICdzdHJpbmcnICkgewoJCQkJcmV0dXJu
IGVsZW0udGV4dENvbnRlbnQ7CgkJCX0gZWxzZSBpZiAoIHR5cGVvZiBlbGVtLmlu
bmVyVGV4dCA9PT0gJ3N0cmluZycgKSB7CgkJCQkvLyBSZXBsYWNlIElFJ3MgY2Fy
cmlhZ2UgcmV0dXJucwoJCQkJcmV0dXJuIGVsZW0uaW5uZXJUZXh0LnJlcGxhY2Uo
IHJSZXR1cm4sICcnICk7CgkJCX0gZWxzZSB7CgkJCQkvLyBUcmF2ZXJzZSBpdCdz
IGNoaWxkcmVuCgkJCQlmb3IgKCBlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVt
OyBlbGVtID0gZWxlbS5uZXh0U2libGluZykgewoJCQkJCXJldCArPSBnZXRUZXh0
KCBlbGVtICk7CgkJCQl9CgkJCX0KCQl9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0g
MyB8fCBub2RlVHlwZSA9PT0gNCApIHsKCQkJcmV0dXJuIGVsZW0ubm9kZVZhbHVl
OwoJCX0KCX0gZWxzZSB7CgoJCS8vIElmIG5vIG5vZGVUeXBlLCB0aGlzIGlzIGV4
cGVjdGVkIHRvIGJlIGFuIGFycmF5CgkJZm9yICggaSA9IDA7IChub2RlID0gZWxl
bVtpXSk7IGkrKyApIHsKCQkJLy8gRG8gbm90IHRyYXZlcnNlIGNvbW1lbnQgbm9k
ZXMKCQkJaWYgKCBub2RlLm5vZGVUeXBlICE9PSA4ICkgewoJCQkJcmV0ICs9IGdl
dFRleHQoIG5vZGUgKTsKCQkJfQoJCX0KCX0KCXJldHVybiByZXQ7Cn07Cgp2YXIg
RXhwciA9IFNpenpsZS5zZWxlY3RvcnMgPSB7CglvcmRlcjogWyAiSUQiLCAiTkFN
RSIsICJUQUciIF0sCgoJbWF0Y2g6IHsKCQlJRDogLyMoKD86W1x3XHUwMGMwLVx1
RkZGRlwtXXxcXC4pKykvLAoJCUNMQVNTOiAvXC4oKD86W1x3XHUwMGMwLVx1RkZG
RlwtXXxcXC4pKykvLAoJCU5BTUU6IC9cW25hbWU9WyciXSooKD86W1x3XHUwMGMw
LVx1RkZGRlwtXXxcXC4pKylbJyJdKlxdLywKCQlBVFRSOiAvXFtccyooKD86W1x3
XHUwMGMwLVx1RkZGRlwtXXxcXC4pKylccyooPzooXFM/PSlccyooPzooWyciXSko
Lio/KVwzfCgjPyg/Oltcd1x1MDBjMC1cdUZGRkZcLV18XFwuKSopfCl8KVxzKlxd
LywKCQlUQUc6IC9eKCg/Oltcd1x1MDBjMC1cdUZGRkZcKlwtXXxcXC4pKykvLAoJ
CUNISUxEOiAvOihvbmx5fG50aHxsYXN0fGZpcnN0KS1jaGlsZCg/OlwoXHMqKGV2
ZW58b2RkfCg/OlsrXC1dP1xkK3woPzpbK1wtXT9cZCopP25ccyooPzpbK1wtXVxz
KlxkKyk/KSlccypcKSk/LywKCQlQT1M6IC86KG50aHxlcXxndHxsdHxmaXJzdHxs
YXN0fGV2ZW58b2RkKSg/OlwoKFxkKilcKSk/KD89W15cLV18JCkvLAoJCVBTRVVE
TzogLzooKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKykoPzpcKChbJyJdPyko
KD86XChbXlwpXStcKXxbXlwoXCldKikrKVwyXCkpPy8KCX0sCgoJbGVmdE1hdGNo
OiB7fSwKCglhdHRyTWFwOiB7CgkJImNsYXNzIjogImNsYXNzTmFtZSIsCgkJImZv
ciI6ICJodG1sRm9yIgoJfSwKCglhdHRySGFuZGxlOiB7CgkJaHJlZjogZnVuY3Rp
b24oIGVsZW0gKSB7CgkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSggImhyZWYi
ICk7CgkJfSwKCQl0eXBlOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGVs
ZW0uZ2V0QXR0cmlidXRlKCAidHlwZSIgKTsKCQl9Cgl9LAoKCXJlbGF0aXZlOiB7
CgkJIisiOiBmdW5jdGlvbihjaGVja1NldCwgcGFydCl7CgkJCXZhciBpc1BhcnRT
dHIgPSB0eXBlb2YgcGFydCA9PT0gInN0cmluZyIsCgkJCQlpc1RhZyA9IGlzUGFy
dFN0ciAmJiAhck5vbldvcmQudGVzdCggcGFydCApLAoJCQkJaXNQYXJ0U3RyTm90
VGFnID0gaXNQYXJ0U3RyICYmICFpc1RhZzsKCgkJCWlmICggaXNUYWcgKSB7CgkJ
CQlwYXJ0ID0gcGFydC50b0xvd2VyQ2FzZSgpOwoJCQl9CgoJCQlmb3IgKCB2YXIg
aSA9IDAsIGwgPSBjaGVja1NldC5sZW5ndGgsIGVsZW07IGkgPCBsOyBpKysgKSB7
CgkJCQlpZiAoIChlbGVtID0gY2hlY2tTZXRbaV0pICkgewoJCQkJCXdoaWxlICgg
KGVsZW0gPSBlbGVtLnByZXZpb3VzU2libGluZykgJiYgZWxlbS5ub2RlVHlwZSAh
PT0gMSApIHt9CgoJCQkJCWNoZWNrU2V0W2ldID0gaXNQYXJ0U3RyTm90VGFnIHx8
IGVsZW0gJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBwYXJ0ID8K
CQkJCQkJZWxlbSB8fCBmYWxzZSA6CgkJCQkJCWVsZW0gPT09IHBhcnQ7CgkJCQl9
CgkJCX0KCgkJCWlmICggaXNQYXJ0U3RyTm90VGFnICkgewoJCQkJU2l6emxlLmZp
bHRlciggcGFydCwgY2hlY2tTZXQsIHRydWUgKTsKCQkJfQoJCX0sCgoJCSI+Ijog
ZnVuY3Rpb24oIGNoZWNrU2V0LCBwYXJ0ICkgewoJCQl2YXIgZWxlbSwKCQkJCWlz
UGFydFN0ciA9IHR5cGVvZiBwYXJ0ID09PSAic3RyaW5nIiwKCQkJCWkgPSAwLAoJ
CQkJbCA9IGNoZWNrU2V0Lmxlbmd0aDsKCgkJCWlmICggaXNQYXJ0U3RyICYmICFy
Tm9uV29yZC50ZXN0KCBwYXJ0ICkgKSB7CgkJCQlwYXJ0ID0gcGFydC50b0xvd2Vy
Q2FzZSgpOwoKCQkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCQkJCQllbGVtID0g
Y2hlY2tTZXRbaV07CgoJCQkJCWlmICggZWxlbSApIHsKCQkJCQkJdmFyIHBhcmVu
dCA9IGVsZW0ucGFyZW50Tm9kZTsKCQkJCQkJY2hlY2tTZXRbaV0gPSBwYXJlbnQu
bm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gcGFydCA/IHBhcmVudCA6IGZhbHNl
OwoJCQkJCX0KCQkJCX0KCgkJCX0gZWxzZSB7CgkJCQlmb3IgKCA7IGkgPCBsOyBp
KysgKSB7CgkJCQkJZWxlbSA9IGNoZWNrU2V0W2ldOwoKCQkJCQlpZiAoIGVsZW0g
KSB7CgkJCQkJCWNoZWNrU2V0W2ldID0gaXNQYXJ0U3RyID8KCQkJCQkJCWVsZW0u
cGFyZW50Tm9kZSA6CgkJCQkJCQllbGVtLnBhcmVudE5vZGUgPT09IHBhcnQ7CgkJ
CQkJfQoJCQkJfQoKCQkJCWlmICggaXNQYXJ0U3RyICkgewoJCQkJCVNpenpsZS5m
aWx0ZXIoIHBhcnQsIGNoZWNrU2V0LCB0cnVlICk7CgkJCQl9CgkJCX0KCQl9LAoK
CQkiIjogZnVuY3Rpb24oY2hlY2tTZXQsIHBhcnQsIGlzWE1MKXsKCQkJdmFyIG5v
ZGVDaGVjaywKCQkJCWRvbmVOYW1lID0gZG9uZSsrLAoJCQkJY2hlY2tGbiA9IGRp
ckNoZWNrOwoKCQkJaWYgKCB0eXBlb2YgcGFydCA9PT0gInN0cmluZyIgJiYgIXJO
b25Xb3JkLnRlc3QoIHBhcnQgKSApIHsKCQkJCXBhcnQgPSBwYXJ0LnRvTG93ZXJD
YXNlKCk7CgkJCQlub2RlQ2hlY2sgPSBwYXJ0OwoJCQkJY2hlY2tGbiA9IGRpck5v
ZGVDaGVjazsKCQkJfQoKCQkJY2hlY2tGbiggInBhcmVudE5vZGUiLCBwYXJ0LCBk
b25lTmFtZSwgY2hlY2tTZXQsIG5vZGVDaGVjaywgaXNYTUwgKTsKCQl9LAoKCQki
fiI6IGZ1bmN0aW9uKCBjaGVja1NldCwgcGFydCwgaXNYTUwgKSB7CgkJCXZhciBu
b2RlQ2hlY2ssCgkJCQlkb25lTmFtZSA9IGRvbmUrKywKCQkJCWNoZWNrRm4gPSBk
aXJDaGVjazsKCgkJCWlmICggdHlwZW9mIHBhcnQgPT09ICJzdHJpbmciICYmICFy
Tm9uV29yZC50ZXN0KCBwYXJ0ICkgKSB7CgkJCQlwYXJ0ID0gcGFydC50b0xvd2Vy
Q2FzZSgpOwoJCQkJbm9kZUNoZWNrID0gcGFydDsKCQkJCWNoZWNrRm4gPSBkaXJO
b2RlQ2hlY2s7CgkJCX0KCgkJCWNoZWNrRm4oICJwcmV2aW91c1NpYmxpbmciLCBw
YXJ0LCBkb25lTmFtZSwgY2hlY2tTZXQsIG5vZGVDaGVjaywgaXNYTUwgKTsKCQl9
Cgl9LAoKCWZpbmQ6IHsKCQlJRDogZnVuY3Rpb24oIG1hdGNoLCBjb250ZXh0LCBp
c1hNTCApIHsKCQkJaWYgKCB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCAh
PT0gInVuZGVmaW5lZCIgJiYgIWlzWE1MICkgewoJCQkJdmFyIG0gPSBjb250ZXh0
LmdldEVsZW1lbnRCeUlkKG1hdGNoWzFdKTsKCQkJCS8vIENoZWNrIHBhcmVudE5v
ZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zCgkJCQkvLyBu
b2RlcyB0aGF0IGFyZSBubyBsb25nZXIgaW4gdGhlIGRvY3VtZW50ICM2OTYzCgkJ
CQlyZXR1cm4gbSAmJiBtLnBhcmVudE5vZGUgPyBbbV0gOiBbXTsKCQkJfQoJCX0s
CgoJCU5BTUU6IGZ1bmN0aW9uKCBtYXRjaCwgY29udGV4dCApIHsKCQkJaWYgKCB0
eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5TmFtZSAhPT0gInVuZGVmaW5lZCIg
KSB7CgkJCQl2YXIgcmV0ID0gW10sCgkJCQkJcmVzdWx0cyA9IGNvbnRleHQuZ2V0
RWxlbWVudHNCeU5hbWUoIG1hdGNoWzFdICk7CgoJCQkJZm9yICggdmFyIGkgPSAw
LCBsID0gcmVzdWx0cy5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJCQkJaWYgKCBy
ZXN1bHRzW2ldLmdldEF0dHJpYnV0ZSgibmFtZSIpID09PSBtYXRjaFsxXSApIHsK
CQkJCQkJcmV0LnB1c2goIHJlc3VsdHNbaV0gKTsKCQkJCQl9CgkJCQl9CgoJCQkJ
cmV0dXJuIHJldC5sZW5ndGggPT09IDAgPyBudWxsIDogcmV0OwoJCQl9CgkJfSwK
CgkJVEFHOiBmdW5jdGlvbiggbWF0Y2gsIGNvbnRleHQgKSB7CgkJCWlmICggdHlw
ZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09ICJ1bmRlZmluZWQi
ICkgewoJCQkJcmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIG1h
dGNoWzFdICk7CgkJCX0KCQl9Cgl9LAoJcHJlRmlsdGVyOiB7CgkJQ0xBU1M6IGZ1
bmN0aW9uKCBtYXRjaCwgY3VyTG9vcCwgaW5wbGFjZSwgcmVzdWx0LCBub3QsIGlz
WE1MICkgewoJCQltYXRjaCA9ICIgIiArIG1hdGNoWzFdLnJlcGxhY2UoIHJCYWNr
c2xhc2gsICIiICkgKyAiICI7CgoJCQlpZiAoIGlzWE1MICkgewoJCQkJcmV0dXJu
IG1hdGNoOwoJCQl9CgoJCQlmb3IgKCB2YXIgaSA9IDAsIGVsZW07IChlbGVtID0g
Y3VyTG9vcFtpXSkgIT0gbnVsbDsgaSsrICkgewoJCQkJaWYgKCBlbGVtICkgewoJ
CQkJCWlmICggbm90IF4gKGVsZW0uY2xhc3NOYW1lICYmICgiICIgKyBlbGVtLmNs
YXNzTmFtZSArICIgIikucmVwbGFjZSgvW1x0XG5ccl0vZywgIiAiKS5pbmRleE9m
KG1hdGNoKSA+PSAwKSApIHsKCQkJCQkJaWYgKCAhaW5wbGFjZSApIHsKCQkJCQkJ
CXJlc3VsdC5wdXNoKCBlbGVtICk7CgkJCQkJCX0KCgkJCQkJfSBlbHNlIGlmICgg
aW5wbGFjZSApIHsKCQkJCQkJY3VyTG9vcFtpXSA9IGZhbHNlOwoJCQkJCX0KCQkJ
CX0KCQkJfQoKCQkJcmV0dXJuIGZhbHNlOwoJCX0sCgoJCUlEOiBmdW5jdGlvbigg
bWF0Y2ggKSB7CgkJCXJldHVybiBtYXRjaFsxXS5yZXBsYWNlKCByQmFja3NsYXNo
LCAiIiApOwoJCX0sCgoJCVRBRzogZnVuY3Rpb24oIG1hdGNoLCBjdXJMb29wICkg
ewoJCQlyZXR1cm4gbWF0Y2hbMV0ucmVwbGFjZSggckJhY2tzbGFzaCwgIiIgKS50
b0xvd2VyQ2FzZSgpOwoJCX0sCgoJCUNISUxEOiBmdW5jdGlvbiggbWF0Y2ggKSB7
CgkJCWlmICggbWF0Y2hbMV0gPT09ICJudGgiICkgewoJCQkJaWYgKCAhbWF0Y2hb
Ml0gKSB7CgkJCQkJU2l6emxlLmVycm9yKCBtYXRjaFswXSApOwoJCQkJfQoKCQkJ
CW1hdGNoWzJdID0gbWF0Y2hbMl0ucmVwbGFjZSgvXlwrfFxzKi9nLCAnJyk7CgoJ
CQkJLy8gcGFyc2UgZXF1YXRpb25zIGxpa2UgJ2V2ZW4nLCAnb2RkJywgJzUnLCAn
Mm4nLCAnM24rMicsICc0bi0xJywgJy1uKzYnCgkJCQl2YXIgdGVzdCA9IC8oLT8p
KFxkKikoPzpuKFsrXC1dP1xkKikpPy8uZXhlYygKCQkJCQltYXRjaFsyXSA9PT0g
ImV2ZW4iICYmICIybiIgfHwgbWF0Y2hbMl0gPT09ICJvZGQiICYmICIybisxIiB8
fAoJCQkJCSEvXEQvLnRlc3QoIG1hdGNoWzJdICkgJiYgIjBuKyIgKyBtYXRjaFsy
XSB8fCBtYXRjaFsyXSk7CgoJCQkJLy8gY2FsY3VsYXRlIHRoZSBudW1iZXJzIChm
aXJzdCluKyhsYXN0KSBpbmNsdWRpbmcgaWYgdGhleSBhcmUgbmVnYXRpdmUKCQkJ
CW1hdGNoWzJdID0gKHRlc3RbMV0gKyAodGVzdFsyXSB8fCAxKSkgLSAwOwoJCQkJ
bWF0Y2hbM10gPSB0ZXN0WzNdIC0gMDsKCQkJfQoJCQllbHNlIGlmICggbWF0Y2hb
Ml0gKSB7CgkJCQlTaXp6bGUuZXJyb3IoIG1hdGNoWzBdICk7CgkJCX0KCgkJCS8v
IFRPRE86IE1vdmUgdG8gbm9ybWFsIGNhY2hpbmcgc3lzdGVtCgkJCW1hdGNoWzBd
ID0gZG9uZSsrOwoKCQkJcmV0dXJuIG1hdGNoOwoJCX0sCgoJCUFUVFI6IGZ1bmN0
aW9uKCBtYXRjaCwgY3VyTG9vcCwgaW5wbGFjZSwgcmVzdWx0LCBub3QsIGlzWE1M
ICkgewoJCQl2YXIgbmFtZSA9IG1hdGNoWzFdID0gbWF0Y2hbMV0ucmVwbGFjZSgg
ckJhY2tzbGFzaCwgIiIgKTsKCgkJCWlmICggIWlzWE1MICYmIEV4cHIuYXR0ck1h
cFtuYW1lXSApIHsKCQkJCW1hdGNoWzFdID0gRXhwci5hdHRyTWFwW25hbWVdOwoJ
CQl9CgoJCQkvLyBIYW5kbGUgaWYgYW4gdW4tcXVvdGVkIHZhbHVlIHdhcyB1c2Vk
CgkJCW1hdGNoWzRdID0gKCBtYXRjaFs0XSB8fCBtYXRjaFs1XSB8fCAiIiApLnJl
cGxhY2UoIHJCYWNrc2xhc2gsICIiICk7CgoJCQlpZiAoIG1hdGNoWzJdID09PSAi
fj0iICkgewoJCQkJbWF0Y2hbNF0gPSAiICIgKyBtYXRjaFs0XSArICIgIjsKCQkJ
fQoKCQkJcmV0dXJuIG1hdGNoOwoJCX0sCgoJCVBTRVVETzogZnVuY3Rpb24oIG1h
dGNoLCBjdXJMb29wLCBpbnBsYWNlLCByZXN1bHQsIG5vdCApIHsKCQkJaWYgKCBt
YXRjaFsxXSA9PT0gIm5vdCIgKSB7CgkJCQkvLyBJZiB3ZSdyZSBkZWFsaW5nIHdp
dGggYSBjb21wbGV4IGV4cHJlc3Npb24sIG9yIGEgc2ltcGxlIG9uZQoJCQkJaWYg
KCAoIGNodW5rZXIuZXhlYyhtYXRjaFszXSkgfHwgIiIgKS5sZW5ndGggPiAxIHx8
IC9eXHcvLnRlc3QobWF0Y2hbM10pICkgewoJCQkJCW1hdGNoWzNdID0gU2l6emxl
KG1hdGNoWzNdLCBudWxsLCBudWxsLCBjdXJMb29wKTsKCgkJCQl9IGVsc2UgewoJ
CQkJCXZhciByZXQgPSBTaXp6bGUuZmlsdGVyKG1hdGNoWzNdLCBjdXJMb29wLCBp
bnBsYWNlLCB0cnVlIF4gbm90KTsKCgkJCQkJaWYgKCAhaW5wbGFjZSApIHsKCQkJ
CQkJcmVzdWx0LnB1c2guYXBwbHkoIHJlc3VsdCwgcmV0ICk7CgkJCQkJfQoKCQkJ
CQlyZXR1cm4gZmFsc2U7CgkJCQl9CgoJCQl9IGVsc2UgaWYgKCBFeHByLm1hdGNo
LlBPUy50ZXN0KCBtYXRjaFswXSApIHx8IEV4cHIubWF0Y2guQ0hJTEQudGVzdCgg
bWF0Y2hbMF0gKSApIHsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgoJCQlyZXR1cm4g
bWF0Y2g7CgkJfSwKCgkJUE9TOiBmdW5jdGlvbiggbWF0Y2ggKSB7CgkJCW1hdGNo
LnVuc2hpZnQoIHRydWUgKTsKCgkJCXJldHVybiBtYXRjaDsKCQl9Cgl9LAoKCWZp
bHRlcnM6IHsKCQllbmFibGVkOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJu
IGVsZW0uZGlzYWJsZWQgPT09IGZhbHNlICYmIGVsZW0udHlwZSAhPT0gImhpZGRl
biI7CgkJfSwKCgkJZGlzYWJsZWQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1
cm4gZWxlbS5kaXNhYmxlZCA9PT0gdHJ1ZTsKCQl9LAoKCQljaGVja2VkOiBmdW5j
dGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGVsZW0uY2hlY2tlZCA9PT0gdHJ1ZTsK
CQl9LAoKCQlzZWxlY3RlZDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCS8vIEFjY2Vz
c2luZyB0aGlzIHByb3BlcnR5IG1ha2VzIHNlbGVjdGVkLWJ5LWRlZmF1bHQKCQkJ
Ly8gb3B0aW9ucyBpbiBTYWZhcmkgd29yayBwcm9wZXJseQoJCQlpZiAoIGVsZW0u
cGFyZW50Tm9kZSApIHsKCQkJCWVsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4
OwoJCQl9CgoJCQlyZXR1cm4gZWxlbS5zZWxlY3RlZCA9PT0gdHJ1ZTsKCQl9LAoK
CQlwYXJlbnQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gISFlbGVtLmZp
cnN0Q2hpbGQ7CgkJfSwKCgkJZW1wdHk6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQly
ZXR1cm4gIWVsZW0uZmlyc3RDaGlsZDsKCQl9LAoKCQloYXM6IGZ1bmN0aW9uKCBl
bGVtLCBpLCBtYXRjaCApIHsKCQkJcmV0dXJuICEhU2l6emxlKCBtYXRjaFszXSwg
ZWxlbSApLmxlbmd0aDsKCQl9LAoKCQloZWFkZXI6IGZ1bmN0aW9uKCBlbGVtICkg
ewoJCQlyZXR1cm4gKC9oXGQvaSkudGVzdCggZWxlbS5ub2RlTmFtZSApOwoJCX0s
CgoJCXRleHQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQl2YXIgYXR0ciA9IGVsZW0u
Z2V0QXR0cmlidXRlKCAidHlwZSIgKSwgdHlwZSA9IGVsZW0udHlwZTsKCQkJLy8g
SUU2IGFuZCA3IHdpbGwgbWFwIGVsZW0udHlwZSB0byAndGV4dCcgZm9yIG5ldyBI
VE1MNSB0eXBlcyAoc2VhcmNoLCBldGMpCgkJCS8vIHVzZSBnZXRBdHRyaWJ1dGUg
aW5zdGVhZCB0byB0ZXN0IHRoaXMgY2FzZQoJCQlyZXR1cm4gZWxlbS5ub2RlTmFt
ZS50b0xvd2VyQ2FzZSgpID09PSAiaW5wdXQiICYmICJ0ZXh0IiA9PT0gdHlwZSAm
JiAoIGF0dHIgPT09IHR5cGUgfHwgYXR0ciA9PT0gbnVsbCApOwoJCX0sCgoJCXJh
ZGlvOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUu
dG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiAmJiAicmFkaW8iID09PSBlbGVtLnR5
cGU7CgkJfSwKCgkJY2hlY2tib3g6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1
cm4gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiaW5wdXQiICYmICJj
aGVja2JveCIgPT09IGVsZW0udHlwZTsKCQl9LAoKCQlmaWxlOiBmdW5jdGlvbigg
ZWxlbSApIHsKCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9
PT0gImlucHV0IiAmJiAiZmlsZSIgPT09IGVsZW0udHlwZTsKCQl9LAoKCQlwYXNz
d29yZDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBlbGVtLm5vZGVOYW1l
LnRvTG93ZXJDYXNlKCkgPT09ICJpbnB1dCIgJiYgInBhc3N3b3JkIiA9PT0gZWxl
bS50eXBlOwoJCX0sCgoJCXN1Ym1pdDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZh
ciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4g
KG5hbWUgPT09ICJpbnB1dCIgfHwgbmFtZSA9PT0gImJ1dHRvbiIpICYmICJzdWJt
aXQiID09PSBlbGVtLnR5cGU7CgkJfSwKCgkJaW1hZ2U6IGZ1bmN0aW9uKCBlbGVt
ICkgewoJCQlyZXR1cm4gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAi
aW5wdXQiICYmICJpbWFnZSIgPT09IGVsZW0udHlwZTsKCQl9LAoKCQlyZXNldDog
ZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50
b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gKG5hbWUgPT09ICJpbnB1dCIgfHwgbmFt
ZSA9PT0gImJ1dHRvbiIpICYmICJyZXNldCIgPT09IGVsZW0udHlwZTsKCQl9LAoK
CQlidXR0b246IGZ1bmN0aW9uKCBlbGVtICkgewoJCQl2YXIgbmFtZSA9IGVsZW0u
bm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCQkJcmV0dXJuIG5hbWUgPT09ICJpbnB1
dCIgJiYgImJ1dHRvbiIgPT09IGVsZW0udHlwZSB8fCBuYW1lID09PSAiYnV0dG9u
IjsKCQl9LAoKCQlpbnB1dDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiAo
L2lucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24vaSkudGVzdCggZWxlbS5ub2Rl
TmFtZSApOwoJCX0sCgoJCWZvY3VzOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0
dXJuIGVsZW0gPT09IGVsZW0ub3duZXJEb2N1bWVudC5hY3RpdmVFbGVtZW50OwoJ
CX0KCX0sCglzZXRGaWx0ZXJzOiB7CgkJZmlyc3Q6IGZ1bmN0aW9uKCBlbGVtLCBp
ICkgewoJCQlyZXR1cm4gaSA9PT0gMDsKCQl9LAoKCQlsYXN0OiBmdW5jdGlvbigg
ZWxlbSwgaSwgbWF0Y2gsIGFycmF5ICkgewoJCQlyZXR1cm4gaSA9PT0gYXJyYXku
bGVuZ3RoIC0gMTsKCQl9LAoKCQlldmVuOiBmdW5jdGlvbiggZWxlbSwgaSApIHsK
CQkJcmV0dXJuIGkgJSAyID09PSAwOwoJCX0sCgoJCW9kZDogZnVuY3Rpb24oIGVs
ZW0sIGkgKSB7CgkJCXJldHVybiBpICUgMiA9PT0gMTsKCQl9LAoKCQlsdDogZnVu
Y3Rpb24oIGVsZW0sIGksIG1hdGNoICkgewoJCQlyZXR1cm4gaSA8IG1hdGNoWzNd
IC0gMDsKCQl9LAoKCQlndDogZnVuY3Rpb24oIGVsZW0sIGksIG1hdGNoICkgewoJ
CQlyZXR1cm4gaSA+IG1hdGNoWzNdIC0gMDsKCQl9LAoKCQludGg6IGZ1bmN0aW9u
KCBlbGVtLCBpLCBtYXRjaCApIHsKCQkJcmV0dXJuIG1hdGNoWzNdIC0gMCA9PT0g
aTsKCQl9LAoKCQllcTogZnVuY3Rpb24oIGVsZW0sIGksIG1hdGNoICkgewoJCQly
ZXR1cm4gbWF0Y2hbM10gLSAwID09PSBpOwoJCX0KCX0sCglmaWx0ZXI6IHsKCQlQ
U0VVRE86IGZ1bmN0aW9uKCBlbGVtLCBtYXRjaCwgaSwgYXJyYXkgKSB7CgkJCXZh
ciBuYW1lID0gbWF0Y2hbMV0sCgkJCQlmaWx0ZXIgPSBFeHByLmZpbHRlcnNbIG5h
bWUgXTsKCgkJCWlmICggZmlsdGVyICkgewoJCQkJcmV0dXJuIGZpbHRlciggZWxl
bSwgaSwgbWF0Y2gsIGFycmF5ICk7CgoJCQl9IGVsc2UgaWYgKCBuYW1lID09PSAi
Y29udGFpbnMiICkgewoJCQkJcmV0dXJuIChlbGVtLnRleHRDb250ZW50IHx8IGVs
ZW0uaW5uZXJUZXh0IHx8IGdldFRleHQoWyBlbGVtIF0pIHx8ICIiKS5pbmRleE9m
KG1hdGNoWzNdKSA+PSAwOwoKCQkJfSBlbHNlIGlmICggbmFtZSA9PT0gIm5vdCIg
KSB7CgkJCQl2YXIgbm90ID0gbWF0Y2hbM107CgoJCQkJZm9yICggdmFyIGogPSAw
LCBsID0gbm90Lmxlbmd0aDsgaiA8IGw7IGorKyApIHsKCQkJCQlpZiAoIG5vdFtq
XSA9PT0gZWxlbSApIHsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0K
CgkJCQlyZXR1cm4gdHJ1ZTsKCgkJCX0gZWxzZSB7CgkJCQlTaXp6bGUuZXJyb3Io
IG5hbWUgKTsKCQkJfQoJCX0sCgoJCUNISUxEOiBmdW5jdGlvbiggZWxlbSwgbWF0
Y2ggKSB7CgkJCXZhciBmaXJzdCwgbGFzdCwKCQkJCWRvbmVOYW1lLCBwYXJlbnQs
IGNhY2hlLAoJCQkJY291bnQsIGRpZmYsCgkJCQl0eXBlID0gbWF0Y2hbMV0sCgkJ
CQlub2RlID0gZWxlbTsKCgkJCXN3aXRjaCAoIHR5cGUgKSB7CgkJCQljYXNlICJv
bmx5IjoKCQkJCWNhc2UgImZpcnN0IjoKCQkJCQl3aGlsZSAoIChub2RlID0gbm9k
ZS5wcmV2aW91c1NpYmxpbmcpICkgewoJCQkJCQlpZiAoIG5vZGUubm9kZVR5cGUg
PT09IDEgKSB7CgkJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJCX0KCQkJCQl9CgoJ
CQkJCWlmICggdHlwZSA9PT0gImZpcnN0IiApIHsKCQkJCQkJcmV0dXJuIHRydWU7
CgkJCQkJfQoKCQkJCQlub2RlID0gZWxlbTsKCgkJCQkJLyogZmFsbHMgdGhyb3Vn
aCAqLwoJCQkJY2FzZSAibGFzdCI6CgkJCQkJd2hpbGUgKCAobm9kZSA9IG5vZGUu
bmV4dFNpYmxpbmcpICkgewoJCQkJCQlpZiAoIG5vZGUubm9kZVR5cGUgPT09IDEg
KSB7CgkJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCXJl
dHVybiB0cnVlOwoKCQkJCWNhc2UgIm50aCI6CgkJCQkJZmlyc3QgPSBtYXRjaFsy
XTsKCQkJCQlsYXN0ID0gbWF0Y2hbM107CgoJCQkJCWlmICggZmlyc3QgPT09IDEg
JiYgbGFzdCA9PT0gMCApIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoKCQkJ
CQlkb25lTmFtZSA9IG1hdGNoWzBdOwoJCQkJCXBhcmVudCA9IGVsZW0ucGFyZW50
Tm9kZTsKCgkJCQkJaWYgKCBwYXJlbnQgJiYgKHBhcmVudFsgZXhwYW5kbyBdICE9
PSBkb25lTmFtZSB8fCAhZWxlbS5ub2RlSW5kZXgpICkgewoJCQkJCQljb3VudCA9
IDA7CgoJCQkJCQlmb3IgKCBub2RlID0gcGFyZW50LmZpcnN0Q2hpbGQ7IG5vZGU7
IG5vZGUgPSBub2RlLm5leHRTaWJsaW5nICkgewoJCQkJCQkJaWYgKCBub2RlLm5v
ZGVUeXBlID09PSAxICkgewoJCQkJCQkJCW5vZGUubm9kZUluZGV4ID0gKytjb3Vu
dDsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJcGFyZW50WyBleHBhbmRvIF0gPSBk
b25lTmFtZTsKCQkJCQl9CgoJCQkJCWRpZmYgPSBlbGVtLm5vZGVJbmRleCAtIGxh
c3Q7CgoJCQkJCWlmICggZmlyc3QgPT09IDAgKSB7CgkJCQkJCXJldHVybiBkaWZm
ID09PSAwOwoKCQkJCQl9IGVsc2UgewoJCQkJCQlyZXR1cm4gKCBkaWZmICUgZmly
c3QgPT09IDAgJiYgZGlmZiAvIGZpcnN0ID49IDAgKTsKCQkJCQl9CgkJCX0KCQl9
LAoKCQlJRDogZnVuY3Rpb24oIGVsZW0sIG1hdGNoICkgewoJCQlyZXR1cm4gZWxl
bS5ub2RlVHlwZSA9PT0gMSAmJiBlbGVtLmdldEF0dHJpYnV0ZSgiaWQiKSA9PT0g
bWF0Y2g7CgkJfSwKCgkJVEFHOiBmdW5jdGlvbiggZWxlbSwgbWF0Y2ggKSB7CgkJ
CXJldHVybiAobWF0Y2ggPT09ICIqIiAmJiBlbGVtLm5vZGVUeXBlID09PSAxKSB8
fCAhIWVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgp
ID09PSBtYXRjaDsKCQl9LAoKCQlDTEFTUzogZnVuY3Rpb24oIGVsZW0sIG1hdGNo
ICkgewoJCQlyZXR1cm4gKCIgIiArIChlbGVtLmNsYXNzTmFtZSB8fCBlbGVtLmdl
dEF0dHJpYnV0ZSgiY2xhc3MiKSkgKyAiICIpCgkJCQkuaW5kZXhPZiggbWF0Y2gg
KSA+IC0xOwoJCX0sCgoJCUFUVFI6IGZ1bmN0aW9uKCBlbGVtLCBtYXRjaCApIHsK
CQkJdmFyIG5hbWUgPSBtYXRjaFsxXSwKCQkJCXJlc3VsdCA9IFNpenpsZS5hdHRy
ID8KCQkJCQlTaXp6bGUuYXR0ciggZWxlbSwgbmFtZSApIDoKCQkJCQlFeHByLmF0
dHJIYW5kbGVbIG5hbWUgXSA/CgkJCQkJRXhwci5hdHRySGFuZGxlWyBuYW1lIF0o
IGVsZW0gKSA6CgkJCQkJZWxlbVsgbmFtZSBdICE9IG51bGwgPwoJCQkJCQllbGVt
WyBuYW1lIF0gOgoJCQkJCQllbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApLAoJCQkJ
dmFsdWUgPSByZXN1bHQgKyAiIiwKCQkJCXR5cGUgPSBtYXRjaFsyXSwKCQkJCWNo
ZWNrID0gbWF0Y2hbNF07CgoJCQlyZXR1cm4gcmVzdWx0ID09IG51bGwgPwoJCQkJ
dHlwZSA9PT0gIiE9IiA6CgkJCQkhdHlwZSAmJiBTaXp6bGUuYXR0ciA/CgkJCQly
ZXN1bHQgIT0gbnVsbCA6CgkJCQl0eXBlID09PSAiPSIgPwoJCQkJdmFsdWUgPT09
IGNoZWNrIDoKCQkJCXR5cGUgPT09ICIqPSIgPwoJCQkJdmFsdWUuaW5kZXhPZihj
aGVjaykgPj0gMCA6CgkJCQl0eXBlID09PSAifj0iID8KCQkJCSgiICIgKyB2YWx1
ZSArICIgIikuaW5kZXhPZihjaGVjaykgPj0gMCA6CgkJCQkhY2hlY2sgPwoJCQkJ
dmFsdWUgJiYgcmVzdWx0ICE9PSBmYWxzZSA6CgkJCQl0eXBlID09PSAiIT0iID8K
CQkJCXZhbHVlICE9PSBjaGVjayA6CgkJCQl0eXBlID09PSAiXj0iID8KCQkJCXZh
bHVlLmluZGV4T2YoY2hlY2spID09PSAwIDoKCQkJCXR5cGUgPT09ICIkPSIgPwoJ
CQkJdmFsdWUuc3Vic3RyKHZhbHVlLmxlbmd0aCAtIGNoZWNrLmxlbmd0aCkgPT09
IGNoZWNrIDoKCQkJCXR5cGUgPT09ICJ8PSIgPwoJCQkJdmFsdWUgPT09IGNoZWNr
IHx8IHZhbHVlLnN1YnN0cigwLCBjaGVjay5sZW5ndGggKyAxKSA9PT0gY2hlY2sg
KyAiLSIgOgoJCQkJZmFsc2U7CgkJfSwKCgkJUE9TOiBmdW5jdGlvbiggZWxlbSwg
bWF0Y2gsIGksIGFycmF5ICkgewoJCQl2YXIgbmFtZSA9IG1hdGNoWzJdLAoJCQkJ
ZmlsdGVyID0gRXhwci5zZXRGaWx0ZXJzWyBuYW1lIF07CgoJCQlpZiAoIGZpbHRl
ciApIHsKCQkJCXJldHVybiBmaWx0ZXIoIGVsZW0sIGksIG1hdGNoLCBhcnJheSAp
OwoJCQl9CgkJfQoJfQp9OwoKdmFyIG9yaWdQT1MgPSBFeHByLm1hdGNoLlBPUywK
CWZlc2NhcGUgPSBmdW5jdGlvbihhbGwsIG51bSl7CgkJcmV0dXJuICJcXCIgKyAo
bnVtIC0gMCArIDEpOwoJfTsKCmZvciAoIHZhciB0eXBlIGluIEV4cHIubWF0Y2gg
KSB7CglFeHByLm1hdGNoWyB0eXBlIF0gPSBuZXcgUmVnRXhwKCBFeHByLm1hdGNo
WyB0eXBlIF0uc291cmNlICsgKC8oPyFbXlxbXSpcXSkoPyFbXlwoXSpcKSkvLnNv
dXJjZSkgKTsKCUV4cHIubGVmdE1hdGNoWyB0eXBlIF0gPSBuZXcgUmVnRXhwKCAv
KF4oPzoufFxyfFxuKSo/KS8uc291cmNlICsgRXhwci5tYXRjaFsgdHlwZSBdLnNv
dXJjZS5yZXBsYWNlKC9cXChcZCspL2csIGZlc2NhcGUpICk7Cn0KLy8gRXhwb3Nl
IG9yaWdQT1MKLy8gImdsb2JhbCIgYXMgaW4gcmVnYXJkbGVzcyBvZiByZWxhdGlv
biB0byBicmFja2V0cy9wYXJlbnMKRXhwci5tYXRjaC5nbG9iYWxQT1MgPSBvcmln
UE9TOwoKdmFyIG1ha2VBcnJheSA9IGZ1bmN0aW9uKCBhcnJheSwgcmVzdWx0cyAp
IHsKCWFycmF5ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoIGFycmF5LCAw
ICk7CgoJaWYgKCByZXN1bHRzICkgewoJCXJlc3VsdHMucHVzaC5hcHBseSggcmVz
dWx0cywgYXJyYXkgKTsKCQlyZXR1cm4gcmVzdWx0czsKCX0KCglyZXR1cm4gYXJy
YXk7Cn07CgovLyBQZXJmb3JtIGEgc2ltcGxlIGNoZWNrIHRvIGRldGVybWluZSBp
ZiB0aGUgYnJvd3NlciBpcyBjYXBhYmxlIG9mCi8vIGNvbnZlcnRpbmcgYSBOb2Rl
TGlzdCB0byBhbiBhcnJheSB1c2luZyBidWlsdGluIG1ldGhvZHMuCi8vIEFsc28g
dmVyaWZpZXMgdGhhdCB0aGUgcmV0dXJuZWQgYXJyYXkgaG9sZHMgRE9NIG5vZGVz
Ci8vICh3aGljaCBpcyBub3QgdGhlIGNhc2UgaW4gdGhlIEJsYWNrYmVycnkgYnJv
d3NlcikKdHJ5IHsKCUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKCBkb2N1bWVu
dC5kb2N1bWVudEVsZW1lbnQuY2hpbGROb2RlcywgMCApWzBdLm5vZGVUeXBlOwoK
Ly8gUHJvdmlkZSBhIGZhbGxiYWNrIG1ldGhvZCBpZiBpdCBkb2VzIG5vdCB3b3Jr
Cn0gY2F0Y2goIGUgKSB7CgltYWtlQXJyYXkgPSBmdW5jdGlvbiggYXJyYXksIHJl
c3VsdHMgKSB7CgkJdmFyIGkgPSAwLAoJCQlyZXQgPSByZXN1bHRzIHx8IFtdOwoK
CQlpZiAoIHRvU3RyaW5nLmNhbGwoYXJyYXkpID09PSAiW29iamVjdCBBcnJheV0i
ICkgewoJCQlBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSggcmV0LCBhcnJheSAp
OwoKCQl9IGVsc2UgewoJCQlpZiAoIHR5cGVvZiBhcnJheS5sZW5ndGggPT09ICJu
dW1iZXIiICkgewoJCQkJZm9yICggdmFyIGwgPSBhcnJheS5sZW5ndGg7IGkgPCBs
OyBpKysgKSB7CgkJCQkJcmV0LnB1c2goIGFycmF5W2ldICk7CgkJCQl9CgoJCQl9
IGVsc2UgewoJCQkJZm9yICggOyBhcnJheVtpXTsgaSsrICkgewoJCQkJCXJldC5w
dXNoKCBhcnJheVtpXSApOwoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4gcmV0OwoJ
fTsKfQoKdmFyIHNvcnRPcmRlciwgc2libGluZ0NoZWNrOwoKaWYgKCBkb2N1bWVu
dC5kb2N1bWVudEVsZW1lbnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24gKSB7Cglz
b3J0T3JkZXIgPSBmdW5jdGlvbiggYSwgYiApIHsKCQlpZiAoIGEgPT09IGIgKSB7
CgkJCWhhc0R1cGxpY2F0ZSA9IHRydWU7CgkJCXJldHVybiAwOwoJCX0KCgkJaWYg
KCAhYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiB8fCAhYi5jb21wYXJlRG9jdW1l
bnRQb3NpdGlvbiApIHsKCQkJcmV0dXJuIGEuY29tcGFyZURvY3VtZW50UG9zaXRp
b24gPyAtMSA6IDE7CgkJfQoKCQlyZXR1cm4gYS5jb21wYXJlRG9jdW1lbnRQb3Np
dGlvbihiKSAmIDQgPyAtMSA6IDE7Cgl9OwoKfSBlbHNlIHsKCXNvcnRPcmRlciA9
IGZ1bmN0aW9uKCBhLCBiICkgewoJCS8vIFRoZSBub2RlcyBhcmUgaWRlbnRpY2Fs
LCB3ZSBjYW4gZXhpdCBlYXJseQoJCWlmICggYSA9PT0gYiApIHsKCQkJaGFzRHVw
bGljYXRlID0gdHJ1ZTsKCQkJcmV0dXJuIDA7CgoJCS8vIEZhbGxiYWNrIHRvIHVz
aW5nIHNvdXJjZUluZGV4IChpbiBJRSkgaWYgaXQncyBhdmFpbGFibGUgb24gYm90
aCBub2RlcwoJCX0gZWxzZSBpZiAoIGEuc291cmNlSW5kZXggJiYgYi5zb3VyY2VJ
bmRleCApIHsKCQkJcmV0dXJuIGEuc291cmNlSW5kZXggLSBiLnNvdXJjZUluZGV4
OwoJCX0KCgkJdmFyIGFsLCBibCwKCQkJYXAgPSBbXSwKCQkJYnAgPSBbXSwKCQkJ
YXVwID0gYS5wYXJlbnROb2RlLAoJCQlidXAgPSBiLnBhcmVudE5vZGUsCgkJCWN1
ciA9IGF1cDsKCgkJLy8gSWYgdGhlIG5vZGVzIGFyZSBzaWJsaW5ncyAob3IgaWRl
bnRpY2FsKSB3ZSBjYW4gZG8gYSBxdWljayBjaGVjawoJCWlmICggYXVwID09PSBi
dXAgKSB7CgkJCXJldHVybiBzaWJsaW5nQ2hlY2soIGEsIGIgKTsKCgkJLy8gSWYg
bm8gcGFyZW50cyB3ZXJlIGZvdW5kIHRoZW4gdGhlIG5vZGVzIGFyZSBkaXNjb25u
ZWN0ZWQKCQl9IGVsc2UgaWYgKCAhYXVwICkgewoJCQlyZXR1cm4gLTE7CgoJCX0g
ZWxzZSBpZiAoICFidXAgKSB7CgkJCXJldHVybiAxOwoJCX0KCgkJLy8gT3RoZXJ3
aXNlIHRoZXkncmUgc29tZXdoZXJlIGVsc2UgaW4gdGhlIHRyZWUgc28gd2UgbmVl
ZAoJCS8vIHRvIGJ1aWxkIHVwIGEgZnVsbCBsaXN0IG9mIHRoZSBwYXJlbnROb2Rl
cyBmb3IgY29tcGFyaXNvbgoJCXdoaWxlICggY3VyICkgewoJCQlhcC51bnNoaWZ0
KCBjdXIgKTsKCQkJY3VyID0gY3VyLnBhcmVudE5vZGU7CgkJfQoKCQljdXIgPSBi
dXA7CgoJCXdoaWxlICggY3VyICkgewoJCQlicC51bnNoaWZ0KCBjdXIgKTsKCQkJ
Y3VyID0gY3VyLnBhcmVudE5vZGU7CgkJfQoKCQlhbCA9IGFwLmxlbmd0aDsKCQli
bCA9IGJwLmxlbmd0aDsKCgkJLy8gU3RhcnQgd2Fsa2luZyBkb3duIHRoZSB0cmVl
IGxvb2tpbmcgZm9yIGEgZGlzY3JlcGFuY3kKCQlmb3IgKCB2YXIgaSA9IDA7IGkg
PCBhbCAmJiBpIDwgYmw7IGkrKyApIHsKCQkJaWYgKCBhcFtpXSAhPT0gYnBbaV0g
KSB7CgkJCQlyZXR1cm4gc2libGluZ0NoZWNrKCBhcFtpXSwgYnBbaV0gKTsKCQkJ
fQoJCX0KCgkJLy8gV2UgZW5kZWQgc29tZXBsYWNlIHVwIHRoZSB0cmVlIHNvIGRv
IGEgc2libGluZyBjaGVjawoJCXJldHVybiBpID09PSBhbCA/CgkJCXNpYmxpbmdD
aGVjayggYSwgYnBbaV0sIC0xICkgOgoJCQlzaWJsaW5nQ2hlY2soIGFwW2ldLCBi
LCAxICk7Cgl9OwoKCXNpYmxpbmdDaGVjayA9IGZ1bmN0aW9uKCBhLCBiLCByZXQg
KSB7CgkJaWYgKCBhID09PSBiICkgewoJCQlyZXR1cm4gcmV0OwoJCX0KCgkJdmFy
IGN1ciA9IGEubmV4dFNpYmxpbmc7CgoJCXdoaWxlICggY3VyICkgewoJCQlpZiAo
IGN1ciA9PT0gYiApIHsKCQkJCXJldHVybiAtMTsKCQkJfQoKCQkJY3VyID0gY3Vy
Lm5leHRTaWJsaW5nOwoJCX0KCgkJcmV0dXJuIDE7Cgl9Owp9CgovLyBDaGVjayB0
byBzZWUgaWYgdGhlIGJyb3dzZXIgcmV0dXJucyBlbGVtZW50cyBieSBuYW1lIHdo
ZW4KLy8gcXVlcnlpbmcgYnkgZ2V0RWxlbWVudEJ5SWQgKGFuZCBwcm92aWRlIGEg
d29ya2Fyb3VuZCkKKGZ1bmN0aW9uKCl7CgkvLyBXZSdyZSBnb2luZyB0byBpbmpl
Y3QgYSBmYWtlIGlucHV0IGVsZW1lbnQgd2l0aCBhIHNwZWNpZmllZCBuYW1lCgl2
YXIgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLAoJCWlkID0g
InNjcmlwdCIgKyAobmV3IERhdGUoKSkuZ2V0VGltZSgpLAoJCXJvb3QgPSBkb2N1
bWVudC5kb2N1bWVudEVsZW1lbnQ7CgoJZm9ybS5pbm5lckhUTUwgPSAiPGEgbmFt
ZT0nIiArIGlkICsgIicvPiI7CgoJLy8gSW5qZWN0IGl0IGludG8gdGhlIHJvb3Qg
ZWxlbWVudCwgY2hlY2sgaXRzIHN0YXR1cywgYW5kIHJlbW92ZSBpdCBxdWlja2x5
Cglyb290Lmluc2VydEJlZm9yZSggZm9ybSwgcm9vdC5maXJzdENoaWxkICk7CgoJ
Ly8gVGhlIHdvcmthcm91bmQgaGFzIHRvIGRvIGFkZGl0aW9uYWwgY2hlY2tzIGFm
dGVyIGEgZ2V0RWxlbWVudEJ5SWQKCS8vIFdoaWNoIHNsb3dzIHRoaW5ncyBkb3du
IGZvciBvdGhlciBicm93c2VycyAoaGVuY2UgdGhlIGJyYW5jaGluZykKCWlmICgg
ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIGlkICkgKSB7CgkJRXhwci5maW5kLklE
ID0gZnVuY3Rpb24oIG1hdGNoLCBjb250ZXh0LCBpc1hNTCApIHsKCQkJaWYgKCB0
eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCAhPT0gInVuZGVmaW5lZCIgJiYg
IWlzWE1MICkgewoJCQkJdmFyIG0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKG1h
dGNoWzFdKTsKCgkJCQlyZXR1cm4gbSA/CgkJCQkJbS5pZCA9PT0gbWF0Y2hbMV0g
fHwgdHlwZW9mIG0uZ2V0QXR0cmlidXRlTm9kZSAhPT0gInVuZGVmaW5lZCIgJiYg
bS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpLm5vZGVWYWx1ZSA9PT0gbWF0Y2hbMV0g
PwoJCQkJCQlbbV0gOgoJCQkJCQl1bmRlZmluZWQgOgoJCQkJCVtdOwoJCQl9CgkJ
fTsKCgkJRXhwci5maWx0ZXIuSUQgPSBmdW5jdGlvbiggZWxlbSwgbWF0Y2ggKSB7
CgkJCXZhciBub2RlID0gdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlTm9kZSAhPT0g
InVuZGVmaW5lZCIgJiYgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpOwoKCQkJ
cmV0dXJuIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgbm9kZSAmJiBub2RlLm5vZGVW
YWx1ZSA9PT0gbWF0Y2g7CgkJfTsKCX0KCglyb290LnJlbW92ZUNoaWxkKCBmb3Jt
ICk7CgoJLy8gcmVsZWFzZSBtZW1vcnkgaW4gSUUKCXJvb3QgPSBmb3JtID0gbnVs
bDsKfSkoKTsKCihmdW5jdGlvbigpewoJLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBi
cm93c2VyIHJldHVybnMgb25seSBlbGVtZW50cwoJLy8gd2hlbiBkb2luZyBnZXRF
bGVtZW50c0J5VGFnTmFtZSgiKiIpCgoJLy8gQ3JlYXRlIGEgZmFrZSBlbGVtZW50
Cgl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CglkaXYu
YXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoIiIpICk7CgoJLy8g
TWFrZSBzdXJlIG5vIGNvbW1lbnRzIGFyZSBmb3VuZAoJaWYgKCBkaXYuZ2V0RWxl
bWVudHNCeVRhZ05hbWUoIioiKS5sZW5ndGggPiAwICkgewoJCUV4cHIuZmluZC5U
QUcgPSBmdW5jdGlvbiggbWF0Y2gsIGNvbnRleHQgKSB7CgkJCXZhciByZXN1bHRz
ID0gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggbWF0Y2hbMV0gKTsKCgkJ
CS8vIEZpbHRlciBvdXQgcG9zc2libGUgY29tbWVudHMKCQkJaWYgKCBtYXRjaFsx
XSA9PT0gIioiICkgewoJCQkJdmFyIHRtcCA9IFtdOwoKCQkJCWZvciAoIHZhciBp
ID0gMDsgcmVzdWx0c1tpXTsgaSsrICkgewoJCQkJCWlmICggcmVzdWx0c1tpXS5u
b2RlVHlwZSA9PT0gMSApIHsKCQkJCQkJdG1wLnB1c2goIHJlc3VsdHNbaV0gKTsK
CQkJCQl9CgkJCQl9CgoJCQkJcmVzdWx0cyA9IHRtcDsKCQkJfQoKCQkJcmV0dXJu
IHJlc3VsdHM7CgkJfTsKCX0KCgkvLyBDaGVjayB0byBzZWUgaWYgYW4gYXR0cmli
dXRlIHJldHVybnMgbm9ybWFsaXplZCBocmVmIGF0dHJpYnV0ZXMKCWRpdi5pbm5l
ckhUTUwgPSAiPGEgaHJlZj0nIyc+PC9hPiI7CgoJaWYgKCBkaXYuZmlyc3RDaGls
ZCAmJiB0eXBlb2YgZGl2LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlICE9PSAidW5k
ZWZpbmVkIiAmJgoJCQlkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYi
KSAhPT0gIiMiICkgewoKCQlFeHByLmF0dHJIYW5kbGUuaHJlZiA9IGZ1bmN0aW9u
KCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoICJocmVmIiwg
MiApOwoJCX07Cgl9CgoJLy8gcmVsZWFzZSBtZW1vcnkgaW4gSUUKCWRpdiA9IG51
bGw7Cn0pKCk7CgppZiAoIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwgKSB7Cgko
ZnVuY3Rpb24oKXsKCQl2YXIgb2xkU2l6emxlID0gU2l6emxlLAoJCQlkaXYgPSBk
b2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSwKCQkJaWQgPSAiX19zaXp6bGVf
XyI7CgoJCWRpdi5pbm5lckhUTUwgPSAiPHAgY2xhc3M9J1RFU1QnPjwvcD4iOwoK
CQkvLyBTYWZhcmkgY2FuJ3QgaGFuZGxlIHVwcGVyY2FzZSBvciB1bmljb2RlIGNo
YXJhY3RlcnMgd2hlbgoJCS8vIGluIHF1aXJrcyBtb2RlLgoJCWlmICggZGl2LnF1
ZXJ5U2VsZWN0b3JBbGwgJiYgZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIi5URVNUIiku
bGVuZ3RoID09PSAwICkgewoJCQlyZXR1cm47CgkJfQoKCQlTaXp6bGUgPSBmdW5j
dGlvbiggcXVlcnksIGNvbnRleHQsIGV4dHJhLCBzZWVkICkgewoJCQljb250ZXh0
ID0gY29udGV4dCB8fCBkb2N1bWVudDsKCgkJCS8vIE9ubHkgdXNlIHF1ZXJ5U2Vs
ZWN0b3JBbGwgb24gbm9uLVhNTCBkb2N1bWVudHMKCQkJLy8gKElEIHNlbGVjdG9y
cyBkb24ndCB3b3JrIGluIG5vbi1IVE1MIGRvY3VtZW50cykKCQkJaWYgKCAhc2Vl
ZCAmJiAhU2l6emxlLmlzWE1MKGNvbnRleHQpICkgewoJCQkJLy8gU2VlIGlmIHdl
IGZpbmQgYSBzZWxlY3RvciB0byBzcGVlZCB1cAoJCQkJdmFyIG1hdGNoID0gL14o
XHcrJCl8XlwuKFtcd1wtXSskKXxeIyhbXHdcLV0rJCkvLmV4ZWMoIHF1ZXJ5ICk7
CgoJCQkJaWYgKCBtYXRjaCAmJiAoY29udGV4dC5ub2RlVHlwZSA9PT0gMSB8fCBj
b250ZXh0Lm5vZGVUeXBlID09PSA5KSApIHsKCQkJCQkvLyBTcGVlZC11cDogU2l6
emxlKCJUQUciKQoJCQkJCWlmICggbWF0Y2hbMV0gKSB7CgkJCQkJCXJldHVybiBt
YWtlQXJyYXkoIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHF1ZXJ5ICks
IGV4dHJhICk7CgoJCQkJCS8vIFNwZWVkLXVwOiBTaXp6bGUoIi5DTEFTUyIpCgkJ
CQkJfSBlbHNlIGlmICggbWF0Y2hbMl0gJiYgRXhwci5maW5kLkNMQVNTICYmIGNv
bnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApIHsKCQkJCQkJcmV0dXJuIG1h
a2VBcnJheSggY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBtYXRjaFsy
XSApLCBleHRyYSApOwoJCQkJCX0KCQkJCX0KCgkJCQlpZiAoIGNvbnRleHQubm9k
ZVR5cGUgPT09IDkgKSB7CgkJCQkJLy8gU3BlZWQtdXA6IFNpenpsZSgiYm9keSIp
CgkJCQkJLy8gVGhlIGJvZHkgZWxlbWVudCBvbmx5IGV4aXN0cyBvbmNlLCBvcHRp
bWl6ZSBmaW5kaW5nIGl0CgkJCQkJaWYgKCBxdWVyeSA9PT0gImJvZHkiICYmIGNv
bnRleHQuYm9keSApIHsKCQkJCQkJcmV0dXJuIG1ha2VBcnJheSggWyBjb250ZXh0
LmJvZHkgXSwgZXh0cmEgKTsKCgkJCQkJLy8gU3BlZWQtdXA6IFNpenpsZSgiI0lE
IikKCQkJCQl9IGVsc2UgaWYgKCBtYXRjaCAmJiBtYXRjaFszXSApIHsKCQkJCQkJ
dmFyIGVsZW0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKCBtYXRjaFszXSApOwoK
CQkJCQkJLy8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVy
cnkgNC42IHJldHVybnMKCQkJCQkJLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2Vy
IGluIHRoZSBkb2N1bWVudCAjNjk2MwoJCQkJCQlpZiAoIGVsZW0gJiYgZWxlbS5w
YXJlbnROb2RlICkgewoJCQkJCQkJLy8gSGFuZGxlIHRoZSBjYXNlIHdoZXJlIElF
IGFuZCBPcGVyYSByZXR1cm4gaXRlbXMKCQkJCQkJCS8vIGJ5IG5hbWUgaW5zdGVh
ZCBvZiBJRAoJCQkJCQkJaWYgKCBlbGVtLmlkID09PSBtYXRjaFszXSApIHsKCQkJ
CQkJCQlyZXR1cm4gbWFrZUFycmF5KCBbIGVsZW0gXSwgZXh0cmEgKTsKCQkJCQkJ
CX0KCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlyZXR1cm4gbWFrZUFycmF5KCBbXSwg
ZXh0cmEgKTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJdHJ5IHsKCQkJCQkJcmV0dXJu
IG1ha2VBcnJheSggY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KSwgZXh0
cmEgKTsKCQkJCQl9IGNhdGNoKHFzYUVycm9yKSB7fQoKCQkJCS8vIHFTQSB3b3Jr
cyBzdHJhbmdlbHkgb24gRWxlbWVudC1yb290ZWQgcXVlcmllcwoJCQkJLy8gV2Ug
Y2FuIHdvcmsgYXJvdW5kIHRoaXMgYnkgc3BlY2lmeWluZyBhbiBleHRyYSBJRCBv
biB0aGUgcm9vdAoJCQkJLy8gYW5kIHdvcmtpbmcgdXAgZnJvbSB0aGVyZSAoVGhh
bmtzIHRvIEFuZHJldyBEdXBvbnQgZm9yIHRoZSB0ZWNobmlxdWUpCgkJCQkvLyBJ
RSA4IGRvZXNuJ3Qgd29yayBvbiBvYmplY3QgZWxlbWVudHMKCQkJCX0gZWxzZSBp
ZiAoIGNvbnRleHQubm9kZVR5cGUgPT09IDEgJiYgY29udGV4dC5ub2RlTmFtZS50
b0xvd2VyQ2FzZSgpICE9PSAib2JqZWN0IiApIHsKCQkJCQl2YXIgb2xkQ29udGV4
dCA9IGNvbnRleHQsCgkJCQkJCW9sZCA9IGNvbnRleHQuZ2V0QXR0cmlidXRlKCAi
aWQiICksCgkJCQkJCW5pZCA9IG9sZCB8fCBpZCwKCQkJCQkJaGFzUGFyZW50ID0g
Y29udGV4dC5wYXJlbnROb2RlLAoJCQkJCQlyZWxhdGl2ZUhpZXJhcmNoeVNlbGVj
dG9yID0gL15ccypbK35dLy50ZXN0KCBxdWVyeSApOwoKCQkJCQlpZiAoICFvbGQg
KSB7CgkJCQkJCWNvbnRleHQuc2V0QXR0cmlidXRlKCAiaWQiLCBuaWQgKTsKCQkJ
CQl9IGVsc2UgewoJCQkJCQluaWQgPSBuaWQucmVwbGFjZSggLycvZywgIlxcJCYi
ICk7CgkJCQkJfQoJCQkJCWlmICggcmVsYXRpdmVIaWVyYXJjaHlTZWxlY3RvciAm
JiBoYXNQYXJlbnQgKSB7CgkJCQkJCWNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5v
ZGU7CgkJCQkJfQoKCQkJCQl0cnkgewoJCQkJCQlpZiAoICFyZWxhdGl2ZUhpZXJh
cmNoeVNlbGVjdG9yIHx8IGhhc1BhcmVudCApIHsKCQkJCQkJCXJldHVybiBtYWtl
QXJyYXkoIGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggIltpZD0nIiArIG5pZCAr
ICInXSAiICsgcXVlcnkgKSwgZXh0cmEgKTsKCQkJCQkJfQoKCQkJCQl9IGNhdGNo
KHBzZXVkb0Vycm9yKSB7CgkJCQkJfSBmaW5hbGx5IHsKCQkJCQkJaWYgKCAhb2xk
ICkgewoJCQkJCQkJb2xkQ29udGV4dC5yZW1vdmVBdHRyaWJ1dGUoICJpZCIgKTsK
CQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG9sZFNpenpsZShx
dWVyeSwgY29udGV4dCwgZXh0cmEsIHNlZWQpOwoJCX07CgoJCWZvciAoIHZhciBw
cm9wIGluIG9sZFNpenpsZSApIHsKCQkJU2l6emxlWyBwcm9wIF0gPSBvbGRTaXp6
bGVbIHByb3AgXTsKCQl9CgoJCS8vIHJlbGVhc2UgbWVtb3J5IGluIElFCgkJZGl2
ID0gbnVsbDsKCX0pKCk7Cn0KCihmdW5jdGlvbigpewoJdmFyIGh0bWwgPSBkb2N1
bWVudC5kb2N1bWVudEVsZW1lbnQsCgkJbWF0Y2hlcyA9IGh0bWwubWF0Y2hlc1Nl
bGVjdG9yIHx8IGh0bWwubW96TWF0Y2hlc1NlbGVjdG9yIHx8IGh0bWwud2Via2l0
TWF0Y2hlc1NlbGVjdG9yIHx8IGh0bWwubXNNYXRjaGVzU2VsZWN0b3I7CgoJaWYg
KCBtYXRjaGVzICkgewoJCS8vIENoZWNrIHRvIHNlZSBpZiBpdCdzIHBvc3NpYmxl
IHRvIGRvIG1hdGNoZXNTZWxlY3RvcgoJCS8vIG9uIGEgZGlzY29ubmVjdGVkIG5v
ZGUgKElFIDkgZmFpbHMgdGhpcykKCQl2YXIgZGlzY29ubmVjdGVkTWF0Y2ggPSAh
bWF0Y2hlcy5jYWxsKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApLCAi
ZGl2IiApLAoJCQlwc2V1ZG9Xb3JrcyA9IGZhbHNlOwoKCQl0cnkgewoJCQkvLyBU
aGlzIHNob3VsZCBmYWlsIHdpdGggYW4gZXhjZXB0aW9uCgkJCS8vIEdlY2tvIGRv
ZXMgbm90IGVycm9yLCByZXR1cm5zIGZhbHNlIGluc3RlYWQKCQkJbWF0Y2hlcy5j
YWxsKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICJbdGVzdCE9JyddOnNpenps
ZSIgKTsKCgkJfSBjYXRjaCggcHNldWRvRXJyb3IgKSB7CgkJCXBzZXVkb1dvcmtz
ID0gdHJ1ZTsKCQl9CgoJCVNpenpsZS5tYXRjaGVzU2VsZWN0b3IgPSBmdW5jdGlv
biggbm9kZSwgZXhwciApIHsKCQkJLy8gTWFrZSBzdXJlIHRoYXQgYXR0cmlidXRl
IHNlbGVjdG9ycyBhcmUgcXVvdGVkCgkJCWV4cHIgPSBleHByLnJlcGxhY2UoL1w9
XHMqKFteJyJcXV0qKVxzKlxdL2csICI9JyQxJ10iKTsKCgkJCWlmICggIVNpenps
ZS5pc1hNTCggbm9kZSApICkgewoJCQkJdHJ5IHsKCQkJCQlpZiAoIHBzZXVkb1dv
cmtzIHx8ICFFeHByLm1hdGNoLlBTRVVETy50ZXN0KCBleHByICkgJiYgIS8hPS8u
dGVzdCggZXhwciApICkgewoJCQkJCQl2YXIgcmV0ID0gbWF0Y2hlcy5jYWxsKCBu
b2RlLCBleHByICk7CgoJCQkJCQkvLyBJRSA5J3MgbWF0Y2hlc1NlbGVjdG9yIHJl
dHVybnMgZmFsc2Ugb24gZGlzY29ubmVjdGVkIG5vZGVzCgkJCQkJCWlmICggcmV0
IHx8ICFkaXNjb25uZWN0ZWRNYXRjaCB8fAoJCQkJCQkJCS8vIEFzIHdlbGwsIGRp
c2Nvbm5lY3RlZCBub2RlcyBhcmUgc2FpZCB0byBiZSBpbiBhIGRvY3VtZW50CgkJ
CQkJCQkJLy8gZnJhZ21lbnQgaW4gSUUgOSwgc28gY2hlY2sgZm9yIHRoYXQKCQkJ
CQkJCQlub2RlLmRvY3VtZW50ICYmIG5vZGUuZG9jdW1lbnQubm9kZVR5cGUgIT09
IDExICkgewoJCQkJCQkJcmV0dXJuIHJldDsKCQkJCQkJfQoJCQkJCX0KCQkJCX0g
Y2F0Y2goZSkge30KCQkJfQoKCQkJcmV0dXJuIFNpenpsZShleHByLCBudWxsLCBu
dWxsLCBbbm9kZV0pLmxlbmd0aCA+IDA7CgkJfTsKCX0KfSkoKTsKCihmdW5jdGlv
bigpewoJdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwoK
CWRpdi5pbm5lckhUTUwgPSAiPGRpdiBjbGFzcz0ndGVzdCBlJz48L2Rpdj48ZGl2
IGNsYXNzPSd0ZXN0Jz48L2Rpdj4iOwoKCS8vIE9wZXJhIGNhbid0IGZpbmQgYSBz
ZWNvbmQgY2xhc3NuYW1lIChpbiA5LjYpCgkvLyBBbHNvLCBtYWtlIHN1cmUgdGhh
dCBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIGFjdHVhbGx5IGV4aXN0cwoJaWYgKCAh
ZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgfHwgZGl2LmdldEVsZW1lbnRzQnlD
bGFzc05hbWUoImUiKS5sZW5ndGggPT09IDAgKSB7CgkJcmV0dXJuOwoJfQoKCS8v
IFNhZmFyaSBjYWNoZXMgY2xhc3MgYXR0cmlidXRlcywgZG9lc24ndCBjYXRjaCBj
aGFuZ2VzIChpbiAzLjIpCglkaXYubGFzdENoaWxkLmNsYXNzTmFtZSA9ICJlIjsK
CglpZiAoIGRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlIikubGVuZ3RoID09
PSAxICkgewoJCXJldHVybjsKCX0KCglFeHByLm9yZGVyLnNwbGljZSgxLCAwLCAi
Q0xBU1MiKTsKCUV4cHIuZmluZC5DTEFTUyA9IGZ1bmN0aW9uKCBtYXRjaCwgY29u
dGV4dCwgaXNYTUwgKSB7CgkJaWYgKCB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50
c0J5Q2xhc3NOYW1lICE9PSAidW5kZWZpbmVkIiAmJiAhaXNYTUwgKSB7CgkJCXJl
dHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobWF0Y2hbMV0pOwoJ
CX0KCX07CgoJLy8gcmVsZWFzZSBtZW1vcnkgaW4gSUUKCWRpdiA9IG51bGw7Cn0p
KCk7CgpmdW5jdGlvbiBkaXJOb2RlQ2hlY2soIGRpciwgY3VyLCBkb25lTmFtZSwg
Y2hlY2tTZXQsIG5vZGVDaGVjaywgaXNYTUwgKSB7Cglmb3IgKCB2YXIgaSA9IDAs
IGwgPSBjaGVja1NldC5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJdmFyIGVsZW0g
PSBjaGVja1NldFtpXTsKCgkJaWYgKCBlbGVtICkgewoJCQl2YXIgbWF0Y2ggPSBm
YWxzZTsKCgkJCWVsZW0gPSBlbGVtW2Rpcl07CgoJCQl3aGlsZSAoIGVsZW0gKSB7
CgkJCQlpZiAoIGVsZW1bIGV4cGFuZG8gXSA9PT0gZG9uZU5hbWUgKSB7CgkJCQkJ
bWF0Y2ggPSBjaGVja1NldFtlbGVtLnNpenNldF07CgkJCQkJYnJlYWs7CgkJCQl9
CgoJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICYmICFpc1hNTCApewoJCQkJ
CWVsZW1bIGV4cGFuZG8gXSA9IGRvbmVOYW1lOwoJCQkJCWVsZW0uc2l6c2V0ID0g
aTsKCQkJCX0KCgkJCQlpZiAoIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9
PT0gY3VyICkgewoJCQkJCW1hdGNoID0gZWxlbTsKCQkJCQlicmVhazsKCQkJCX0K
CgkJCQllbGVtID0gZWxlbVtkaXJdOwoJCQl9CgoJCQljaGVja1NldFtpXSA9IG1h
dGNoOwoJCX0KCX0KfQoKZnVuY3Rpb24gZGlyQ2hlY2soIGRpciwgY3VyLCBkb25l
TmFtZSwgY2hlY2tTZXQsIG5vZGVDaGVjaywgaXNYTUwgKSB7Cglmb3IgKCB2YXIg
aSA9IDAsIGwgPSBjaGVja1NldC5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJdmFy
IGVsZW0gPSBjaGVja1NldFtpXTsKCgkJaWYgKCBlbGVtICkgewoJCQl2YXIgbWF0
Y2ggPSBmYWxzZTsKCgkJCWVsZW0gPSBlbGVtW2Rpcl07CgoJCQl3aGlsZSAoIGVs
ZW0gKSB7CgkJCQlpZiAoIGVsZW1bIGV4cGFuZG8gXSA9PT0gZG9uZU5hbWUgKSB7
CgkJCQkJbWF0Y2ggPSBjaGVja1NldFtlbGVtLnNpenNldF07CgkJCQkJYnJlYWs7
CgkJCQl9CgoJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkgewoJCQkJCWlm
ICggIWlzWE1MICkgewoJCQkJCQllbGVtWyBleHBhbmRvIF0gPSBkb25lTmFtZTsK
CQkJCQkJZWxlbS5zaXpzZXQgPSBpOwoJCQkJCX0KCgkJCQkJaWYgKCB0eXBlb2Yg
Y3VyICE9PSAic3RyaW5nIiApIHsKCQkJCQkJaWYgKCBlbGVtID09PSBjdXIgKSB7
CgkJCQkJCQltYXRjaCA9IHRydWU7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoKCQkJ
CQl9IGVsc2UgaWYgKCBTaXp6bGUuZmlsdGVyKCBjdXIsIFtlbGVtXSApLmxlbmd0
aCA+IDAgKSB7CgkJCQkJCW1hdGNoID0gZWxlbTsKCQkJCQkJYnJlYWs7CgkJCQkJ
fQoJCQkJfQoKCQkJCWVsZW0gPSBlbGVtW2Rpcl07CgkJCX0KCgkJCWNoZWNrU2V0
W2ldID0gbWF0Y2g7CgkJfQoJfQp9CgppZiAoIGRvY3VtZW50LmRvY3VtZW50RWxl
bWVudC5jb250YWlucyApIHsKCVNpenpsZS5jb250YWlucyA9IGZ1bmN0aW9uKCBh
LCBiICkgewoJCXJldHVybiBhICE9PSBiICYmIChhLmNvbnRhaW5zID8gYS5jb250
YWlucyhiKSA6IHRydWUpOwoJfTsKCn0gZWxzZSBpZiAoIGRvY3VtZW50LmRvY3Vt
ZW50RWxlbWVudC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiApIHsKCVNpenpsZS5j
b250YWlucyA9IGZ1bmN0aW9uKCBhLCBiICkgewoJCXJldHVybiAhIShhLmNvbXBh
cmVEb2N1bWVudFBvc2l0aW9uKGIpICYgMTYpOwoJfTsKCn0gZWxzZSB7CglTaXp6
bGUuY29udGFpbnMgPSBmdW5jdGlvbigpIHsKCQlyZXR1cm4gZmFsc2U7Cgl9Owp9
CgpTaXp6bGUuaXNYTUwgPSBmdW5jdGlvbiggZWxlbSApIHsKCS8vIGRvY3VtZW50
RWxlbWVudCBpcyB2ZXJpZmllZCBmb3IgY2FzZXMgd2hlcmUgaXQgZG9lc24ndCB5
ZXQgZXhpc3QKCS8vIChzdWNoIGFzIGxvYWRpbmcgaWZyYW1lcyBpbiBJRSAtICM0
ODMzKQoJdmFyIGRvY3VtZW50RWxlbWVudCA9IChlbGVtID8gZWxlbS5vd25lckRv
Y3VtZW50IHx8IGVsZW0gOiAwKS5kb2N1bWVudEVsZW1lbnQ7CgoJcmV0dXJuIGRv
Y3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gIkhU
TUwiIDogZmFsc2U7Cn07Cgp2YXIgcG9zUHJvY2VzcyA9IGZ1bmN0aW9uKCBzZWxl
Y3RvciwgY29udGV4dCwgc2VlZCApIHsKCXZhciBtYXRjaCwKCQl0bXBTZXQgPSBb
XSwKCQlsYXRlciA9ICIiLAoJCXJvb3QgPSBjb250ZXh0Lm5vZGVUeXBlID8gW2Nv
bnRleHRdIDogY29udGV4dDsKCgkvLyBQb3NpdGlvbiBzZWxlY3RvcnMgbXVzdCBi
ZSBkb25lIGFmdGVyIHRoZSBmaWx0ZXIKCS8vIEFuZCBzbyBtdXN0IDpub3QocG9z
aXRpb25hbCkgc28gd2UgbW92ZSBhbGwgUFNFVURPcyB0byB0aGUgZW5kCgl3aGls
ZSAoIChtYXRjaCA9IEV4cHIubWF0Y2guUFNFVURPLmV4ZWMoIHNlbGVjdG9yICkp
ICkgewoJCWxhdGVyICs9IG1hdGNoWzBdOwoJCXNlbGVjdG9yID0gc2VsZWN0b3Iu
cmVwbGFjZSggRXhwci5tYXRjaC5QU0VVRE8sICIiICk7Cgl9CgoJc2VsZWN0b3Ig
PSBFeHByLnJlbGF0aXZlW3NlbGVjdG9yXSA/IHNlbGVjdG9yICsgIioiIDogc2Vs
ZWN0b3I7CgoJZm9yICggdmFyIGkgPSAwLCBsID0gcm9vdC5sZW5ndGg7IGkgPCBs
OyBpKysgKSB7CgkJU2l6emxlKCBzZWxlY3Rvciwgcm9vdFtpXSwgdG1wU2V0LCBz
ZWVkICk7Cgl9CgoJcmV0dXJuIFNpenpsZS5maWx0ZXIoIGxhdGVyLCB0bXBTZXQg
KTsKfTsKCi8vIEVYUE9TRQovLyBPdmVycmlkZSBzaXp6bGUgYXR0cmlidXRlIHJl
dHJpZXZhbApTaXp6bGUuYXR0ciA9IGpRdWVyeS5hdHRyOwpTaXp6bGUuc2VsZWN0
b3JzLmF0dHJNYXAgPSB7fTsKalF1ZXJ5LmZpbmQgPSBTaXp6bGU7CmpRdWVyeS5l
eHByID0gU2l6emxlLnNlbGVjdG9yczsKalF1ZXJ5LmV4cHJbIjoiXSA9IGpRdWVy
eS5leHByLmZpbHRlcnM7CmpRdWVyeS51bmlxdWUgPSBTaXp6bGUudW5pcXVlU29y
dDsKalF1ZXJ5LnRleHQgPSBTaXp6bGUuZ2V0VGV4dDsKalF1ZXJ5LmlzWE1MRG9j
ID0gU2l6emxlLmlzWE1MOwpqUXVlcnkuY29udGFpbnMgPSBTaXp6bGUuY29udGFp
bnM7CgoKfSkoKTsKCgp2YXIgcnVudGlsID0gL1VudGlsJC8sCglycGFyZW50c3By
ZXYgPSAvXig/OnBhcmVudHN8cHJldlVudGlsfHByZXZBbGwpLywKCS8vIE5vdGU6
IFRoaXMgUmVnRXhwIHNob3VsZCBiZSBpbXByb3ZlZCwgb3IgbGlrZWx5IHB1bGxl
ZCBmcm9tIFNpenpsZQoJcm11bHRpc2VsZWN0b3IgPSAvLC8sCglpc1NpbXBsZSA9
IC9eLlteOiNcW1wuLF0qJC8sCglzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGlj
ZSwKCVBPUyA9IGpRdWVyeS5leHByLm1hdGNoLmdsb2JhbFBPUywKCS8vIG1ldGhv
ZHMgZ3VhcmFudGVlZCB0byBwcm9kdWNlIGEgdW5pcXVlIHNldCB3aGVuIHN0YXJ0
aW5nIGZyb20gYSB1bmlxdWUgc2V0CglndWFyYW50ZWVkVW5pcXVlID0gewoJCWNo
aWxkcmVuOiB0cnVlLAoJCWNvbnRlbnRzOiB0cnVlLAoJCW5leHQ6IHRydWUsCgkJ
cHJldjogdHJ1ZQoJfTsKCmpRdWVyeS5mbi5leHRlbmQoewoJZmluZDogZnVuY3Rp
b24oIHNlbGVjdG9yICkgewoJCXZhciBzZWxmID0gdGhpcywKCQkJaSwgbDsKCgkJ
aWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciICkgewoJCQlyZXR1cm4g
alF1ZXJ5KCBzZWxlY3RvciApLmZpbHRlcihmdW5jdGlvbigpIHsKCQkJCWZvciAo
IGkgPSAwLCBsID0gc2VsZi5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJCQkJaWYg
KCBqUXVlcnkuY29udGFpbnMoIHNlbGZbIGkgXSwgdGhpcyApICkgewoJCQkJCQly
ZXR1cm4gdHJ1ZTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoJCX0KCgkJdmFyIHJldCA9
IHRoaXMucHVzaFN0YWNrKCAiIiwgImZpbmQiLCBzZWxlY3RvciApLAoJCQlsZW5n
dGgsIG4sIHI7CgoJCWZvciAoIGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBs
OyBpKysgKSB7CgkJCWxlbmd0aCA9IHJldC5sZW5ndGg7CgkJCWpRdWVyeS5maW5k
KCBzZWxlY3RvciwgdGhpc1tpXSwgcmV0ICk7CgoJCQlpZiAoIGkgPiAwICkgewoJ
CQkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIHJlc3VsdHMgYXJlIHVuaXF1ZQoJCQkJ
Zm9yICggbiA9IGxlbmd0aDsgbiA8IHJldC5sZW5ndGg7IG4rKyApIHsKCQkJCQlm
b3IgKCByID0gMDsgciA8IGxlbmd0aDsgcisrICkgewoJCQkJCQlpZiAoIHJldFty
XSA9PT0gcmV0W25dICkgewoJCQkJCQkJcmV0LnNwbGljZShuLS0sIDEpOwoJCQkJ
CQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVy
biByZXQ7Cgl9LAoKCWhhczogZnVuY3Rpb24oIHRhcmdldCApIHsKCQl2YXIgdGFy
Z2V0cyA9IGpRdWVyeSggdGFyZ2V0ICk7CgkJcmV0dXJuIHRoaXMuZmlsdGVyKGZ1
bmN0aW9uKCkgewoJCQlmb3IgKCB2YXIgaSA9IDAsIGwgPSB0YXJnZXRzLmxlbmd0
aDsgaSA8IGw7IGkrKyApIHsKCQkJCWlmICggalF1ZXJ5LmNvbnRhaW5zKCB0aGlz
LCB0YXJnZXRzW2ldICkgKSB7CgkJCQkJcmV0dXJuIHRydWU7CgkJCQl9CgkJCX0K
CQl9KTsKCX0sCgoJbm90OiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJcmV0dXJu
IHRoaXMucHVzaFN0YWNrKCB3aW5ub3codGhpcywgc2VsZWN0b3IsIGZhbHNlKSwg
Im5vdCIsIHNlbGVjdG9yKTsKCX0sCgoJZmlsdGVyOiBmdW5jdGlvbiggc2VsZWN0
b3IgKSB7CgkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3codGhpcywgc2Vs
ZWN0b3IsIHRydWUpLCAiZmlsdGVyIiwgc2VsZWN0b3IgKTsKCX0sCgoJaXM6IGZ1
bmN0aW9uKCBzZWxlY3RvciApIHsKCQlyZXR1cm4gISFzZWxlY3RvciAmJiAoCgkJ
CXR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgPwoJCQkJLy8gSWYgdGhpcyBp
cyBhIHBvc2l0aW9uYWwgc2VsZWN0b3IsIGNoZWNrIG1lbWJlcnNoaXAgaW4gdGhl
IHJldHVybmVkIHNldAoJCQkJLy8gc28gJCgicDpmaXJzdCIpLmlzKCJwOmxhc3Qi
KSB3b24ndCByZXR1cm4gdHJ1ZSBmb3IgYSBkb2Mgd2l0aCB0d28gInAiLgoJCQkJ
UE9TLnRlc3QoIHNlbGVjdG9yICkgPwoJCQkJCWpRdWVyeSggc2VsZWN0b3IsIHRo
aXMuY29udGV4dCApLmluZGV4KCB0aGlzWzBdICkgPj0gMCA6CgkJCQkJalF1ZXJ5
LmZpbHRlciggc2VsZWN0b3IsIHRoaXMgKS5sZW5ndGggPiAwIDoKCQkJCXRoaXMu
ZmlsdGVyKCBzZWxlY3RvciApLmxlbmd0aCA+IDAgKTsKCX0sCgoJY2xvc2VzdDog
ZnVuY3Rpb24oIHNlbGVjdG9ycywgY29udGV4dCApIHsKCQl2YXIgcmV0ID0gW10s
IGksIGwsIGN1ciA9IHRoaXNbMF07CgoJCS8vIEFycmF5IChkZXByZWNhdGVkIGFz
IG9mIGpRdWVyeSAxLjcpCgkJaWYgKCBqUXVlcnkuaXNBcnJheSggc2VsZWN0b3Jz
ICkgKSB7CgkJCXZhciBsZXZlbCA9IDE7CgoJCQl3aGlsZSAoIGN1ciAmJiBjdXIu
b3duZXJEb2N1bWVudCAmJiBjdXIgIT09IGNvbnRleHQgKSB7CgkJCQlmb3IgKCBp
ID0gMDsgaSA8IHNlbGVjdG9ycy5sZW5ndGg7IGkrKyApIHsKCgkJCQkJaWYgKCBq
UXVlcnkoIGN1ciApLmlzKCBzZWxlY3RvcnNbIGkgXSApICkgewoJCQkJCQlyZXQu
cHVzaCh7IHNlbGVjdG9yOiBzZWxlY3RvcnNbIGkgXSwgZWxlbTogY3VyLCBsZXZl
bDogbGV2ZWwgfSk7CgkJCQkJfQoJCQkJfQoKCQkJCWN1ciA9IGN1ci5wYXJlbnRO
b2RlOwoJCQkJbGV2ZWwrKzsKCQkJfQoKCQkJcmV0dXJuIHJldDsKCQl9CgoJCS8v
IFN0cmluZwoJCXZhciBwb3MgPSBQT1MudGVzdCggc2VsZWN0b3JzICkgfHwgdHlw
ZW9mIHNlbGVjdG9ycyAhPT0gInN0cmluZyIgPwoJCQkJalF1ZXJ5KCBzZWxlY3Rv
cnMsIGNvbnRleHQgfHwgdGhpcy5jb250ZXh0ICkgOgoJCQkJMDsKCgkJZm9yICgg
aSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKyApIHsKCQkJY3VyID0g
dGhpc1tpXTsKCgkJCXdoaWxlICggY3VyICkgewoJCQkJaWYgKCBwb3MgPyBwb3Mu
aW5kZXgoY3VyKSA+IC0xIDogalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGN1
ciwgc2VsZWN0b3JzKSApIHsKCQkJCQlyZXQucHVzaCggY3VyICk7CgkJCQkJYnJl
YWs7CgoJCQkJfSBlbHNlIHsKCQkJCQljdXIgPSBjdXIucGFyZW50Tm9kZTsKCQkJ
CQlpZiAoICFjdXIgfHwgIWN1ci5vd25lckRvY3VtZW50IHx8IGN1ciA9PT0gY29u
dGV4dCB8fCBjdXIubm9kZVR5cGUgPT09IDExICkgewoJCQkJCQlicmVhazsKCQkJ
CQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldCA9IHJldC5sZW5ndGggPiAxID8galF1
ZXJ5LnVuaXF1ZSggcmV0ICkgOiByZXQ7CgoJCXJldHVybiB0aGlzLnB1c2hTdGFj
ayggcmV0LCAiY2xvc2VzdCIsIHNlbGVjdG9ycyApOwoJfSwKCgkvLyBEZXRlcm1p
bmUgdGhlIHBvc2l0aW9uIG9mIGFuIGVsZW1lbnQgd2l0aGluCgkvLyB0aGUgbWF0
Y2hlZCBzZXQgb2YgZWxlbWVudHMKCWluZGV4OiBmdW5jdGlvbiggZWxlbSApIHsK
CgkJLy8gTm8gYXJndW1lbnQsIHJldHVybiBpbmRleCBpbiBwYXJlbnQKCQlpZiAo
ICFlbGVtICkgewoJCQlyZXR1cm4gKCB0aGlzWzBdICYmIHRoaXNbMF0ucGFyZW50
Tm9kZSApID8gdGhpcy5wcmV2QWxsKCkubGVuZ3RoIDogLTE7CgkJfQoKCQkvLyBp
bmRleCBpbiBzZWxlY3RvcgoJCWlmICggdHlwZW9mIGVsZW0gPT09ICJzdHJpbmci
ICkgewoJCQlyZXR1cm4galF1ZXJ5LmluQXJyYXkoIHRoaXNbMF0sIGpRdWVyeSgg
ZWxlbSApICk7CgkJfQoKCQkvLyBMb2NhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBk
ZXNpcmVkIGVsZW1lbnQKCQlyZXR1cm4galF1ZXJ5LmluQXJyYXkoCgkJCS8vIElm
IGl0IHJlY2VpdmVzIGEgalF1ZXJ5IG9iamVjdCwgdGhlIGZpcnN0IGVsZW1lbnQg
aXMgdXNlZAoJCQllbGVtLmpxdWVyeSA/IGVsZW1bMF0gOiBlbGVtLCB0aGlzICk7
Cgl9LAoKCWFkZDogZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0ICkgewoJCXZh
ciBzZXQgPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciID8KCQkJCWpRdWVy
eSggc2VsZWN0b3IsIGNvbnRleHQgKSA6CgkJCQlqUXVlcnkubWFrZUFycmF5KCBz
ZWxlY3RvciAmJiBzZWxlY3Rvci5ub2RlVHlwZSA/IFsgc2VsZWN0b3IgXSA6IHNl
bGVjdG9yICksCgkJCWFsbCA9IGpRdWVyeS5tZXJnZSggdGhpcy5nZXQoKSwgc2V0
ICk7CgoJCXJldHVybiB0aGlzLnB1c2hTdGFjayggaXNEaXNjb25uZWN0ZWQoIHNl
dFswXSApIHx8IGlzRGlzY29ubmVjdGVkKCBhbGxbMF0gKSA/CgkJCWFsbCA6CgkJ
CWpRdWVyeS51bmlxdWUoIGFsbCApICk7Cgl9LAoKCWFuZFNlbGY6IGZ1bmN0aW9u
KCkgewoJCXJldHVybiB0aGlzLmFkZCggdGhpcy5wcmV2T2JqZWN0ICk7Cgl9Cn0p
OwoKLy8gQSBwYWluZnVsbHkgc2ltcGxlIGNoZWNrIHRvIHNlZSBpZiBhbiBlbGVt
ZW50IGlzIGRpc2Nvbm5lY3RlZAovLyBmcm9tIGEgZG9jdW1lbnQgKHNob3VsZCBi
ZSBpbXByb3ZlZCwgd2hlcmUgZmVhc2libGUpLgpmdW5jdGlvbiBpc0Rpc2Nvbm5l
Y3RlZCggbm9kZSApIHsKCXJldHVybiAhbm9kZSB8fCAhbm9kZS5wYXJlbnROb2Rl
IHx8IG5vZGUucGFyZW50Tm9kZS5ub2RlVHlwZSA9PT0gMTE7Cn0KCmpRdWVyeS5l
YWNoKHsKCXBhcmVudDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJdmFyIHBhcmVudCA9
IGVsZW0ucGFyZW50Tm9kZTsKCQlyZXR1cm4gcGFyZW50ICYmIHBhcmVudC5ub2Rl
VHlwZSAhPT0gMTEgPyBwYXJlbnQgOiBudWxsOwoJfSwKCXBhcmVudHM6IGZ1bmN0
aW9uKCBlbGVtICkgewoJCXJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCAicGFyZW50
Tm9kZSIgKTsKCX0sCglwYXJlbnRzVW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1
bnRpbCApIHsKCQlyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgInBhcmVudE5vZGUi
LCB1bnRpbCApOwoJfSwKCW5leHQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVy
biBqUXVlcnkubnRoKCBlbGVtLCAyLCAibmV4dFNpYmxpbmciICk7Cgl9LAoJcHJl
djogZnVuY3Rpb24oIGVsZW0gKSB7CgkJcmV0dXJuIGpRdWVyeS5udGgoIGVsZW0s
IDIsICJwcmV2aW91c1NpYmxpbmciICk7Cgl9LAoJbmV4dEFsbDogZnVuY3Rpb24o
IGVsZW0gKSB7CgkJcmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sICJuZXh0U2libGlu
ZyIgKTsKCX0sCglwcmV2QWxsOiBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4g
alF1ZXJ5LmRpciggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCX0sCgluZXh0
VW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHsKCQlyZXR1cm4galF1
ZXJ5LmRpciggZWxlbSwgIm5leHRTaWJsaW5nIiwgdW50aWwgKTsKCX0sCglwcmV2
VW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHsKCQlyZXR1cm4galF1
ZXJ5LmRpciggZWxlbSwgInByZXZpb3VzU2libGluZyIsIHVudGlsICk7Cgl9LAoJ
c2libGluZ3M6IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiBqUXVlcnkuc2li
bGluZyggKCBlbGVtLnBhcmVudE5vZGUgfHwge30gKS5maXJzdENoaWxkLCBlbGVt
ICk7Cgl9LAoJY2hpbGRyZW46IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiBq
UXVlcnkuc2libGluZyggZWxlbS5maXJzdENoaWxkICk7Cgl9LAoJY29udGVudHM6
IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiBqUXVlcnkubm9kZU5hbWUoIGVs
ZW0sICJpZnJhbWUiICkgPwoJCQllbGVtLmNvbnRlbnREb2N1bWVudCB8fCBlbGVt
LmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQgOgoJCQlqUXVlcnkubWFrZUFycmF5KCBl
bGVtLmNoaWxkTm9kZXMgKTsKCX0KfSwgZnVuY3Rpb24oIG5hbWUsIGZuICkgewoJ
alF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggdW50aWwsIHNlbGVjdG9yICkg
ewoJCXZhciByZXQgPSBqUXVlcnkubWFwKCB0aGlzLCBmbiwgdW50aWwgKTsKCgkJ
aWYgKCAhcnVudGlsLnRlc3QoIG5hbWUgKSApIHsKCQkJc2VsZWN0b3IgPSB1bnRp
bDsKCQl9CgoJCWlmICggc2VsZWN0b3IgJiYgdHlwZW9mIHNlbGVjdG9yID09PSAi
c3RyaW5nIiApIHsKCQkJcmV0ID0galF1ZXJ5LmZpbHRlciggc2VsZWN0b3IsIHJl
dCApOwoJCX0KCgkJcmV0ID0gdGhpcy5sZW5ndGggPiAxICYmICFndWFyYW50ZWVk
VW5pcXVlWyBuYW1lIF0gPyBqUXVlcnkudW5pcXVlKCByZXQgKSA6IHJldDsKCgkJ
aWYgKCAodGhpcy5sZW5ndGggPiAxIHx8IHJtdWx0aXNlbGVjdG9yLnRlc3QoIHNl
bGVjdG9yICkpICYmIHJwYXJlbnRzcHJldi50ZXN0KCBuYW1lICkgKSB7CgkJCXJl
dCA9IHJldC5yZXZlcnNlKCk7CgkJfQoKCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2so
IHJldCwgbmFtZSwgc2xpY2UuY2FsbCggYXJndW1lbnRzICkuam9pbigiLCIpICk7
Cgl9Owp9KTsKCmpRdWVyeS5leHRlbmQoewoJZmlsdGVyOiBmdW5jdGlvbiggZXhw
ciwgZWxlbXMsIG5vdCApIHsKCQlpZiAoIG5vdCApIHsKCQkJZXhwciA9ICI6bm90
KCIgKyBleHByICsgIikiOwoJCX0KCgkJcmV0dXJuIGVsZW1zLmxlbmd0aCA9PT0g
MSA/CgkJCWpRdWVyeS5maW5kLm1hdGNoZXNTZWxlY3RvcihlbGVtc1swXSwgZXhw
cikgPyBbIGVsZW1zWzBdIF0gOiBbXSA6CgkJCWpRdWVyeS5maW5kLm1hdGNoZXMo
ZXhwciwgZWxlbXMpOwoJfSwKCglkaXI6IGZ1bmN0aW9uKCBlbGVtLCBkaXIsIHVu
dGlsICkgewoJCXZhciBtYXRjaGVkID0gW10sCgkJCWN1ciA9IGVsZW1bIGRpciBd
OwoKCQl3aGlsZSAoIGN1ciAmJiBjdXIubm9kZVR5cGUgIT09IDkgJiYgKHVudGls
ID09PSB1bmRlZmluZWQgfHwgY3VyLm5vZGVUeXBlICE9PSAxIHx8ICFqUXVlcnko
IGN1ciApLmlzKCB1bnRpbCApKSApIHsKCQkJaWYgKCBjdXIubm9kZVR5cGUgPT09
IDEgKSB7CgkJCQltYXRjaGVkLnB1c2goIGN1ciApOwoJCQl9CgkJCWN1ciA9IGN1
cltkaXJdOwoJCX0KCQlyZXR1cm4gbWF0Y2hlZDsKCX0sCgoJbnRoOiBmdW5jdGlv
biggY3VyLCByZXN1bHQsIGRpciwgZWxlbSApIHsKCQlyZXN1bHQgPSByZXN1bHQg
fHwgMTsKCQl2YXIgbnVtID0gMDsKCgkJZm9yICggOyBjdXI7IGN1ciA9IGN1cltk
aXJdICkgewoJCQlpZiAoIGN1ci5ub2RlVHlwZSA9PT0gMSAmJiArK251bSA9PT0g
cmVzdWx0ICkgewoJCQkJYnJlYWs7CgkJCX0KCQl9CgoJCXJldHVybiBjdXI7Cgl9
LAoKCXNpYmxpbmc6IGZ1bmN0aW9uKCBuLCBlbGVtICkgewoJCXZhciByID0gW107
CgoJCWZvciAoIDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcgKSB7CgkJCWlmICggbi5u
b2RlVHlwZSA9PT0gMSAmJiBuICE9PSBlbGVtICkgewoJCQkJci5wdXNoKCBuICk7
CgkJCX0KCQl9CgoJCXJldHVybiByOwoJfQp9KTsKCi8vIEltcGxlbWVudCB0aGUg
aWRlbnRpY2FsIGZ1bmN0aW9uYWxpdHkgZm9yIGZpbHRlciBhbmQgbm90CmZ1bmN0
aW9uIHdpbm5vdyggZWxlbWVudHMsIHF1YWxpZmllciwga2VlcCApIHsKCgkvLyBD
YW4ndCBwYXNzIG51bGwgb3IgdW5kZWZpbmVkIHRvIGluZGV4T2YgaW4gRmlyZWZv
eCA0CgkvLyBTZXQgdG8gMCB0byBza2lwIHN0cmluZyBjaGVjawoJcXVhbGlmaWVy
ID0gcXVhbGlmaWVyIHx8IDA7CgoJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggcXVh
bGlmaWVyICkgKSB7CgkJcmV0dXJuIGpRdWVyeS5ncmVwKGVsZW1lbnRzLCBmdW5j
dGlvbiggZWxlbSwgaSApIHsKCQkJdmFyIHJldFZhbCA9ICEhcXVhbGlmaWVyLmNh
bGwoIGVsZW0sIGksIGVsZW0gKTsKCQkJcmV0dXJuIHJldFZhbCA9PT0ga2VlcDsK
CQl9KTsKCgl9IGVsc2UgaWYgKCBxdWFsaWZpZXIubm9kZVR5cGUgKSB7CgkJcmV0
dXJuIGpRdWVyeS5ncmVwKGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSwgaSApIHsK
CQkJcmV0dXJuICggZWxlbSA9PT0gcXVhbGlmaWVyICkgPT09IGtlZXA7CgkJfSk7
CgoJfSBlbHNlIGlmICggdHlwZW9mIHF1YWxpZmllciA9PT0gInN0cmluZyIgKSB7
CgkJdmFyIGZpbHRlcmVkID0galF1ZXJ5LmdyZXAoZWxlbWVudHMsIGZ1bmN0aW9u
KCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMTsKCQl9KTsK
CgkJaWYgKCBpc1NpbXBsZS50ZXN0KCBxdWFsaWZpZXIgKSApIHsKCQkJcmV0dXJu
IGpRdWVyeS5maWx0ZXIocXVhbGlmaWVyLCBmaWx0ZXJlZCwgIWtlZXApOwoJCX0g
ZWxzZSB7CgkJCXF1YWxpZmllciA9IGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwg
ZmlsdGVyZWQgKTsKCQl9Cgl9CgoJcmV0dXJuIGpRdWVyeS5ncmVwKGVsZW1lbnRz
LCBmdW5jdGlvbiggZWxlbSwgaSApIHsKCQlyZXR1cm4gKCBqUXVlcnkuaW5BcnJh
eSggZWxlbSwgcXVhbGlmaWVyICkgPj0gMCApID09PSBrZWVwOwoJfSk7Cn0KCgoK
CmZ1bmN0aW9uIGNyZWF0ZVNhZmVGcmFnbWVudCggZG9jdW1lbnQgKSB7Cgl2YXIg
bGlzdCA9IG5vZGVOYW1lcy5zcGxpdCggInwiICksCglzYWZlRnJhZyA9IGRvY3Vt
ZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKCglpZiAoIHNhZmVGcmFnLmNy
ZWF0ZUVsZW1lbnQgKSB7CgkJd2hpbGUgKCBsaXN0Lmxlbmd0aCApIHsKCQkJc2Fm
ZUZyYWcuY3JlYXRlRWxlbWVudCgKCQkJCWxpc3QucG9wKCkKCQkJKTsKCQl9Cgl9
CglyZXR1cm4gc2FmZUZyYWc7Cn0KCnZhciBub2RlTmFtZXMgPSAiYWJicnxhcnRp
Y2xlfGFzaWRlfGF1ZGlvfGJkaXxjYW52YXN8ZGF0YXxkYXRhbGlzdHxkZXRhaWxz
fGZpZ2NhcHRpb258ZmlndXJlfGZvb3RlcnwiICsKCQkiaGVhZGVyfGhncm91cHxt
YXJrfG1ldGVyfG5hdnxvdXRwdXR8cHJvZ3Jlc3N8c2VjdGlvbnxzdW1tYXJ5fHRp
bWV8dmlkZW8iLAoJcmlubGluZWpRdWVyeSA9IC8galF1ZXJ5XGQrPSIoPzpcZCt8
bnVsbCkiL2csCglybGVhZGluZ1doaXRlc3BhY2UgPSAvXlxzKy8sCglyeGh0bWxU
YWcgPSAvPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1l
dGF8cGFyYW0pKChbXHc6XSspW14+XSopXC8+L2lnLAoJcnRhZ05hbWUgPSAvPChb
XHc6XSspLywKCXJ0Ym9keSA9IC88dGJvZHkvaSwKCXJodG1sID0gLzx8JiM/XHcr
Oy8sCglybm9Jbm5lcmh0bWwgPSAvPCg/OnNjcmlwdHxzdHlsZSkvaSwKCXJub2Nh
Y2hlID0gLzwoPzpzY3JpcHR8b2JqZWN0fGVtYmVkfG9wdGlvbnxzdHlsZSkvaSwK
CXJub3NoaW1jYWNoZSA9IG5ldyBSZWdFeHAoIjwoPzoiICsgbm9kZU5hbWVzICsg
IilbXFxzLz5dIiwgImkiKSwKCS8vIGNoZWNrZWQ9ImNoZWNrZWQiIG9yIGNoZWNr
ZWQKCXJjaGVja2VkID0gL2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4p
L2ksCglyc2NyaXB0VHlwZSA9IC9cLyhqYXZhfGVjbWEpc2NyaXB0L2ksCglyY2xl
YW5TY3JpcHQgPSAvXlxzKjwhKD86XFtDREFUQVxbfFwtXC0pLywKCXdyYXBNYXAg
PSB7CgkJb3B0aW9uOiBbIDEsICI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+
IiwgIjwvc2VsZWN0PiIgXSwKCQlsZWdlbmQ6IFsgMSwgIjxmaWVsZHNldD4iLCAi
PC9maWVsZHNldD4iIF0sCgkJdGhlYWQ6IFsgMSwgIjx0YWJsZT4iLCAiPC90YWJs
ZT4iIF0sCgkJdHI6IFsgMiwgIjx0YWJsZT48dGJvZHk+IiwgIjwvdGJvZHk+PC90
YWJsZT4iIF0sCgkJdGQ6IFsgMywgIjx0YWJsZT48dGJvZHk+PHRyPiIsICI8L3Ry
PjwvdGJvZHk+PC90YWJsZT4iIF0sCgkJY29sOiBbIDIsICI8dGFibGU+PHRib2R5
PjwvdGJvZHk+PGNvbGdyb3VwPiIsICI8L2NvbGdyb3VwPjwvdGFibGU+IiBdLAoJ
CWFyZWE6IFsgMSwgIjxtYXA+IiwgIjwvbWFwPiIgXSwKCQlfZGVmYXVsdDogWyAw
LCAiIiwgIiIgXQoJfSwKCXNhZmVGcmFnbWVudCA9IGNyZWF0ZVNhZmVGcmFnbWVu
dCggZG9jdW1lbnQgKTsKCndyYXBNYXAub3B0Z3JvdXAgPSB3cmFwTWFwLm9wdGlv
bjsKd3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdy
b3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDsKd3JhcE1hcC50
aCA9IHdyYXBNYXAudGQ7CgovLyBJRSBjYW4ndCBzZXJpYWxpemUgPGxpbms+IGFu
ZCA8c2NyaXB0PiB0YWdzIG5vcm1hbGx5CmlmICggIWpRdWVyeS5zdXBwb3J0Lmh0
bWxTZXJpYWxpemUgKSB7Cgl3cmFwTWFwLl9kZWZhdWx0ID0gWyAxLCAiZGl2PGRp
dj4iLCAiPC9kaXY+IiBdOwp9CgpqUXVlcnkuZm4uZXh0ZW5kKHsKCXRleHQ6IGZ1
bmN0aW9uKCB2YWx1ZSApIHsKCQlyZXR1cm4galF1ZXJ5LmFjY2VzcyggdGhpcywg
ZnVuY3Rpb24oIHZhbHVlICkgewoJCQlyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5l
ZCA/CgkJCQlqUXVlcnkudGV4dCggdGhpcyApIDoKCQkJCXRoaXMuZW1wdHkoKS5h
cHBlbmQoICggdGhpc1swXSAmJiB0aGlzWzBdLm93bmVyRG9jdW1lbnQgfHwgZG9j
dW1lbnQgKS5jcmVhdGVUZXh0Tm9kZSggdmFsdWUgKSApOwoJCX0sIG51bGwsIHZh
bHVlLCBhcmd1bWVudHMubGVuZ3RoICk7Cgl9LAoKCXdyYXBBbGw6IGZ1bmN0aW9u
KCBodG1sICkgewoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGh0bWwgKSApIHsK
CQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKSB7CgkJCQlqUXVlcnkodGhp
cykud3JhcEFsbCggaHRtbC5jYWxsKHRoaXMsIGkpICk7CgkJCX0pOwoJCX0KCgkJ
aWYgKCB0aGlzWzBdICkgewoJCQkvLyBUaGUgZWxlbWVudHMgdG8gd3JhcCB0aGUg
dGFyZ2V0IGFyb3VuZAoJCQl2YXIgd3JhcCA9IGpRdWVyeSggaHRtbCwgdGhpc1sw
XS5vd25lckRvY3VtZW50ICkuZXEoMCkuY2xvbmUodHJ1ZSk7CgoJCQlpZiAoIHRo
aXNbMF0ucGFyZW50Tm9kZSApIHsKCQkJCXdyYXAuaW5zZXJ0QmVmb3JlKCB0aGlz
WzBdICk7CgkJCX0KCgkJCXdyYXAubWFwKGZ1bmN0aW9uKCkgewoJCQkJdmFyIGVs
ZW0gPSB0aGlzOwoKCQkJCXdoaWxlICggZWxlbS5maXJzdENoaWxkICYmIGVsZW0u
Zmlyc3RDaGlsZC5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCQllbGVtID0gZWxlbS5m
aXJzdENoaWxkOwoJCQkJfQoKCQkJCXJldHVybiBlbGVtOwoJCQl9KS5hcHBlbmQo
IHRoaXMgKTsKCQl9CgoJCXJldHVybiB0aGlzOwoJfSwKCgl3cmFwSW5uZXI6IGZ1
bmN0aW9uKCBodG1sICkgewoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGh0bWwg
KSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKSB7CgkJCQlqUXVl
cnkodGhpcykud3JhcElubmVyKCBodG1sLmNhbGwodGhpcywgaSkgKTsKCQkJfSk7
CgkJfQoKCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQl2YXIgc2Vs
ZiA9IGpRdWVyeSggdGhpcyApLAoJCQkJY29udGVudHMgPSBzZWxmLmNvbnRlbnRz
KCk7CgoJCQlpZiAoIGNvbnRlbnRzLmxlbmd0aCApIHsKCQkJCWNvbnRlbnRzLndy
YXBBbGwoIGh0bWwgKTsKCgkJCX0gZWxzZSB7CgkJCQlzZWxmLmFwcGVuZCggaHRt
bCApOwoJCQl9CgkJfSk7Cgl9LAoKCXdyYXA6IGZ1bmN0aW9uKCBodG1sICkgewoJ
CXZhciBpc0Z1bmN0aW9uID0galF1ZXJ5LmlzRnVuY3Rpb24oIGh0bWwgKTsKCgkJ
cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKSB7CgkJCWpRdWVyeSggdGhpcyAp
LndyYXBBbGwoIGlzRnVuY3Rpb24gPyBodG1sLmNhbGwodGhpcywgaSkgOiBodG1s
ICk7CgkJfSk7Cgl9LAoKCXVud3JhcDogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHRo
aXMucGFyZW50KCkuZWFjaChmdW5jdGlvbigpIHsKCQkJaWYgKCAhalF1ZXJ5Lm5v
ZGVOYW1lKCB0aGlzLCAiYm9keSIgKSApIHsKCQkJCWpRdWVyeSggdGhpcyApLnJl
cGxhY2VXaXRoKCB0aGlzLmNoaWxkTm9kZXMgKTsKCQkJfQoJCX0pLmVuZCgpOwoJ
fSwKCglhcHBlbmQ6IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLmRvbU1hbmlw
KGFyZ3VtZW50cywgdHJ1ZSwgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCWlmICggdGhp
cy5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCXRoaXMuYXBwZW5kQ2hpbGQoIGVsZW0g
KTsKCQkJfQoJCX0pOwoJfSwKCglwcmVwZW5kOiBmdW5jdGlvbigpIHsKCQlyZXR1
cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsIHRydWUsIGZ1bmN0aW9uKCBlbGVt
ICkgewoJCQlpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgKSB7CgkJCQl0aGlzLmlu
c2VydEJlZm9yZSggZWxlbSwgdGhpcy5maXJzdENoaWxkICk7CgkJCX0KCQl9KTsK
CX0sCgoJYmVmb3JlOiBmdW5jdGlvbigpIHsKCQlpZiAoIHRoaXNbMF0gJiYgdGhp
c1swXS5wYXJlbnROb2RlICkgewoJCQlyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1
bWVudHMsIGZhbHNlLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXRoaXMucGFyZW50
Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMgKTsKCQkJfSk7CgkJfSBlbHNl
IGlmICggYXJndW1lbnRzLmxlbmd0aCApIHsKCQkJdmFyIHNldCA9IGpRdWVyeS5j
bGVhbiggYXJndW1lbnRzICk7CgkJCXNldC5wdXNoLmFwcGx5KCBzZXQsIHRoaXMu
dG9BcnJheSgpICk7CgkJCXJldHVybiB0aGlzLnB1c2hTdGFjayggc2V0LCAiYmVm
b3JlIiwgYXJndW1lbnRzICk7CgkJfQoJfSwKCglhZnRlcjogZnVuY3Rpb24oKSB7
CgkJaWYgKCB0aGlzWzBdICYmIHRoaXNbMF0ucGFyZW50Tm9kZSApIHsKCQkJcmV0
dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCBmYWxzZSwgZnVuY3Rpb24oIGVs
ZW0gKSB7CgkJCQl0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBlbGVtLCB0
aGlzLm5leHRTaWJsaW5nICk7CgkJCX0pOwoJCX0gZWxzZSBpZiAoIGFyZ3VtZW50
cy5sZW5ndGggKSB7CgkJCXZhciBzZXQgPSB0aGlzLnB1c2hTdGFjayggdGhpcywg
ImFmdGVyIiwgYXJndW1lbnRzICk7CgkJCXNldC5wdXNoLmFwcGx5KCBzZXQsIGpR
dWVyeS5jbGVhbihhcmd1bWVudHMpICk7CgkJCXJldHVybiBzZXQ7CgkJfQoJfSwK
CgkvLyBrZWVwRGF0YSBpcyBmb3IgaW50ZXJuYWwgdXNlIG9ubHktLWRvIG5vdCBk
b2N1bWVudAoJcmVtb3ZlOiBmdW5jdGlvbiggc2VsZWN0b3IsIGtlZXBEYXRhICkg
ewoJCWZvciAoIHZhciBpID0gMCwgZWxlbTsgKGVsZW0gPSB0aGlzW2ldKSAhPSBu
dWxsOyBpKysgKSB7CgkJCWlmICggIXNlbGVjdG9yIHx8IGpRdWVyeS5maWx0ZXIo
IHNlbGVjdG9yLCBbIGVsZW0gXSApLmxlbmd0aCApIHsKCQkJCWlmICggIWtlZXBE
YXRhICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJalF1ZXJ5LmNsZWFu
RGF0YSggZWxlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpICk7CgkJCQkJalF1
ZXJ5LmNsZWFuRGF0YSggWyBlbGVtIF0gKTsKCQkJCX0KCgkJCQlpZiAoIGVsZW0u
cGFyZW50Tm9kZSApIHsKCQkJCQllbGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQo
IGVsZW0gKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHRoaXM7Cgl9LAoKCWVt
cHR5OiBmdW5jdGlvbigpIHsKCQlmb3IgKCB2YXIgaSA9IDAsIGVsZW07IChlbGVt
ID0gdGhpc1tpXSkgIT0gbnVsbDsgaSsrICkgewoJCQkvLyBSZW1vdmUgZWxlbWVu
dCBub2RlcyBhbmQgcHJldmVudCBtZW1vcnkgbGVha3MKCQkJaWYgKCBlbGVtLm5v
ZGVUeXBlID09PSAxICkgewoJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZWxlbS5nZXRF
bGVtZW50c0J5VGFnTmFtZSgiKiIpICk7CgkJCX0KCgkJCS8vIFJlbW92ZSBhbnkg
cmVtYWluaW5nIG5vZGVzCgkJCXdoaWxlICggZWxlbS5maXJzdENoaWxkICkgewoJ
CQkJZWxlbS5yZW1vdmVDaGlsZCggZWxlbS5maXJzdENoaWxkICk7CgkJCX0KCQl9
CgoJCXJldHVybiB0aGlzOwoJfSwKCgljbG9uZTogZnVuY3Rpb24oIGRhdGFBbmRF
dmVudHMsIGRlZXBEYXRhQW5kRXZlbnRzICkgewoJCWRhdGFBbmRFdmVudHMgPSBk
YXRhQW5kRXZlbnRzID09IG51bGwgPyBmYWxzZSA6IGRhdGFBbmRFdmVudHM7CgkJ
ZGVlcERhdGFBbmRFdmVudHMgPSBkZWVwRGF0YUFuZEV2ZW50cyA9PSBudWxsID8g
ZGF0YUFuZEV2ZW50cyA6IGRlZXBEYXRhQW5kRXZlbnRzOwoKCQlyZXR1cm4gdGhp
cy5tYXAoIGZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIGpRdWVyeS5jbG9uZSggdGhp
cywgZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKTsKCQl9KTsKCX0s
CgoJaHRtbDogZnVuY3Rpb24oIHZhbHVlICkgewoJCXJldHVybiBqUXVlcnkuYWNj
ZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCXZhciBlbGVtID0gdGhp
c1swXSB8fCB7fSwKCQkJCWkgPSAwLAoJCQkJbCA9IHRoaXMubGVuZ3RoOwoKCQkJ
aWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICkgewoJCQkJcmV0dXJuIGVsZW0ubm9k
ZVR5cGUgPT09IDEgPwoJCQkJCWVsZW0uaW5uZXJIVE1MLnJlcGxhY2UoIHJpbmxp
bmVqUXVlcnksICIiICkgOgoJCQkJCW51bGw7CgkJCX0KCgoJCQlpZiAoIHR5cGVv
ZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgIXJub0lubmVyaHRtbC50ZXN0KCB2YWx1
ZSApICYmCgkJCQkoIGpRdWVyeS5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlIHx8
ICFybGVhZGluZ1doaXRlc3BhY2UudGVzdCggdmFsdWUgKSApICYmCgkJCQkhd3Jh
cE1hcFsgKCBydGFnTmFtZS5leGVjKCB2YWx1ZSApIHx8IFsiIiwgIiJdIClbMV0u
dG9Mb3dlckNhc2UoKSBdICkgewoKCQkJCXZhbHVlID0gdmFsdWUucmVwbGFjZSgg
cnhodG1sVGFnLCAiPCQxPjwvJDI+IiApOwoKCQkJCXRyeSB7CgkJCQkJZm9yICg7
IGkgPCBsOyBpKysgKSB7CgkJCQkJCS8vIFJlbW92ZSBlbGVtZW50IG5vZGVzIGFu
ZCBwcmV2ZW50IG1lbW9yeSBsZWFrcwoJCQkJCQllbGVtID0gdGhpc1tpXSB8fCB7
fTsKCQkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkgewoJCQkJCQkJalF1
ZXJ5LmNsZWFuRGF0YSggZWxlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSggIioiICkg
KTsKCQkJCQkJCWVsZW0uaW5uZXJIVE1MID0gdmFsdWU7CgkJCQkJCX0KCQkJCQl9
CgoJCQkJCWVsZW0gPSAwOwoKCQkJCS8vIElmIHVzaW5nIGlubmVySFRNTCB0aHJv
d3MgYW4gZXhjZXB0aW9uLCB1c2UgdGhlIGZhbGxiYWNrIG1ldGhvZAoJCQkJfSBj
YXRjaChlKSB7fQoJCQl9CgoJCQlpZiAoIGVsZW0gKSB7CgkJCQl0aGlzLmVtcHR5
KCkuYXBwZW5kKCB2YWx1ZSApOwoJCQl9CgkJfSwgbnVsbCwgdmFsdWUsIGFyZ3Vt
ZW50cy5sZW5ndGggKTsKCX0sCgoJcmVwbGFjZVdpdGg6IGZ1bmN0aW9uKCB2YWx1
ZSApIHsKCQlpZiAoIHRoaXNbMF0gJiYgdGhpc1swXS5wYXJlbnROb2RlICkgewoJ
CQkvLyBNYWtlIHN1cmUgdGhhdCB0aGUgZWxlbWVudHMgYXJlIHJlbW92ZWQgZnJv
bSB0aGUgRE9NIGJlZm9yZSB0aGV5IGFyZSBpbnNlcnRlZAoJCQkvLyB0aGlzIGNh
biBoZWxwIGZpeCByZXBsYWNpbmcgYSBwYXJlbnQgd2l0aCBjaGlsZCBlbGVtZW50
cwoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0
dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKSB7CgkJCQkJdmFyIHNlbGYgPSBqUXVl
cnkodGhpcyksIG9sZCA9IHNlbGYuaHRtbCgpOwoJCQkJCXNlbGYucmVwbGFjZVdp
dGgoIHZhbHVlLmNhbGwoIHRoaXMsIGksIG9sZCApICk7CgkJCQl9KTsKCQkJfQoK
CQkJaWYgKCB0eXBlb2YgdmFsdWUgIT09ICJzdHJpbmciICkgewoJCQkJdmFsdWUg
PSBqUXVlcnkoIHZhbHVlICkuZGV0YWNoKCk7CgkJCX0KCgkJCXJldHVybiB0aGlz
LmVhY2goZnVuY3Rpb24oKSB7CgkJCQl2YXIgbmV4dCA9IHRoaXMubmV4dFNpYmxp
bmcsCgkJCQkJcGFyZW50ID0gdGhpcy5wYXJlbnROb2RlOwoKCQkJCWpRdWVyeSgg
dGhpcyApLnJlbW92ZSgpOwoKCQkJCWlmICggbmV4dCApIHsKCQkJCQlqUXVlcnko
bmV4dCkuYmVmb3JlKCB2YWx1ZSApOwoJCQkJfSBlbHNlIHsKCQkJCQlqUXVlcnko
cGFyZW50KS5hcHBlbmQoIHZhbHVlICk7CgkJCQl9CgkJCX0pOwoJCX0gZWxzZSB7
CgkJCXJldHVybiB0aGlzLmxlbmd0aCA/CgkJCQl0aGlzLnB1c2hTdGFjayggalF1
ZXJ5KGpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlKCkgOiB2YWx1ZSks
ICJyZXBsYWNlV2l0aCIsIHZhbHVlICkgOgoJCQkJdGhpczsKCQl9Cgl9LAoKCWRl
dGFjaDogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCXJldHVybiB0aGlzLnJlbW92
ZSggc2VsZWN0b3IsIHRydWUgKTsKCX0sCgoJZG9tTWFuaXA6IGZ1bmN0aW9uKCBh
cmdzLCB0YWJsZSwgY2FsbGJhY2sgKSB7CgkJdmFyIHJlc3VsdHMsIGZpcnN0LCBm
cmFnbWVudCwgcGFyZW50LAoJCQl2YWx1ZSA9IGFyZ3NbMF0sCgkJCXNjcmlwdHMg
PSBbXTsKCgkJLy8gV2UgY2FuJ3QgY2xvbmVOb2RlIGZyYWdtZW50cyB0aGF0IGNv
bnRhaW4gY2hlY2tlZCwgaW4gV2ViS2l0CgkJaWYgKCAhalF1ZXJ5LnN1cHBvcnQu
Y2hlY2tDbG9uZSAmJiBhcmd1bWVudHMubGVuZ3RoID09PSAzICYmIHR5cGVvZiB2
YWx1ZSA9PT0gInN0cmluZyIgJiYgcmNoZWNrZWQudGVzdCggdmFsdWUgKSApIHsK
CQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCWpRdWVyeSh0aGlz
KS5kb21NYW5pcCggYXJncywgdGFibGUsIGNhbGxiYWNrLCB0cnVlICk7CgkJCX0p
OwoJCX0KCgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkgKSB7CgkJCXJl
dHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSkgewoJCQkJdmFyIHNlbGYgPSBqUXVl
cnkodGhpcyk7CgkJCQlhcmdzWzBdID0gdmFsdWUuY2FsbCh0aGlzLCBpLCB0YWJs
ZSA/IHNlbGYuaHRtbCgpIDogdW5kZWZpbmVkKTsKCQkJCXNlbGYuZG9tTWFuaXAo
IGFyZ3MsIHRhYmxlLCBjYWxsYmFjayApOwoJCQl9KTsKCQl9CgoJCWlmICggdGhp
c1swXSApIHsKCQkJcGFyZW50ID0gdmFsdWUgJiYgdmFsdWUucGFyZW50Tm9kZTsK
CgkJCS8vIElmIHdlJ3JlIGluIGEgZnJhZ21lbnQsIGp1c3QgdXNlIHRoYXQgaW5z
dGVhZCBvZiBidWlsZGluZyBhIG5ldyBvbmUKCQkJaWYgKCBqUXVlcnkuc3VwcG9y
dC5wYXJlbnROb2RlICYmIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgPT09IDEx
ICYmIHBhcmVudC5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gdGhpcy5sZW5ndGggKSB7
CgkJCQlyZXN1bHRzID0geyBmcmFnbWVudDogcGFyZW50IH07CgoJCQl9IGVsc2Ug
ewoJCQkJcmVzdWx0cyA9IGpRdWVyeS5idWlsZEZyYWdtZW50KCBhcmdzLCB0aGlz
LCBzY3JpcHRzICk7CgkJCX0KCgkJCWZyYWdtZW50ID0gcmVzdWx0cy5mcmFnbWVu
dDsKCgkJCWlmICggZnJhZ21lbnQuY2hpbGROb2Rlcy5sZW5ndGggPT09IDEgKSB7
CgkJCQlmaXJzdCA9IGZyYWdtZW50ID0gZnJhZ21lbnQuZmlyc3RDaGlsZDsKCQkJ
fSBlbHNlIHsKCQkJCWZpcnN0ID0gZnJhZ21lbnQuZmlyc3RDaGlsZDsKCQkJfQoK
CQkJaWYgKCBmaXJzdCApIHsKCQkJCXRhYmxlID0gdGFibGUgJiYgalF1ZXJ5Lm5v
ZGVOYW1lKCBmaXJzdCwgInRyIiApOwoKCQkJCWZvciAoIHZhciBpID0gMCwgbCA9
IHRoaXMubGVuZ3RoLCBsYXN0SW5kZXggPSBsIC0gMTsgaSA8IGw7IGkrKyApIHsK
CQkJCQljYWxsYmFjay5jYWxsKAoJCQkJCQl0YWJsZSA/CgkJCQkJCQlyb290KHRo
aXNbaV0sIGZpcnN0KSA6CgkJCQkJCQl0aGlzW2ldLAoJCQkJCQkvLyBNYWtlIHN1
cmUgdGhhdCB3ZSBkbyBub3QgbGVhayBtZW1vcnkgYnkgaW5hZHZlcnRlbnRseSBk
aXNjYXJkaW5nCgkJCQkJCS8vIHRoZSBvcmlnaW5hbCBmcmFnbWVudCAod2hpY2gg
bWlnaHQgaGF2ZSBhdHRhY2hlZCBkYXRhKSBpbnN0ZWFkIG9mCgkJCQkJCS8vIHVz
aW5nIGl0OyBpbiBhZGRpdGlvbiwgdXNlIHRoZSBvcmlnaW5hbCBmcmFnbWVudCBv
YmplY3QgZm9yIHRoZSBsYXN0CgkJCQkJCS8vIGl0ZW0gaW5zdGVhZCBvZiBmaXJz
dCBiZWNhdXNlIGl0IGNhbiBlbmQgdXAgYmVpbmcgZW1wdGllZCBpbmNvcnJlY3Rs
eQoJCQkJCQkvLyBpbiBjZXJ0YWluIHNpdHVhdGlvbnMgKEJ1ZyAjODA3MCkuCgkJ
CQkJCS8vIEZyYWdtZW50cyBmcm9tIHRoZSBmcmFnbWVudCBjYWNoZSBtdXN0IGFs
d2F5cyBiZSBjbG9uZWQgYW5kIG5ldmVyIHVzZWQKCQkJCQkJLy8gaW4gcGxhY2Uu
CgkJCQkJCXJlc3VsdHMuY2FjaGVhYmxlIHx8ICggbCA+IDEgJiYgaSA8IGxhc3RJ
bmRleCApID8KCQkJCQkJCWpRdWVyeS5jbG9uZSggZnJhZ21lbnQsIHRydWUsIHRy
dWUgKSA6CgkJCQkJCQlmcmFnbWVudAoJCQkJCSk7CgkJCQl9CgkJCX0KCgkJCWlm
ICggc2NyaXB0cy5sZW5ndGggKSB7CgkJCQlqUXVlcnkuZWFjaCggc2NyaXB0cywg
ZnVuY3Rpb24oIGksIGVsZW0gKSB7CgkJCQkJaWYgKCBlbGVtLnNyYyApIHsKCQkJ
CQkJalF1ZXJ5LmFqYXgoewoJCQkJCQkJdHlwZTogIkdFVCIsCgkJCQkJCQlnbG9i
YWw6IGZhbHNlLAoJCQkJCQkJdXJsOiBlbGVtLnNyYywKCQkJCQkJCWFzeW5jOiBm
YWxzZSwKCQkJCQkJCWRhdGFUeXBlOiAic2NyaXB0IgoJCQkJCQl9KTsKCQkJCQl9
IGVsc2UgewoJCQkJCQlqUXVlcnkuZ2xvYmFsRXZhbCggKCBlbGVtLnRleHQgfHwg
ZWxlbS50ZXh0Q29udGVudCB8fCBlbGVtLmlubmVySFRNTCB8fCAiIiApLnJlcGxh
Y2UoIHJjbGVhblNjcmlwdCwgIi8qJDAqLyIgKSApOwoJCQkJCX0KCgkJCQkJaWYg
KCBlbGVtLnBhcmVudE5vZGUgKSB7CgkJCQkJCWVsZW0ucGFyZW50Tm9kZS5yZW1v
dmVDaGlsZCggZWxlbSApOwoJCQkJCX0KCQkJCX0pOwoJCQl9CgkJfQoKCQlyZXR1
cm4gdGhpczsKCX0KfSk7CgpmdW5jdGlvbiByb290KCBlbGVtLCBjdXIgKSB7Cgly
ZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKGVsZW0sICJ0YWJsZSIpID8KCQkoZWxlbS5n
ZXRFbGVtZW50c0J5VGFnTmFtZSgidGJvZHkiKVswXSB8fAoJCWVsZW0uYXBwZW5k
Q2hpbGQoZWxlbS5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRib2R5Iikp
KSA6CgkJZWxlbTsKfQoKZnVuY3Rpb24gY2xvbmVDb3B5RXZlbnQoIHNyYywgZGVz
dCApIHsKCglpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgfHwgIWpRdWVyeS5oYXNE
YXRhKCBzcmMgKSApIHsKCQlyZXR1cm47Cgl9CgoJdmFyIHR5cGUsIGksIGwsCgkJ
b2xkRGF0YSA9IGpRdWVyeS5fZGF0YSggc3JjICksCgkJY3VyRGF0YSA9IGpRdWVy
eS5fZGF0YSggZGVzdCwgb2xkRGF0YSApLAoJCWV2ZW50cyA9IG9sZERhdGEuZXZl
bnRzOwoKCWlmICggZXZlbnRzICkgewoJCWRlbGV0ZSBjdXJEYXRhLmhhbmRsZTsK
CQljdXJEYXRhLmV2ZW50cyA9IHt9OwoKCQlmb3IgKCB0eXBlIGluIGV2ZW50cyAp
IHsKCQkJZm9yICggaSA9IDAsIGwgPSBldmVudHNbIHR5cGUgXS5sZW5ndGg7IGkg
PCBsOyBpKysgKSB7CgkJCQlqUXVlcnkuZXZlbnQuYWRkKCBkZXN0LCB0eXBlLCBl
dmVudHNbIHR5cGUgXVsgaSBdICk7CgkJCX0KCQl9Cgl9CgoJLy8gbWFrZSB0aGUg
Y2xvbmVkIHB1YmxpYyBkYXRhIG9iamVjdCBhIGNvcHkgZnJvbSB0aGUgb3JpZ2lu
YWwKCWlmICggY3VyRGF0YS5kYXRhICkgewoJCWN1ckRhdGEuZGF0YSA9IGpRdWVy
eS5leHRlbmQoIHt9LCBjdXJEYXRhLmRhdGEgKTsKCX0KfQoKZnVuY3Rpb24gY2xv
bmVGaXhBdHRyaWJ1dGVzKCBzcmMsIGRlc3QgKSB7Cgl2YXIgbm9kZU5hbWU7CgoJ
Ly8gV2UgZG8gbm90IG5lZWQgdG8gZG8gYW55dGhpbmcgZm9yIG5vbi1FbGVtZW50
cwoJaWYgKCBkZXN0Lm5vZGVUeXBlICE9PSAxICkgewoJCXJldHVybjsKCX0KCgkv
LyBjbGVhckF0dHJpYnV0ZXMgcmVtb3ZlcyB0aGUgYXR0cmlidXRlcywgd2hpY2gg
d2UgZG9uJ3Qgd2FudCwKCS8vIGJ1dCBhbHNvIHJlbW92ZXMgdGhlIGF0dGFjaEV2
ZW50IGV2ZW50cywgd2hpY2ggd2UgKmRvKiB3YW50CglpZiAoIGRlc3QuY2xlYXJB
dHRyaWJ1dGVzICkgewoJCWRlc3QuY2xlYXJBdHRyaWJ1dGVzKCk7Cgl9CgoJLy8g
bWVyZ2VBdHRyaWJ1dGVzLCBpbiBjb250cmFzdCwgb25seSBtZXJnZXMgYmFjayBv
biB0aGUKCS8vIG9yaWdpbmFsIGF0dHJpYnV0ZXMsIG5vdCB0aGUgZXZlbnRzCglp
ZiAoIGRlc3QubWVyZ2VBdHRyaWJ1dGVzICkgewoJCWRlc3QubWVyZ2VBdHRyaWJ1
dGVzKCBzcmMgKTsKCX0KCglub2RlTmFtZSA9IGRlc3Qubm9kZU5hbWUudG9Mb3dl
ckNhc2UoKTsKCgkvLyBJRTYtOCBmYWlsIHRvIGNsb25lIGNoaWxkcmVuIGluc2lk
ZSBvYmplY3QgZWxlbWVudHMgdGhhdCB1c2UKCS8vIHRoZSBwcm9wcmlldGFyeSBj
bGFzc2lkIGF0dHJpYnV0ZSB2YWx1ZSAocmF0aGVyIHRoYW4gdGhlIHR5cGUKCS8v
IGF0dHJpYnV0ZSkgdG8gaWRlbnRpZnkgdGhlIHR5cGUgb2YgY29udGVudCB0byBk
aXNwbGF5CglpZiAoIG5vZGVOYW1lID09PSAib2JqZWN0IiApIHsKCQlkZXN0Lm91
dGVySFRNTCA9IHNyYy5vdXRlckhUTUw7CgoJfSBlbHNlIGlmICggbm9kZU5hbWUg
PT09ICJpbnB1dCIgJiYgKHNyYy50eXBlID09PSAiY2hlY2tib3giIHx8IHNyYy50
eXBlID09PSAicmFkaW8iKSApIHsKCQkvLyBJRTYtOCBmYWlscyB0byBwZXJzaXN0
IHRoZSBjaGVja2VkIHN0YXRlIG9mIGEgY2xvbmVkIGNoZWNrYm94CgkJLy8gb3Ig
cmFkaW8gYnV0dG9uLiBXb3JzZSwgSUU2LTcgZmFpbCB0byBnaXZlIHRoZSBjbG9u
ZWQgZWxlbWVudAoJCS8vIGEgY2hlY2tlZCBhcHBlYXJhbmNlIGlmIHRoZSBkZWZh
dWx0Q2hlY2tlZCB2YWx1ZSBpc24ndCBhbHNvIHNldAoJCWlmICggc3JjLmNoZWNr
ZWQgKSB7CgkJCWRlc3QuZGVmYXVsdENoZWNrZWQgPSBkZXN0LmNoZWNrZWQgPSBz
cmMuY2hlY2tlZDsKCQl9CgoJCS8vIElFNi03IGdldCBjb25mdXNlZCBhbmQgZW5k
IHVwIHNldHRpbmcgdGhlIHZhbHVlIG9mIGEgY2xvbmVkCgkJLy8gY2hlY2tib3gv
cmFkaW8gYnV0dG9uIHRvIGFuIGVtcHR5IHN0cmluZyBpbnN0ZWFkIG9mICJvbiIK
CQlpZiAoIGRlc3QudmFsdWUgIT09IHNyYy52YWx1ZSApIHsKCQkJZGVzdC52YWx1
ZSA9IHNyYy52YWx1ZTsKCQl9CgoJLy8gSUU2LTggZmFpbHMgdG8gcmV0dXJuIHRo
ZSBzZWxlY3RlZCBvcHRpb24gdG8gdGhlIGRlZmF1bHQgc2VsZWN0ZWQKCS8vIHN0
YXRlIHdoZW4gY2xvbmluZyBvcHRpb25zCgl9IGVsc2UgaWYgKCBub2RlTmFtZSA9
PT0gIm9wdGlvbiIgKSB7CgkJZGVzdC5zZWxlY3RlZCA9IHNyYy5kZWZhdWx0U2Vs
ZWN0ZWQ7CgoJLy8gSUU2LTggZmFpbHMgdG8gc2V0IHRoZSBkZWZhdWx0VmFsdWUg
dG8gdGhlIGNvcnJlY3QgdmFsdWUgd2hlbgoJLy8gY2xvbmluZyBvdGhlciB0eXBl
cyBvZiBpbnB1dCBmaWVsZHMKCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAiaW5w
dXQiIHx8IG5vZGVOYW1lID09PSAidGV4dGFyZWEiICkgewoJCWRlc3QuZGVmYXVs
dFZhbHVlID0gc3JjLmRlZmF1bHRWYWx1ZTsKCgkvLyBJRSBibGFua3MgY29udGVu
dHMgd2hlbiBjbG9uaW5nIHNjcmlwdHMKCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09
PSAic2NyaXB0IiAmJiBkZXN0LnRleHQgIT09IHNyYy50ZXh0ICkgewoJCWRlc3Qu
dGV4dCA9IHNyYy50ZXh0OwoJfQoKCS8vIEV2ZW50IGRhdGEgZ2V0cyByZWZlcmVu
Y2VkIGluc3RlYWQgb2YgY29waWVkIGlmIHRoZSBleHBhbmRvCgkvLyBnZXRzIGNv
cGllZCB0b28KCWRlc3QucmVtb3ZlQXR0cmlidXRlKCBqUXVlcnkuZXhwYW5kbyAp
OwoKCS8vIENsZWFyIGZsYWdzIGZvciBidWJibGluZyBzcGVjaWFsIGNoYW5nZS9z
dWJtaXQgZXZlbnRzLCB0aGV5IG11c3QKCS8vIGJlIHJlYXR0YWNoZWQgd2hlbiB0
aGUgbmV3bHkgY2xvbmVkIGV2ZW50cyBhcmUgZmlyc3QgYWN0aXZhdGVkCglkZXN0
LnJlbW92ZUF0dHJpYnV0ZSggIl9zdWJtaXRfYXR0YWNoZWQiICk7CglkZXN0LnJl
bW92ZUF0dHJpYnV0ZSggIl9jaGFuZ2VfYXR0YWNoZWQiICk7Cn0KCmpRdWVyeS5i
dWlsZEZyYWdtZW50ID0gZnVuY3Rpb24oIGFyZ3MsIG5vZGVzLCBzY3JpcHRzICkg
ewoJdmFyIGZyYWdtZW50LCBjYWNoZWFibGUsIGNhY2hlcmVzdWx0cywgZG9jLAoJ
Zmlyc3QgPSBhcmdzWyAwIF07CgoJLy8gbm9kZXMgbWF5IGNvbnRhaW4gZWl0aGVy
IGFuIGV4cGxpY2l0IGRvY3VtZW50IG9iamVjdCwKCS8vIGEgalF1ZXJ5IGNvbGxl
Y3Rpb24gb3IgY29udGV4dCBvYmplY3QuCgkvLyBJZiBub2Rlc1swXSBjb250YWlu
cyBhIHZhbGlkIG9iamVjdCB0byBhc3NpZ24gdG8gZG9jCglpZiAoIG5vZGVzICYm
IG5vZGVzWzBdICkgewoJCWRvYyA9IG5vZGVzWzBdLm93bmVyRG9jdW1lbnQgfHwg
bm9kZXNbMF07Cgl9CgoJLy8gRW5zdXJlIHRoYXQgYW4gYXR0ciBvYmplY3QgZG9l
c24ndCBpbmNvcnJlY3RseSBzdGFuZCBpbiBhcyBhIGRvY3VtZW50IG9iamVjdAoJ
Ly8gQ2hyb21lIGFuZCBGaXJlZm94IHNlZW0gdG8gYWxsb3cgdGhpcyB0byBvY2N1
ciBhbmQgd2lsbCB0aHJvdyBleGNlcHRpb24KCS8vIEZpeGVzICM4OTUwCglpZiAo
ICFkb2MuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCApIHsKCQlkb2MgPSBkb2N1bWVu
dDsKCX0KCgkvLyBPbmx5IGNhY2hlICJzbWFsbCIgKDEvMiBLQikgSFRNTCBzdHJp
bmdzIHRoYXQgYXJlIGFzc29jaWF0ZWQgd2l0aCB0aGUgbWFpbiBkb2N1bWVudAoJ
Ly8gQ2xvbmluZyBvcHRpb25zIGxvc2VzIHRoZSBzZWxlY3RlZCBzdGF0ZSwgc28g
ZG9uJ3QgY2FjaGUgdGhlbQoJLy8gSUUgNiBkb2Vzbid0IGxpa2UgaXQgd2hlbiB5
b3UgcHV0IDxvYmplY3Q+IG9yIDxlbWJlZD4gZWxlbWVudHMgaW4gYSBmcmFnbWVu
dAoJLy8gQWxzbywgV2ViS2l0IGRvZXMgbm90IGNsb25lICdjaGVja2VkJyBhdHRy
aWJ1dGVzIG9uIGNsb25lTm9kZSwgc28gZG9uJ3QgY2FjaGUKCS8vIExhc3RseSwg
SUU2LDcsOCB3aWxsIG5vdCBjb3JyZWN0bHkgcmV1c2UgY2FjaGVkIGZyYWdtZW50
cyB0aGF0IHdlcmUgY3JlYXRlZCBmcm9tIHVua25vd24gZWxlbXMgIzEwNTAxCglp
ZiAoIGFyZ3MubGVuZ3RoID09PSAxICYmIHR5cGVvZiBmaXJzdCA9PT0gInN0cmlu
ZyIgJiYgZmlyc3QubGVuZ3RoIDwgNTEyICYmIGRvYyA9PT0gZG9jdW1lbnQgJiYK
CQlmaXJzdC5jaGFyQXQoMCkgPT09ICI8IiAmJiAhcm5vY2FjaGUudGVzdCggZmly
c3QgKSAmJgoJCShqUXVlcnkuc3VwcG9ydC5jaGVja0Nsb25lIHx8ICFyY2hlY2tl
ZC50ZXN0KCBmaXJzdCApKSAmJgoJCShqUXVlcnkuc3VwcG9ydC5odG1sNUNsb25l
IHx8ICFybm9zaGltY2FjaGUudGVzdCggZmlyc3QgKSkgKSB7CgoJCWNhY2hlYWJs
ZSA9IHRydWU7CgoJCWNhY2hlcmVzdWx0cyA9IGpRdWVyeS5mcmFnbWVudHNbIGZp
cnN0IF07CgkJaWYgKCBjYWNoZXJlc3VsdHMgJiYgY2FjaGVyZXN1bHRzICE9PSAx
ICkgewoJCQlmcmFnbWVudCA9IGNhY2hlcmVzdWx0czsKCQl9Cgl9CgoJaWYgKCAh
ZnJhZ21lbnQgKSB7CgkJZnJhZ21lbnQgPSBkb2MuY3JlYXRlRG9jdW1lbnRGcmFn
bWVudCgpOwoJCWpRdWVyeS5jbGVhbiggYXJncywgZG9jLCBmcmFnbWVudCwgc2Ny
aXB0cyApOwoJfQoKCWlmICggY2FjaGVhYmxlICkgewoJCWpRdWVyeS5mcmFnbWVu
dHNbIGZpcnN0IF0gPSBjYWNoZXJlc3VsdHMgPyBmcmFnbWVudCA6IDE7Cgl9CgoJ
cmV0dXJuIHsgZnJhZ21lbnQ6IGZyYWdtZW50LCBjYWNoZWFibGU6IGNhY2hlYWJs
ZSB9Owp9OwoKalF1ZXJ5LmZyYWdtZW50cyA9IHt9OwoKalF1ZXJ5LmVhY2goewoJ
YXBwZW5kVG86ICJhcHBlbmQiLAoJcHJlcGVuZFRvOiAicHJlcGVuZCIsCglpbnNl
cnRCZWZvcmU6ICJiZWZvcmUiLAoJaW5zZXJ0QWZ0ZXI6ICJhZnRlciIsCglyZXBs
YWNlQWxsOiAicmVwbGFjZVdpdGgiCn0sIGZ1bmN0aW9uKCBuYW1lLCBvcmlnaW5h
bCApIHsKCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNlbGVjdG9yICkg
ewoJCXZhciByZXQgPSBbXSwKCQkJaW5zZXJ0ID0galF1ZXJ5KCBzZWxlY3RvciAp
LAoJCQlwYXJlbnQgPSB0aGlzLmxlbmd0aCA9PT0gMSAmJiB0aGlzWzBdLnBhcmVu
dE5vZGU7CgoJCWlmICggcGFyZW50ICYmIHBhcmVudC5ub2RlVHlwZSA9PT0gMTEg
JiYgcGFyZW50LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICYmIGluc2VydC5sZW5n
dGggPT09IDEgKSB7CgkJCWluc2VydFsgb3JpZ2luYWwgXSggdGhpc1swXSApOwoJ
CQlyZXR1cm4gdGhpczsKCgkJfSBlbHNlIHsKCQkJZm9yICggdmFyIGkgPSAwLCBs
ID0gaW5zZXJ0Lmxlbmd0aDsgaSA8IGw7IGkrKyApIHsKCQkJCXZhciBlbGVtcyA9
ICggaSA+IDAgPyB0aGlzLmNsb25lKHRydWUpIDogdGhpcyApLmdldCgpOwoJCQkJ
alF1ZXJ5KCBpbnNlcnRbaV0gKVsgb3JpZ2luYWwgXSggZWxlbXMgKTsKCQkJCXJl
dCA9IHJldC5jb25jYXQoIGVsZW1zICk7CgkJCX0KCgkJCXJldHVybiB0aGlzLnB1
c2hTdGFjayggcmV0LCBuYW1lLCBpbnNlcnQuc2VsZWN0b3IgKTsKCQl9Cgl9Owp9
KTsKCmZ1bmN0aW9uIGdldEFsbCggZWxlbSApIHsKCWlmICggdHlwZW9mIGVsZW0u
Z2V0RWxlbWVudHNCeVRhZ05hbWUgIT09ICJ1bmRlZmluZWQiICkgewoJCXJldHVy
biBlbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiKiIgKTsKCgl9IGVsc2UgaWYg
KCB0eXBlb2YgZWxlbS5xdWVyeVNlbGVjdG9yQWxsICE9PSAidW5kZWZpbmVkIiAp
IHsKCQlyZXR1cm4gZWxlbS5xdWVyeVNlbGVjdG9yQWxsKCAiKiIgKTsKCgl9IGVs
c2UgewoJCXJldHVybiBbXTsKCX0KfQoKLy8gVXNlZCBpbiBjbGVhbiwgZml4ZXMg
dGhlIGRlZmF1bHRDaGVja2VkIHByb3BlcnR5CmZ1bmN0aW9uIGZpeERlZmF1bHRD
aGVja2VkKCBlbGVtICkgewoJaWYgKCBlbGVtLnR5cGUgPT09ICJjaGVja2JveCIg
fHwgZWxlbS50eXBlID09PSAicmFkaW8iICkgewoJCWVsZW0uZGVmYXVsdENoZWNr
ZWQgPSBlbGVtLmNoZWNrZWQ7Cgl9Cn0KLy8gRmluZHMgYWxsIGlucHV0cyBhbmQg
cGFzc2VzIHRoZW0gdG8gZml4RGVmYXVsdENoZWNrZWQKZnVuY3Rpb24gZmluZElu
cHV0cyggZWxlbSApIHsKCXZhciBub2RlTmFtZSA9ICggZWxlbS5ub2RlTmFtZSB8
fCAiIiApLnRvTG93ZXJDYXNlKCk7CglpZiAoIG5vZGVOYW1lID09PSAiaW5wdXQi
ICkgewoJCWZpeERlZmF1bHRDaGVja2VkKCBlbGVtICk7CgkvLyBTa2lwIHNjcmlw
dHMsIGdldCBvdGhlciBjaGlsZHJlbgoJfSBlbHNlIGlmICggbm9kZU5hbWUgIT09
ICJzY3JpcHQiICYmIHR5cGVvZiBlbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lICE9
PSAidW5kZWZpbmVkIiApIHsKCQlqUXVlcnkuZ3JlcCggZWxlbS5nZXRFbGVtZW50
c0J5VGFnTmFtZSgiaW5wdXQiKSwgZml4RGVmYXVsdENoZWNrZWQgKTsKCX0KfQoK
Ly8gRGVyaXZlZCBGcm9tOiBodHRwOi8vd3d3LmllY3NzLmNvbS9zaGltcHJvdmUv
amF2YXNjcmlwdC9zaGltcHJvdmUuMS0wLTEuanMKZnVuY3Rpb24gc2hpbUNsb25l
Tm9kZSggZWxlbSApIHsKCXZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50
KCAiZGl2IiApOwoJc2FmZUZyYWdtZW50LmFwcGVuZENoaWxkKCBkaXYgKTsKCglk
aXYuaW5uZXJIVE1MID0gZWxlbS5vdXRlckhUTUw7CglyZXR1cm4gZGl2LmZpcnN0
Q2hpbGQ7Cn0KCmpRdWVyeS5leHRlbmQoewoJY2xvbmU6IGZ1bmN0aW9uKCBlbGVt
LCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApIHsKCQl2YXIgc3Jj
RWxlbWVudHMsCgkJCWRlc3RFbGVtZW50cywKCQkJaSwKCQkJLy8gSUU8PTggZG9l
cyBub3QgcHJvcGVybHkgY2xvbmUgZGV0YWNoZWQsIHVua25vd24gZWxlbWVudCBu
b2RlcwoJCQljbG9uZSA9IGpRdWVyeS5zdXBwb3J0Lmh0bWw1Q2xvbmUgfHwgalF1
ZXJ5LmlzWE1MRG9jKGVsZW0pIHx8ICFybm9zaGltY2FjaGUudGVzdCggIjwiICsg
ZWxlbS5ub2RlTmFtZSArICI+IiApID8KCQkJCWVsZW0uY2xvbmVOb2RlKCB0cnVl
ICkgOgoJCQkJc2hpbUNsb25lTm9kZSggZWxlbSApOwoKCQlpZiAoICghalF1ZXJ5
LnN1cHBvcnQubm9DbG9uZUV2ZW50IHx8ICFqUXVlcnkuc3VwcG9ydC5ub0Nsb25l
Q2hlY2tlZCkgJiYKCQkJCShlbGVtLm5vZGVUeXBlID09PSAxIHx8IGVsZW0ubm9k
ZVR5cGUgPT09IDExKSAmJiAhalF1ZXJ5LmlzWE1MRG9jKGVsZW0pICkgewoJCQkv
LyBJRSBjb3BpZXMgZXZlbnRzIGJvdW5kIHZpYSBhdHRhY2hFdmVudCB3aGVuIHVz
aW5nIGNsb25lTm9kZS4KCQkJLy8gQ2FsbGluZyBkZXRhY2hFdmVudCBvbiB0aGUg
Y2xvbmUgd2lsbCBhbHNvIHJlbW92ZSB0aGUgZXZlbnRzCgkJCS8vIGZyb20gdGhl
IG9yaWdpbmFsLiBJbiBvcmRlciB0byBnZXQgYXJvdW5kIHRoaXMsIHdlIHVzZSBz
b21lCgkJCS8vIHByb3ByaWV0YXJ5IG1ldGhvZHMgdG8gY2xlYXIgdGhlIGV2ZW50
cy4gVGhhbmtzIHRvIE1vb1Rvb2xzCgkJCS8vIGd1eXMgZm9yIHRoaXMgaG90bmVz
cy4KCgkJCWNsb25lRml4QXR0cmlidXRlcyggZWxlbSwgY2xvbmUgKTsKCgkJCS8v
IFVzaW5nIFNpenpsZSBoZXJlIGlzIGNyYXp5IHNsb3csIHNvIHdlIHVzZSBnZXRF
bGVtZW50c0J5VGFnTmFtZSBpbnN0ZWFkCgkJCXNyY0VsZW1lbnRzID0gZ2V0QWxs
KCBlbGVtICk7CgkJCWRlc3RFbGVtZW50cyA9IGdldEFsbCggY2xvbmUgKTsKCgkJ
CS8vIFdlaXJkIGl0ZXJhdGlvbiBiZWNhdXNlIElFIHdpbGwgcmVwbGFjZSB0aGUg
bGVuZ3RoIHByb3BlcnR5CgkJCS8vIHdpdGggYW4gZWxlbWVudCBpZiB5b3UgYXJl
IGNsb25pbmcgdGhlIGJvZHkgYW5kIG9uZSBvZiB0aGUKCQkJLy8gZWxlbWVudHMg
b24gdGhlIHBhZ2UgaGFzIGEgbmFtZSBvciBpZCBvZiAibGVuZ3RoIgoJCQlmb3Ig
KCBpID0gMDsgc3JjRWxlbWVudHNbaV07ICsraSApIHsKCQkJCS8vIEVuc3VyZSB0
aGF0IHRoZSBkZXN0aW5hdGlvbiBub2RlIGlzIG5vdCBudWxsOyBGaXhlcyAjOTU4
NwoJCQkJaWYgKCBkZXN0RWxlbWVudHNbaV0gKSB7CgkJCQkJY2xvbmVGaXhBdHRy
aWJ1dGVzKCBzcmNFbGVtZW50c1tpXSwgZGVzdEVsZW1lbnRzW2ldICk7CgkJCQl9
CgkJCX0KCQl9CgoJCS8vIENvcHkgdGhlIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5h
bCB0byB0aGUgY2xvbmUKCQlpZiAoIGRhdGFBbmRFdmVudHMgKSB7CgkJCWNsb25l
Q29weUV2ZW50KCBlbGVtLCBjbG9uZSApOwoKCQkJaWYgKCBkZWVwRGF0YUFuZEV2
ZW50cyApIHsKCQkJCXNyY0VsZW1lbnRzID0gZ2V0QWxsKCBlbGVtICk7CgkJCQlk
ZXN0RWxlbWVudHMgPSBnZXRBbGwoIGNsb25lICk7CgoJCQkJZm9yICggaSA9IDA7
IHNyY0VsZW1lbnRzW2ldOyArK2kgKSB7CgkJCQkJY2xvbmVDb3B5RXZlbnQoIHNy
Y0VsZW1lbnRzW2ldLCBkZXN0RWxlbWVudHNbaV0gKTsKCQkJCX0KCQkJfQoJCX0K
CgkJc3JjRWxlbWVudHMgPSBkZXN0RWxlbWVudHMgPSBudWxsOwoKCQkvLyBSZXR1
cm4gdGhlIGNsb25lZCBzZXQKCQlyZXR1cm4gY2xvbmU7Cgl9LAoKCWNsZWFuOiBm
dW5jdGlvbiggZWxlbXMsIGNvbnRleHQsIGZyYWdtZW50LCBzY3JpcHRzICkgewoJ
CXZhciBjaGVja1NjcmlwdFR5cGUsIHNjcmlwdCwgaiwKCQkJCXJldCA9IFtdOwoK
CQljb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDsKCgkJLy8gIWNvbnRleHQu
Y3JlYXRlRWxlbWVudCBmYWlscyBpbiBJRSB3aXRoIGFuIGVycm9yIGJ1dCByZXR1
cm5zIHR5cGVvZiAnb2JqZWN0JwoJCWlmICggdHlwZW9mIGNvbnRleHQuY3JlYXRl
RWxlbWVudCA9PT0gInVuZGVmaW5lZCIgKSB7CgkJCWNvbnRleHQgPSBjb250ZXh0
Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dFswXSAmJiBjb250ZXh0WzBdLm93bmVy
RG9jdW1lbnQgfHwgZG9jdW1lbnQ7CgkJfQoKCQlmb3IgKCB2YXIgaSA9IDAsIGVs
ZW07IChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKyApIHsKCQkJaWYgKCB0
eXBlb2YgZWxlbSA9PT0gIm51bWJlciIgKSB7CgkJCQllbGVtICs9ICIiOwoJCQl9
CgoJCQlpZiAoICFlbGVtICkgewoJCQkJY29udGludWU7CgkJCX0KCgkJCS8vIENv
bnZlcnQgaHRtbCBzdHJpbmcgaW50byBET00gbm9kZXMKCQkJaWYgKCB0eXBlb2Yg
ZWxlbSA9PT0gInN0cmluZyIgKSB7CgkJCQlpZiAoICFyaHRtbC50ZXN0KCBlbGVt
ICkgKSB7CgkJCQkJZWxlbSA9IGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIGVsZW0g
KTsKCQkJCX0gZWxzZSB7CgkJCQkJLy8gRml4ICJYSFRNTCItc3R5bGUgdGFncyBp
biBhbGwgYnJvd3NlcnMKCQkJCQllbGVtID0gZWxlbS5yZXBsYWNlKHJ4aHRtbFRh
ZywgIjwkMT48LyQyPiIpOwoKCQkJCQkvLyBUcmltIHdoaXRlc3BhY2UsIG90aGVy
d2lzZSBpbmRleE9mIHdvbid0IHdvcmsgYXMgZXhwZWN0ZWQKCQkJCQl2YXIgdGFn
ID0gKCBydGFnTmFtZS5leGVjKCBlbGVtICkgfHwgWyIiLCAiIl0gKVsxXS50b0xv
d2VyQ2FzZSgpLAoJCQkJCQl3cmFwID0gd3JhcE1hcFsgdGFnIF0gfHwgd3JhcE1h
cC5fZGVmYXVsdCwKCQkJCQkJZGVwdGggPSB3cmFwWzBdLAoJCQkJCQlkaXYgPSBj
b250ZXh0LmNyZWF0ZUVsZW1lbnQoImRpdiIpLAoJCQkJCQlzYWZlQ2hpbGROb2Rl
cyA9IHNhZmVGcmFnbWVudC5jaGlsZE5vZGVzLAoJCQkJCQlyZW1vdmU7CgoJCQkJ
CS8vIEFwcGVuZCB3cmFwcGVyIGVsZW1lbnQgdG8gdW5rbm93biBlbGVtZW50IHNh
ZmUgZG9jIGZyYWdtZW50CgkJCQkJaWYgKCBjb250ZXh0ID09PSBkb2N1bWVudCAp
IHsKCQkJCQkJLy8gVXNlIHRoZSBmcmFnbWVudCB3ZSd2ZSBhbHJlYWR5IGNyZWF0
ZWQgZm9yIHRoaXMgZG9jdW1lbnQKCQkJCQkJc2FmZUZyYWdtZW50LmFwcGVuZENo
aWxkKCBkaXYgKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkvLyBVc2UgYSBmcmFnbWVu
dCBjcmVhdGVkIHdpdGggdGhlIG93bmVyIGRvY3VtZW50CgkJCQkJCWNyZWF0ZVNh
ZmVGcmFnbWVudCggY29udGV4dCApLmFwcGVuZENoaWxkKCBkaXYgKTsKCQkJCQl9
CgoJCQkJCS8vIEdvIHRvIGh0bWwgYW5kIGJhY2ssIHRoZW4gcGVlbCBvZmYgZXh0
cmEgd3JhcHBlcnMKCQkJCQlkaXYuaW5uZXJIVE1MID0gd3JhcFsxXSArIGVsZW0g
KyB3cmFwWzJdOwoKCQkJCQkvLyBNb3ZlIHRvIHRoZSByaWdodCBkZXB0aAoJCQkJ
CXdoaWxlICggZGVwdGgtLSApIHsKCQkJCQkJZGl2ID0gZGl2Lmxhc3RDaGlsZDsK
CQkJCQl9CgoJCQkJCS8vIFJlbW92ZSBJRSdzIGF1dG9pbnNlcnRlZCA8dGJvZHk+
IGZyb20gdGFibGUgZnJhZ21lbnRzCgkJCQkJaWYgKCAhalF1ZXJ5LnN1cHBvcnQu
dGJvZHkgKSB7CgoJCQkJCQkvLyBTdHJpbmcgd2FzIGEgPHRhYmxlPiwgKm1heSog
aGF2ZSBzcHVyaW91cyA8dGJvZHk+CgkJCQkJCXZhciBoYXNCb2R5ID0gcnRib2R5
LnRlc3QoZWxlbSksCgkJCQkJCQl0Ym9keSA9IHRhZyA9PT0gInRhYmxlIiAmJiAh
aGFzQm9keSA/CgkJCQkJCQkJZGl2LmZpcnN0Q2hpbGQgJiYgZGl2LmZpcnN0Q2hp
bGQuY2hpbGROb2RlcyA6CgoJCQkJCQkJCS8vIFN0cmluZyB3YXMgYSBiYXJlIDx0
aGVhZD4gb3IgPHRmb290PgoJCQkJCQkJCXdyYXBbMV0gPT09ICI8dGFibGU+IiAm
JiAhaGFzQm9keSA/CgkJCQkJCQkJCWRpdi5jaGlsZE5vZGVzIDoKCQkJCQkJCQkJ
W107CgoJCQkJCQlmb3IgKCBqID0gdGJvZHkubGVuZ3RoIC0gMTsgaiA+PSAwIDsg
LS1qICkgewoJCQkJCQkJaWYgKCBqUXVlcnkubm9kZU5hbWUoIHRib2R5WyBqIF0s
ICJ0Ym9keSIgKSAmJiAhdGJvZHlbIGogXS5jaGlsZE5vZGVzLmxlbmd0aCApIHsK
CQkJCQkJCQl0Ym9keVsgaiBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIHRib2R5
WyBqIF0gKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gSUUgY29t
cGxldGVseSBraWxscyBsZWFkaW5nIHdoaXRlc3BhY2Ugd2hlbiBpbm5lckhUTUwg
aXMgdXNlZAoJCQkJCWlmICggIWpRdWVyeS5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNw
YWNlICYmIHJsZWFkaW5nV2hpdGVzcGFjZS50ZXN0KCBlbGVtICkgKSB7CgkJCQkJ
CWRpdi5pbnNlcnRCZWZvcmUoIGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIHJsZWFk
aW5nV2hpdGVzcGFjZS5leGVjKGVsZW0pWzBdICksIGRpdi5maXJzdENoaWxkICk7
CgkJCQkJfQoKCQkJCQllbGVtID0gZGl2LmNoaWxkTm9kZXM7CgoJCQkJCS8vIENs
ZWFyIGVsZW1lbnRzIGZyb20gRG9jdW1lbnRGcmFnbWVudCAoc2FmZUZyYWdtZW50
IG9yIG90aGVyd2lzZSkKCQkJCQkvLyB0byBhdm9pZCBob2FyZGluZyBlbGVtZW50
cy4gRml4ZXMgIzExMzU2CgkJCQkJaWYgKCBkaXYgKSB7CgkJCQkJCWRpdi5wYXJl
bnROb2RlLnJlbW92ZUNoaWxkKCBkaXYgKTsKCgkJCQkJCS8vIEd1YXJkIGFnYWlu
c3QgLTEgaW5kZXggZXhjZXB0aW9ucyBpbiBGRjMuNgoJCQkJCQlpZiAoIHNhZmVD
aGlsZE5vZGVzLmxlbmd0aCA+IDAgKSB7CgkJCQkJCQlyZW1vdmUgPSBzYWZlQ2hp
bGROb2Rlc1sgc2FmZUNoaWxkTm9kZXMubGVuZ3RoIC0gMSBdOwoKCQkJCQkJCWlm
ICggcmVtb3ZlICYmIHJlbW92ZS5wYXJlbnROb2RlICkgewoJCQkJCQkJCXJlbW92
ZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCByZW1vdmUgKTsKCQkJCQkJCX0KCQkJ
CQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gUmVzZXRzIGRlZmF1bHRDaGVj
a2VkIGZvciBhbnkgcmFkaW9zIGFuZCBjaGVja2JveGVzCgkJCS8vIGFib3V0IHRv
IGJlIGFwcGVuZGVkIHRvIHRoZSBET00gaW4gSUUgNi83ICgjODA2MCkKCQkJdmFy
IGxlbjsKCQkJaWYgKCAhalF1ZXJ5LnN1cHBvcnQuYXBwZW5kQ2hlY2tlZCApIHsK
CQkJCWlmICggZWxlbVswXSAmJiB0eXBlb2YgKGxlbiA9IGVsZW0ubGVuZ3RoKSA9
PT0gIm51bWJlciIgKSB7CgkJCQkJZm9yICggaiA9IDA7IGogPCBsZW47IGorKyAp
IHsKCQkJCQkJZmluZElucHV0cyggZWxlbVtqXSApOwoJCQkJCX0KCQkJCX0gZWxz
ZSB7CgkJCQkJZmluZElucHV0cyggZWxlbSApOwoJCQkJfQoJCQl9CgoJCQlpZiAo
IGVsZW0ubm9kZVR5cGUgKSB7CgkJCQlyZXQucHVzaCggZWxlbSApOwoJCQl9IGVs
c2UgewoJCQkJcmV0ID0galF1ZXJ5Lm1lcmdlKCByZXQsIGVsZW0gKTsKCQkJfQoJ
CX0KCgkJaWYgKCBmcmFnbWVudCApIHsKCQkJY2hlY2tTY3JpcHRUeXBlID0gZnVu
Y3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gIWVsZW0udHlwZSB8fCByc2NyaXB0
VHlwZS50ZXN0KCBlbGVtLnR5cGUgKTsKCQkJfTsKCQkJZm9yICggaSA9IDA7IHJl
dFtpXTsgaSsrICkgewoJCQkJc2NyaXB0ID0gcmV0W2ldOwoJCQkJaWYgKCBzY3Jp
cHRzICYmIGpRdWVyeS5ub2RlTmFtZSggc2NyaXB0LCAic2NyaXB0IiApICYmICgh
c2NyaXB0LnR5cGUgfHwgcnNjcmlwdFR5cGUudGVzdCggc2NyaXB0LnR5cGUgKSkg
KSB7CgkJCQkJc2NyaXB0cy5wdXNoKCBzY3JpcHQucGFyZW50Tm9kZSA/IHNjcmlw
dC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBzY3JpcHQgKSA6IHNjcmlwdCApOwoK
CQkJCX0gZWxzZSB7CgkJCQkJaWYgKCBzY3JpcHQubm9kZVR5cGUgPT09IDEgKSB7
CgkJCQkJCXZhciBqc1RhZ3MgPSBqUXVlcnkuZ3JlcCggc2NyaXB0LmdldEVsZW1l
bnRzQnlUYWdOYW1lKCAic2NyaXB0IiApLCBjaGVja1NjcmlwdFR5cGUgKTsKCgkJ
CQkJCXJldC5zcGxpY2UuYXBwbHkoIHJldCwgW2kgKyAxLCAwXS5jb25jYXQoIGpz
VGFncyApICk7CgkJCQkJfQoJCQkJCWZyYWdtZW50LmFwcGVuZENoaWxkKCBzY3Jp
cHQgKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHJldDsKCX0sCgoJY2xlYW5E
YXRhOiBmdW5jdGlvbiggZWxlbXMgKSB7CgkJdmFyIGRhdGEsIGlkLAoJCQljYWNo
ZSA9IGpRdWVyeS5jYWNoZSwKCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVj
aWFsLAoJCQlkZWxldGVFeHBhbmRvID0galF1ZXJ5LnN1cHBvcnQuZGVsZXRlRXhw
YW5kbzsKCgkJZm9yICggdmFyIGkgPSAwLCBlbGVtOyAoZWxlbSA9IGVsZW1zW2ld
KSAhPSBudWxsOyBpKysgKSB7CgkJCWlmICggZWxlbS5ub2RlTmFtZSAmJiBqUXVl
cnkubm9EYXRhW2VsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0gKSB7CgkJCQlj
b250aW51ZTsKCQkJfQoKCQkJaWQgPSBlbGVtWyBqUXVlcnkuZXhwYW5kbyBdOwoK
CQkJaWYgKCBpZCApIHsKCQkJCWRhdGEgPSBjYWNoZVsgaWQgXTsKCgkJCQlpZiAo
IGRhdGEgJiYgZGF0YS5ldmVudHMgKSB7CgkJCQkJZm9yICggdmFyIHR5cGUgaW4g
ZGF0YS5ldmVudHMgKSB7CgkJCQkJCWlmICggc3BlY2lhbFsgdHlwZSBdICkgewoJ
CQkJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggZWxlbSwgdHlwZSApOwoKCQkJCQkJ
Ly8gVGhpcyBpcyBhIHNob3J0Y3V0IHRvIGF2b2lkIGpRdWVyeS5ldmVudC5yZW1v
dmUncyBvdmVyaGVhZAoJCQkJCQl9IGVsc2UgewoJCQkJCQkJalF1ZXJ5LnJlbW92
ZUV2ZW50KCBlbGVtLCB0eXBlLCBkYXRhLmhhbmRsZSApOwoJCQkJCQl9CgkJCQkJ
fQoKCQkJCQkvLyBOdWxsIHRoZSBET00gcmVmZXJlbmNlIHRvIGF2b2lkIElFNi83
LzggbGVhayAoIzcwNTQpCgkJCQkJaWYgKCBkYXRhLmhhbmRsZSApIHsKCQkJCQkJ
ZGF0YS5oYW5kbGUuZWxlbSA9IG51bGw7CgkJCQkJfQoJCQkJfQoKCQkJCWlmICgg
ZGVsZXRlRXhwYW5kbyApIHsKCQkJCQlkZWxldGUgZWxlbVsgalF1ZXJ5LmV4cGFu
ZG8gXTsKCgkJCQl9IGVsc2UgaWYgKCBlbGVtLnJlbW92ZUF0dHJpYnV0ZSApIHsK
CQkJCQllbGVtLnJlbW92ZUF0dHJpYnV0ZSggalF1ZXJ5LmV4cGFuZG8gKTsKCQkJ
CX0KCgkJCQlkZWxldGUgY2FjaGVbIGlkIF07CgkJCX0KCQl9Cgl9Cn0pOwoKCgoK
dmFyIHJhbHBoYSA9IC9hbHBoYVwoW14pXSpcKS9pLAoJcm9wYWNpdHkgPSAvb3Bh
Y2l0eT0oW14pXSopLywKCS8vIGZpeGVkIGZvciBJRTksIHNlZSAjODM0NgoJcnVw
cGVyID0gLyhbQS1aXXxebXMpL2csCglybnVtID0gL15bXC0rXT8oPzpcZCpcLik/
XGQrJC9pLAoJcm51bW5vbnB4ID0gL14tPyg/OlxkKlwuKT9cZCsoPyFweClbXlxk
XHNdKyQvaSwKCXJyZWxOdW0gPSAvXihbXC0rXSk9KFtcLSsuXGRlXSspLywKCXJt
YXJnaW4gPSAvXm1hcmdpbi8sCgoJY3NzU2hvdyA9IHsgcG9zaXRpb246ICJhYnNv
bHV0ZSIsIHZpc2liaWxpdHk6ICJoaWRkZW4iLCBkaXNwbGF5OiAiYmxvY2siIH0s
CgoJLy8gb3JkZXIgaXMgaW1wb3J0YW50IQoJY3NzRXhwYW5kID0gWyAiVG9wIiwg
IlJpZ2h0IiwgIkJvdHRvbSIsICJMZWZ0IiBdLAoKCWN1ckNTUywKCglnZXRDb21w
dXRlZFN0eWxlLAoJY3VycmVudFN0eWxlOwoKalF1ZXJ5LmZuLmNzcyA9IGZ1bmN0
aW9uKCBuYW1lLCB2YWx1ZSApIHsKCXJldHVybiBqUXVlcnkuYWNjZXNzKCB0aGlz
LCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJcmV0dXJuIHZhbHVl
ICE9PSB1bmRlZmluZWQgPwoJCQlqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUsIHZh
bHVlICkgOgoJCQlqUXVlcnkuY3NzKCBlbGVtLCBuYW1lICk7Cgl9LCBuYW1lLCB2
YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKfTsKCmpRdWVyeS5leHRlbmQo
ewoJLy8gQWRkIGluIHN0eWxlIHByb3BlcnR5IGhvb2tzIGZvciBvdmVycmlkaW5n
IHRoZSBkZWZhdWx0CgkvLyBiZWhhdmlvciBvZiBnZXR0aW5nIGFuZCBzZXR0aW5n
IGEgc3R5bGUgcHJvcGVydHkKCWNzc0hvb2tzOiB7CgkJb3BhY2l0eTogewoJCQln
ZXQ6IGZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJCWlmICggY29tcHV0
ZWQgKSB7CgkJCQkJLy8gV2Ugc2hvdWxkIGFsd2F5cyBnZXQgYSBudW1iZXIgYmFj
ayBmcm9tIG9wYWNpdHkKCQkJCQl2YXIgcmV0ID0gY3VyQ1NTKCBlbGVtLCAib3Bh
Y2l0eSIgKTsKCQkJCQlyZXR1cm4gcmV0ID09PSAiIiA/ICIxIiA6IHJldDsKCgkJ
CQl9IGVsc2UgewoJCQkJCXJldHVybiBlbGVtLnN0eWxlLm9wYWNpdHk7CgkJCQl9
CgkJCX0KCQl9Cgl9LAoKCS8vIEV4Y2x1ZGUgdGhlIGZvbGxvd2luZyBjc3MgcHJv
cGVydGllcyB0byBhZGQgcHgKCWNzc051bWJlcjogewoJCSJmaWxsT3BhY2l0eSI6
IHRydWUsCgkJImZvbnRXZWlnaHQiOiB0cnVlLAoJCSJsaW5lSGVpZ2h0IjogdHJ1
ZSwKCQkib3BhY2l0eSI6IHRydWUsCgkJIm9ycGhhbnMiOiB0cnVlLAoJCSJ3aWRv
d3MiOiB0cnVlLAoJCSJ6SW5kZXgiOiB0cnVlLAoJCSJ6b29tIjogdHJ1ZQoJfSwK
CgkvLyBBZGQgaW4gcHJvcGVydGllcyB3aG9zZSBuYW1lcyB5b3Ugd2lzaCB0byBm
aXggYmVmb3JlCgkvLyBzZXR0aW5nIG9yIGdldHRpbmcgdGhlIHZhbHVlCgljc3NQ
cm9wczogewoJCS8vIG5vcm1hbGl6ZSBmbG9hdCBjc3MgcHJvcGVydHkKCQkiZmxv
YXQiOiBqUXVlcnkuc3VwcG9ydC5jc3NGbG9hdCA/ICJjc3NGbG9hdCIgOiAic3R5
bGVGbG9hdCIKCX0sCgoJLy8gR2V0IGFuZCBzZXQgdGhlIHN0eWxlIHByb3BlcnR5
IG9uIGEgRE9NIE5vZGUKCXN0eWxlOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFs
dWUsIGV4dHJhICkgewoJCS8vIERvbid0IHNldCBzdHlsZXMgb24gdGV4dCBhbmQg
Y29tbWVudCBub2RlcwoJCWlmICggIWVsZW0gfHwgZWxlbS5ub2RlVHlwZSA9PT0g
MyB8fCBlbGVtLm5vZGVUeXBlID09PSA4IHx8ICFlbGVtLnN0eWxlICkgewoJCQly
ZXR1cm47CgkJfQoKCQkvLyBNYWtlIHN1cmUgdGhhdCB3ZSdyZSB3b3JraW5nIHdp
dGggdGhlIHJpZ2h0IG5hbWUKCQl2YXIgcmV0LCB0eXBlLCBvcmlnTmFtZSA9IGpR
dWVyeS5jYW1lbENhc2UoIG5hbWUgKSwKCQkJc3R5bGUgPSBlbGVtLnN0eWxlLCBo
b29rcyA9IGpRdWVyeS5jc3NIb29rc1sgb3JpZ05hbWUgXTsKCgkJbmFtZSA9IGpR
dWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSB8fCBvcmlnTmFtZTsKCgkJLy8gQ2hl
Y2sgaWYgd2UncmUgc2V0dGluZyBhIHZhbHVlCgkJaWYgKCB2YWx1ZSAhPT0gdW5k
ZWZpbmVkICkgewoJCQl0eXBlID0gdHlwZW9mIHZhbHVlOwoKCQkJLy8gY29udmVy
dCByZWxhdGl2ZSBudW1iZXIgc3RyaW5ncyAoKz0gb3IgLT0pIHRvIHJlbGF0aXZl
IG51bWJlcnMuICM3MzQ1CgkJCWlmICggdHlwZSA9PT0gInN0cmluZyIgJiYgKHJl
dCA9IHJyZWxOdW0uZXhlYyggdmFsdWUgKSkgKSB7CgkJCQl2YWx1ZSA9ICggKygg
cmV0WzFdICsgMSkgKiArcmV0WzJdICkgKyBwYXJzZUZsb2F0KCBqUXVlcnkuY3Nz
KCBlbGVtLCBuYW1lICkgKTsKCQkJCS8vIEZpeGVzIGJ1ZyAjOTIzNwoJCQkJdHlw
ZSA9ICJudW1iZXIiOwoJCQl9CgoJCQkvLyBNYWtlIHN1cmUgdGhhdCBOYU4gYW5k
IG51bGwgdmFsdWVzIGFyZW4ndCBzZXQuIFNlZTogIzcxMTYKCQkJaWYgKCB2YWx1
ZSA9PSBudWxsIHx8IHR5cGUgPT09ICJudW1iZXIiICYmIGlzTmFOKCB2YWx1ZSAp
ICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBJZiBhIG51bWJlciB3YXMgcGFz
c2VkIGluLCBhZGQgJ3B4JyB0byB0aGUgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1Mg
cHJvcGVydGllcykKCQkJaWYgKCB0eXBlID09PSAibnVtYmVyIiAmJiAhalF1ZXJ5
LmNzc051bWJlclsgb3JpZ05hbWUgXSApIHsKCQkJCXZhbHVlICs9ICJweCI7CgkJ
CX0KCgkJCS8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQsIHVzZSB0aGF0IHZhbHVl
LCBvdGhlcndpc2UganVzdCBzZXQgdGhlIHNwZWNpZmllZCB2YWx1ZQoJCQlpZiAo
ICFob29rcyB8fCAhKCJzZXQiIGluIGhvb2tzKSB8fCAodmFsdWUgPSBob29rcy5z
ZXQoIGVsZW0sIHZhbHVlICkpICE9PSB1bmRlZmluZWQgKSB7CgkJCQkvLyBXcmFw
cGVkIHRvIHByZXZlbnQgSUUgZnJvbSB0aHJvd2luZyBlcnJvcnMgd2hlbiAnaW52
YWxpZCcgdmFsdWVzIGFyZSBwcm92aWRlZAoJCQkJLy8gRml4ZXMgYnVnICM1NTA5
CgkJCQl0cnkgewoJCQkJCXN0eWxlWyBuYW1lIF0gPSB2YWx1ZTsKCQkJCX0gY2F0
Y2goZSkge30KCQkJfQoKCQl9IGVsc2UgewoJCQkvLyBJZiBhIGhvb2sgd2FzIHBy
b3ZpZGVkIGdldCB0aGUgbm9uLWNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmUKCQkJ
aWYgKCBob29rcyAmJiAiZ2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0
KCBlbGVtLCBmYWxzZSwgZXh0cmEgKSkgIT09IHVuZGVmaW5lZCApIHsKCQkJCXJl
dHVybiByZXQ7CgkJCX0KCgkJCS8vIE90aGVyd2lzZSBqdXN0IGdldCB0aGUgdmFs
dWUgZnJvbSB0aGUgc3R5bGUgb2JqZWN0CgkJCXJldHVybiBzdHlsZVsgbmFtZSBd
OwoJCX0KCX0sCgoJY3NzOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZXh0cmEgKSB7
CgkJdmFyIHJldCwgaG9va3M7CgoJCS8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdv
cmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoJCW5hbWUgPSBqUXVlcnkuY2FtZWxD
YXNlKCBuYW1lICk7CgkJaG9va3MgPSBqUXVlcnkuY3NzSG9va3NbIG5hbWUgXTsK
CQluYW1lID0galF1ZXJ5LmNzc1Byb3BzWyBuYW1lIF0gfHwgbmFtZTsKCgkJLy8g
Y3NzRmxvYXQgbmVlZHMgYSBzcGVjaWFsIHRyZWF0bWVudAoJCWlmICggbmFtZSA9
PT0gImNzc0Zsb2F0IiApIHsKCQkJbmFtZSA9ICJmbG9hdCI7CgkJfQoKCQkvLyBJ
ZiBhIGhvb2sgd2FzIHByb3ZpZGVkIGdldCB0aGUgY29tcHV0ZWQgdmFsdWUgZnJv
bSB0aGVyZQoJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9
IGhvb2tzLmdldCggZWxlbSwgdHJ1ZSwgZXh0cmEgKSkgIT09IHVuZGVmaW5lZCAp
IHsKCQkJcmV0dXJuIHJldDsKCgkJLy8gT3RoZXJ3aXNlLCBpZiBhIHdheSB0byBn
ZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGV4aXN0cywgdXNlIHRoYXQKCQl9IGVsc2Ug
aWYgKCBjdXJDU1MgKSB7CgkJCXJldHVybiBjdXJDU1MoIGVsZW0sIG5hbWUgKTsK
CQl9Cgl9LAoKCS8vIEEgbWV0aG9kIGZvciBxdWlja2x5IHN3YXBwaW5nIGluL291
dCBDU1MgcHJvcGVydGllcyB0byBnZXQgY29ycmVjdCBjYWxjdWxhdGlvbnMKCXN3
YXA6IGZ1bmN0aW9uKCBlbGVtLCBvcHRpb25zLCBjYWxsYmFjayApIHsKCQl2YXIg
b2xkID0ge30sCgkJCXJldCwgbmFtZTsKCgkJLy8gUmVtZW1iZXIgdGhlIG9sZCB2
YWx1ZXMsIGFuZCBpbnNlcnQgdGhlIG5ldyBvbmVzCgkJZm9yICggbmFtZSBpbiBv
cHRpb25zICkgewoJCQlvbGRbIG5hbWUgXSA9IGVsZW0uc3R5bGVbIG5hbWUgXTsK
CQkJZWxlbS5zdHlsZVsgbmFtZSBdID0gb3B0aW9uc1sgbmFtZSBdOwoJCX0KCgkJ
cmV0ID0gY2FsbGJhY2suY2FsbCggZWxlbSApOwoKCQkvLyBSZXZlcnQgdGhlIG9s
ZCB2YWx1ZXMKCQlmb3IgKCBuYW1lIGluIG9wdGlvbnMgKSB7CgkJCWVsZW0uc3R5
bGVbIG5hbWUgXSA9IG9sZFsgbmFtZSBdOwoJCX0KCgkJcmV0dXJuIHJldDsKCX0K
fSk7CgovLyBERVBSRUNBVEVEIGluIDEuMywgVXNlIGpRdWVyeS5jc3MoKSBpbnN0
ZWFkCmpRdWVyeS5jdXJDU1MgPSBqUXVlcnkuY3NzOwoKaWYgKCBkb2N1bWVudC5k
ZWZhdWx0VmlldyAmJiBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0
eWxlICkgewoJZ2V0Q29tcHV0ZWRTdHlsZSA9IGZ1bmN0aW9uKCBlbGVtLCBuYW1l
ICkgewoJCXZhciByZXQsIGRlZmF1bHRWaWV3LCBjb21wdXRlZFN0eWxlLCB3aWR0
aCwKCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQluYW1lID0gbmFtZS5yZXBsYWNl
KCBydXBwZXIsICItJDEiICkudG9Mb3dlckNhc2UoKTsKCgkJaWYgKCAoZGVmYXVs
dFZpZXcgPSBlbGVtLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpICYmCgkJCQko
Y29tcHV0ZWRTdHlsZSA9IGRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoIGVs
ZW0sIG51bGwgKSkgKSB7CgoJCQlyZXQgPSBjb21wdXRlZFN0eWxlLmdldFByb3Bl
cnR5VmFsdWUoIG5hbWUgKTsKCQkJaWYgKCByZXQgPT09ICIiICYmICFqUXVlcnku
Y29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIGVs
ZW0gKSApIHsKCQkJCXJldCA9IGpRdWVyeS5zdHlsZSggZWxlbSwgbmFtZSApOwoJ
CQl9CgkJfQoKCQkvLyBBIHRyaWJ1dGUgdG8gdGhlICJhd2Vzb21lIGhhY2sgYnkg
RGVhbiBFZHdhcmRzIgoJCS8vIFdlYktpdCB1c2VzICJjb21wdXRlZCB2YWx1ZSAo
cGVyY2VudGFnZSBpZiBzcGVjaWZpZWQpIiBpbnN0ZWFkIG9mICJ1c2VkIHZhbHVl
IiBmb3IgbWFyZ2lucwoJCS8vIHdoaWNoIGlzIGFnYWluc3QgdGhlIENTU09NIGRy
YWZ0IHNwZWM6IGh0dHA6Ly9kZXYudzMub3JnL2Nzc3dnL2Nzc29tLyNyZXNvbHZl
ZC12YWx1ZXMKCQlpZiAoICFqUXVlcnkuc3VwcG9ydC5waXhlbE1hcmdpbiAmJiBj
b21wdXRlZFN0eWxlICYmIHJtYXJnaW4udGVzdCggbmFtZSApICYmIHJudW1ub25w
eC50ZXN0KCByZXQgKSApIHsKCQkJd2lkdGggPSBzdHlsZS53aWR0aDsKCQkJc3R5
bGUud2lkdGggPSByZXQ7CgkJCXJldCA9IGNvbXB1dGVkU3R5bGUud2lkdGg7CgkJ
CXN0eWxlLndpZHRoID0gd2lkdGg7CgkJfQoKCQlyZXR1cm4gcmV0OwoJfTsKfQoK
aWYgKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlICkgewoJ
Y3VycmVudFN0eWxlID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7CgkJdmFyIGxl
ZnQsIHJzTGVmdCwgdW5jb21wdXRlZCwKCQkJcmV0ID0gZWxlbS5jdXJyZW50U3R5
bGUgJiYgZWxlbS5jdXJyZW50U3R5bGVbIG5hbWUgXSwKCQkJc3R5bGUgPSBlbGVt
LnN0eWxlOwoKCQkvLyBBdm9pZCBzZXR0aW5nIHJldCB0byBlbXB0eSBzdHJpbmcg
aGVyZQoJCS8vIHNvIHdlIGRvbid0IGRlZmF1bHQgdG8gYXV0bwoJCWlmICggcmV0
ID09IG51bGwgJiYgc3R5bGUgJiYgKHVuY29tcHV0ZWQgPSBzdHlsZVsgbmFtZSBd
KSApIHsKCQkJcmV0ID0gdW5jb21wdXRlZDsKCQl9CgoJCS8vIEZyb20gdGhlIGF3
ZXNvbWUgaGFjayBieSBEZWFuIEVkd2FyZHMKCQkvLyBodHRwOi8vZXJpay5lYWUu
bmV0L2FyY2hpdmVzLzIwMDcvMDcvMjcvMTguNTQuMTUvI2NvbW1lbnQtMTAyMjkx
CgoJCS8vIElmIHdlJ3JlIG5vdCBkZWFsaW5nIHdpdGggYSByZWd1bGFyIHBpeGVs
IG51bWJlcgoJCS8vIGJ1dCBhIG51bWJlciB0aGF0IGhhcyBhIHdlaXJkIGVuZGlu
Zywgd2UgbmVlZCB0byBjb252ZXJ0IGl0IHRvIHBpeGVscwoJCWlmICggcm51bW5v
bnB4LnRlc3QoIHJldCApICkgewoKCQkJLy8gUmVtZW1iZXIgdGhlIG9yaWdpbmFs
IHZhbHVlcwoJCQlsZWZ0ID0gc3R5bGUubGVmdDsKCQkJcnNMZWZ0ID0gZWxlbS5y
dW50aW1lU3R5bGUgJiYgZWxlbS5ydW50aW1lU3R5bGUubGVmdDsKCgkJCS8vIFB1
dCBpbiB0aGUgbmV3IHZhbHVlcyB0byBnZXQgYSBjb21wdXRlZCB2YWx1ZSBvdXQK
CQkJaWYgKCByc0xlZnQgKSB7CgkJCQllbGVtLnJ1bnRpbWVTdHlsZS5sZWZ0ID0g
ZWxlbS5jdXJyZW50U3R5bGUubGVmdDsKCQkJfQoJCQlzdHlsZS5sZWZ0ID0gbmFt
ZSA9PT0gImZvbnRTaXplIiA/ICIxZW0iIDogcmV0OwoJCQlyZXQgPSBzdHlsZS5w
aXhlbExlZnQgKyAicHgiOwoKCQkJLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVl
cwoJCQlzdHlsZS5sZWZ0ID0gbGVmdDsKCQkJaWYgKCByc0xlZnQgKSB7CgkJCQll
bGVtLnJ1bnRpbWVTdHlsZS5sZWZ0ID0gcnNMZWZ0OwoJCQl9CgkJfQoKCQlyZXR1
cm4gcmV0ID09PSAiIiA/ICJhdXRvIiA6IHJldDsKCX07Cn0KCmN1ckNTUyA9IGdl
dENvbXB1dGVkU3R5bGUgfHwgY3VycmVudFN0eWxlOwoKZnVuY3Rpb24gZ2V0V2lk
dGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKSB7CgoJLy8gU3RhcnQgd2l0
aCBvZmZzZXQgcHJvcGVydHkKCXZhciB2YWwgPSBuYW1lID09PSAid2lkdGgiID8g
ZWxlbS5vZmZzZXRXaWR0aCA6IGVsZW0ub2Zmc2V0SGVpZ2h0LAoJCWkgPSBuYW1l
ID09PSAid2lkdGgiID8gMSA6IDAsCgkJbGVuID0gNDsKCglpZiAoIHZhbCA+IDAg
KSB7CgkJaWYgKCBleHRyYSAhPT0gImJvcmRlciIgKSB7CgkJCWZvciAoIDsgaSA8
IGxlbjsgaSArPSAyICkgewoJCQkJaWYgKCAhZXh0cmEgKSB7CgkJCQkJdmFsIC09
IHBhcnNlRmxvYXQoIGpRdWVyeS5jc3MoIGVsZW0sICJwYWRkaW5nIiArIGNzc0V4
cGFuZFsgaSBdICkgKSB8fCAwOwoJCQkJfQoJCQkJaWYgKCBleHRyYSA9PT0gIm1h
cmdpbiIgKSB7CgkJCQkJdmFsICs9IHBhcnNlRmxvYXQoIGpRdWVyeS5jc3MoIGVs
ZW0sIGV4dHJhICsgY3NzRXhwYW5kWyBpIF0gKSApIHx8IDA7CgkJCQl9IGVsc2Ug
ewoJCQkJCXZhbCAtPSBwYXJzZUZsb2F0KCBqUXVlcnkuY3NzKCBlbGVtLCAiYm9y
ZGVyIiArIGNzc0V4cGFuZFsgaSBdICsgIldpZHRoIiApICkgfHwgMDsKCQkJCX0K
CQkJfQoJCX0KCgkJcmV0dXJuIHZhbCArICJweCI7Cgl9CgoJLy8gRmFsbCBiYWNr
IHRvIGNvbXB1dGVkIHRoZW4gdW5jb21wdXRlZCBjc3MgaWYgbmVjZXNzYXJ5Cgl2
YWwgPSBjdXJDU1MoIGVsZW0sIG5hbWUgKTsKCWlmICggdmFsIDwgMCB8fCB2YWwg
PT0gbnVsbCApIHsKCQl2YWwgPSBlbGVtLnN0eWxlWyBuYW1lIF07Cgl9CgoJLy8g
Q29tcHV0ZWQgdW5pdCBpcyBub3QgcGl4ZWxzLiBTdG9wIGhlcmUgYW5kIHJldHVy
bi4KCWlmICggcm51bW5vbnB4LnRlc3QodmFsKSApIHsKCQlyZXR1cm4gdmFsOwoJ
fQoKCS8vIE5vcm1hbGl6ZSAiIiwgYXV0bywgYW5kIHByZXBhcmUgZm9yIGV4dHJh
Cgl2YWwgPSBwYXJzZUZsb2F0KCB2YWwgKSB8fCAwOwoKCS8vIEFkZCBwYWRkaW5n
LCBib3JkZXIsIG1hcmdpbgoJaWYgKCBleHRyYSApIHsKCQlmb3IgKCA7IGkgPCBs
ZW47IGkgKz0gMiApIHsKCQkJdmFsICs9IHBhcnNlRmxvYXQoIGpRdWVyeS5jc3Mo
IGVsZW0sICJwYWRkaW5nIiArIGNzc0V4cGFuZFsgaSBdICkgKSB8fCAwOwoJCQlp
ZiAoIGV4dHJhICE9PSAicGFkZGluZyIgKSB7CgkJCQl2YWwgKz0gcGFyc2VGbG9h
dCggalF1ZXJ5LmNzcyggZWxlbSwgImJvcmRlciIgKyBjc3NFeHBhbmRbIGkgXSAr
ICJXaWR0aCIgKSApIHx8IDA7CgkJCX0KCQkJaWYgKCBleHRyYSA9PT0gIm1hcmdp
biIgKSB7CgkJCQl2YWwgKz0gcGFyc2VGbG9hdCggalF1ZXJ5LmNzcyggZWxlbSwg
ZXh0cmEgKyBjc3NFeHBhbmRbIGkgXSkgKSB8fCAwOwoJCQl9CgkJfQoJfQoKCXJl
dHVybiB2YWwgKyAicHgiOwp9CgpqUXVlcnkuZWFjaChbICJoZWlnaHQiLCAid2lk
dGgiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoJalF1ZXJ5LmNzc0hvb2tzWyBu
YW1lIF0gPSB7CgkJZ2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQsIGV4dHJh
ICkgewoJCQlpZiAoIGNvbXB1dGVkICkgewoJCQkJaWYgKCBlbGVtLm9mZnNldFdp
ZHRoICE9PSAwICkgewoJCQkJCXJldHVybiBnZXRXaWR0aE9ySGVpZ2h0KCBlbGVt
LCBuYW1lLCBleHRyYSApOwoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4galF1ZXJ5
LnN3YXAoIGVsZW0sIGNzc1Nob3csIGZ1bmN0aW9uKCkgewoJCQkJCQlyZXR1cm4g
Z2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTsKCQkJCQl9KTsK
CQkJCX0KCQkJfQoJCX0sCgoJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkg
ewoJCQlyZXR1cm4gcm51bS50ZXN0KCB2YWx1ZSApID8KCQkJCXZhbHVlICsgInB4
IiA6CgkJCQl2YWx1ZTsKCQl9Cgl9Owp9KTsKCmlmICggIWpRdWVyeS5zdXBwb3J0
Lm9wYWNpdHkgKSB7CglqUXVlcnkuY3NzSG9va3Mub3BhY2l0eSA9IHsKCQlnZXQ6
IGZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJLy8gSUUgdXNlcyBmaWx0
ZXJzIGZvciBvcGFjaXR5CgkJCXJldHVybiByb3BhY2l0eS50ZXN0KCAoY29tcHV0
ZWQgJiYgZWxlbS5jdXJyZW50U3R5bGUgPyBlbGVtLmN1cnJlbnRTdHlsZS5maWx0
ZXIgOiBlbGVtLnN0eWxlLmZpbHRlcikgfHwgIiIgKSA/CgkJCQkoIHBhcnNlRmxv
YXQoIFJlZ0V4cC4kMSApIC8gMTAwICkgKyAiIiA6CgkJCQljb21wdXRlZCA/ICIx
IiA6ICIiOwoJCX0sCgoJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJ
CQl2YXIgc3R5bGUgPSBlbGVtLnN0eWxlLAoJCQkJY3VycmVudFN0eWxlID0gZWxl
bS5jdXJyZW50U3R5bGUsCgkJCQlvcGFjaXR5ID0galF1ZXJ5LmlzTnVtZXJpYygg
dmFsdWUgKSA/ICJhbHBoYShvcGFjaXR5PSIgKyB2YWx1ZSAqIDEwMCArICIpIiA6
ICIiLAoJCQkJZmlsdGVyID0gY3VycmVudFN0eWxlICYmIGN1cnJlbnRTdHlsZS5m
aWx0ZXIgfHwgc3R5bGUuZmlsdGVyIHx8ICIiOwoKCQkJLy8gSUUgaGFzIHRyb3Vi
bGUgd2l0aCBvcGFjaXR5IGlmIGl0IGRvZXMgbm90IGhhdmUgbGF5b3V0CgkJCS8v
IEZvcmNlIGl0IGJ5IHNldHRpbmcgdGhlIHpvb20gbGV2ZWwKCQkJc3R5bGUuem9v
bSA9IDE7CgoJCQkvLyBpZiBzZXR0aW5nIG9wYWNpdHkgdG8gMSwgYW5kIG5vIG90
aGVyIGZpbHRlcnMgZXhpc3QgLSBhdHRlbXB0IHRvIHJlbW92ZSBmaWx0ZXIgYXR0
cmlidXRlICM2NjUyCgkJCWlmICggdmFsdWUgPj0gMSAmJiBqUXVlcnkudHJpbSgg
ZmlsdGVyLnJlcGxhY2UoIHJhbHBoYSwgIiIgKSApID09PSAiIiApIHsKCgkJCQkv
LyBTZXR0aW5nIHN0eWxlLmZpbHRlciB0byBudWxsLCAiIiAmICIgIiBzdGlsbCBs
ZWF2ZSAiZmlsdGVyOiIgaW4gdGhlIGNzc1RleHQKCQkJCS8vIGlmICJmaWx0ZXI6
IiBpcyBwcmVzZW50IGF0IGFsbCwgY2xlYXJUeXBlIGlzIGRpc2FibGVkLCB3ZSB3
YW50IHRvIGF2b2lkIHRoaXMKCQkJCS8vIHN0eWxlLnJlbW92ZUF0dHJpYnV0ZSBp
cyBJRSBPbmx5LCBidXQgc28gYXBwYXJlbnRseSBpcyB0aGlzIGNvZGUgcGF0aC4u
LgoJCQkJc3R5bGUucmVtb3ZlQXR0cmlidXRlKCAiZmlsdGVyIiApOwoKCQkJCS8v
IGlmIHRoZXJlIHRoZXJlIGlzIG5vIGZpbHRlciBzdHlsZSBhcHBsaWVkIGluIGEg
Y3NzIHJ1bGUsIHdlIGFyZSBkb25lCgkJCQlpZiAoIGN1cnJlbnRTdHlsZSAmJiAh
Y3VycmVudFN0eWxlLmZpbHRlciApIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCX0K
CgkJCS8vIG90aGVyd2lzZSwgc2V0IG5ldyBmaWx0ZXIgdmFsdWVzCgkJCXN0eWxl
LmZpbHRlciA9IHJhbHBoYS50ZXN0KCBmaWx0ZXIgKSA/CgkJCQlmaWx0ZXIucmVw
bGFjZSggcmFscGhhLCBvcGFjaXR5ICkgOgoJCQkJZmlsdGVyICsgIiAiICsgb3Bh
Y2l0eTsKCQl9Cgl9Owp9CgpqUXVlcnkoZnVuY3Rpb24oKSB7CgkvLyBUaGlzIGhv
b2sgY2Fubm90IGJlIGFkZGVkIHVudGlsIERPTSByZWFkeSBiZWNhdXNlIHRoZSBz
dXBwb3J0IHRlc3QKCS8vIGZvciBpdCBpcyBub3QgcnVuIHVudGlsIGFmdGVyIERP
TSByZWFkeQoJaWYgKCAhalF1ZXJ5LnN1cHBvcnQucmVsaWFibGVNYXJnaW5SaWdo
dCApIHsKCQlqUXVlcnkuY3NzSG9va3MubWFyZ2luUmlnaHQgPSB7CgkJCWdldDog
ZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCQkJLy8gV2ViS2l0IEJ1ZyAx
MzM0MyAtIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyB3cm9uZyB2YWx1ZSBmb3Ig
bWFyZ2luLXJpZ2h0CgkJCQkvLyBXb3JrIGFyb3VuZCBieSB0ZW1wb3JhcmlseSBz
ZXR0aW5nIGVsZW1lbnQgZGlzcGxheSB0byBpbmxpbmUtYmxvY2sKCQkJCXJldHVy
biBqUXVlcnkuc3dhcCggZWxlbSwgeyAiZGlzcGxheSI6ICJpbmxpbmUtYmxvY2si
IH0sIGZ1bmN0aW9uKCkgewoJCQkJCWlmICggY29tcHV0ZWQgKSB7CgkJCQkJCXJl
dHVybiBjdXJDU1MoIGVsZW0sICJtYXJnaW4tcmlnaHQiICk7CgkJCQkJfSBlbHNl
IHsKCQkJCQkJcmV0dXJuIGVsZW0uc3R5bGUubWFyZ2luUmlnaHQ7CgkJCQkJfQoJ
CQkJfSk7CgkJCX0KCQl9OwoJfQp9KTsKCmlmICggalF1ZXJ5LmV4cHIgJiYgalF1
ZXJ5LmV4cHIuZmlsdGVycyApIHsKCWpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVu
ID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJdmFyIHdpZHRoID0gZWxlbS5vZmZzZXRX
aWR0aCwKCQkJaGVpZ2h0ID0gZWxlbS5vZmZzZXRIZWlnaHQ7CgoJCXJldHVybiAo
IHdpZHRoID09PSAwICYmIGhlaWdodCA9PT0gMCApIHx8ICghalF1ZXJ5LnN1cHBv
cnQucmVsaWFibGVIaWRkZW5PZmZzZXRzICYmICgoZWxlbS5zdHlsZSAmJiBlbGVt
LnN0eWxlLmRpc3BsYXkpIHx8IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiAp
KSA9PT0gIm5vbmUiKTsKCX07CgoJalF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxl
ID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJcmV0dXJuICFqUXVlcnkuZXhwci5maWx0
ZXJzLmhpZGRlbiggZWxlbSApOwoJfTsKfQoKLy8gVGhlc2UgaG9va3MgYXJlIHVz
ZWQgYnkgYW5pbWF0ZSB0byBleHBhbmQgcHJvcGVydGllcwpqUXVlcnkuZWFjaCh7
CgltYXJnaW46ICIiLAoJcGFkZGluZzogIiIsCglib3JkZXI6ICJXaWR0aCIKfSwg
ZnVuY3Rpb24oIHByZWZpeCwgc3VmZml4ICkgewoKCWpRdWVyeS5jc3NIb29rc1sg
cHJlZml4ICsgc3VmZml4IF0gPSB7CgkJZXhwYW5kOiBmdW5jdGlvbiggdmFsdWUg
KSB7CgkJCXZhciBpLAoKCQkJCS8vIGFzc3VtZXMgYSBzaW5nbGUgbnVtYmVyIGlm
IG5vdCBhIHN0cmluZwoJCQkJcGFydHMgPSB0eXBlb2YgdmFsdWUgPT09ICJzdHJp
bmciID8gdmFsdWUuc3BsaXQoIiAiKSA6IFsgdmFsdWUgXSwKCQkJCWV4cGFuZGVk
ID0ge307CgoJCQlmb3IgKCBpID0gMDsgaSA8IDQ7IGkrKyApIHsKCQkJCWV4cGFu
ZGVkWyBwcmVmaXggKyBjc3NFeHBhbmRbIGkgXSArIHN1ZmZpeCBdID0KCQkJCQlw
YXJ0c1sgaSBdIHx8IHBhcnRzWyBpIC0gMiBdIHx8IHBhcnRzWyAwIF07CgkJCX0K
CgkJCXJldHVybiBleHBhbmRlZDsKCQl9Cgl9Owp9KTsKCgoKCnZhciByMjAgPSAv
JTIwL2csCglyYnJhY2tldCA9IC9cW1xdJC8sCglyQ1JMRiA9IC9ccj9cbi9nLAoJ
cmhhc2ggPSAvIy4qJC8sCglyaGVhZGVycyA9IC9eKC4qPyk6WyBcdF0qKFteXHJc
bl0qKVxyPyQvbWcsIC8vIElFIGxlYXZlcyBhbiBcciBjaGFyYWN0ZXIgYXQgRU9M
CglyaW5wdXQgPSAvXig/OmNvbG9yfGRhdGV8ZGF0ZXRpbWV8ZGF0ZXRpbWUtbG9j
YWx8ZW1haWx8aGlkZGVufG1vbnRofG51bWJlcnxwYXNzd29yZHxyYW5nZXxzZWFy
Y2h8dGVsfHRleHR8dGltZXx1cmx8d2VlaykkL2ksCgkvLyAjNzY1MywgIzgxMjUs
ICM4MTUyOiBsb2NhbCBwcm90b2NvbCBkZXRlY3Rpb24KCXJsb2NhbFByb3RvY29s
ID0gL14oPzphYm91dHxhcHB8YXBwXC1zdG9yYWdlfC4rXC1leHRlbnNpb258Zmls
ZXxyZXN8d2lkZ2V0KTokLywKCXJub0NvbnRlbnQgPSAvXig/OkdFVHxIRUFEKSQv
LAoJcnByb3RvY29sID0gL15cL1wvLywKCXJxdWVyeSA9IC9cPy8sCglyc2NyaXB0
ID0gLzxzY3JpcHRcYltePF0qKD86KD8hPFwvc2NyaXB0Pik8W148XSopKjxcL3Nj
cmlwdD4vZ2ksCglyc2VsZWN0VGV4dGFyZWEgPSAvXig/OnNlbGVjdHx0ZXh0YXJl
YSkvaSwKCXJzcGFjZXNBamF4ID0gL1xzKy8sCglydHMgPSAvKFs/Jl0pXz1bXiZd
Ki8sCglydXJsID0gL14oW1x3XCtcLlwtXSs6KSg/OlwvXC8oW15cLz8jOl0qKSg/
OjooXGQrKSk/KT8vLAoKCS8vIEtlZXAgYSBjb3B5IG9mIHRoZSBvbGQgbG9hZCBt
ZXRob2QKCV9sb2FkID0galF1ZXJ5LmZuLmxvYWQsCgoJLyogUHJlZmlsdGVycwoJ
ICogMSkgVGhleSBhcmUgdXNlZnVsIHRvIGludHJvZHVjZSBjdXN0b20gZGF0YVR5
cGVzIChzZWUgYWpheC9qc29ucC5qcyBmb3IgYW4gZXhhbXBsZSkKCSAqIDIpIFRo
ZXNlIGFyZSBjYWxsZWQ6CgkgKiAgICAtIEJFRk9SRSBhc2tpbmcgZm9yIGEgdHJh
bnNwb3J0CgkgKiAgICAtIEFGVEVSIHBhcmFtIHNlcmlhbGl6YXRpb24gKHMuZGF0
YSBpcyBhIHN0cmluZyBpZiBzLnByb2Nlc3NEYXRhIGlzIHRydWUpCgkgKiAzKSBr
ZXkgaXMgdGhlIGRhdGFUeXBlCgkgKiA0KSB0aGUgY2F0Y2hhbGwgc3ltYm9sICIq
IiBjYW4gYmUgdXNlZAoJICogNSkgZXhlY3V0aW9uIHdpbGwgc3RhcnQgd2l0aCB0
cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gY29udGludWUgZG93biB0byAiKiIg
aWYgbmVlZGVkCgkgKi8KCXByZWZpbHRlcnMgPSB7fSwKCgkvKiBUcmFuc3BvcnRz
IGJpbmRpbmdzCgkgKiAxKSBrZXkgaXMgdGhlIGRhdGFUeXBlCgkgKiAyKSB0aGUg
Y2F0Y2hhbGwgc3ltYm9sICIqIiBjYW4gYmUgdXNlZAoJICogMykgc2VsZWN0aW9u
IHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gZ28g
dG8gIioiIGlmIG5lZWRlZAoJICovCgl0cmFuc3BvcnRzID0ge30sCgoJLy8gRG9j
dW1lbnQgbG9jYXRpb24KCWFqYXhMb2NhdGlvbiwKCgkvLyBEb2N1bWVudCBsb2Nh
dGlvbiBzZWdtZW50cwoJYWpheExvY1BhcnRzLAoKCS8vIEF2b2lkIGNvbW1lbnQt
cHJvbG9nIGNoYXIgc2VxdWVuY2UgKCMxMDA5OCk7IG11c3QgYXBwZWFzZSBsaW50
IGFuZCBldmFkZSBjb21wcmVzc2lvbgoJYWxsVHlwZXMgPSBbIiovIl0gKyBbIioi
XTsKCi8vICM4MTM4LCBJRSBtYXkgdGhyb3cgYW4gZXhjZXB0aW9uIHdoZW4gYWNj
ZXNzaW5nCi8vIGEgZmllbGQgZnJvbSB3aW5kb3cubG9jYXRpb24gaWYgZG9jdW1l
bnQuZG9tYWluIGhhcyBiZWVuIHNldAp0cnkgewoJYWpheExvY2F0aW9uID0gbG9j
YXRpb24uaHJlZjsKfSBjYXRjaCggZSApIHsKCS8vIFVzZSB0aGUgaHJlZiBhdHRy
aWJ1dGUgb2YgYW4gQSBlbGVtZW50CgkvLyBzaW5jZSBJRSB3aWxsIG1vZGlmeSBp
dCBnaXZlbiBkb2N1bWVudC5sb2NhdGlvbgoJYWpheExvY2F0aW9uID0gZG9jdW1l
bnQuY3JlYXRlRWxlbWVudCggImEiICk7CglhamF4TG9jYXRpb24uaHJlZiA9ICIi
OwoJYWpheExvY2F0aW9uID0gYWpheExvY2F0aW9uLmhyZWY7Cn0KCi8vIFNlZ21l
bnQgbG9jYXRpb24gaW50byBwYXJ0cwphamF4TG9jUGFydHMgPSBydXJsLmV4ZWMo
IGFqYXhMb2NhdGlvbi50b0xvd2VyQ2FzZSgpICkgfHwgW107CgovLyBCYXNlICJj
b25zdHJ1Y3RvciIgZm9yIGpRdWVyeS5hamF4UHJlZmlsdGVyIGFuZCBqUXVlcnku
YWpheFRyYW5zcG9ydApmdW5jdGlvbiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9y
dHMoIHN0cnVjdHVyZSApIHsKCgkvLyBkYXRhVHlwZUV4cHJlc3Npb24gaXMgb3B0
aW9uYWwgYW5kIGRlZmF1bHRzIHRvICIqIgoJcmV0dXJuIGZ1bmN0aW9uKCBkYXRh
VHlwZUV4cHJlc3Npb24sIGZ1bmMgKSB7CgoJCWlmICggdHlwZW9mIGRhdGFUeXBl
RXhwcmVzc2lvbiAhPT0gInN0cmluZyIgKSB7CgkJCWZ1bmMgPSBkYXRhVHlwZUV4
cHJlc3Npb247CgkJCWRhdGFUeXBlRXhwcmVzc2lvbiA9ICIqIjsKCQl9CgoJCWlm
ICggalF1ZXJ5LmlzRnVuY3Rpb24oIGZ1bmMgKSApIHsKCQkJdmFyIGRhdGFUeXBl
cyA9IGRhdGFUeXBlRXhwcmVzc2lvbi50b0xvd2VyQ2FzZSgpLnNwbGl0KCByc3Bh
Y2VzQWpheCApLAoJCQkJaSA9IDAsCgkJCQlsZW5ndGggPSBkYXRhVHlwZXMubGVu
Z3RoLAoJCQkJZGF0YVR5cGUsCgkJCQlsaXN0LAoJCQkJcGxhY2VCZWZvcmU7CgoJ
CQkvLyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgZGF0YVR5cGVFeHByZXNzaW9u
CgkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJZGF0YVR5cGUgPSBk
YXRhVHlwZXNbIGkgXTsKCQkJCS8vIFdlIGNvbnRyb2wgaWYgd2UncmUgYXNrZWQg
dG8gYWRkIGJlZm9yZQoJCQkJLy8gYW55IGV4aXN0aW5nIGVsZW1lbnQKCQkJCXBs
YWNlQmVmb3JlID0gL15cKy8udGVzdCggZGF0YVR5cGUgKTsKCQkJCWlmICggcGxh
Y2VCZWZvcmUgKSB7CgkJCQkJZGF0YVR5cGUgPSBkYXRhVHlwZS5zdWJzdHIoIDEg
KSB8fCAiKiI7CgkJCQl9CgkJCQlsaXN0ID0gc3RydWN0dXJlWyBkYXRhVHlwZSBd
ID0gc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdOwoJCQkJLy8gdGhlbiB3ZSBh
ZGQgdG8gdGhlIHN0cnVjdHVyZSBhY2NvcmRpbmdseQoJCQkJbGlzdFsgcGxhY2VC
ZWZvcmUgPyAidW5zaGlmdCIgOiAicHVzaCIgXSggZnVuYyApOwoJCQl9CgkJfQoJ
fTsKfQoKLy8gQmFzZSBpbnNwZWN0aW9uIGZ1bmN0aW9uIGZvciBwcmVmaWx0ZXJz
IGFuZCB0cmFuc3BvcnRzCmZ1bmN0aW9uIGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFu
c3BvcnRzKCBzdHJ1Y3R1cmUsIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFY
SFIsCgkJZGF0YVR5cGUgLyogaW50ZXJuYWwgKi8sIGluc3BlY3RlZCAvKiBpbnRl
cm5hbCAqLyApIHsKCglkYXRhVHlwZSA9IGRhdGFUeXBlIHx8IG9wdGlvbnMuZGF0
YVR5cGVzWyAwIF07CglpbnNwZWN0ZWQgPSBpbnNwZWN0ZWQgfHwge307CgoJaW5z
cGVjdGVkWyBkYXRhVHlwZSBdID0gdHJ1ZTsKCgl2YXIgbGlzdCA9IHN0cnVjdHVy
ZVsgZGF0YVR5cGUgXSwKCQlpID0gMCwKCQlsZW5ndGggPSBsaXN0ID8gbGlzdC5s
ZW5ndGggOiAwLAoJCWV4ZWN1dGVPbmx5ID0gKCBzdHJ1Y3R1cmUgPT09IHByZWZp
bHRlcnMgKSwKCQlzZWxlY3Rpb247CgoJZm9yICggOyBpIDwgbGVuZ3RoICYmICgg
ZXhlY3V0ZU9ubHkgfHwgIXNlbGVjdGlvbiApOyBpKysgKSB7CgkJc2VsZWN0aW9u
ID0gbGlzdFsgaSBdKCBvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSICk7
CgkJLy8gSWYgd2UgZ290IHJlZGlyZWN0ZWQgdG8gYW5vdGhlciBkYXRhVHlwZQoJ
CS8vIHdlIHRyeSB0aGVyZSBpZiBleGVjdXRpbmcgb25seSBhbmQgbm90IGRvbmUg
YWxyZWFkeQoJCWlmICggdHlwZW9mIHNlbGVjdGlvbiA9PT0gInN0cmluZyIgKSB7
CgkJCWlmICggIWV4ZWN1dGVPbmx5IHx8IGluc3BlY3RlZFsgc2VsZWN0aW9uIF0g
KSB7CgkJCQlzZWxlY3Rpb24gPSB1bmRlZmluZWQ7CgkJCX0gZWxzZSB7CgkJCQlv
cHRpb25zLmRhdGFUeXBlcy51bnNoaWZ0KCBzZWxlY3Rpb24gKTsKCQkJCXNlbGVj
dGlvbiA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKAoJCQkJCQlzdHJ1
Y3R1cmUsIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIsIHNlbGVjdGlv
biwgaW5zcGVjdGVkICk7CgkJCX0KCQl9Cgl9CgkvLyBJZiB3ZSdyZSBvbmx5IGV4
ZWN1dGluZyBvciBub3RoaW5nIHdhcyBzZWxlY3RlZAoJLy8gd2UgdHJ5IHRoZSBj
YXRjaGFsbCBkYXRhVHlwZSBpZiBub3QgZG9uZSBhbHJlYWR5CglpZiAoICggZXhl
Y3V0ZU9ubHkgfHwgIXNlbGVjdGlvbiApICYmICFpbnNwZWN0ZWRbICIqIiBdICkg
ewoJCXNlbGVjdGlvbiA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKAoJ
CQkJc3RydWN0dXJlLCBvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSLCAi
KiIsIGluc3BlY3RlZCApOwoJfQoJLy8gdW5uZWNlc3Nhcnkgd2hlbiBvbmx5IGV4
ZWN1dGluZyAocHJlZmlsdGVycykKCS8vIGJ1dCBpdCdsbCBiZSBpZ25vcmVkIGJ5
IHRoZSBjYWxsZXIgaW4gdGhhdCBjYXNlCglyZXR1cm4gc2VsZWN0aW9uOwp9Cgov
LyBBIHNwZWNpYWwgZXh0ZW5kIGZvciBhamF4IG9wdGlvbnMKLy8gdGhhdCB0YWtl
cyAiZmxhdCIgb3B0aW9ucyAobm90IHRvIGJlIGRlZXAgZXh0ZW5kZWQpCi8vIEZp
eGVzICM5ODg3CmZ1bmN0aW9uIGFqYXhFeHRlbmQoIHRhcmdldCwgc3JjICkgewoJ
dmFyIGtleSwgZGVlcCwKCQlmbGF0T3B0aW9ucyA9IGpRdWVyeS5hamF4U2V0dGlu
Z3MuZmxhdE9wdGlvbnMgfHwge307Cglmb3IgKCBrZXkgaW4gc3JjICkgewoJCWlm
ICggc3JjWyBrZXkgXSAhPT0gdW5kZWZpbmVkICkgewoJCQkoIGZsYXRPcHRpb25z
WyBrZXkgXSA/IHRhcmdldCA6ICggZGVlcCB8fCAoIGRlZXAgPSB7fSApICkgKVsg
a2V5IF0gPSBzcmNbIGtleSBdOwoJCX0KCX0KCWlmICggZGVlcCApIHsKCQlqUXVl
cnkuZXh0ZW5kKCB0cnVlLCB0YXJnZXQsIGRlZXAgKTsKCX0KfQoKalF1ZXJ5LmZu
LmV4dGVuZCh7Cglsb2FkOiBmdW5jdGlvbiggdXJsLCBwYXJhbXMsIGNhbGxiYWNr
ICkgewoJCWlmICggdHlwZW9mIHVybCAhPT0gInN0cmluZyIgJiYgX2xvYWQgKSB7
CgkJCXJldHVybiBfbG9hZC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgoJCS8v
IERvbid0IGRvIGEgcmVxdWVzdCBpZiBubyBlbGVtZW50cyBhcmUgYmVpbmcgcmVx
dWVzdGVkCgkJfSBlbHNlIGlmICggIXRoaXMubGVuZ3RoICkgewoJCQlyZXR1cm4g
dGhpczsKCQl9CgoJCXZhciBvZmYgPSB1cmwuaW5kZXhPZiggIiAiICk7CgkJaWYg
KCBvZmYgPj0gMCApIHsKCQkJdmFyIHNlbGVjdG9yID0gdXJsLnNsaWNlKCBvZmYs
IHVybC5sZW5ndGggKTsKCQkJdXJsID0gdXJsLnNsaWNlKCAwLCBvZmYgKTsKCQl9
CgoJCS8vIERlZmF1bHQgdG8gYSBHRVQgcmVxdWVzdAoJCXZhciB0eXBlID0gIkdF
VCI7CgoJCS8vIElmIHRoZSBzZWNvbmQgcGFyYW1ldGVyIHdhcyBwcm92aWRlZAoJ
CWlmICggcGFyYW1zICkgewoJCQkvLyBJZiBpdCdzIGEgZnVuY3Rpb24KCQkJaWYg
KCBqUXVlcnkuaXNGdW5jdGlvbiggcGFyYW1zICkgKSB7CgkJCQkvLyBXZSBhc3N1
bWUgdGhhdCBpdCdzIHRoZSBjYWxsYmFjawoJCQkJY2FsbGJhY2sgPSBwYXJhbXM7
CgkJCQlwYXJhbXMgPSB1bmRlZmluZWQ7CgoJCQkvLyBPdGhlcndpc2UsIGJ1aWxk
IGEgcGFyYW0gc3RyaW5nCgkJCX0gZWxzZSBpZiAoIHR5cGVvZiBwYXJhbXMgPT09
ICJvYmplY3QiICkgewoJCQkJcGFyYW1zID0galF1ZXJ5LnBhcmFtKCBwYXJhbXMs
IGpRdWVyeS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWwgKTsKCQkJCXR5cGUgPSAi
UE9TVCI7CgkJCX0KCQl9CgoJCXZhciBzZWxmID0gdGhpczsKCgkJLy8gUmVxdWVz
dCB0aGUgcmVtb3RlIGRvY3VtZW50CgkJalF1ZXJ5LmFqYXgoewoJCQl1cmw6IHVy
bCwKCQkJdHlwZTogdHlwZSwKCQkJZGF0YVR5cGU6ICJodG1sIiwKCQkJZGF0YTog
cGFyYW1zLAoJCQkvLyBDb21wbGV0ZSBjYWxsYmFjayAocmVzcG9uc2VUZXh0IGlz
IHVzZWQgaW50ZXJuYWxseSkKCQkJY29tcGxldGU6IGZ1bmN0aW9uKCBqcVhIUiwg
c3RhdHVzLCByZXNwb25zZVRleHQgKSB7CgkJCQkvLyBTdG9yZSB0aGUgcmVzcG9u
c2UgYXMgc3BlY2lmaWVkIGJ5IHRoZSBqcVhIUiBvYmplY3QKCQkJCXJlc3BvbnNl
VGV4dCA9IGpxWEhSLnJlc3BvbnNlVGV4dDsKCQkJCS8vIElmIHN1Y2Nlc3NmdWws
IGluamVjdCB0aGUgSFRNTCBpbnRvIGFsbCB0aGUgbWF0Y2hlZCBlbGVtZW50cwoJ
CQkJaWYgKCBqcVhIUi5pc1Jlc29sdmVkKCkgKSB7CgkJCQkJLy8gIzQ4MjU6IEdl
dCB0aGUgYWN0dWFsIHJlc3BvbnNlIGluIGNhc2UKCQkJCQkvLyBhIGRhdGFGaWx0
ZXIgaXMgcHJlc2VudCBpbiBhamF4U2V0dGluZ3MKCQkJCQlqcVhIUi5kb25lKGZ1
bmN0aW9uKCByICkgewoJCQkJCQlyZXNwb25zZVRleHQgPSByOwoJCQkJCX0pOwoJ
CQkJCS8vIFNlZSBpZiBhIHNlbGVjdG9yIHdhcyBzcGVjaWZpZWQKCQkJCQlzZWxm
Lmh0bWwoIHNlbGVjdG9yID8KCQkJCQkJLy8gQ3JlYXRlIGEgZHVtbXkgZGl2IHRv
IGhvbGQgdGhlIHJlc3VsdHMKCQkJCQkJalF1ZXJ5KCI8ZGl2PiIpCgkJCQkJCQkv
LyBpbmplY3QgdGhlIGNvbnRlbnRzIG9mIHRoZSBkb2N1bWVudCBpbiwgcmVtb3Zp
bmcgdGhlIHNjcmlwdHMKCQkJCQkJCS8vIHRvIGF2b2lkIGFueSAnUGVybWlzc2lv
biBEZW5pZWQnIGVycm9ycyBpbiBJRQoJCQkJCQkJLmFwcGVuZChyZXNwb25zZVRl
eHQucmVwbGFjZShyc2NyaXB0LCAiIikpCgoJCQkJCQkJLy8gTG9jYXRlIHRoZSBz
cGVjaWZpZWQgZWxlbWVudHMKCQkJCQkJCS5maW5kKHNlbGVjdG9yKSA6CgoJCQkJ
CQkvLyBJZiBub3QsIGp1c3QgaW5qZWN0IHRoZSBmdWxsIHJlc3VsdAoJCQkJCQly
ZXNwb25zZVRleHQgKTsKCQkJCX0KCgkJCQlpZiAoIGNhbGxiYWNrICkgewoJCQkJ
CXNlbGYuZWFjaCggY2FsbGJhY2ssIFsgcmVzcG9uc2VUZXh0LCBzdGF0dXMsIGpx
WEhSIF0gKTsKCQkJCX0KCQkJfQoJCX0pOwoKCQlyZXR1cm4gdGhpczsKCX0sCgoJ
c2VyaWFsaXplOiBmdW5jdGlvbigpIHsKCQlyZXR1cm4galF1ZXJ5LnBhcmFtKCB0
aGlzLnNlcmlhbGl6ZUFycmF5KCkgKTsKCX0sCgoJc2VyaWFsaXplQXJyYXk6IGZ1
bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLm1hcChmdW5jdGlvbigpewoJCQlyZXR1
cm4gdGhpcy5lbGVtZW50cyA/IGpRdWVyeS5tYWtlQXJyYXkoIHRoaXMuZWxlbWVu
dHMgKSA6IHRoaXM7CgkJfSkKCQkuZmlsdGVyKGZ1bmN0aW9uKCl7CgkJCXJldHVy
biB0aGlzLm5hbWUgJiYgIXRoaXMuZGlzYWJsZWQgJiYKCQkJCSggdGhpcy5jaGVj
a2VkIHx8IHJzZWxlY3RUZXh0YXJlYS50ZXN0KCB0aGlzLm5vZGVOYW1lICkgfHwK
CQkJCQlyaW5wdXQudGVzdCggdGhpcy50eXBlICkgKTsKCQl9KQoJCS5tYXAoZnVu
Y3Rpb24oIGksIGVsZW0gKXsKCQkJdmFyIHZhbCA9IGpRdWVyeSggdGhpcyApLnZh
bCgpOwoKCQkJcmV0dXJuIHZhbCA9PSBudWxsID8KCQkJCW51bGwgOgoJCQkJalF1
ZXJ5LmlzQXJyYXkoIHZhbCApID8KCQkJCQlqUXVlcnkubWFwKCB2YWwsIGZ1bmN0
aW9uKCB2YWwsIGkgKXsKCQkJCQkJcmV0dXJuIHsgbmFtZTogZWxlbS5uYW1lLCB2
YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCAiXHJcbiIgKSB9OwoJCQkJCX0pIDoK
CQkJCQl7IG5hbWU6IGVsZW0ubmFtZSwgdmFsdWU6IHZhbC5yZXBsYWNlKCByQ1JM
RiwgIlxyXG4iICkgfTsKCQl9KS5nZXQoKTsKCX0KfSk7CgovLyBBdHRhY2ggYSBi
dW5jaCBvZiBmdW5jdGlvbnMgZm9yIGhhbmRsaW5nIGNvbW1vbiBBSkFYIGV2ZW50
cwpqUXVlcnkuZWFjaCggImFqYXhTdGFydCBhamF4U3RvcCBhamF4Q29tcGxldGUg
YWpheEVycm9yIGFqYXhTdWNjZXNzIGFqYXhTZW5kIi5zcGxpdCggIiAiICksIGZ1
bmN0aW9uKCBpLCBvICl7CglqUXVlcnkuZm5bIG8gXSA9IGZ1bmN0aW9uKCBmICl7
CgkJcmV0dXJuIHRoaXMub24oIG8sIGYgKTsKCX07Cn0pOwoKalF1ZXJ5LmVhY2go
IFsgImdldCIsICJwb3N0IiBdLCBmdW5jdGlvbiggaSwgbWV0aG9kICkgewoJalF1
ZXJ5WyBtZXRob2QgXSA9IGZ1bmN0aW9uKCB1cmwsIGRhdGEsIGNhbGxiYWNrLCB0
eXBlICkgewoJCS8vIHNoaWZ0IGFyZ3VtZW50cyBpZiBkYXRhIGFyZ3VtZW50IHdh
cyBvbWl0dGVkCgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggZGF0YSApICkgewoJ
CQl0eXBlID0gdHlwZSB8fCBjYWxsYmFjazsKCQkJY2FsbGJhY2sgPSBkYXRhOwoJ
CQlkYXRhID0gdW5kZWZpbmVkOwoJCX0KCgkJcmV0dXJuIGpRdWVyeS5hamF4KHsK
CQkJdHlwZTogbWV0aG9kLAoJCQl1cmw6IHVybCwKCQkJZGF0YTogZGF0YSwKCQkJ
c3VjY2VzczogY2FsbGJhY2ssCgkJCWRhdGFUeXBlOiB0eXBlCgkJfSk7Cgl9Owp9
KTsKCmpRdWVyeS5leHRlbmQoewoKCWdldFNjcmlwdDogZnVuY3Rpb24oIHVybCwg
Y2FsbGJhY2sgKSB7CgkJcmV0dXJuIGpRdWVyeS5nZXQoIHVybCwgdW5kZWZpbmVk
LCBjYWxsYmFjaywgInNjcmlwdCIgKTsKCX0sCgoJZ2V0SlNPTjogZnVuY3Rpb24o
IHVybCwgZGF0YSwgY2FsbGJhY2sgKSB7CgkJcmV0dXJuIGpRdWVyeS5nZXQoIHVy
bCwgZGF0YSwgY2FsbGJhY2ssICJqc29uIiApOwoJfSwKCgkvLyBDcmVhdGVzIGEg
ZnVsbCBmbGVkZ2VkIHNldHRpbmdzIG9iamVjdCBpbnRvIHRhcmdldAoJLy8gd2l0
aCBib3RoIGFqYXhTZXR0aW5ncyBhbmQgc2V0dGluZ3MgZmllbGRzLgoJLy8gSWYg
dGFyZ2V0IGlzIG9taXR0ZWQsIHdyaXRlcyBpbnRvIGFqYXhTZXR0aW5ncy4KCWFq
YXhTZXR1cDogZnVuY3Rpb24oIHRhcmdldCwgc2V0dGluZ3MgKSB7CgkJaWYgKCBz
ZXR0aW5ncyApIHsKCQkJLy8gQnVpbGRpbmcgYSBzZXR0aW5ncyBvYmplY3QKCQkJ
YWpheEV4dGVuZCggdGFyZ2V0LCBqUXVlcnkuYWpheFNldHRpbmdzICk7CgkJfSBl
bHNlIHsKCQkJLy8gRXh0ZW5kaW5nIGFqYXhTZXR0aW5ncwoJCQlzZXR0aW5ncyA9
IHRhcmdldDsKCQkJdGFyZ2V0ID0galF1ZXJ5LmFqYXhTZXR0aW5nczsKCQl9CgkJ
YWpheEV4dGVuZCggdGFyZ2V0LCBzZXR0aW5ncyApOwoJCXJldHVybiB0YXJnZXQ7
Cgl9LAoKCWFqYXhTZXR0aW5nczogewoJCXVybDogYWpheExvY2F0aW9uLAoJCWlz
TG9jYWw6IHJsb2NhbFByb3RvY29sLnRlc3QoIGFqYXhMb2NQYXJ0c1sgMSBdICks
CgkJZ2xvYmFsOiB0cnVlLAoJCXR5cGU6ICJHRVQiLAoJCWNvbnRlbnRUeXBlOiAi
YXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04
IiwKCQlwcm9jZXNzRGF0YTogdHJ1ZSwKCQlhc3luYzogdHJ1ZSwKCQkvKgoJCXRp
bWVvdXQ6IDAsCgkJZGF0YTogbnVsbCwKCQlkYXRhVHlwZTogbnVsbCwKCQl1c2Vy
bmFtZTogbnVsbCwKCQlwYXNzd29yZDogbnVsbCwKCQljYWNoZTogbnVsbCwKCQl0
cmFkaXRpb25hbDogZmFsc2UsCgkJaGVhZGVyczoge30sCgkJKi8KCgkJYWNjZXB0
czogewoJCQl4bWw6ICJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIiwKCQkJaHRt
bDogInRleHQvaHRtbCIsCgkJCXRleHQ6ICJ0ZXh0L3BsYWluIiwKCQkJanNvbjog
ImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCIsCgkJCSIqIjogYWxs
VHlwZXMKCQl9LAoKCQljb250ZW50czogewoJCQl4bWw6IC94bWwvLAoJCQlodG1s
OiAvaHRtbC8sCgkJCWpzb246IC9qc29uLwoJCX0sCgoJCXJlc3BvbnNlRmllbGRz
OiB7CgkJCXhtbDogInJlc3BvbnNlWE1MIiwKCQkJdGV4dDogInJlc3BvbnNlVGV4
dCIKCQl9LAoKCQkvLyBMaXN0IG9mIGRhdGEgY29udmVydGVycwoJCS8vIDEpIGtl
eSBmb3JtYXQgaXMgInNvdXJjZV90eXBlIGRlc3RpbmF0aW9uX3R5cGUiIChhIHNp
bmdsZSBzcGFjZSBpbi1iZXR3ZWVuKQoJCS8vIDIpIHRoZSBjYXRjaGFsbCBzeW1i
b2wgIioiIGNhbiBiZSB1c2VkIGZvciBzb3VyY2VfdHlwZQoJCWNvbnZlcnRlcnM6
IHsKCgkJCS8vIENvbnZlcnQgYW55dGhpbmcgdG8gdGV4dAoJCQkiKiB0ZXh0Ijog
d2luZG93LlN0cmluZywKCgkJCS8vIFRleHQgdG8gaHRtbCAodHJ1ZSA9IG5vIHRy
YW5zZm9ybWF0aW9uKQoJCQkidGV4dCBodG1sIjogdHJ1ZSwKCgkJCS8vIEV2YWx1
YXRlIHRleHQgYXMgYSBqc29uIGV4cHJlc3Npb24KCQkJInRleHQganNvbiI6IGpR
dWVyeS5wYXJzZUpTT04sCgoJCQkvLyBQYXJzZSB0ZXh0IGFzIHhtbAoJCQkidGV4
dCB4bWwiOiBqUXVlcnkucGFyc2VYTUwKCQl9LAoKCQkvLyBGb3Igb3B0aW9ucyB0
aGF0IHNob3VsZG4ndCBiZSBkZWVwIGV4dGVuZGVkOgoJCS8vIHlvdSBjYW4gYWRk
IHlvdXIgb3duIGN1c3RvbSBvcHRpb25zIGhlcmUgaWYKCQkvLyBhbmQgd2hlbiB5
b3UgY3JlYXRlIG9uZSB0aGF0IHNob3VsZG4ndCBiZQoJCS8vIGRlZXAgZXh0ZW5k
ZWQgKHNlZSBhamF4RXh0ZW5kKQoJCWZsYXRPcHRpb25zOiB7CgkJCWNvbnRleHQ6
IHRydWUsCgkJCXVybDogdHJ1ZQoJCX0KCX0sCgoJYWpheFByZWZpbHRlcjogYWRk
VG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBwcmVmaWx0ZXJzICksCglhamF4VHJh
bnNwb3J0OiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHRyYW5zcG9ydHMg
KSwKCgkvLyBNYWluIG1ldGhvZAoJYWpheDogZnVuY3Rpb24oIHVybCwgb3B0aW9u
cyApIHsKCgkJLy8gSWYgdXJsIGlzIGFuIG9iamVjdCwgc2ltdWxhdGUgcHJlLTEu
NSBzaWduYXR1cmUKCQlpZiAoIHR5cGVvZiB1cmwgPT09ICJvYmplY3QiICkgewoJ
CQlvcHRpb25zID0gdXJsOwoJCQl1cmwgPSB1bmRlZmluZWQ7CgkJfQoKCQkvLyBG
b3JjZSBvcHRpb25zIHRvIGJlIGFuIG9iamVjdAoJCW9wdGlvbnMgPSBvcHRpb25z
IHx8IHt9OwoKCQl2YXIgLy8gQ3JlYXRlIHRoZSBmaW5hbCBvcHRpb25zIG9iamVj
dAoJCQlzID0galF1ZXJ5LmFqYXhTZXR1cCgge30sIG9wdGlvbnMgKSwKCQkJLy8g
Q2FsbGJhY2tzIGNvbnRleHQKCQkJY2FsbGJhY2tDb250ZXh0ID0gcy5jb250ZXh0
IHx8IHMsCgkJCS8vIENvbnRleHQgZm9yIGdsb2JhbCBldmVudHMKCQkJLy8gSXQn
cyB0aGUgY2FsbGJhY2tDb250ZXh0IGlmIG9uZSB3YXMgcHJvdmlkZWQgaW4gdGhl
IG9wdGlvbnMKCQkJLy8gYW5kIGlmIGl0J3MgYSBET00gbm9kZSBvciBhIGpRdWVy
eSBjb2xsZWN0aW9uCgkJCWdsb2JhbEV2ZW50Q29udGV4dCA9IGNhbGxiYWNrQ29u
dGV4dCAhPT0gcyAmJgoJCQkJKCBjYWxsYmFja0NvbnRleHQubm9kZVR5cGUgfHwg
Y2FsbGJhY2tDb250ZXh0IGluc3RhbmNlb2YgalF1ZXJ5ICkgPwoJCQkJCQlqUXVl
cnkoIGNhbGxiYWNrQ29udGV4dCApIDogalF1ZXJ5LmV2ZW50LAoJCQkvLyBEZWZl
cnJlZHMKCQkJZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKSwKCQkJY29tcGxl
dGVEZWZlcnJlZCA9IGpRdWVyeS5DYWxsYmFja3MoICJvbmNlIG1lbW9yeSIgKSwK
CQkJLy8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKCQkJc3RhdHVzQ29kZSA9
IHMuc3RhdHVzQ29kZSB8fCB7fSwKCQkJLy8gaWZNb2RpZmllZCBrZXkKCQkJaWZN
b2RpZmllZEtleSwKCQkJLy8gSGVhZGVycyAodGhleSBhcmUgc2VudCBhbGwgYXQg
b25jZSkKCQkJcmVxdWVzdEhlYWRlcnMgPSB7fSwKCQkJcmVxdWVzdEhlYWRlcnNO
YW1lcyA9IHt9LAoJCQkvLyBSZXNwb25zZSBoZWFkZXJzCgkJCXJlc3BvbnNlSGVh
ZGVyc1N0cmluZywKCQkJcmVzcG9uc2VIZWFkZXJzLAoJCQkvLyB0cmFuc3BvcnQK
CQkJdHJhbnNwb3J0LAoJCQkvLyB0aW1lb3V0IGhhbmRsZQoJCQl0aW1lb3V0VGlt
ZXIsCgkJCS8vIENyb3NzLWRvbWFpbiBkZXRlY3Rpb24gdmFycwoJCQlwYXJ0cywK
CQkJLy8gVGhlIGpxWEhSIHN0YXRlCgkJCXN0YXRlID0gMCwKCQkJLy8gVG8ga25v
dyBpZiBnbG9iYWwgZXZlbnRzIGFyZSB0byBiZSBkaXNwYXRjaGVkCgkJCWZpcmVH
bG9iYWxzLAoJCQkvLyBMb29wIHZhcmlhYmxlCgkJCWksCgkJCS8vIEZha2UgeGhy
CgkJCWpxWEhSID0gewoKCQkJCXJlYWR5U3RhdGU6IDAsCgoJCQkJLy8gQ2FjaGVz
IHRoZSBoZWFkZXIKCQkJCXNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uKCBuYW1l
LCB2YWx1ZSApIHsKCQkJCQlpZiAoICFzdGF0ZSApIHsKCQkJCQkJdmFyIGxuYW1l
ID0gbmFtZS50b0xvd2VyQ2FzZSgpOwoJCQkJCQluYW1lID0gcmVxdWVzdEhlYWRl
cnNOYW1lc1sgbG5hbWUgXSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0g
fHwgbmFtZTsKCQkJCQkJcmVxdWVzdEhlYWRlcnNbIG5hbWUgXSA9IHZhbHVlOwoJ
CQkJCX0KCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgoJCQkJLy8gUmF3IHN0cmlu
ZwoJCQkJZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHsKCQkJCQly
ZXR1cm4gc3RhdGUgPT09IDIgPyByZXNwb25zZUhlYWRlcnNTdHJpbmcgOiBudWxs
OwoJCQkJfSwKCgkJCQkvLyBCdWlsZHMgaGVhZGVycyBoYXNodGFibGUgaWYgbmVl
ZGVkCgkJCQlnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24oIGtleSApIHsKCQkJ
CQl2YXIgbWF0Y2g7CgkJCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCQkJaWYg
KCAhcmVzcG9uc2VIZWFkZXJzICkgewoJCQkJCQkJcmVzcG9uc2VIZWFkZXJzID0g
e307CgkJCQkJCQl3aGlsZSggKCBtYXRjaCA9IHJoZWFkZXJzLmV4ZWMoIHJlc3Bv
bnNlSGVhZGVyc1N0cmluZyApICkgKSB7CgkJCQkJCQkJcmVzcG9uc2VIZWFkZXJz
WyBtYXRjaFsxXS50b0xvd2VyQ2FzZSgpIF0gPSBtYXRjaFsgMiBdOwoJCQkJCQkJ
fQoJCQkJCQl9CgkJCQkJCW1hdGNoID0gcmVzcG9uc2VIZWFkZXJzWyBrZXkudG9M
b3dlckNhc2UoKSBdOwoJCQkJCX0KCQkJCQlyZXR1cm4gbWF0Y2ggPT09IHVuZGVm
aW5lZCA/IG51bGwgOiBtYXRjaDsKCQkJCX0sCgoJCQkJLy8gT3ZlcnJpZGVzIHJl
c3BvbnNlIGNvbnRlbnQtdHlwZSBoZWFkZXIKCQkJCW92ZXJyaWRlTWltZVR5cGU6
IGZ1bmN0aW9uKCB0eXBlICkgewoJCQkJCWlmICggIXN0YXRlICkgewoJCQkJCQlz
Lm1pbWVUeXBlID0gdHlwZTsKCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9
LAoKCQkJCS8vIENhbmNlbCB0aGUgcmVxdWVzdAoJCQkJYWJvcnQ6IGZ1bmN0aW9u
KCBzdGF0dXNUZXh0ICkgewoJCQkJCXN0YXR1c1RleHQgPSBzdGF0dXNUZXh0IHx8
ICJhYm9ydCI7CgkJCQkJaWYgKCB0cmFuc3BvcnQgKSB7CgkJCQkJCXRyYW5zcG9y
dC5hYm9ydCggc3RhdHVzVGV4dCApOwoJCQkJCX0KCQkJCQlkb25lKCAwLCBzdGF0
dXNUZXh0ICk7CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9CgkJCX07CgoJCS8vIENh
bGxiYWNrIGZvciB3aGVuIGV2ZXJ5dGhpbmcgaXMgZG9uZQoJCS8vIEl0IGlzIGRl
ZmluZWQgaGVyZSBiZWNhdXNlIGpzbGludCBjb21wbGFpbnMgaWYgaXQgaXMgZGVj
bGFyZWQKCQkvLyBhdCB0aGUgZW5kIG9mIHRoZSBmdW5jdGlvbiAod2hpY2ggd291
bGQgYmUgbW9yZSBsb2dpY2FsIGFuZCByZWFkYWJsZSkKCQlmdW5jdGlvbiBkb25l
KCBzdGF0dXMsIG5hdGl2ZVN0YXR1c1RleHQsIHJlc3BvbnNlcywgaGVhZGVycyAp
IHsKCgkJCS8vIENhbGxlZCBvbmNlCgkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJ
CQlyZXR1cm47CgkJCX0KCgkJCS8vIFN0YXRlIGlzICJkb25lIiBub3cKCQkJc3Rh
dGUgPSAyOwoKCQkJLy8gQ2xlYXIgdGltZW91dCBpZiBpdCBleGlzdHMKCQkJaWYg
KCB0aW1lb3V0VGltZXIgKSB7CgkJCQljbGVhclRpbWVvdXQoIHRpbWVvdXRUaW1l
ciApOwoJCQl9CgoJCQkvLyBEZXJlZmVyZW5jZSB0cmFuc3BvcnQgZm9yIGVhcmx5
IGdhcmJhZ2UgY29sbGVjdGlvbgoJCQkvLyAobm8gbWF0dGVyIGhvdyBsb25nIHRo
ZSBqcVhIUiBvYmplY3Qgd2lsbCBiZSB1c2VkKQoJCQl0cmFuc3BvcnQgPSB1bmRl
ZmluZWQ7CgoJCQkvLyBDYWNoZSByZXNwb25zZSBoZWFkZXJzCgkJCXJlc3BvbnNl
SGVhZGVyc1N0cmluZyA9IGhlYWRlcnMgfHwgIiI7CgoJCQkvLyBTZXQgcmVhZHlT
dGF0ZQoJCQlqcVhIUi5yZWFkeVN0YXRlID0gc3RhdHVzID4gMCA/IDQgOiAwOwoK
CQkJdmFyIGlzU3VjY2VzcywKCQkJCXN1Y2Nlc3MsCgkJCQllcnJvciwKCQkJCXN0
YXR1c1RleHQgPSBuYXRpdmVTdGF0dXNUZXh0LAoJCQkJcmVzcG9uc2UgPSByZXNw
b25zZXMgPyBhamF4SGFuZGxlUmVzcG9uc2VzKCBzLCBqcVhIUiwgcmVzcG9uc2Vz
ICkgOiB1bmRlZmluZWQsCgkJCQlsYXN0TW9kaWZpZWQsCgkJCQlldGFnOwoKCQkJ
Ly8gSWYgc3VjY2Vzc2Z1bCwgaGFuZGxlIHR5cGUgY2hhaW5pbmcKCQkJaWYgKCBz
dGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCB8fCBzdGF0dXMgPT09IDMwNCAp
IHsKCgkJCQkvLyBTZXQgdGhlIElmLU1vZGlmaWVkLVNpbmNlIGFuZC9vciBJZi1O
b25lLU1hdGNoIGhlYWRlciwgaWYgaW4gaWZNb2RpZmllZCBtb2RlLgoJCQkJaWYg
KCBzLmlmTW9kaWZpZWQgKSB7CgoJCQkJCWlmICggKCBsYXN0TW9kaWZpZWQgPSBq
cVhIUi5nZXRSZXNwb25zZUhlYWRlciggIkxhc3QtTW9kaWZpZWQiICkgKSApIHsK
CQkJCQkJalF1ZXJ5Lmxhc3RNb2RpZmllZFsgaWZNb2RpZmllZEtleSBdID0gbGFz
dE1vZGlmaWVkOwoJCQkJCX0KCQkJCQlpZiAoICggZXRhZyA9IGpxWEhSLmdldFJl
c3BvbnNlSGVhZGVyKCAiRXRhZyIgKSApICkgewoJCQkJCQlqUXVlcnkuZXRhZ1sg
aWZNb2RpZmllZEtleSBdID0gZXRhZzsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gSWYg
bm90IG1vZGlmaWVkCgkJCQlpZiAoIHN0YXR1cyA9PT0gMzA0ICkgewoKCQkJCQlz
dGF0dXNUZXh0ID0gIm5vdG1vZGlmaWVkIjsKCQkJCQlpc1N1Y2Nlc3MgPSB0cnVl
OwoKCQkJCS8vIElmIHdlIGhhdmUgZGF0YQoJCQkJfSBlbHNlIHsKCgkJCQkJdHJ5
IHsKCQkJCQkJc3VjY2VzcyA9IGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSApOwoJ
CQkJCQlzdGF0dXNUZXh0ID0gInN1Y2Nlc3MiOwoJCQkJCQlpc1N1Y2Nlc3MgPSB0
cnVlOwoJCQkJCX0gY2F0Y2goZSkgewoJCQkJCQkvLyBXZSBoYXZlIGEgcGFyc2Vy
ZXJyb3IKCQkJCQkJc3RhdHVzVGV4dCA9ICJwYXJzZXJlcnJvciI7CgkJCQkJCWVy
cm9yID0gZTsKCQkJCQl9CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQkvLyBXZSBleHRy
YWN0IGVycm9yIGZyb20gc3RhdHVzVGV4dAoJCQkJLy8gdGhlbiBub3JtYWxpemUg
c3RhdHVzVGV4dCBhbmQgc3RhdHVzIGZvciBub24tYWJvcnRzCgkJCQllcnJvciA9
IHN0YXR1c1RleHQ7CgkJCQlpZiAoICFzdGF0dXNUZXh0IHx8IHN0YXR1cyApIHsK
CQkJCQlzdGF0dXNUZXh0ID0gImVycm9yIjsKCQkJCQlpZiAoIHN0YXR1cyA8IDAg
KSB7CgkJCQkJCXN0YXR1cyA9IDA7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBT
ZXQgZGF0YSBmb3IgdGhlIGZha2UgeGhyIG9iamVjdAoJCQlqcVhIUi5zdGF0dXMg
PSBzdGF0dXM7CgkJCWpxWEhSLnN0YXR1c1RleHQgPSAiIiArICggbmF0aXZlU3Rh
dHVzVGV4dCB8fCBzdGF0dXNUZXh0ICk7CgoJCQkvLyBTdWNjZXNzL0Vycm9yCgkJ
CWlmICggaXNTdWNjZXNzICkgewoJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGNh
bGxiYWNrQ29udGV4dCwgWyBzdWNjZXNzLCBzdGF0dXNUZXh0LCBqcVhIUiBdICk7
CgkJCX0gZWxzZSB7CgkJCQlkZWZlcnJlZC5yZWplY3RXaXRoKCBjYWxsYmFja0Nv
bnRleHQsIFsganFYSFIsIHN0YXR1c1RleHQsIGVycm9yIF0gKTsKCQkJfQoKCQkJ
Ly8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3MKCQkJanFYSFIuc3RhdHVzQ29k
ZSggc3RhdHVzQ29kZSApOwoJCQlzdGF0dXNDb2RlID0gdW5kZWZpbmVkOwoKCQkJ
aWYgKCBmaXJlR2xvYmFscyApIHsKCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmln
Z2VyKCAiYWpheCIgKyAoIGlzU3VjY2VzcyA/ICJTdWNjZXNzIiA6ICJFcnJvciIg
KSwKCQkJCQkJWyBqcVhIUiwgcywgaXNTdWNjZXNzID8gc3VjY2VzcyA6IGVycm9y
IF0gKTsKCQkJfQoKCQkJLy8gQ29tcGxldGUKCQkJY29tcGxldGVEZWZlcnJlZC5m
aXJlV2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIGpxWEhSLCBzdGF0dXNUZXh0IF0g
KTsKCgkJCWlmICggZmlyZUdsb2JhbHMgKSB7CgkJCQlnbG9iYWxFdmVudENvbnRl
eHQudHJpZ2dlciggImFqYXhDb21wbGV0ZSIsIFsganFYSFIsIHMgXSApOwoJCQkJ
Ly8gSGFuZGxlIHRoZSBnbG9iYWwgQUpBWCBjb3VudGVyCgkJCQlpZiAoICEoIC0t
alF1ZXJ5LmFjdGl2ZSApICkgewoJCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCAi
YWpheFN0b3AiICk7CgkJCQl9CgkJCX0KCQl9CgoJCS8vIEF0dGFjaCBkZWZlcnJl
ZHMKCQlkZWZlcnJlZC5wcm9taXNlKCBqcVhIUiApOwoJCWpxWEhSLnN1Y2Nlc3Mg
PSBqcVhIUi5kb25lOwoJCWpxWEhSLmVycm9yID0ganFYSFIuZmFpbDsKCQlqcVhI
Ui5jb21wbGV0ZSA9IGNvbXBsZXRlRGVmZXJyZWQuYWRkOwoKCQkvLyBTdGF0dXMt
ZGVwZW5kZW50IGNhbGxiYWNrcwoJCWpxWEhSLnN0YXR1c0NvZGUgPSBmdW5jdGlv
biggbWFwICkgewoJCQlpZiAoIG1hcCApIHsKCQkJCXZhciB0bXA7CgkJCQlpZiAo
IHN0YXRlIDwgMiApIHsKCQkJCQlmb3IgKCB0bXAgaW4gbWFwICkgewoJCQkJCQlz
dGF0dXNDb2RlWyB0bXAgXSA9IFsgc3RhdHVzQ29kZVt0bXBdLCBtYXBbdG1wXSBd
OwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJdG1wID0gbWFwWyBqcVhIUi5zdGF0
dXMgXTsKCQkJCQlqcVhIUi50aGVuKCB0bXAsIHRtcCApOwoJCQkJfQoJCQl9CgkJ
CXJldHVybiB0aGlzOwoJCX07CgoJCS8vIFJlbW92ZSBoYXNoIGNoYXJhY3RlciAo
Izc1MzE6IGFuZCBzdHJpbmcgcHJvbW90aW9uKQoJCS8vIEFkZCBwcm90b2NvbCBp
ZiBub3QgcHJvdmlkZWQgKCM1ODY2OiBJRTcgaXNzdWUgd2l0aCBwcm90b2NvbC1s
ZXNzIHVybHMpCgkJLy8gV2UgYWxzbyB1c2UgdGhlIHVybCBwYXJhbWV0ZXIgaWYg
YXZhaWxhYmxlCgkJcy51cmwgPSAoICggdXJsIHx8IHMudXJsICkgKyAiIiApLnJl
cGxhY2UoIHJoYXNoLCAiIiApLnJlcGxhY2UoIHJwcm90b2NvbCwgYWpheExvY1Bh
cnRzWyAxIF0gKyAiLy8iICk7CgoJCS8vIEV4dHJhY3QgZGF0YVR5cGVzIGxpc3QK
CQlzLmRhdGFUeXBlcyA9IGpRdWVyeS50cmltKCBzLmRhdGFUeXBlIHx8ICIqIiAp
LnRvTG93ZXJDYXNlKCkuc3BsaXQoIHJzcGFjZXNBamF4ICk7CgoJCS8vIERldGVy
bWluZSBpZiBhIGNyb3NzLWRvbWFpbiByZXF1ZXN0IGlzIGluIG9yZGVyCgkJaWYg
KCBzLmNyb3NzRG9tYWluID09IG51bGwgKSB7CgkJCXBhcnRzID0gcnVybC5leGVj
KCBzLnVybC50b0xvd2VyQ2FzZSgpICk7CgkJCXMuY3Jvc3NEb21haW4gPSAhISgg
cGFydHMgJiYKCQkJCSggcGFydHNbIDEgXSAhPSBhamF4TG9jUGFydHNbIDEgXSB8
fCBwYXJ0c1sgMiBdICE9IGFqYXhMb2NQYXJ0c1sgMiBdIHx8CgkJCQkJKCBwYXJ0
c1sgMyBdIHx8ICggcGFydHNbIDEgXSA9PT0gImh0dHA6IiA/IDgwIDogNDQzICkg
KSAhPQoJCQkJCQkoIGFqYXhMb2NQYXJ0c1sgMyBdIHx8ICggYWpheExvY1BhcnRz
WyAxIF0gPT09ICJodHRwOiIgPyA4MCA6IDQ0MyApICkgKQoJCQkpOwoJCX0KCgkJ
Ly8gQ29udmVydCBkYXRhIGlmIG5vdCBhbHJlYWR5IGEgc3RyaW5nCgkJaWYgKCBz
LmRhdGEgJiYgcy5wcm9jZXNzRGF0YSAmJiB0eXBlb2Ygcy5kYXRhICE9PSAic3Ry
aW5nIiApIHsKCQkJcy5kYXRhID0galF1ZXJ5LnBhcmFtKCBzLmRhdGEsIHMudHJh
ZGl0aW9uYWwgKTsKCQl9CgoJCS8vIEFwcGx5IHByZWZpbHRlcnMKCQlpbnNwZWN0
UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycywgcywgb3B0aW9ucywg
anFYSFIgKTsKCgkJLy8gSWYgcmVxdWVzdCB3YXMgYWJvcnRlZCBpbnNpZGUgYSBw
cmVmaWx0ZXIsIHN0b3AgdGhlcmUKCQlpZiAoIHN0YXRlID09PSAyICkgewoJCQly
ZXR1cm4gZmFsc2U7CgkJfQoKCQkvLyBXZSBjYW4gZmlyZSBnbG9iYWwgZXZlbnRz
IGFzIG9mIG5vdyBpZiBhc2tlZCB0bwoJCWZpcmVHbG9iYWxzID0gcy5nbG9iYWw7
CgoJCS8vIFVwcGVyY2FzZSB0aGUgdHlwZQoJCXMudHlwZSA9IHMudHlwZS50b1Vw
cGVyQ2FzZSgpOwoKCQkvLyBEZXRlcm1pbmUgaWYgcmVxdWVzdCBoYXMgY29udGVu
dAoJCXMuaGFzQ29udGVudCA9ICFybm9Db250ZW50LnRlc3QoIHMudHlwZSApOwoK
CQkvLyBXYXRjaCBmb3IgYSBuZXcgc2V0IG9mIHJlcXVlc3RzCgkJaWYgKCBmaXJl
R2xvYmFscyAmJiBqUXVlcnkuYWN0aXZlKysgPT09IDAgKSB7CgkJCWpRdWVyeS5l
dmVudC50cmlnZ2VyKCAiYWpheFN0YXJ0IiApOwoJCX0KCgkJLy8gTW9yZSBvcHRp
b25zIGhhbmRsaW5nIGZvciByZXF1ZXN0cyB3aXRoIG5vIGNvbnRlbnQKCQlpZiAo
ICFzLmhhc0NvbnRlbnQgKSB7CgoJCQkvLyBJZiBkYXRhIGlzIGF2YWlsYWJsZSwg
YXBwZW5kIGRhdGEgdG8gdXJsCgkJCWlmICggcy5kYXRhICkgewoJCQkJcy51cmwg
Kz0gKCBycXVlcnkudGVzdCggcy51cmwgKSA/ICImIiA6ICI/IiApICsgcy5kYXRh
OwoJCQkJLy8gIzk2ODI6IHJlbW92ZSBkYXRhIHNvIHRoYXQgaXQncyBub3QgdXNl
ZCBpbiBhbiBldmVudHVhbCByZXRyeQoJCQkJZGVsZXRlIHMuZGF0YTsKCQkJfQoK
CQkJLy8gR2V0IGlmTW9kaWZpZWRLZXkgYmVmb3JlIGFkZGluZyB0aGUgYW50aS1j
YWNoZSBwYXJhbWV0ZXIKCQkJaWZNb2RpZmllZEtleSA9IHMudXJsOwoKCQkJLy8g
QWRkIGFudGktY2FjaGUgaW4gdXJsIGlmIG5lZWRlZAoJCQlpZiAoIHMuY2FjaGUg
PT09IGZhbHNlICkgewoKCQkJCXZhciB0cyA9IGpRdWVyeS5ub3coKSwKCQkJCQkv
LyB0cnkgcmVwbGFjaW5nIF89IGlmIGl0IGlzIHRoZXJlCgkJCQkJcmV0ID0gcy51
cmwucmVwbGFjZSggcnRzLCAiJDFfPSIgKyB0cyApOwoKCQkJCS8vIGlmIG5vdGhp
bmcgd2FzIHJlcGxhY2VkLCBhZGQgdGltZXN0YW1wIHRvIHRoZSBlbmQKCQkJCXMu
dXJsID0gcmV0ICsgKCAoIHJldCA9PT0gcy51cmwgKSA/ICggcnF1ZXJ5LnRlc3Qo
IHMudXJsICkgPyAiJiIgOiAiPyIgKSArICJfPSIgKyB0cyA6ICIiICk7CgkJCX0K
CQl9CgoJCS8vIFNldCB0aGUgY29ycmVjdCBoZWFkZXIsIGlmIGRhdGEgaXMgYmVp
bmcgc2VudAoJCWlmICggcy5kYXRhICYmIHMuaGFzQ29udGVudCAmJiBzLmNvbnRl
bnRUeXBlICE9PSBmYWxzZSB8fCBvcHRpb25zLmNvbnRlbnRUeXBlICkgewoJCQlq
cVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCAiQ29udGVudC1UeXBlIiwgcy5jb250ZW50
VHlwZSApOwoJCX0KCgkJLy8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQv
b3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS4K
CQlpZiAoIHMuaWZNb2RpZmllZCApIHsKCQkJaWZNb2RpZmllZEtleSA9IGlmTW9k
aWZpZWRLZXkgfHwgcy51cmw7CgkJCWlmICggalF1ZXJ5Lmxhc3RNb2RpZmllZFsg
aWZNb2RpZmllZEtleSBdICkgewoJCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlcigg
IklmLU1vZGlmaWVkLVNpbmNlIiwgalF1ZXJ5Lmxhc3RNb2RpZmllZFsgaWZNb2Rp
ZmllZEtleSBdICk7CgkJCX0KCQkJaWYgKCBqUXVlcnkuZXRhZ1sgaWZNb2RpZmll
ZEtleSBdICkgewoJCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlciggIklmLU5vbmUt
TWF0Y2giLCBqUXVlcnkuZXRhZ1sgaWZNb2RpZmllZEtleSBdICk7CgkJCX0KCQl9
CgoJCS8vIFNldCB0aGUgQWNjZXB0cyBoZWFkZXIgZm9yIHRoZSBzZXJ2ZXIsIGRl
cGVuZGluZyBvbiB0aGUgZGF0YVR5cGUKCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVy
KAoJCQkiQWNjZXB0IiwKCQkJcy5kYXRhVHlwZXNbIDAgXSAmJiBzLmFjY2VwdHNb
IHMuZGF0YVR5cGVzWzBdIF0gPwoJCQkJcy5hY2NlcHRzWyBzLmRhdGFUeXBlc1sw
XSBdICsgKCBzLmRhdGFUeXBlc1sgMCBdICE9PSAiKiIgPyAiLCAiICsgYWxsVHlw
ZXMgKyAiOyBxPTAuMDEiIDogIiIgKSA6CgkJCQlzLmFjY2VwdHNbICIqIiBdCgkJ
KTsKCgkJLy8gQ2hlY2sgZm9yIGhlYWRlcnMgb3B0aW9uCgkJZm9yICggaSBpbiBz
LmhlYWRlcnMgKSB7CgkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIGksIHMuaGVh
ZGVyc1sgaSBdICk7CgkJfQoKCQkvLyBBbGxvdyBjdXN0b20gaGVhZGVycy9taW1l
dHlwZXMgYW5kIGVhcmx5IGFib3J0CgkJaWYgKCBzLmJlZm9yZVNlbmQgJiYgKCBz
LmJlZm9yZVNlbmQuY2FsbCggY2FsbGJhY2tDb250ZXh0LCBqcVhIUiwgcyApID09
PSBmYWxzZSB8fCBzdGF0ZSA9PT0gMiApICkgewoJCQkJLy8gQWJvcnQgaWYgbm90
IGRvbmUgYWxyZWFkeQoJCQkJanFYSFIuYWJvcnQoKTsKCQkJCXJldHVybiBmYWxz
ZTsKCgkJfQoKCQkvLyBJbnN0YWxsIGNhbGxiYWNrcyBvbiBkZWZlcnJlZHMKCQlm
b3IgKCBpIGluIHsgc3VjY2VzczogMSwgZXJyb3I6IDEsIGNvbXBsZXRlOiAxIH0g
KSB7CgkJCWpxWEhSWyBpIF0oIHNbIGkgXSApOwoJCX0KCgkJLy8gR2V0IHRyYW5z
cG9ydAoJCXRyYW5zcG9ydCA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRz
KCB0cmFuc3BvcnRzLCBzLCBvcHRpb25zLCBqcVhIUiApOwoKCQkvLyBJZiBubyB0
cmFuc3BvcnQsIHdlIGF1dG8tYWJvcnQKCQlpZiAoICF0cmFuc3BvcnQgKSB7CgkJ
CWRvbmUoIC0xLCAiTm8gVHJhbnNwb3J0IiApOwoJCX0gZWxzZSB7CgkJCWpxWEhS
LnJlYWR5U3RhdGUgPSAxOwoJCQkvLyBTZW5kIGdsb2JhbCBldmVudAoJCQlpZiAo
IGZpcmVHbG9iYWxzICkgewoJCQkJZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIo
ICJhamF4U2VuZCIsIFsganFYSFIsIHMgXSApOwoJCQl9CgkJCS8vIFRpbWVvdXQK
CQkJaWYgKCBzLmFzeW5jICYmIHMudGltZW91dCA+IDAgKSB7CgkJCQl0aW1lb3V0
VGltZXIgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpewoJCQkJCWpxWEhSLmFib3J0
KCAidGltZW91dCIgKTsKCQkJCX0sIHMudGltZW91dCApOwoJCQl9CgoJCQl0cnkg
ewoJCQkJc3RhdGUgPSAxOwoJCQkJdHJhbnNwb3J0LnNlbmQoIHJlcXVlc3RIZWFk
ZXJzLCBkb25lICk7CgkJCX0gY2F0Y2ggKGUpIHsKCQkJCS8vIFByb3BhZ2F0ZSBl
eGNlcHRpb24gYXMgZXJyb3IgaWYgbm90IGRvbmUKCQkJCWlmICggc3RhdGUgPCAy
ICkgewoJCQkJCWRvbmUoIC0xLCBlICk7CgkJCQkvLyBTaW1wbHkgcmV0aHJvdyBv
dGhlcndpc2UKCQkJCX0gZWxzZSB7CgkJCQkJdGhyb3cgZTsKCQkJCX0KCQkJfQoJ
CX0KCgkJcmV0dXJuIGpxWEhSOwoJfSwKCgkvLyBTZXJpYWxpemUgYW4gYXJyYXkg
b2YgZm9ybSBlbGVtZW50cyBvciBhIHNldCBvZgoJLy8ga2V5L3ZhbHVlcyBpbnRv
IGEgcXVlcnkgc3RyaW5nCglwYXJhbTogZnVuY3Rpb24oIGEsIHRyYWRpdGlvbmFs
ICkgewoJCXZhciBzID0gW10sCgkJCWFkZCA9IGZ1bmN0aW9uKCBrZXksIHZhbHVl
ICkgewoJCQkJLy8gSWYgdmFsdWUgaXMgYSBmdW5jdGlvbiwgaW52b2tlIGl0IGFu
ZCByZXR1cm4gaXRzIHZhbHVlCgkJCQl2YWx1ZSA9IGpRdWVyeS5pc0Z1bmN0aW9u
KCB2YWx1ZSApID8gdmFsdWUoKSA6IHZhbHVlOwoJCQkJc1sgcy5sZW5ndGggXSA9
IGVuY29kZVVSSUNvbXBvbmVudCgga2V5ICkgKyAiPSIgKyBlbmNvZGVVUklDb21w
b25lbnQoIHZhbHVlICk7CgkJCX07CgoJCS8vIFNldCB0cmFkaXRpb25hbCB0byB0
cnVlIGZvciBqUXVlcnkgPD0gMS4zLjIgYmVoYXZpb3IuCgkJaWYgKCB0cmFkaXRp
b25hbCA9PT0gdW5kZWZpbmVkICkgewoJCQl0cmFkaXRpb25hbCA9IGpRdWVyeS5h
amF4U2V0dGluZ3MudHJhZGl0aW9uYWw7CgkJfQoKCQkvLyBJZiBhbiBhcnJheSB3
YXMgcGFzc2VkIGluLCBhc3N1bWUgdGhhdCBpdCBpcyBhbiBhcnJheSBvZiBmb3Jt
IGVsZW1lbnRzLgoJCWlmICggalF1ZXJ5LmlzQXJyYXkoIGEgKSB8fCAoIGEuanF1
ZXJ5ICYmICFqUXVlcnkuaXNQbGFpbk9iamVjdCggYSApICkgKSB7CgkJCS8vIFNl
cmlhbGl6ZSB0aGUgZm9ybSBlbGVtZW50cwoJCQlqUXVlcnkuZWFjaCggYSwgZnVu
Y3Rpb24oKSB7CgkJCQlhZGQoIHRoaXMubmFtZSwgdGhpcy52YWx1ZSApOwoJCQl9
KTsKCgkJfSBlbHNlIHsKCQkJLy8gSWYgdHJhZGl0aW9uYWwsIGVuY29kZSB0aGUg
Im9sZCIgd2F5ICh0aGUgd2F5IDEuMy4yIG9yIG9sZGVyCgkJCS8vIGRpZCBpdCks
IG90aGVyd2lzZSBlbmNvZGUgcGFyYW1zIHJlY3Vyc2l2ZWx5LgoJCQlmb3IgKCB2
YXIgcHJlZml4IGluIGEgKSB7CgkJCQlidWlsZFBhcmFtcyggcHJlZml4LCBhWyBw
cmVmaXggXSwgdHJhZGl0aW9uYWwsIGFkZCApOwoJCQl9CgkJfQoKCQkvLyBSZXR1
cm4gdGhlIHJlc3VsdGluZyBzZXJpYWxpemF0aW9uCgkJcmV0dXJuIHMuam9pbigg
IiYiICkucmVwbGFjZSggcjIwLCAiKyIgKTsKCX0KfSk7CgpmdW5jdGlvbiBidWls
ZFBhcmFtcyggcHJlZml4LCBvYmosIHRyYWRpdGlvbmFsLCBhZGQgKSB7CglpZiAo
IGpRdWVyeS5pc0FycmF5KCBvYmogKSApIHsKCQkvLyBTZXJpYWxpemUgYXJyYXkg
aXRlbS4KCQlqUXVlcnkuZWFjaCggb2JqLCBmdW5jdGlvbiggaSwgdiApIHsKCQkJ
aWYgKCB0cmFkaXRpb25hbCB8fCByYnJhY2tldC50ZXN0KCBwcmVmaXggKSApIHsK
CQkJCS8vIFRyZWF0IGVhY2ggYXJyYXkgaXRlbSBhcyBhIHNjYWxhci4KCQkJCWFk
ZCggcHJlZml4LCB2ICk7CgoJCQl9IGVsc2UgewoJCQkJLy8gSWYgYXJyYXkgaXRl
bSBpcyBub24tc2NhbGFyIChhcnJheSBvciBvYmplY3QpLCBlbmNvZGUgaXRzCgkJ
CQkvLyBudW1lcmljIGluZGV4IHRvIHJlc29sdmUgZGVzZXJpYWxpemF0aW9uIGFt
YmlndWl0eSBpc3N1ZXMuCgkJCQkvLyBOb3RlIHRoYXQgcmFjayAoYXMgb2YgMS4w
LjApIGNhbid0IGN1cnJlbnRseSBkZXNlcmlhbGl6ZQoJCQkJLy8gbmVzdGVkIGFy
cmF5cyBwcm9wZXJseSwgYW5kIGF0dGVtcHRpbmcgdG8gZG8gc28gbWF5IGNhdXNl
CgkJCQkvLyBhIHNlcnZlciBlcnJvci4gUG9zc2libGUgZml4ZXMgYXJlIHRvIG1v
ZGlmeSByYWNrJ3MKCQkJCS8vIGRlc2VyaWFsaXphdGlvbiBhbGdvcml0aG0gb3Ig
dG8gcHJvdmlkZSBhbiBvcHRpb24gb3IgZmxhZwoJCQkJLy8gdG8gZm9yY2UgYXJy
YXkgc2VyaWFsaXphdGlvbiB0byBiZSBzaGFsbG93LgoJCQkJYnVpbGRQYXJhbXMo
IHByZWZpeCArICJbIiArICggdHlwZW9mIHYgPT09ICJvYmplY3QiID8gaSA6ICIi
ICkgKyAiXSIsIHYsIHRyYWRpdGlvbmFsLCBhZGQgKTsKCQkJfQoJCX0pOwoKCX0g
ZWxzZSBpZiAoICF0cmFkaXRpb25hbCAmJiBqUXVlcnkudHlwZSggb2JqICkgPT09
ICJvYmplY3QiICkgewoJCS8vIFNlcmlhbGl6ZSBvYmplY3QgaXRlbS4KCQlmb3Ig
KCB2YXIgbmFtZSBpbiBvYmogKSB7CgkJCWJ1aWxkUGFyYW1zKCBwcmVmaXggKyAi
WyIgKyBuYW1lICsgIl0iLCBvYmpbIG5hbWUgXSwgdHJhZGl0aW9uYWwsIGFkZCAp
OwoJCX0KCgl9IGVsc2UgewoJCS8vIFNlcmlhbGl6ZSBzY2FsYXIgaXRlbS4KCQlh
ZGQoIHByZWZpeCwgb2JqICk7Cgl9Cn0KCi8vIFRoaXMgaXMgc3RpbGwgb24gdGhl
IGpRdWVyeSBvYmplY3QuLi4gZm9yIG5vdwovLyBXYW50IHRvIG1vdmUgdGhpcyB0
byBqUXVlcnkuYWpheCBzb21lIGRheQpqUXVlcnkuZXh0ZW5kKHsKCgkvLyBDb3Vu
dGVyIGZvciBob2xkaW5nIHRoZSBudW1iZXIgb2YgYWN0aXZlIHF1ZXJpZXMKCWFj
dGl2ZTogMCwKCgkvLyBMYXN0LU1vZGlmaWVkIGhlYWRlciBjYWNoZSBmb3IgbmV4
dCByZXF1ZXN0CglsYXN0TW9kaWZpZWQ6IHt9LAoJZXRhZzoge30KCn0pOwoKLyog
SGFuZGxlcyByZXNwb25zZXMgdG8gYW4gYWpheCByZXF1ZXN0OgogKiAtIHNldHMg
YWxsIHJlc3BvbnNlWFhYIGZpZWxkcyBhY2NvcmRpbmdseQogKiAtIGZpbmRzIHRo
ZSByaWdodCBkYXRhVHlwZSAobWVkaWF0ZXMgYmV0d2VlbiBjb250ZW50LXR5cGUg
YW5kIGV4cGVjdGVkIGRhdGFUeXBlKQogKiAtIHJldHVybnMgdGhlIGNvcnJlc3Bv
bmRpbmcgcmVzcG9uc2UKICovCmZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMo
IHMsIGpxWEhSLCByZXNwb25zZXMgKSB7CgoJdmFyIGNvbnRlbnRzID0gcy5jb250
ZW50cywKCQlkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcywKCQlyZXNwb25zZUZpZWxk
cyA9IHMucmVzcG9uc2VGaWVsZHMsCgkJY3QsCgkJdHlwZSwKCQlmaW5hbERhdGFU
eXBlLAoJCWZpcnN0RGF0YVR5cGU7CgoJLy8gRmlsbCByZXNwb25zZVhYWCBmaWVs
ZHMKCWZvciAoIHR5cGUgaW4gcmVzcG9uc2VGaWVsZHMgKSB7CgkJaWYgKCB0eXBl
IGluIHJlc3BvbnNlcyApIHsKCQkJanFYSFJbIHJlc3BvbnNlRmllbGRzW3R5cGVd
IF0gPSByZXNwb25zZXNbIHR5cGUgXTsKCQl9Cgl9CgoJLy8gUmVtb3ZlIGF1dG8g
ZGF0YVR5cGUgYW5kIGdldCBjb250ZW50LXR5cGUgaW4gdGhlIHByb2Nlc3MKCXdo
aWxlKCBkYXRhVHlwZXNbIDAgXSA9PT0gIioiICkgewoJCWRhdGFUeXBlcy5zaGlm
dCgpOwoJCWlmICggY3QgPT09IHVuZGVmaW5lZCApIHsKCQkJY3QgPSBzLm1pbWVU
eXBlIHx8IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCAiY29udGVudC10eXBlIiAp
OwoJCX0KCX0KCgkvLyBDaGVjayBpZiB3ZSdyZSBkZWFsaW5nIHdpdGggYSBrbm93
biBjb250ZW50LXR5cGUKCWlmICggY3QgKSB7CgkJZm9yICggdHlwZSBpbiBjb250
ZW50cyApIHsKCQkJaWYgKCBjb250ZW50c1sgdHlwZSBdICYmIGNvbnRlbnRzWyB0
eXBlIF0udGVzdCggY3QgKSApIHsKCQkJCWRhdGFUeXBlcy51bnNoaWZ0KCB0eXBl
ICk7CgkJCQlicmVhazsKCQkJfQoJCX0KCX0KCgkvLyBDaGVjayB0byBzZWUgaWYg
d2UgaGF2ZSBhIHJlc3BvbnNlIGZvciB0aGUgZXhwZWN0ZWQgZGF0YVR5cGUKCWlm
ICggZGF0YVR5cGVzWyAwIF0gaW4gcmVzcG9uc2VzICkgewoJCWZpbmFsRGF0YVR5
cGUgPSBkYXRhVHlwZXNbIDAgXTsKCX0gZWxzZSB7CgkJLy8gVHJ5IGNvbnZlcnRp
YmxlIGRhdGFUeXBlcwoJCWZvciAoIHR5cGUgaW4gcmVzcG9uc2VzICkgewoJCQlp
ZiAoICFkYXRhVHlwZXNbIDAgXSB8fCBzLmNvbnZlcnRlcnNbIHR5cGUgKyAiICIg
KyBkYXRhVHlwZXNbMF0gXSApIHsKCQkJCWZpbmFsRGF0YVR5cGUgPSB0eXBlOwoJ
CQkJYnJlYWs7CgkJCX0KCQkJaWYgKCAhZmlyc3REYXRhVHlwZSApIHsKCQkJCWZp
cnN0RGF0YVR5cGUgPSB0eXBlOwoJCQl9CgkJfQoJCS8vIE9yIGp1c3QgdXNlIGZp
cnN0IG9uZQoJCWZpbmFsRGF0YVR5cGUgPSBmaW5hbERhdGFUeXBlIHx8IGZpcnN0
RGF0YVR5cGU7Cgl9CgoJLy8gSWYgd2UgZm91bmQgYSBkYXRhVHlwZQoJLy8gV2Ug
YWRkIHRoZSBkYXRhVHlwZSB0byB0aGUgbGlzdCBpZiBuZWVkZWQKCS8vIGFuZCBy
ZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UKCWlmICggZmluYWxEYXRh
VHlwZSApIHsKCQlpZiAoIGZpbmFsRGF0YVR5cGUgIT09IGRhdGFUeXBlc1sgMCBd
ICkgewoJCQlkYXRhVHlwZXMudW5zaGlmdCggZmluYWxEYXRhVHlwZSApOwoJCX0K
CQlyZXR1cm4gcmVzcG9uc2VzWyBmaW5hbERhdGFUeXBlIF07Cgl9Cn0KCi8vIENo
YWluIGNvbnZlcnNpb25zIGdpdmVuIHRoZSByZXF1ZXN0IGFuZCB0aGUgb3JpZ2lu
YWwgcmVzcG9uc2UKZnVuY3Rpb24gYWpheENvbnZlcnQoIHMsIHJlc3BvbnNlICkg
ewoKCS8vIEFwcGx5IHRoZSBkYXRhRmlsdGVyIGlmIHByb3ZpZGVkCglpZiAoIHMu
ZGF0YUZpbHRlciApIHsKCQlyZXNwb25zZSA9IHMuZGF0YUZpbHRlciggcmVzcG9u
c2UsIHMuZGF0YVR5cGUgKTsKCX0KCgl2YXIgZGF0YVR5cGVzID0gcy5kYXRhVHlw
ZXMsCgkJY29udmVydGVycyA9IHt9LAoJCWksCgkJa2V5LAoJCWxlbmd0aCA9IGRh
dGFUeXBlcy5sZW5ndGgsCgkJdG1wLAoJCS8vIEN1cnJlbnQgYW5kIHByZXZpb3Vz
IGRhdGFUeXBlcwoJCWN1cnJlbnQgPSBkYXRhVHlwZXNbIDAgXSwKCQlwcmV2LAoJ
CS8vIENvbnZlcnNpb24gZXhwcmVzc2lvbgoJCWNvbnZlcnNpb24sCgkJLy8gQ29u
dmVyc2lvbiBmdW5jdGlvbgoJCWNvbnYsCgkJLy8gQ29udmVyc2lvbiBmdW5jdGlv
bnMgKHRyYW5zaXRpdmUgY29udmVyc2lvbikKCQljb252MSwKCQljb252MjsKCgkv
LyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgY2hhaW4KCWZvciAoIGkgPSAxOyBp
IDwgbGVuZ3RoOyBpKysgKSB7CgoJCS8vIENyZWF0ZSBjb252ZXJ0ZXJzIG1hcAoJ
CS8vIHdpdGggbG93ZXJjYXNlZCBrZXlzCgkJaWYgKCBpID09PSAxICkgewoJCQlm
b3IgKCBrZXkgaW4gcy5jb252ZXJ0ZXJzICkgewoJCQkJaWYgKCB0eXBlb2Yga2V5
ID09PSAic3RyaW5nIiApIHsKCQkJCQljb252ZXJ0ZXJzWyBrZXkudG9Mb3dlckNh
c2UoKSBdID0gcy5jb252ZXJ0ZXJzWyBrZXkgXTsKCQkJCX0KCQkJfQoJCX0KCgkJ
Ly8gR2V0IHRoZSBkYXRhVHlwZXMKCQlwcmV2ID0gY3VycmVudDsKCQljdXJyZW50
ID0gZGF0YVR5cGVzWyBpIF07CgoJCS8vIElmIGN1cnJlbnQgaXMgYXV0byBkYXRh
VHlwZSwgdXBkYXRlIGl0IHRvIHByZXYKCQlpZiAoIGN1cnJlbnQgPT09ICIqIiAp
IHsKCQkJY3VycmVudCA9IHByZXY7CgkJLy8gSWYgbm8gYXV0byBhbmQgZGF0YVR5
cGVzIGFyZSBhY3R1YWxseSBkaWZmZXJlbnQKCQl9IGVsc2UgaWYgKCBwcmV2ICE9
PSAiKiIgJiYgcHJldiAhPT0gY3VycmVudCApIHsKCgkJCS8vIEdldCB0aGUgY29u
dmVydGVyCgkJCWNvbnZlcnNpb24gPSBwcmV2ICsgIiAiICsgY3VycmVudDsKCQkJ
Y29udiA9IGNvbnZlcnRlcnNbIGNvbnZlcnNpb24gXSB8fCBjb252ZXJ0ZXJzWyAi
KiAiICsgY3VycmVudCBdOwoKCQkJLy8gSWYgdGhlcmUgaXMgbm8gZGlyZWN0IGNv
bnZlcnRlciwgc2VhcmNoIHRyYW5zaXRpdmVseQoJCQlpZiAoICFjb252ICkgewoJ
CQkJY29udjIgPSB1bmRlZmluZWQ7CgkJCQlmb3IgKCBjb252MSBpbiBjb252ZXJ0
ZXJzICkgewoJCQkJCXRtcCA9IGNvbnYxLnNwbGl0KCAiICIgKTsKCQkJCQlpZiAo
IHRtcFsgMCBdID09PSBwcmV2IHx8IHRtcFsgMCBdID09PSAiKiIgKSB7CgkJCQkJ
CWNvbnYyID0gY29udmVydGVyc1sgdG1wWzFdICsgIiAiICsgY3VycmVudCBdOwoJ
CQkJCQlpZiAoIGNvbnYyICkgewoJCQkJCQkJY29udjEgPSBjb252ZXJ0ZXJzWyBj
b252MSBdOwoJCQkJCQkJaWYgKCBjb252MSA9PT0gdHJ1ZSApIHsKCQkJCQkJCQlj
b252ID0gY29udjI7CgkJCQkJCQl9IGVsc2UgaWYgKCBjb252MiA9PT0gdHJ1ZSAp
IHsKCQkJCQkJCQljb252ID0gY29udjE7CgkJCQkJCQl9CgkJCQkJCQlicmVhazsK
CQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCQkvLyBJZiB3ZSBmb3VuZCBubyBj
b252ZXJ0ZXIsIGRpc3BhdGNoIGFuIGVycm9yCgkJCWlmICggISggY29udiB8fCBj
b252MiApICkgewoJCQkJalF1ZXJ5LmVycm9yKCAiTm8gY29udmVyc2lvbiBmcm9t
ICIgKyBjb252ZXJzaW9uLnJlcGxhY2UoIiAiLCIgdG8gIikgKTsKCQkJfQoJCQkv
LyBJZiBmb3VuZCBjb252ZXJ0ZXIgaXMgbm90IGFuIGVxdWl2YWxlbmNlCgkJCWlm
ICggY29udiAhPT0gdHJ1ZSApIHsKCQkJCS8vIENvbnZlcnQgd2l0aCAxIG9yIDIg
Y29udmVydGVycyBhY2NvcmRpbmdseQoJCQkJcmVzcG9uc2UgPSBjb252ID8gY29u
diggcmVzcG9uc2UgKSA6IGNvbnYyKCBjb252MShyZXNwb25zZSkgKTsKCQkJfQoJ
CX0KCX0KCXJldHVybiByZXNwb25zZTsKfQoKCgoKdmFyIGpzYyA9IGpRdWVyeS5u
b3coKSwKCWpzcmUgPSAvKFw9KVw/KCZ8JCl8XD9cPy9pOwoKLy8gRGVmYXVsdCBq
c29ucCBzZXR0aW5ncwpqUXVlcnkuYWpheFNldHVwKHsKCWpzb25wOiAiY2FsbGJh
Y2siLAoJanNvbnBDYWxsYmFjazogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIGpRdWVy
eS5leHBhbmRvICsgIl8iICsgKCBqc2MrKyApOwoJfQp9KTsKCi8vIERldGVjdCwg
bm9ybWFsaXplIG9wdGlvbnMgYW5kIGluc3RhbGwgY2FsbGJhY2tzIGZvciBqc29u
cCByZXF1ZXN0cwpqUXVlcnkuYWpheFByZWZpbHRlciggImpzb24ganNvbnAiLCBm
dW5jdGlvbiggcywgb3JpZ2luYWxTZXR0aW5ncywganFYSFIgKSB7CgoJdmFyIGlu
c3BlY3REYXRhID0gKCB0eXBlb2Ygcy5kYXRhID09PSAic3RyaW5nIiApICYmIC9e
YXBwbGljYXRpb25cL3hcLXd3d1wtZm9ybVwtdXJsZW5jb2RlZC8udGVzdCggcy5j
b250ZW50VHlwZSApOwoKCWlmICggcy5kYXRhVHlwZXNbIDAgXSA9PT0gImpzb25w
IiB8fAoJCXMuanNvbnAgIT09IGZhbHNlICYmICgganNyZS50ZXN0KCBzLnVybCAp
IHx8CgkJCQlpbnNwZWN0RGF0YSAmJiBqc3JlLnRlc3QoIHMuZGF0YSApICkgKSB7
CgoJCXZhciByZXNwb25zZUNvbnRhaW5lciwKCQkJanNvbnBDYWxsYmFjayA9IHMu
anNvbnBDYWxsYmFjayA9CgkJCQlqUXVlcnkuaXNGdW5jdGlvbiggcy5qc29ucENh
bGxiYWNrICkgPyBzLmpzb25wQ2FsbGJhY2soKSA6IHMuanNvbnBDYWxsYmFjaywK
CQkJcHJldmlvdXMgPSB3aW5kb3dbIGpzb25wQ2FsbGJhY2sgXSwKCQkJdXJsID0g
cy51cmwsCgkJCWRhdGEgPSBzLmRhdGEsCgkJCXJlcGxhY2UgPSAiJDEiICsganNv
bnBDYWxsYmFjayArICIkMiI7CgoJCWlmICggcy5qc29ucCAhPT0gZmFsc2UgKSB7
CgkJCXVybCA9IHVybC5yZXBsYWNlKCBqc3JlLCByZXBsYWNlICk7CgkJCWlmICgg
cy51cmwgPT09IHVybCApIHsKCQkJCWlmICggaW5zcGVjdERhdGEgKSB7CgkJCQkJ
ZGF0YSA9IGRhdGEucmVwbGFjZSgganNyZSwgcmVwbGFjZSApOwoJCQkJfQoJCQkJ
aWYgKCBzLmRhdGEgPT09IGRhdGEgKSB7CgkJCQkJLy8gQWRkIGNhbGxiYWNrIG1h
bnVhbGx5CgkJCQkJdXJsICs9ICgvXD8vLnRlc3QoIHVybCApID8gIiYiIDogIj8i
KSArIHMuanNvbnAgKyAiPSIgKyBqc29ucENhbGxiYWNrOwoJCQkJfQoJCQl9CgkJ
fQoKCQlzLnVybCA9IHVybDsKCQlzLmRhdGEgPSBkYXRhOwoKCQkvLyBJbnN0YWxs
IGNhbGxiYWNrCgkJd2luZG93WyBqc29ucENhbGxiYWNrIF0gPSBmdW5jdGlvbigg
cmVzcG9uc2UgKSB7CgkJCXJlc3BvbnNlQ29udGFpbmVyID0gWyByZXNwb25zZSBd
OwoJCX07CgoJCS8vIENsZWFuLXVwIGZ1bmN0aW9uCgkJanFYSFIuYWx3YXlzKGZ1
bmN0aW9uKCkgewoJCQkvLyBTZXQgY2FsbGJhY2sgYmFjayB0byBwcmV2aW91cyB2
YWx1ZQoJCQl3aW5kb3dbIGpzb25wQ2FsbGJhY2sgXSA9IHByZXZpb3VzOwoJCQkv
LyBDYWxsIGlmIGl0IHdhcyBhIGZ1bmN0aW9uIGFuZCB3ZSBoYXZlIGEgcmVzcG9u
c2UKCQkJaWYgKCByZXNwb25zZUNvbnRhaW5lciAmJiBqUXVlcnkuaXNGdW5jdGlv
biggcHJldmlvdXMgKSApIHsKCQkJCXdpbmRvd1sganNvbnBDYWxsYmFjayBdKCBy
ZXNwb25zZUNvbnRhaW5lclsgMCBdICk7CgkJCX0KCQl9KTsKCgkJLy8gVXNlIGRh
dGEgY29udmVydGVyIHRvIHJldHJpZXZlIGpzb24gYWZ0ZXIgc2NyaXB0IGV4ZWN1
dGlvbgoJCXMuY29udmVydGVyc1sic2NyaXB0IGpzb24iXSA9IGZ1bmN0aW9uKCkg
ewoJCQlpZiAoICFyZXNwb25zZUNvbnRhaW5lciApIHsKCQkJCWpRdWVyeS5lcnJv
cigganNvbnBDYWxsYmFjayArICIgd2FzIG5vdCBjYWxsZWQiICk7CgkJCX0KCQkJ
cmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWyAwIF07CgkJfTsKCgkJLy8gZm9yY2Ug
anNvbiBkYXRhVHlwZQoJCXMuZGF0YVR5cGVzWyAwIF0gPSAianNvbiI7CgoJCS8v
IERlbGVnYXRlIHRvIHNjcmlwdAoJCXJldHVybiAic2NyaXB0IjsKCX0KfSk7CgoK
CgovLyBJbnN0YWxsIHNjcmlwdCBkYXRhVHlwZQpqUXVlcnkuYWpheFNldHVwKHsK
CWFjY2VwdHM6IHsKCQlzY3JpcHQ6ICJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0
aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0
aW9uL3gtZWNtYXNjcmlwdCIKCX0sCgljb250ZW50czogewoJCXNjcmlwdDogL2ph
dmFzY3JpcHR8ZWNtYXNjcmlwdC8KCX0sCgljb252ZXJ0ZXJzOiB7CgkJInRleHQg
c2NyaXB0IjogZnVuY3Rpb24oIHRleHQgKSB7CgkJCWpRdWVyeS5nbG9iYWxFdmFs
KCB0ZXh0ICk7CgkJCXJldHVybiB0ZXh0OwoJCX0KCX0KfSk7CgovLyBIYW5kbGUg
Y2FjaGUncyBzcGVjaWFsIGNhc2UgYW5kIGdsb2JhbApqUXVlcnkuYWpheFByZWZp
bHRlciggInNjcmlwdCIsIGZ1bmN0aW9uKCBzICkgewoJaWYgKCBzLmNhY2hlID09
PSB1bmRlZmluZWQgKSB7CgkJcy5jYWNoZSA9IGZhbHNlOwoJfQoJaWYgKCBzLmNy
b3NzRG9tYWluICkgewoJCXMudHlwZSA9ICJHRVQiOwoJCXMuZ2xvYmFsID0gZmFs
c2U7Cgl9Cn0pOwoKLy8gQmluZCBzY3JpcHQgdGFnIGhhY2sgdHJhbnNwb3J0CmpR
dWVyeS5hamF4VHJhbnNwb3J0KCAic2NyaXB0IiwgZnVuY3Rpb24ocykgewoKCS8v
IFRoaXMgdHJhbnNwb3J0IG9ubHkgZGVhbHMgd2l0aCBjcm9zcyBkb21haW4gcmVx
dWVzdHMKCWlmICggcy5jcm9zc0RvbWFpbiApIHsKCgkJdmFyIHNjcmlwdCwKCQkJ
aGVhZCA9IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRh
Z05hbWUoICJoZWFkIiApWzBdIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsK
CgkJcmV0dXJuIHsKCgkJCXNlbmQ6IGZ1bmN0aW9uKCBfLCBjYWxsYmFjayApIHsK
CgkJCQlzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAic2NyaXB0IiAp
OwoKCQkJCXNjcmlwdC5hc3luYyA9ICJhc3luYyI7CgoJCQkJaWYgKCBzLnNjcmlw
dENoYXJzZXQgKSB7CgkJCQkJc2NyaXB0LmNoYXJzZXQgPSBzLnNjcmlwdENoYXJz
ZXQ7CgkJCQl9CgoJCQkJc2NyaXB0LnNyYyA9IHMudXJsOwoKCQkJCS8vIEF0dGFj
aCBoYW5kbGVycyBmb3IgYWxsIGJyb3dzZXJzCgkJCQlzY3JpcHQub25sb2FkID0g
c2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCBfLCBpc0Fib3J0
ICkgewoKCQkJCQlpZiAoIGlzQWJvcnQgfHwgIXNjcmlwdC5yZWFkeVN0YXRlIHx8
IC9sb2FkZWR8Y29tcGxldGUvLnRlc3QoIHNjcmlwdC5yZWFkeVN0YXRlICkgKSB7
CgoJCQkJCQkvLyBIYW5kbGUgbWVtb3J5IGxlYWsgaW4gSUUKCQkJCQkJc2NyaXB0
Lm9ubG9hZCA9IHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwoKCQkJ
CQkJLy8gUmVtb3ZlIHRoZSBzY3JpcHQKCQkJCQkJaWYgKCBoZWFkICYmIHNjcmlw
dC5wYXJlbnROb2RlICkgewoJCQkJCQkJaGVhZC5yZW1vdmVDaGlsZCggc2NyaXB0
ICk7CgkJCQkJCX0KCgkJCQkJCS8vIERlcmVmZXJlbmNlIHRoZSBzY3JpcHQKCQkJ
CQkJc2NyaXB0ID0gdW5kZWZpbmVkOwoKCQkJCQkJLy8gQ2FsbGJhY2sgaWYgbm90
IGFib3J0CgkJCQkJCWlmICggIWlzQWJvcnQgKSB7CgkJCQkJCQljYWxsYmFjaygg
MjAwLCAic3VjY2VzcyIgKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX07CgkJCQkvLyBV
c2UgaW5zZXJ0QmVmb3JlIGluc3RlYWQgb2YgYXBwZW5kQ2hpbGQgIHRvIGNpcmN1
bXZlbnQgYW4gSUU2IGJ1Zy4KCQkJCS8vIFRoaXMgYXJpc2VzIHdoZW4gYSBiYXNl
IG5vZGUgaXMgdXNlZCAoIzI3MDkgYW5kICM0Mzc4KS4KCQkJCWhlYWQuaW5zZXJ0
QmVmb3JlKCBzY3JpcHQsIGhlYWQuZmlyc3RDaGlsZCApOwoJCQl9LAoKCQkJYWJv
cnQ6IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBzY3JpcHQgKSB7CgkJCQkJc2NyaXB0
Lm9ubG9hZCggMCwgMSApOwoJCQkJfQoJCQl9CgkJfTsKCX0KfSk7CgoKCgp2YXIg
Ly8gIzUyODA6IEludGVybmV0IEV4cGxvcmVyIHdpbGwga2VlcCBjb25uZWN0aW9u
cyBhbGl2ZSBpZiB3ZSBkb24ndCBhYm9ydCBvbiB1bmxvYWQKCXhock9uVW5sb2Fk
QWJvcnQgPSB3aW5kb3cuQWN0aXZlWE9iamVjdCA/IGZ1bmN0aW9uKCkgewoJCS8v
IEFib3J0IGFsbCBwZW5kaW5nIHJlcXVlc3RzCgkJZm9yICggdmFyIGtleSBpbiB4
aHJDYWxsYmFja3MgKSB7CgkJCXhockNhbGxiYWNrc1sga2V5IF0oIDAsIDEgKTsK
CQl9Cgl9IDogZmFsc2UsCgl4aHJJZCA9IDAsCgl4aHJDYWxsYmFja3M7CgovLyBG
dW5jdGlvbnMgdG8gY3JlYXRlIHhocnMKZnVuY3Rpb24gY3JlYXRlU3RhbmRhcmRY
SFIoKSB7Cgl0cnkgewoJCXJldHVybiBuZXcgd2luZG93LlhNTEh0dHBSZXF1ZXN0
KCk7Cgl9IGNhdGNoKCBlICkge30KfQoKZnVuY3Rpb24gY3JlYXRlQWN0aXZlWEhS
KCkgewoJdHJ5IHsKCQlyZXR1cm4gbmV3IHdpbmRvdy5BY3RpdmVYT2JqZWN0KCAi
TWljcm9zb2Z0LlhNTEhUVFAiICk7Cgl9IGNhdGNoKCBlICkge30KfQoKLy8gQ3Jl
YXRlIHRoZSByZXF1ZXN0IG9iamVjdAovLyAoVGhpcyBpcyBzdGlsbCBhdHRhY2hl
ZCB0byBhamF4U2V0dGluZ3MgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpCmpR
dWVyeS5hamF4U2V0dGluZ3MueGhyID0gd2luZG93LkFjdGl2ZVhPYmplY3QgPwoJ
LyogTWljcm9zb2Z0IGZhaWxlZCB0byBwcm9wZXJseQoJICogaW1wbGVtZW50IHRo
ZSBYTUxIdHRwUmVxdWVzdCBpbiBJRTcgKGNhbid0IHJlcXVlc3QgbG9jYWwgZmls
ZXMpLAoJICogc28gd2UgdXNlIHRoZSBBY3RpdmVYT2JqZWN0IHdoZW4gaXQgaXMg
YXZhaWxhYmxlCgkgKiBBZGRpdGlvbmFsbHkgWE1MSHR0cFJlcXVlc3QgY2FuIGJl
IGRpc2FibGVkIGluIElFNy9JRTggc28KCSAqIHdlIG5lZWQgYSBmYWxsYmFjay4K
CSAqLwoJZnVuY3Rpb24oKSB7CgkJcmV0dXJuICF0aGlzLmlzTG9jYWwgJiYgY3Jl
YXRlU3RhbmRhcmRYSFIoKSB8fCBjcmVhdGVBY3RpdmVYSFIoKTsKCX0gOgoJLy8g
Rm9yIGFsbCBvdGhlciBicm93c2VycywgdXNlIHRoZSBzdGFuZGFyZCBYTUxIdHRw
UmVxdWVzdCBvYmplY3QKCWNyZWF0ZVN0YW5kYXJkWEhSOwoKLy8gRGV0ZXJtaW5l
IHN1cHBvcnQgcHJvcGVydGllcwooZnVuY3Rpb24oIHhociApIHsKCWpRdWVyeS5l
eHRlbmQoIGpRdWVyeS5zdXBwb3J0LCB7CgkJYWpheDogISF4aHIsCgkJY29yczog
ISF4aHIgJiYgKCAid2l0aENyZWRlbnRpYWxzIiBpbiB4aHIgKQoJfSk7Cn0pKCBq
UXVlcnkuYWpheFNldHRpbmdzLnhocigpICk7CgovLyBDcmVhdGUgdHJhbnNwb3J0
IGlmIHRoZSBicm93c2VyIGNhbiBwcm92aWRlIGFuIHhocgppZiAoIGpRdWVyeS5z
dXBwb3J0LmFqYXggKSB7CgoJalF1ZXJ5LmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24o
IHMgKSB7CgkJLy8gQ3Jvc3MgZG9tYWluIG9ubHkgYWxsb3dlZCBpZiBzdXBwb3J0
ZWQgdGhyb3VnaCBYTUxIdHRwUmVxdWVzdAoJCWlmICggIXMuY3Jvc3NEb21haW4g
fHwgalF1ZXJ5LnN1cHBvcnQuY29ycyApIHsKCgkJCXZhciBjYWxsYmFjazsKCgkJ
CXJldHVybiB7CgkJCQlzZW5kOiBmdW5jdGlvbiggaGVhZGVycywgY29tcGxldGUg
KSB7CgoJCQkJCS8vIEdldCBhIG5ldyB4aHIKCQkJCQl2YXIgeGhyID0gcy54aHIo
KSwKCQkJCQkJaGFuZGxlLAoJCQkJCQlpOwoKCQkJCQkvLyBPcGVuIHRoZSBzb2Nr
ZXQKCQkJCQkvLyBQYXNzaW5nIG51bGwgdXNlcm5hbWUsIGdlbmVyYXRlcyBhIGxv
Z2luIHBvcHVwIG9uIE9wZXJhICgjMjg2NSkKCQkJCQlpZiAoIHMudXNlcm5hbWUg
KSB7CgkJCQkJCXhoci5vcGVuKCBzLnR5cGUsIHMudXJsLCBzLmFzeW5jLCBzLnVz
ZXJuYW1lLCBzLnBhc3N3b3JkICk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJeGhyLm9w
ZW4oIHMudHlwZSwgcy51cmwsIHMuYXN5bmMgKTsKCQkJCQl9CgoJCQkJCS8vIEFw
cGx5IGN1c3RvbSBmaWVsZHMgaWYgcHJvdmlkZWQKCQkJCQlpZiAoIHMueGhyRmll
bGRzICkgewoJCQkJCQlmb3IgKCBpIGluIHMueGhyRmllbGRzICkgewoJCQkJCQkJ
eGhyWyBpIF0gPSBzLnhockZpZWxkc1sgaSBdOwoJCQkJCQl9CgkJCQkJfQoKCQkJ
CQkvLyBPdmVycmlkZSBtaW1lIHR5cGUgaWYgbmVlZGVkCgkJCQkJaWYgKCBzLm1p
bWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlICkgewoJCQkJCQl4aHIub3Zl
cnJpZGVNaW1lVHlwZSggcy5taW1lVHlwZSApOwoJCQkJCX0KCgkJCQkJLy8gWC1S
ZXF1ZXN0ZWQtV2l0aCBoZWFkZXIKCQkJCQkvLyBGb3IgY3Jvc3MtZG9tYWluIHJl
cXVlc3RzLCBzZWVpbmcgYXMgY29uZGl0aW9ucyBmb3IgYSBwcmVmbGlnaHQgYXJl
CgkJCQkJLy8gYWtpbiB0byBhIGppZ3NhdyBwdXp6bGUsIHdlIHNpbXBseSBuZXZl
ciBzZXQgaXQgdG8gYmUgc3VyZS4KCQkJCQkvLyAoaXQgY2FuIGFsd2F5cyBiZSBz
ZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1
cCkKCQkJCQkvLyBGb3Igc2FtZS1kb21haW4gcmVxdWVzdHMsIHdvbid0IGNoYW5n
ZSBoZWFkZXIgaWYgYWxyZWFkeSBwcm92aWRlZC4KCQkJCQlpZiAoICFzLmNyb3Nz
RG9tYWluICYmICFoZWFkZXJzWyJYLVJlcXVlc3RlZC1XaXRoIl0gKSB7CgkJCQkJ
CWhlYWRlcnNbICJYLVJlcXVlc3RlZC1XaXRoIiBdID0gIlhNTEh0dHBSZXF1ZXN0
IjsKCQkJCQl9CgoJCQkJCS8vIE5lZWQgYW4gZXh0cmEgdHJ5L2NhdGNoIGZvciBj
cm9zcyBkb21haW4gcmVxdWVzdHMgaW4gRmlyZWZveCAzCgkJCQkJdHJ5IHsKCQkJ
CQkJZm9yICggaSBpbiBoZWFkZXJzICkgewoJCQkJCQkJeGhyLnNldFJlcXVlc3RI
ZWFkZXIoIGksIGhlYWRlcnNbIGkgXSApOwoJCQkJCQl9CgkJCQkJfSBjYXRjaCgg
XyApIHt9CgoJCQkJCS8vIERvIHNlbmQgdGhlIHJlcXVlc3QKCQkJCQkvLyBUaGlz
IG1heSByYWlzZSBhbiBleGNlcHRpb24gd2hpY2ggaXMgYWN0dWFsbHkKCQkJCQkv
LyBoYW5kbGVkIGluIGpRdWVyeS5hamF4IChzbyBubyB0cnkvY2F0Y2ggaGVyZSkK
CQkJCQl4aHIuc2VuZCggKCBzLmhhc0NvbnRlbnQgJiYgcy5kYXRhICkgfHwgbnVs
bCApOwoKCQkJCQkvLyBMaXN0ZW5lcgoJCQkJCWNhbGxiYWNrID0gZnVuY3Rpb24o
IF8sIGlzQWJvcnQgKSB7CgoJCQkJCQl2YXIgc3RhdHVzLAoJCQkJCQkJc3RhdHVz
VGV4dCwKCQkJCQkJCXJlc3BvbnNlSGVhZGVycywKCQkJCQkJCXJlc3BvbnNlcywK
CQkJCQkJCXhtbDsKCgkJCQkJCS8vIEZpcmVmb3ggdGhyb3dzIGV4Y2VwdGlvbnMg
d2hlbiBhY2Nlc3NpbmcgcHJvcGVydGllcwoJCQkJCQkvLyBvZiBhbiB4aHIgd2hl
biBhIG5ldHdvcmsgZXJyb3Igb2NjdXJlZAoJCQkJCQkvLyBodHRwOi8vaGVscGZ1
bC5rbm9icy1kaWFscy5jb20vaW5kZXgucGhwL0NvbXBvbmVudF9yZXR1cm5lZF9m
YWlsdXJlX2NvZGU6XzB4ODAwNDAxMTFfKE5TX0VSUk9SX05PVF9BVkFJTEFCTEUp
CgkJCQkJCXRyeSB7CgoJCQkJCQkJLy8gV2FzIG5ldmVyIGNhbGxlZCBhbmQgaXMg
YWJvcnRlZCBvciBjb21wbGV0ZQoJCQkJCQkJaWYgKCBjYWxsYmFjayAmJiAoIGlz
QWJvcnQgfHwgeGhyLnJlYWR5U3RhdGUgPT09IDQgKSApIHsKCgkJCQkJCQkJLy8g
T25seSBjYWxsZWQgb25jZQoJCQkJCQkJCWNhbGxiYWNrID0gdW5kZWZpbmVkOwoK
CQkJCQkJCQkvLyBEbyBub3Qga2VlcCBhcyBhY3RpdmUgYW55bW9yZQoJCQkJCQkJ
CWlmICggaGFuZGxlICkgewoJCQkJCQkJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdl
ID0galF1ZXJ5Lm5vb3A7CgkJCQkJCQkJCWlmICggeGhyT25VbmxvYWRBYm9ydCAp
IHsKCQkJCQkJCQkJCWRlbGV0ZSB4aHJDYWxsYmFja3NbIGhhbmRsZSBdOwoJCQkJ
CQkJCQl9CgkJCQkJCQkJfQoKCQkJCQkJCQkvLyBJZiBpdCdzIGFuIGFib3J0CgkJ
CQkJCQkJaWYgKCBpc0Fib3J0ICkgewoJCQkJCQkJCQkvLyBBYm9ydCBpdCBtYW51
YWxseSBpZiBuZWVkZWQKCQkJCQkJCQkJaWYgKCB4aHIucmVhZHlTdGF0ZSAhPT0g
NCApIHsKCQkJCQkJCQkJCXhoci5hYm9ydCgpOwoJCQkJCQkJCQl9CgkJCQkJCQkJ
fSBlbHNlIHsKCQkJCQkJCQkJc3RhdHVzID0geGhyLnN0YXR1czsKCQkJCQkJCQkJ
cmVzcG9uc2VIZWFkZXJzID0geGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpOwoJ
CQkJCQkJCQlyZXNwb25zZXMgPSB7fTsKCQkJCQkJCQkJeG1sID0geGhyLnJlc3Bv
bnNlWE1MOwoKCQkJCQkJCQkJLy8gQ29uc3RydWN0IHJlc3BvbnNlIGxpc3QKCQkJ
CQkJCQkJaWYgKCB4bWwgJiYgeG1sLmRvY3VtZW50RWxlbWVudCAvKiAjNDk1OCAq
LyApIHsKCQkJCQkJCQkJCXJlc3BvbnNlcy54bWwgPSB4bWw7CgkJCQkJCQkJCX0K
CgkJCQkJCQkJCS8vIFdoZW4gcmVxdWVzdGluZyBiaW5hcnkgZGF0YSwgSUU2LTkg
d2lsbCB0aHJvdyBhbiBleGNlcHRpb24KCQkJCQkJCQkJLy8gb24gYW55IGF0dGVt
cHQgdG8gYWNjZXNzIHJlc3BvbnNlVGV4dCAoIzExNDI2KQoJCQkJCQkJCQl0cnkg
ewoJCQkJCQkJCQkJcmVzcG9uc2VzLnRleHQgPSB4aHIucmVzcG9uc2VUZXh0OwoJ
CQkJCQkJCQl9IGNhdGNoKCBfICkgewoJCQkJCQkJCQl9CgoJCQkJCQkJCQkvLyBG
aXJlZm94IHRocm93cyBhbiBleGNlcHRpb24gd2hlbiBhY2Nlc3NpbmcKCQkJCQkJ
CQkJLy8gc3RhdHVzVGV4dCBmb3IgZmF1bHR5IGNyb3NzLWRvbWFpbiByZXF1ZXN0
cwoJCQkJCQkJCQl0cnkgewoJCQkJCQkJCQkJc3RhdHVzVGV4dCA9IHhoci5zdGF0
dXNUZXh0OwoJCQkJCQkJCQl9IGNhdGNoKCBlICkgewoJCQkJCQkJCQkJLy8gV2Ug
bm9ybWFsaXplIHdpdGggV2Via2l0IGdpdmluZyBhbiBlbXB0eSBzdGF0dXNUZXh0
CgkJCQkJCQkJCQlzdGF0dXNUZXh0ID0gIiI7CgkJCQkJCQkJCX0KCgkJCQkJCQkJ
CS8vIEZpbHRlciBzdGF0dXMgZm9yIG5vbiBzdGFuZGFyZCBiZWhhdmlvcnMKCgkJ
CQkJCQkJCS8vIElmIHRoZSByZXF1ZXN0IGlzIGxvY2FsIGFuZCB3ZSBoYXZlIGRh
dGE6IGFzc3VtZSBhIHN1Y2Nlc3MKCQkJCQkJCQkJLy8gKHN1Y2Nlc3Mgd2l0aCBu
byBkYXRhIHdvbid0IGdldCBub3RpZmllZCwgdGhhdCdzIHRoZSBiZXN0IHdlCgkJ
CQkJCQkJCS8vIGNhbiBkbyBnaXZlbiBjdXJyZW50IGltcGxlbWVudGF0aW9ucykK
CQkJCQkJCQkJaWYgKCAhc3RhdHVzICYmIHMuaXNMb2NhbCAmJiAhcy5jcm9zc0Rv
bWFpbiApIHsKCQkJCQkJCQkJCXN0YXR1cyA9IHJlc3BvbnNlcy50ZXh0ID8gMjAw
IDogNDA0OwoJCQkJCQkJCQkvLyBJRSAtICMxNDUwOiBzb21ldGltZXMgcmV0dXJu
cyAxMjIzIHdoZW4gaXQgc2hvdWxkIGJlIDIwNAoJCQkJCQkJCQl9IGVsc2UgaWYg
KCBzdGF0dXMgPT09IDEyMjMgKSB7CgkJCQkJCQkJCQlzdGF0dXMgPSAyMDQ7CgkJ
CQkJCQkJCX0KCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0gY2F0Y2goIGZpcmVm
b3hBY2Nlc3NFeGNlcHRpb24gKSB7CgkJCQkJCQlpZiAoICFpc0Fib3J0ICkgewoJ
CQkJCQkJCWNvbXBsZXRlKCAtMSwgZmlyZWZveEFjY2Vzc0V4Y2VwdGlvbiApOwoJ
CQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBDYWxsIGNvbXBsZXRlIGlmIG5lZWRl
ZAoJCQkJCQlpZiAoIHJlc3BvbnNlcyApIHsKCQkJCQkJCWNvbXBsZXRlKCBzdGF0
dXMsIHN0YXR1c1RleHQsIHJlc3BvbnNlcywgcmVzcG9uc2VIZWFkZXJzICk7CgkJ
CQkJCX0KCQkJCQl9OwoKCQkJCQkvLyBpZiB3ZSdyZSBpbiBzeW5jIG1vZGUgb3Ig
aXQncyBpbiBjYWNoZQoJCQkJCS8vIGFuZCBoYXMgYmVlbiByZXRyaWV2ZWQgZGly
ZWN0bHkgKElFNiAmIElFNykKCQkJCQkvLyB3ZSBuZWVkIHRvIG1hbnVhbGx5IGZp
cmUgdGhlIGNhbGxiYWNrCgkJCQkJaWYgKCAhcy5hc3luYyB8fCB4aHIucmVhZHlT
dGF0ZSA9PT0gNCApIHsKCQkJCQkJY2FsbGJhY2soKTsKCQkJCQl9IGVsc2UgewoJ
CQkJCQloYW5kbGUgPSArK3hocklkOwoJCQkJCQlpZiAoIHhock9uVW5sb2FkQWJv
cnQgKSB7CgkJCQkJCQkvLyBDcmVhdGUgdGhlIGFjdGl2ZSB4aHJzIGNhbGxiYWNr
cyBsaXN0IGlmIG5lZWRlZAoJCQkJCQkJLy8gYW5kIGF0dGFjaCB0aGUgdW5sb2Fk
IGhhbmRsZXIKCQkJCQkJCWlmICggIXhockNhbGxiYWNrcyApIHsKCQkJCQkJCQl4
aHJDYWxsYmFja3MgPSB7fTsKCQkJCQkJCQlqUXVlcnkoIHdpbmRvdyApLnVubG9h
ZCggeGhyT25VbmxvYWRBYm9ydCApOwoJCQkJCQkJfQoJCQkJCQkJLy8gQWRkIHRv
IGxpc3Qgb2YgYWN0aXZlIHhocnMgY2FsbGJhY2tzCgkJCQkJCQl4aHJDYWxsYmFj
a3NbIGhhbmRsZSBdID0gY2FsbGJhY2s7CgkJCQkJCX0KCQkJCQkJeGhyLm9ucmVh
ZHlzdGF0ZWNoYW5nZSA9IGNhbGxiYWNrOwoJCQkJCX0KCQkJCX0sCgoJCQkJYWJv
cnQ6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggY2FsbGJhY2sgKSB7CgkJCQkJCWNh
bGxiYWNrKDAsMSk7CgkJCQkJfQoJCQkJfQoJCQl9OwoJCX0KCX0pOwp9CgoKCgp2
YXIgZWxlbWRpc3BsYXkgPSB7fSwKCWlmcmFtZSwgaWZyYW1lRG9jLAoJcmZ4dHlw
ZXMgPSAvXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sCglyZnhudW0gPSAvXihbK1wt
XT0pPyhbXGQrLlwtXSspKFthLXolXSopJC9pLAoJdGltZXJJZCwKCWZ4QXR0cnMg
PSBbCgkJLy8gaGVpZ2h0IGFuaW1hdGlvbnMKCQlbICJoZWlnaHQiLCAibWFyZ2lu
VG9wIiwgIm1hcmdpbkJvdHRvbSIsICJwYWRkaW5nVG9wIiwgInBhZGRpbmdCb3R0
b20iIF0sCgkJLy8gd2lkdGggYW5pbWF0aW9ucwoJCVsgIndpZHRoIiwgIm1hcmdp
bkxlZnQiLCAibWFyZ2luUmlnaHQiLCAicGFkZGluZ0xlZnQiLCAicGFkZGluZ1Jp
Z2h0IiBdLAoJCS8vIG9wYWNpdHkgYW5pbWF0aW9ucwoJCVsgIm9wYWNpdHkiIF0K
CV0sCglmeE5vdzsKCmpRdWVyeS5mbi5leHRlbmQoewoJc2hvdzogZnVuY3Rpb24o
IHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgewoJCXZhciBlbGVtLCBkaXNwbGF5
OwoKCQlpZiAoIHNwZWVkIHx8IHNwZWVkID09PSAwICkgewoJCQlyZXR1cm4gdGhp
cy5hbmltYXRlKCBnZW5GeCgic2hvdyIsIDMpLCBzcGVlZCwgZWFzaW5nLCBjYWxs
YmFjayApOwoKCQl9IGVsc2UgewoJCQlmb3IgKCB2YXIgaSA9IDAsIGogPSB0aGlz
Lmxlbmd0aDsgaSA8IGo7IGkrKyApIHsKCQkJCWVsZW0gPSB0aGlzWyBpIF07CgoJ
CQkJaWYgKCBlbGVtLnN0eWxlICkgewoJCQkJCWRpc3BsYXkgPSBlbGVtLnN0eWxl
LmRpc3BsYXk7CgoJCQkJCS8vIFJlc2V0IHRoZSBpbmxpbmUgZGlzcGxheSBvZiB0
aGlzIGVsZW1lbnQgdG8gbGVhcm4gaWYgaXQgaXMKCQkJCQkvLyBiZWluZyBoaWRk
ZW4gYnkgY2FzY2FkZWQgcnVsZXMgb3Igbm90CgkJCQkJaWYgKCAhalF1ZXJ5Ll9k
YXRhKGVsZW0sICJvbGRkaXNwbGF5IikgJiYgZGlzcGxheSA9PT0gIm5vbmUiICkg
ewoJCQkJCQlkaXNwbGF5ID0gZWxlbS5zdHlsZS5kaXNwbGF5ID0gIiI7CgkJCQkJ
fQoKCQkJCQkvLyBTZXQgZWxlbWVudHMgd2hpY2ggaGF2ZSBiZWVuIG92ZXJyaWRk
ZW4gd2l0aCBkaXNwbGF5OiBub25lCgkJCQkJLy8gaW4gYSBzdHlsZXNoZWV0IHRv
IHdoYXRldmVyIHRoZSBkZWZhdWx0IGJyb3dzZXIgc3R5bGUgaXMKCQkJCQkvLyBm
b3Igc3VjaCBhbiBlbGVtZW50CgkJCQkJaWYgKCAoZGlzcGxheSA9PT0gIiIgJiYg
alF1ZXJ5LmNzcyhlbGVtLCAiZGlzcGxheSIpID09PSAibm9uZSIpIHx8CgkJCQkJ
CSFqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudC5kb2N1bWVudEVs
ZW1lbnQsIGVsZW0gKSApIHsKCQkJCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAib2xk
ZGlzcGxheSIsIGRlZmF1bHREaXNwbGF5KGVsZW0ubm9kZU5hbWUpICk7CgkJCQkJ
fQoJCQkJfQoJCQl9CgoJCQkvLyBTZXQgdGhlIGRpc3BsYXkgb2YgbW9zdCBvZiB0
aGUgZWxlbWVudHMgaW4gYSBzZWNvbmQgbG9vcAoJCQkvLyB0byBhdm9pZCB0aGUg
Y29uc3RhbnQgcmVmbG93CgkJCWZvciAoIGkgPSAwOyBpIDwgajsgaSsrICkgewoJ
CQkJZWxlbSA9IHRoaXNbIGkgXTsKCgkJCQlpZiAoIGVsZW0uc3R5bGUgKSB7CgkJ
CQkJZGlzcGxheSA9IGVsZW0uc3R5bGUuZGlzcGxheTsKCgkJCQkJaWYgKCBkaXNw
bGF5ID09PSAiIiB8fCBkaXNwbGF5ID09PSAibm9uZSIgKSB7CgkJCQkJCWVsZW0u
c3R5bGUuZGlzcGxheSA9IGpRdWVyeS5fZGF0YSggZWxlbSwgIm9sZGRpc3BsYXki
ICkgfHwgIiI7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdGhpczsKCQl9
Cgl9LAoKCWhpZGU6IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayAp
IHsKCQlpZiAoIHNwZWVkIHx8IHNwZWVkID09PSAwICkgewoJCQlyZXR1cm4gdGhp
cy5hbmltYXRlKCBnZW5GeCgiaGlkZSIsIDMpLCBzcGVlZCwgZWFzaW5nLCBjYWxs
YmFjayk7CgoJCX0gZWxzZSB7CgkJCXZhciBlbGVtLCBkaXNwbGF5LAoJCQkJaSA9
IDAsCgkJCQlqID0gdGhpcy5sZW5ndGg7CgoJCQlmb3IgKCA7IGkgPCBqOyBpKysg
KSB7CgkJCQllbGVtID0gdGhpc1tpXTsKCQkJCWlmICggZWxlbS5zdHlsZSApIHsK
CQkJCQlkaXNwbGF5ID0galF1ZXJ5LmNzcyggZWxlbSwgImRpc3BsYXkiICk7CgoJ
CQkJCWlmICggZGlzcGxheSAhPT0gIm5vbmUiICYmICFqUXVlcnkuX2RhdGEoIGVs
ZW0sICJvbGRkaXNwbGF5IiApICkgewoJCQkJCQlqUXVlcnkuX2RhdGEoIGVsZW0s
ICJvbGRkaXNwbGF5IiwgZGlzcGxheSApOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJ
Ly8gU2V0IHRoZSBkaXNwbGF5IG9mIHRoZSBlbGVtZW50cyBpbiBhIHNlY29uZCBs
b29wCgkJCS8vIHRvIGF2b2lkIHRoZSBjb25zdGFudCByZWZsb3cKCQkJZm9yICgg
aSA9IDA7IGkgPCBqOyBpKysgKSB7CgkJCQlpZiAoIHRoaXNbaV0uc3R5bGUgKSB7
CgkJCQkJdGhpc1tpXS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJCQkJfQoJCQl9
CgoJCQlyZXR1cm4gdGhpczsKCQl9Cgl9LAoKCS8vIFNhdmUgdGhlIG9sZCB0b2dn
bGUgZnVuY3Rpb24KCV90b2dnbGU6IGpRdWVyeS5mbi50b2dnbGUsCgoJdG9nZ2xl
OiBmdW5jdGlvbiggZm4sIGZuMiwgY2FsbGJhY2sgKSB7CgkJdmFyIGJvb2wgPSB0
eXBlb2YgZm4gPT09ICJib29sZWFuIjsKCgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlv
bihmbikgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oZm4yKSApIHsKCQkJdGhpcy5fdG9n
Z2xlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCgkJfSBlbHNlIGlmICggZm4g
PT0gbnVsbCB8fCBib29sICkgewoJCQl0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJ
CQl2YXIgc3RhdGUgPSBib29sID8gZm4gOiBqUXVlcnkodGhpcykuaXMoIjpoaWRk
ZW4iKTsKCQkJCWpRdWVyeSh0aGlzKVsgc3RhdGUgPyAic2hvdyIgOiAiaGlkZSIg
XSgpOwoJCQl9KTsKCgkJfSBlbHNlIHsKCQkJdGhpcy5hbmltYXRlKGdlbkZ4KCJ0
b2dnbGUiLCAzKSwgZm4sIGZuMiwgY2FsbGJhY2spOwoJCX0KCgkJcmV0dXJuIHRo
aXM7Cgl9LAoKCWZhZGVUbzogZnVuY3Rpb24oIHNwZWVkLCB0bywgZWFzaW5nLCBj
YWxsYmFjayApIHsKCQlyZXR1cm4gdGhpcy5maWx0ZXIoIjpoaWRkZW4iKS5jc3Mo
Im9wYWNpdHkiLCAwKS5zaG93KCkuZW5kKCkKCQkJCQkuYW5pbWF0ZSh7b3BhY2l0
eTogdG99LCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayk7Cgl9LAoKCWFuaW1hdGU6
IGZ1bmN0aW9uKCBwcm9wLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHsKCQl2
YXIgb3B0YWxsID0galF1ZXJ5LnNwZWVkKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFj
ayApOwoKCQlpZiAoIGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBwcm9wICkgKSB7CgkJ
CXJldHVybiB0aGlzLmVhY2goIG9wdGFsbC5jb21wbGV0ZSwgWyBmYWxzZSBdICk7
CgkJfQoKCQkvLyBEbyBub3QgY2hhbmdlIHJlZmVyZW5jZWQgcHJvcGVydGllcyBh
cyBwZXItcHJvcGVydHkgZWFzaW5nIHdpbGwgYmUgbG9zdAoJCXByb3AgPSBqUXVl
cnkuZXh0ZW5kKCB7fSwgcHJvcCApOwoKCQlmdW5jdGlvbiBkb0FuaW1hdGlvbigp
IHsKCQkJLy8gWFhYICd0aGlzJyBkb2VzIG5vdCBhbHdheXMgaGF2ZSBhIG5vZGVO
YW1lIHdoZW4gcnVubmluZyB0aGUKCQkJLy8gdGVzdCBzdWl0ZQoKCQkJaWYgKCBv
cHRhbGwucXVldWUgPT09IGZhbHNlICkgewoJCQkJalF1ZXJ5Ll9tYXJrKCB0aGlz
ICk7CgkJCX0KCgkJCXZhciBvcHQgPSBqUXVlcnkuZXh0ZW5kKCB7fSwgb3B0YWxs
ICksCgkJCQlpc0VsZW1lbnQgPSB0aGlzLm5vZGVUeXBlID09PSAxLAoJCQkJaGlk
ZGVuID0gaXNFbGVtZW50ICYmIGpRdWVyeSh0aGlzKS5pcygiOmhpZGRlbiIpLAoJ
CQkJbmFtZSwgdmFsLCBwLCBlLCBob29rcywgcmVwbGFjZSwKCQkJCXBhcnRzLCBz
dGFydCwgZW5kLCB1bml0LAoJCQkJbWV0aG9kOwoKCQkJLy8gd2lsbCBzdG9yZSBw
ZXIgcHJvcGVydHkgZWFzaW5nIGFuZCBiZSB1c2VkIHRvIGRldGVybWluZSB3aGVu
IGFuIGFuaW1hdGlvbiBpcyBjb21wbGV0ZQoJCQlvcHQuYW5pbWF0ZWRQcm9wZXJ0
aWVzID0ge307CgoJCQkvLyBmaXJzdCBwYXNzIG92ZXIgcHJvcGVydHlzIHRvIGV4
cGFuZCAvIG5vcm1hbGl6ZQoJCQlmb3IgKCBwIGluIHByb3AgKSB7CgkJCQluYW1l
ID0galF1ZXJ5LmNhbWVsQ2FzZSggcCApOwoJCQkJaWYgKCBwICE9PSBuYW1lICkg
ewoJCQkJCXByb3BbIG5hbWUgXSA9IHByb3BbIHAgXTsKCQkJCQlkZWxldGUgcHJv
cFsgcCBdOwoJCQkJfQoKCQkJCWlmICggKCBob29rcyA9IGpRdWVyeS5jc3NIb29r
c1sgbmFtZSBdICkgJiYgImV4cGFuZCIgaW4gaG9va3MgKSB7CgkJCQkJcmVwbGFj
ZSA9IGhvb2tzLmV4cGFuZCggcHJvcFsgbmFtZSBdICk7CgkJCQkJZGVsZXRlIHBy
b3BbIG5hbWUgXTsKCgkJCQkJLy8gbm90IHF1aXRlICQuZXh0ZW5kLCB0aGlzIHdv
bnQgb3ZlcndyaXRlIGtleXMgYWxyZWFkeSBwcmVzZW50LgoJCQkJCS8vIGFsc28g
LSByZXVzaW5nICdwJyBmcm9tIGFib3ZlIGJlY2F1c2Ugd2UgaGF2ZSB0aGUgY29y
cmVjdCAibmFtZSIKCQkJCQlmb3IgKCBwIGluIHJlcGxhY2UgKSB7CgkJCQkJCWlm
ICggISAoIHAgaW4gcHJvcCApICkgewoJCQkJCQkJcHJvcFsgcCBdID0gcmVwbGFj
ZVsgcCBdOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlmb3IgKCBuYW1l
IGluIHByb3AgKSB7CgkJCQl2YWwgPSBwcm9wWyBuYW1lIF07CgkJCQkvLyBlYXNp
bmcgcmVzb2x1dGlvbjogcGVyIHByb3BlcnR5ID4gb3B0LnNwZWNpYWxFYXNpbmcg
PiBvcHQuZWFzaW5nID4gJ3N3aW5nJyAoZGVmYXVsdCkKCQkJCWlmICggalF1ZXJ5
LmlzQXJyYXkoIHZhbCApICkgewoJCQkJCW9wdC5hbmltYXRlZFByb3BlcnRpZXNb
IG5hbWUgXSA9IHZhbFsgMSBdOwoJCQkJCXZhbCA9IHByb3BbIG5hbWUgXSA9IHZh
bFsgMCBdOwoJCQkJfSBlbHNlIHsKCQkJCQlvcHQuYW5pbWF0ZWRQcm9wZXJ0aWVz
WyBuYW1lIF0gPSBvcHQuc3BlY2lhbEVhc2luZyAmJiBvcHQuc3BlY2lhbEVhc2lu
Z1sgbmFtZSBdIHx8IG9wdC5lYXNpbmcgfHwgJ3N3aW5nJzsKCQkJCX0KCgkJCQlp
ZiAoIHZhbCA9PT0gImhpZGUiICYmIGhpZGRlbiB8fCB2YWwgPT09ICJzaG93IiAm
JiAhaGlkZGVuICkgewoJCQkJCXJldHVybiBvcHQuY29tcGxldGUuY2FsbCggdGhp
cyApOwoJCQkJfQoKCQkJCWlmICggaXNFbGVtZW50ICYmICggbmFtZSA9PT0gImhl
aWdodCIgfHwgbmFtZSA9PT0gIndpZHRoIiApICkgewoJCQkJCS8vIE1ha2Ugc3Vy
ZSB0aGF0IG5vdGhpbmcgc25lYWtzIG91dAoJCQkJCS8vIFJlY29yZCBhbGwgMyBv
dmVyZmxvdyBhdHRyaWJ1dGVzIGJlY2F1c2UgSUUgZG9lcyBub3QKCQkJCQkvLyBj
aGFuZ2UgdGhlIG92ZXJmbG93IGF0dHJpYnV0ZSB3aGVuIG92ZXJmbG93WCBhbmQK
CQkJCQkvLyBvdmVyZmxvd1kgYXJlIHNldCB0byB0aGUgc2FtZSB2YWx1ZQoJCQkJ
CW9wdC5vdmVyZmxvdyA9IFsgdGhpcy5zdHlsZS5vdmVyZmxvdywgdGhpcy5zdHls
ZS5vdmVyZmxvd1gsIHRoaXMuc3R5bGUub3ZlcmZsb3dZIF07CgoJCQkJCS8vIFNl
dCBkaXNwbGF5IHByb3BlcnR5IHRvIGlubGluZS1ibG9jayBmb3IgaGVpZ2h0L3dp
ZHRoCgkJCQkJLy8gYW5pbWF0aW9ucyBvbiBpbmxpbmUgZWxlbWVudHMgdGhhdCBh
cmUgaGF2aW5nIHdpZHRoL2hlaWdodCBhbmltYXRlZAoJCQkJCWlmICggalF1ZXJ5
LmNzcyggdGhpcywgImRpc3BsYXkiICkgPT09ICJpbmxpbmUiICYmCgkJCQkJCQlq
UXVlcnkuY3NzKCB0aGlzLCAiZmxvYXQiICkgPT09ICJub25lIiApIHsKCgkJCQkJ
CS8vIGlubGluZS1sZXZlbCBlbGVtZW50cyBhY2NlcHQgaW5saW5lLWJsb2NrOwoJ
CQkJCQkvLyBibG9jay1sZXZlbCBlbGVtZW50cyBuZWVkIHRvIGJlIGlubGluZSB3
aXRoIGxheW91dAoJCQkJCQlpZiAoICFqUXVlcnkuc3VwcG9ydC5pbmxpbmVCbG9j
a05lZWRzTGF5b3V0IHx8IGRlZmF1bHREaXNwbGF5KCB0aGlzLm5vZGVOYW1lICkg
PT09ICJpbmxpbmUiICkgewoJCQkJCQkJdGhpcy5zdHlsZS5kaXNwbGF5ID0gImlu
bGluZS1ibG9jayI7CgoJCQkJCQl9IGVsc2UgewoJCQkJCQkJdGhpcy5zdHlsZS56
b29tID0gMTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKCBvcHQu
b3ZlcmZsb3cgIT0gbnVsbCApIHsKCQkJCXRoaXMuc3R5bGUub3ZlcmZsb3cgPSAi
aGlkZGVuIjsKCQkJfQoKCQkJZm9yICggcCBpbiBwcm9wICkgewoJCQkJZSA9IG5l
dyBqUXVlcnkuZngoIHRoaXMsIG9wdCwgcCApOwoJCQkJdmFsID0gcHJvcFsgcCBd
OwoKCQkJCWlmICggcmZ4dHlwZXMudGVzdCggdmFsICkgKSB7CgoJCQkJCS8vIFRy
YWNrcyB3aGV0aGVyIHRvIHNob3cgb3IgaGlkZSBiYXNlZCBvbiBwcml2YXRlCgkJ
CQkJLy8gZGF0YSBhdHRhY2hlZCB0byB0aGUgZWxlbWVudAoJCQkJCW1ldGhvZCA9
IGpRdWVyeS5fZGF0YSggdGhpcywgInRvZ2dsZSIgKyBwICkgfHwgKCB2YWwgPT09
ICJ0b2dnbGUiID8gaGlkZGVuID8gInNob3ciIDogImhpZGUiIDogMCApOwoJCQkJ
CWlmICggbWV0aG9kICkgewoJCQkJCQlqUXVlcnkuX2RhdGEoIHRoaXMsICJ0b2dn
bGUiICsgcCwgbWV0aG9kID09PSAic2hvdyIgPyAiaGlkZSIgOiAic2hvdyIgKTsK
CQkJCQkJZVsgbWV0aG9kIF0oKTsKCQkJCQl9IGVsc2UgewoJCQkJCQllWyB2YWwg
XSgpOwoJCQkJCX0KCgkJCQl9IGVsc2UgewoJCQkJCXBhcnRzID0gcmZ4bnVtLmV4
ZWMoIHZhbCApOwoJCQkJCXN0YXJ0ID0gZS5jdXIoKTsKCgkJCQkJaWYgKCBwYXJ0
cyApIHsKCQkJCQkJZW5kID0gcGFyc2VGbG9hdCggcGFydHNbMl0gKTsKCQkJCQkJ
dW5pdCA9IHBhcnRzWzNdIHx8ICggalF1ZXJ5LmNzc051bWJlclsgcCBdID8gIiIg
OiAicHgiICk7CgoJCQkJCQkvLyBXZSBuZWVkIHRvIGNvbXB1dGUgc3RhcnRpbmcg
dmFsdWUKCQkJCQkJaWYgKCB1bml0ICE9PSAicHgiICkgewoJCQkJCQkJalF1ZXJ5
LnN0eWxlKCB0aGlzLCBwLCAoZW5kIHx8IDEpICsgdW5pdCk7CgkJCQkJCQlzdGFy
dCA9ICggKGVuZCB8fCAxKSAvIGUuY3VyKCkgKSAqIHN0YXJ0OwoJCQkJCQkJalF1
ZXJ5LnN0eWxlKCB0aGlzLCBwLCBzdGFydCArIHVuaXQpOwoJCQkJCQl9CgoJCQkJ
CQkvLyBJZiBhICs9Ly09IHRva2VuIHdhcyBwcm92aWRlZCwgd2UncmUgZG9pbmcg
YSByZWxhdGl2ZSBhbmltYXRpb24KCQkJCQkJaWYgKCBwYXJ0c1sxXSApIHsKCQkJ
CQkJCWVuZCA9ICggKHBhcnRzWyAxIF0gPT09ICItPSIgPyAtMSA6IDEpICogZW5k
ICkgKyBzdGFydDsKCQkJCQkJfQoKCQkJCQkJZS5jdXN0b20oIHN0YXJ0LCBlbmQs
IHVuaXQgKTsKCgkJCQkJfSBlbHNlIHsKCQkJCQkJZS5jdXN0b20oIHN0YXJ0LCB2
YWwsICIiICk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBGb3IgSlMgc3RyaWN0
IGNvbXBsaWFuY2UKCQkJcmV0dXJuIHRydWU7CgkJfQoKCQlyZXR1cm4gb3B0YWxs
LnF1ZXVlID09PSBmYWxzZSA/CgkJCXRoaXMuZWFjaCggZG9BbmltYXRpb24gKSA6
CgkJCXRoaXMucXVldWUoIG9wdGFsbC5xdWV1ZSwgZG9BbmltYXRpb24gKTsKCX0s
CgoJc3RvcDogZnVuY3Rpb24oIHR5cGUsIGNsZWFyUXVldWUsIGdvdG9FbmQgKSB7
CgkJaWYgKCB0eXBlb2YgdHlwZSAhPT0gInN0cmluZyIgKSB7CgkJCWdvdG9FbmQg
PSBjbGVhclF1ZXVlOwoJCQljbGVhclF1ZXVlID0gdHlwZTsKCQkJdHlwZSA9IHVu
ZGVmaW5lZDsKCQl9CgkJaWYgKCBjbGVhclF1ZXVlICYmIHR5cGUgIT09IGZhbHNl
ICkgewoJCQl0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7CgkJfQoKCQly
ZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQl2YXIgaW5kZXgsCgkJCQlo
YWRUaW1lcnMgPSBmYWxzZSwKCQkJCXRpbWVycyA9IGpRdWVyeS50aW1lcnMsCgkJ
CQlkYXRhID0galF1ZXJ5Ll9kYXRhKCB0aGlzICk7CgoJCQkvLyBjbGVhciBtYXJr
ZXIgY291bnRlcnMgaWYgd2Uga25vdyB0aGV5IHdvbid0IGJlCgkJCWlmICggIWdv
dG9FbmQgKSB7CgkJCQlqUXVlcnkuX3VubWFyayggdHJ1ZSwgdGhpcyApOwoJCQl9
CgoJCQlmdW5jdGlvbiBzdG9wUXVldWUoIGVsZW0sIGRhdGEsIGluZGV4ICkgewoJ
CQkJdmFyIGhvb2tzID0gZGF0YVsgaW5kZXggXTsKCQkJCWpRdWVyeS5yZW1vdmVE
YXRhKCBlbGVtLCBpbmRleCwgdHJ1ZSApOwoJCQkJaG9va3Muc3RvcCggZ290b0Vu
ZCApOwoJCQl9CgoJCQlpZiAoIHR5cGUgPT0gbnVsbCApIHsKCQkJCWZvciAoIGlu
ZGV4IGluIGRhdGEgKSB7CgkJCQkJaWYgKCBkYXRhWyBpbmRleCBdICYmIGRhdGFb
IGluZGV4IF0uc3RvcCAmJiBpbmRleC5pbmRleE9mKCIucnVuIikgPT09IGluZGV4
Lmxlbmd0aCAtIDQgKSB7CgkJCQkJCXN0b3BRdWV1ZSggdGhpcywgZGF0YSwgaW5k
ZXggKTsKCQkJCQl9CgkJCQl9CgkJCX0gZWxzZSBpZiAoIGRhdGFbIGluZGV4ID0g
dHlwZSArICIucnVuIiBdICYmIGRhdGFbIGluZGV4IF0uc3RvcCApewoJCQkJc3Rv
cFF1ZXVlKCB0aGlzLCBkYXRhLCBpbmRleCApOwoJCQl9CgoJCQlmb3IgKCBpbmRl
eCA9IHRpbWVycy5sZW5ndGg7IGluZGV4LS07ICkgewoJCQkJaWYgKCB0aW1lcnNb
IGluZGV4IF0uZWxlbSA9PT0gdGhpcyAmJiAodHlwZSA9PSBudWxsIHx8IHRpbWVy
c1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSkgKSB7CgkJCQkJaWYgKCBnb3RvRW5k
ICkgewoKCQkJCQkJLy8gZm9yY2UgdGhlIG5leHQgc3RlcCB0byBiZSB0aGUgbGFz
dAoJCQkJCQl0aW1lcnNbIGluZGV4IF0oIHRydWUgKTsKCQkJCQl9IGVsc2UgewoJ
CQkJCQl0aW1lcnNbIGluZGV4IF0uc2F2ZVN0YXRlKCk7CgkJCQkJfQoJCQkJCWhh
ZFRpbWVycyA9IHRydWU7CgkJCQkJdGltZXJzLnNwbGljZSggaW5kZXgsIDEgKTsK
CQkJCX0KCQkJfQoKCQkJLy8gc3RhcnQgdGhlIG5leHQgaW4gdGhlIHF1ZXVlIGlm
IHRoZSBsYXN0IHN0ZXAgd2Fzbid0IGZvcmNlZAoJCQkvLyB0aW1lcnMgY3VycmVu
dGx5IHdpbGwgY2FsbCB0aGVpciBjb21wbGV0ZSBjYWxsYmFja3MsIHdoaWNoIHdp
bGwgZGVxdWV1ZQoJCQkvLyBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZAoJ
CQlpZiAoICEoIGdvdG9FbmQgJiYgaGFkVGltZXJzICkgKSB7CgkJCQlqUXVlcnku
ZGVxdWV1ZSggdGhpcywgdHlwZSApOwoJCQl9CgkJfSk7Cgl9Cgp9KTsKCi8vIEFu
aW1hdGlvbnMgY3JlYXRlZCBzeW5jaHJvbm91c2x5IHdpbGwgcnVuIHN5bmNocm9u
b3VzbHkKZnVuY3Rpb24gY3JlYXRlRnhOb3coKSB7CglzZXRUaW1lb3V0KCBjbGVh
ckZ4Tm93LCAwICk7CglyZXR1cm4gKCBmeE5vdyA9IGpRdWVyeS5ub3coKSApOwp9
CgpmdW5jdGlvbiBjbGVhckZ4Tm93KCkgewoJZnhOb3cgPSB1bmRlZmluZWQ7Cn0K
Ci8vIEdlbmVyYXRlIHBhcmFtZXRlcnMgdG8gY3JlYXRlIGEgc3RhbmRhcmQgYW5p
bWF0aW9uCmZ1bmN0aW9uIGdlbkZ4KCB0eXBlLCBudW0gKSB7Cgl2YXIgb2JqID0g
e307CgoJalF1ZXJ5LmVhY2goIGZ4QXR0cnMuY29uY2F0LmFwcGx5KFtdLCBmeEF0
dHJzLnNsaWNlKCAwLCBudW0gKSksIGZ1bmN0aW9uKCkgewoJCW9ialsgdGhpcyBd
ID0gdHlwZTsKCX0pOwoKCXJldHVybiBvYmo7Cn0KCi8vIEdlbmVyYXRlIHNob3J0
Y3V0cyBmb3IgY3VzdG9tIGFuaW1hdGlvbnMKalF1ZXJ5LmVhY2goewoJc2xpZGVE
b3duOiBnZW5GeCggInNob3ciLCAxICksCglzbGlkZVVwOiBnZW5GeCggImhpZGUi
LCAxICksCglzbGlkZVRvZ2dsZTogZ2VuRngoICJ0b2dnbGUiLCAxICksCglmYWRl
SW46IHsgb3BhY2l0eTogInNob3ciIH0sCglmYWRlT3V0OiB7IG9wYWNpdHk6ICJo
aWRlIiB9LAoJZmFkZVRvZ2dsZTogeyBvcGFjaXR5OiAidG9nZ2xlIiB9Cn0sIGZ1
bmN0aW9uKCBuYW1lLCBwcm9wcyApIHsKCWpRdWVyeS5mblsgbmFtZSBdID0gZnVu
Y3Rpb24oIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgewoJCXJldHVybiB0aGlz
LmFuaW1hdGUoIHByb3BzLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApOwoJfTsK
fSk7CgpqUXVlcnkuZXh0ZW5kKHsKCXNwZWVkOiBmdW5jdGlvbiggc3BlZWQsIGVh
c2luZywgZm4gKSB7CgkJdmFyIG9wdCA9IHNwZWVkICYmIHR5cGVvZiBzcGVlZCA9
PT0gIm9iamVjdCIgPyBqUXVlcnkuZXh0ZW5kKCB7fSwgc3BlZWQgKSA6IHsKCQkJ
Y29tcGxldGU6IGZuIHx8ICFmbiAmJiBlYXNpbmcgfHwKCQkJCWpRdWVyeS5pc0Z1
bmN0aW9uKCBzcGVlZCApICYmIHNwZWVkLAoJCQlkdXJhdGlvbjogc3BlZWQsCgkJ
CWVhc2luZzogZm4gJiYgZWFzaW5nIHx8IGVhc2luZyAmJiAhalF1ZXJ5LmlzRnVu
Y3Rpb24oIGVhc2luZyApICYmIGVhc2luZwoJCX07CgoJCW9wdC5kdXJhdGlvbiA9
IGpRdWVyeS5meC5vZmYgPyAwIDogdHlwZW9mIG9wdC5kdXJhdGlvbiA9PT0gIm51
bWJlciIgPyBvcHQuZHVyYXRpb24gOgoJCQlvcHQuZHVyYXRpb24gaW4galF1ZXJ5
LmZ4LnNwZWVkcyA/IGpRdWVyeS5meC5zcGVlZHNbIG9wdC5kdXJhdGlvbiBdIDog
alF1ZXJ5LmZ4LnNwZWVkcy5fZGVmYXVsdDsKCgkJLy8gbm9ybWFsaXplIG9wdC5x
dWV1ZSAtIHRydWUvdW5kZWZpbmVkL251bGwgLT4gImZ4IgoJCWlmICggb3B0LnF1
ZXVlID09IG51bGwgfHwgb3B0LnF1ZXVlID09PSB0cnVlICkgewoJCQlvcHQucXVl
dWUgPSAiZngiOwoJCX0KCgkJLy8gUXVldWVpbmcKCQlvcHQub2xkID0gb3B0LmNv
bXBsZXRlOwoKCQlvcHQuY29tcGxldGUgPSBmdW5jdGlvbiggbm9Vbm1hcmsgKSB7
CgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIG9wdC5vbGQgKSApIHsKCQkJCW9w
dC5vbGQuY2FsbCggdGhpcyApOwoJCQl9CgoJCQlpZiAoIG9wdC5xdWV1ZSApIHsK
CQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCBvcHQucXVldWUgKTsKCQkJfSBlbHNl
IGlmICggbm9Vbm1hcmsgIT09IGZhbHNlICkgewoJCQkJalF1ZXJ5Ll91bm1hcmso
IHRoaXMgKTsKCQkJfQoJCX07CgoJCXJldHVybiBvcHQ7Cgl9LAoKCWVhc2luZzog
ewoJCWxpbmVhcjogZnVuY3Rpb24oIHAgKSB7CgkJCXJldHVybiBwOwoJCX0sCgkJ
c3dpbmc6IGZ1bmN0aW9uKCBwICkgewoJCQlyZXR1cm4gKCAtTWF0aC5jb3MoIHAq
TWF0aC5QSSApIC8gMiApICsgMC41OwoJCX0KCX0sCgoJdGltZXJzOiBbXSwKCglm
eDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIHByb3AgKSB7CgkJdGhpcy5vcHRp
b25zID0gb3B0aW9uczsKCQl0aGlzLmVsZW0gPSBlbGVtOwoJCXRoaXMucHJvcCA9
IHByb3A7CgoJCW9wdGlvbnMub3JpZyA9IG9wdGlvbnMub3JpZyB8fCB7fTsKCX0K
Cn0pOwoKalF1ZXJ5LmZ4LnByb3RvdHlwZSA9IHsKCS8vIFNpbXBsZSBmdW5jdGlv
biBmb3Igc2V0dGluZyBhIHN0eWxlIHZhbHVlCgl1cGRhdGU6IGZ1bmN0aW9uKCkg
ewoJCWlmICggdGhpcy5vcHRpb25zLnN0ZXAgKSB7CgkJCXRoaXMub3B0aW9ucy5z
dGVwLmNhbGwoIHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMgKTsKCQl9CgoJCSgg
alF1ZXJ5LmZ4LnN0ZXBbIHRoaXMucHJvcCBdIHx8IGpRdWVyeS5meC5zdGVwLl9k
ZWZhdWx0ICkoIHRoaXMgKTsKCX0sCgoJLy8gR2V0IHRoZSBjdXJyZW50IHNpemUK
CWN1cjogZnVuY3Rpb24oKSB7CgkJaWYgKCB0aGlzLmVsZW1bIHRoaXMucHJvcCBd
ICE9IG51bGwgJiYgKCF0aGlzLmVsZW0uc3R5bGUgfHwgdGhpcy5lbGVtLnN0eWxl
WyB0aGlzLnByb3AgXSA9PSBudWxsKSApIHsKCQkJcmV0dXJuIHRoaXMuZWxlbVsg
dGhpcy5wcm9wIF07CgkJfQoKCQl2YXIgcGFyc2VkLAoJCQlyID0galF1ZXJ5LmNz
cyggdGhpcy5lbGVtLCB0aGlzLnByb3AgKTsKCQkvLyBFbXB0eSBzdHJpbmdzLCBu
dWxsLCB1bmRlZmluZWQgYW5kICJhdXRvIiBhcmUgY29udmVydGVkIHRvIDAsCgkJ
Ly8gY29tcGxleCB2YWx1ZXMgc3VjaCBhcyAicm90YXRlKDFyYWQpIiBhcmUgcmV0
dXJuZWQgYXMgaXMsCgkJLy8gc2ltcGxlIHZhbHVlcyBzdWNoIGFzICIxMHB4IiBh
cmUgcGFyc2VkIHRvIEZsb2F0LgoJCXJldHVybiBpc05hTiggcGFyc2VkID0gcGFy
c2VGbG9hdCggciApICkgPyAhciB8fCByID09PSAiYXV0byIgPyAwIDogciA6IHBh
cnNlZDsKCX0sCgoJLy8gU3RhcnQgYW4gYW5pbWF0aW9uIGZyb20gb25lIG51bWJl
ciB0byBhbm90aGVyCgljdXN0b206IGZ1bmN0aW9uKCBmcm9tLCB0bywgdW5pdCAp
IHsKCQl2YXIgc2VsZiA9IHRoaXMsCgkJCWZ4ID0galF1ZXJ5LmZ4OwoKCQl0aGlz
LnN0YXJ0VGltZSA9IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCk7CgkJdGhpcy5lbmQg
PSB0bzsKCQl0aGlzLm5vdyA9IHRoaXMuc3RhcnQgPSBmcm9tOwoJCXRoaXMucG9z
ID0gdGhpcy5zdGF0ZSA9IDA7CgkJdGhpcy51bml0ID0gdW5pdCB8fCB0aGlzLnVu
aXQgfHwgKCBqUXVlcnkuY3NzTnVtYmVyWyB0aGlzLnByb3AgXSA/ICIiIDogInB4
IiApOwoKCQlmdW5jdGlvbiB0KCBnb3RvRW5kICkgewoJCQlyZXR1cm4gc2VsZi5z
dGVwKCBnb3RvRW5kICk7CgkJfQoKCQl0LnF1ZXVlID0gdGhpcy5vcHRpb25zLnF1
ZXVlOwoJCXQuZWxlbSA9IHRoaXMuZWxlbTsKCQl0LnNhdmVTdGF0ZSA9IGZ1bmN0
aW9uKCkgewoJCQlpZiAoIGpRdWVyeS5fZGF0YSggc2VsZi5lbGVtLCAiZnhzaG93
IiArIHNlbGYucHJvcCApID09PSB1bmRlZmluZWQgKSB7CgkJCQlpZiAoIHNlbGYu
b3B0aW9ucy5oaWRlICkgewoJCQkJCWpRdWVyeS5fZGF0YSggc2VsZi5lbGVtLCAi
ZnhzaG93IiArIHNlbGYucHJvcCwgc2VsZi5zdGFydCApOwoJCQkJfSBlbHNlIGlm
ICggc2VsZi5vcHRpb25zLnNob3cgKSB7CgkJCQkJalF1ZXJ5Ll9kYXRhKCBzZWxm
LmVsZW0sICJmeHNob3ciICsgc2VsZi5wcm9wLCBzZWxmLmVuZCApOwoJCQkJfQoJ
CQl9CgkJfTsKCgkJaWYgKCB0KCkgJiYgalF1ZXJ5LnRpbWVycy5wdXNoKHQpICYm
ICF0aW1lcklkICkgewoJCQl0aW1lcklkID0gc2V0SW50ZXJ2YWwoIGZ4LnRpY2ss
IGZ4LmludGVydmFsICk7CgkJfQoJfSwKCgkvLyBTaW1wbGUgJ3Nob3cnIGZ1bmN0
aW9uCglzaG93OiBmdW5jdGlvbigpIHsKCQl2YXIgZGF0YVNob3cgPSBqUXVlcnku
X2RhdGEoIHRoaXMuZWxlbSwgImZ4c2hvdyIgKyB0aGlzLnByb3AgKTsKCgkJLy8g
UmVtZW1iZXIgd2hlcmUgd2Ugc3RhcnRlZCwgc28gdGhhdCB3ZSBjYW4gZ28gYmFj
ayB0byBpdCBsYXRlcgoJCXRoaXMub3B0aW9ucy5vcmlnWyB0aGlzLnByb3AgXSA9
IGRhdGFTaG93IHx8IGpRdWVyeS5zdHlsZSggdGhpcy5lbGVtLCB0aGlzLnByb3Ag
KTsKCQl0aGlzLm9wdGlvbnMuc2hvdyA9IHRydWU7CgoJCS8vIEJlZ2luIHRoZSBh
bmltYXRpb24KCQkvLyBNYWtlIHN1cmUgdGhhdCB3ZSBzdGFydCBhdCBhIHNtYWxs
IHdpZHRoL2hlaWdodCB0byBhdm9pZCBhbnkgZmxhc2ggb2YgY29udGVudAoJCWlm
ICggZGF0YVNob3cgIT09IHVuZGVmaW5lZCApIHsKCQkJLy8gVGhpcyBzaG93IGlz
IHBpY2tpbmcgdXAgd2hlcmUgYSBwcmV2aW91cyBoaWRlIG9yIHNob3cgbGVmdCBv
ZmYKCQkJdGhpcy5jdXN0b20oIHRoaXMuY3VyKCksIGRhdGFTaG93ICk7CgkJfSBl
bHNlIHsKCQkJdGhpcy5jdXN0b20oIHRoaXMucHJvcCA9PT0gIndpZHRoIiB8fCB0
aGlzLnByb3AgPT09ICJoZWlnaHQiID8gMSA6IDAsIHRoaXMuY3VyKCkgKTsKCQl9
CgoJCS8vIFN0YXJ0IGJ5IHNob3dpbmcgdGhlIGVsZW1lbnQKCQlqUXVlcnkoIHRo
aXMuZWxlbSApLnNob3coKTsKCX0sCgoJLy8gU2ltcGxlICdoaWRlJyBmdW5jdGlv
bgoJaGlkZTogZnVuY3Rpb24oKSB7CgkJLy8gUmVtZW1iZXIgd2hlcmUgd2Ugc3Rh
cnRlZCwgc28gdGhhdCB3ZSBjYW4gZ28gYmFjayB0byBpdCBsYXRlcgoJCXRoaXMu
b3B0aW9ucy5vcmlnWyB0aGlzLnByb3AgXSA9IGpRdWVyeS5fZGF0YSggdGhpcy5l
bGVtLCAiZnhzaG93IiArIHRoaXMucHJvcCApIHx8IGpRdWVyeS5zdHlsZSggdGhp
cy5lbGVtLCB0aGlzLnByb3AgKTsKCQl0aGlzLm9wdGlvbnMuaGlkZSA9IHRydWU7
CgoJCS8vIEJlZ2luIHRoZSBhbmltYXRpb24KCQl0aGlzLmN1c3RvbSggdGhpcy5j
dXIoKSwgMCApOwoJfSwKCgkvLyBFYWNoIHN0ZXAgb2YgYW4gYW5pbWF0aW9uCglz
dGVwOiBmdW5jdGlvbiggZ290b0VuZCApIHsKCQl2YXIgcCwgbiwgY29tcGxldGUs
CgkJCXQgPSBmeE5vdyB8fCBjcmVhdGVGeE5vdygpLAoJCQlkb25lID0gdHJ1ZSwK
CQkJZWxlbSA9IHRoaXMuZWxlbSwKCQkJb3B0aW9ucyA9IHRoaXMub3B0aW9uczsK
CgkJaWYgKCBnb3RvRW5kIHx8IHQgPj0gb3B0aW9ucy5kdXJhdGlvbiArIHRoaXMu
c3RhcnRUaW1lICkgewoJCQl0aGlzLm5vdyA9IHRoaXMuZW5kOwoJCQl0aGlzLnBv
cyA9IHRoaXMuc3RhdGUgPSAxOwoJCQl0aGlzLnVwZGF0ZSgpOwoKCQkJb3B0aW9u
cy5hbmltYXRlZFByb3BlcnRpZXNbIHRoaXMucHJvcCBdID0gdHJ1ZTsKCgkJCWZv
ciAoIHAgaW4gb3B0aW9ucy5hbmltYXRlZFByb3BlcnRpZXMgKSB7CgkJCQlpZiAo
IG9wdGlvbnMuYW5pbWF0ZWRQcm9wZXJ0aWVzWyBwIF0gIT09IHRydWUgKSB7CgkJ
CQkJZG9uZSA9IGZhbHNlOwoJCQkJfQoJCQl9CgoJCQlpZiAoIGRvbmUgKSB7CgkJ
CQkvLyBSZXNldCB0aGUgb3ZlcmZsb3cKCQkJCWlmICggb3B0aW9ucy5vdmVyZmxv
dyAhPSBudWxsICYmICFqUXVlcnkuc3VwcG9ydC5zaHJpbmtXcmFwQmxvY2tzICkg
ewoKCQkJCQlqUXVlcnkuZWFjaCggWyAiIiwgIlgiLCAiWSIgXSwgZnVuY3Rpb24o
IGluZGV4LCB2YWx1ZSApIHsKCQkJCQkJZWxlbS5zdHlsZVsgIm92ZXJmbG93IiAr
IHZhbHVlIF0gPSBvcHRpb25zLm92ZXJmbG93WyBpbmRleCBdOwoJCQkJCX0pOwoJ
CQkJfQoKCQkJCS8vIEhpZGUgdGhlIGVsZW1lbnQgaWYgdGhlICJoaWRlIiBvcGVy
YXRpb24gd2FzIGRvbmUKCQkJCWlmICggb3B0aW9ucy5oaWRlICkgewoJCQkJCWpR
dWVyeSggZWxlbSApLmhpZGUoKTsKCQkJCX0KCgkJCQkvLyBSZXNldCB0aGUgcHJv
cGVydGllcywgaWYgdGhlIGl0ZW0gaGFzIGJlZW4gaGlkZGVuIG9yIHNob3duCgkJ
CQlpZiAoIG9wdGlvbnMuaGlkZSB8fCBvcHRpb25zLnNob3cgKSB7CgkJCQkJZm9y
ICggcCBpbiBvcHRpb25zLmFuaW1hdGVkUHJvcGVydGllcyApIHsKCQkJCQkJalF1
ZXJ5LnN0eWxlKCBlbGVtLCBwLCBvcHRpb25zLm9yaWdbIHAgXSApOwoJCQkJCQlq
UXVlcnkucmVtb3ZlRGF0YSggZWxlbSwgImZ4c2hvdyIgKyBwLCB0cnVlICk7CgkJ
CQkJCS8vIFRvZ2dsZSBkYXRhIGlzIG5vIGxvbmdlciBuZWVkZWQKCQkJCQkJalF1
ZXJ5LnJlbW92ZURhdGEoIGVsZW0sICJ0b2dnbGUiICsgcCwgdHJ1ZSApOwoJCQkJ
CX0KCQkJCX0KCgkJCQkvLyBFeGVjdXRlIHRoZSBjb21wbGV0ZSBmdW5jdGlvbgoJ
CQkJLy8gaW4gdGhlIGV2ZW50IHRoYXQgdGhlIGNvbXBsZXRlIGZ1bmN0aW9uIHRo
cm93cyBhbiBleGNlcHRpb24KCQkJCS8vIHdlIG11c3QgZW5zdXJlIGl0IHdvbid0
IGJlIGNhbGxlZCB0d2ljZS4gIzU2ODQKCgkJCQljb21wbGV0ZSA9IG9wdGlvbnMu
Y29tcGxldGU7CgkJCQlpZiAoIGNvbXBsZXRlICkgewoKCQkJCQlvcHRpb25zLmNv
bXBsZXRlID0gZmFsc2U7CgkJCQkJY29tcGxldGUuY2FsbCggZWxlbSApOwoJCQkJ
fQoJCQl9CgoJCQlyZXR1cm4gZmFsc2U7CgoJCX0gZWxzZSB7CgkJCS8vIGNsYXNz
aWNhbCBlYXNpbmcgY2Fubm90IGJlIHVzZWQgd2l0aCBhbiBJbmZpbml0eSBkdXJh
dGlvbgoJCQlpZiAoIG9wdGlvbnMuZHVyYXRpb24gPT0gSW5maW5pdHkgKSB7CgkJ
CQl0aGlzLm5vdyA9IHQ7CgkJCX0gZWxzZSB7CgkJCQluID0gdCAtIHRoaXMuc3Rh
cnRUaW1lOwoJCQkJdGhpcy5zdGF0ZSA9IG4gLyBvcHRpb25zLmR1cmF0aW9uOwoK
CQkJCS8vIFBlcmZvcm0gdGhlIGVhc2luZyBmdW5jdGlvbiwgZGVmYXVsdHMgdG8g
c3dpbmcKCQkJCXRoaXMucG9zID0galF1ZXJ5LmVhc2luZ1sgb3B0aW9ucy5hbmlt
YXRlZFByb3BlcnRpZXNbdGhpcy5wcm9wXSBdKCB0aGlzLnN0YXRlLCBuLCAwLCAx
LCBvcHRpb25zLmR1cmF0aW9uICk7CgkJCQl0aGlzLm5vdyA9IHRoaXMuc3RhcnQg
KyAoICh0aGlzLmVuZCAtIHRoaXMuc3RhcnQpICogdGhpcy5wb3MgKTsKCQkJfQoJ
CQkvLyBQZXJmb3JtIHRoZSBuZXh0IHN0ZXAgb2YgdGhlIGFuaW1hdGlvbgoJCQl0
aGlzLnVwZGF0ZSgpOwoJCX0KCgkJcmV0dXJuIHRydWU7Cgl9Cn07CgpqUXVlcnku
ZXh0ZW5kKCBqUXVlcnkuZngsIHsKCXRpY2s6IGZ1bmN0aW9uKCkgewoJCXZhciB0
aW1lciwKCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJaSA9IDA7CgoJCWZv
ciAoIDsgaSA8IHRpbWVycy5sZW5ndGg7IGkrKyApIHsKCQkJdGltZXIgPSB0aW1l
cnNbIGkgXTsKCQkJLy8gQ2hlY2tzIHRoZSB0aW1lciBoYXMgbm90IGFscmVhZHkg
YmVlbiByZW1vdmVkCgkJCWlmICggIXRpbWVyKCkgJiYgdGltZXJzWyBpIF0gPT09
IHRpbWVyICkgewoJCQkJdGltZXJzLnNwbGljZSggaS0tLCAxICk7CgkJCX0KCQl9
CgoJCWlmICggIXRpbWVycy5sZW5ndGggKSB7CgkJCWpRdWVyeS5meC5zdG9wKCk7
CgkJfQoJfSwKCglpbnRlcnZhbDogMTMsCgoJc3RvcDogZnVuY3Rpb24oKSB7CgkJ
Y2xlYXJJbnRlcnZhbCggdGltZXJJZCApOwoJCXRpbWVySWQgPSBudWxsOwoJfSwK
CglzcGVlZHM6IHsKCQlzbG93OiA2MDAsCgkJZmFzdDogMjAwLAoJCS8vIERlZmF1
bHQgc3BlZWQKCQlfZGVmYXVsdDogNDAwCgl9LAoKCXN0ZXA6IHsKCQlvcGFjaXR5
OiBmdW5jdGlvbiggZnggKSB7CgkJCWpRdWVyeS5zdHlsZSggZnguZWxlbSwgIm9w
YWNpdHkiLCBmeC5ub3cgKTsKCQl9LAoKCQlfZGVmYXVsdDogZnVuY3Rpb24oIGZ4
ICkgewoJCQlpZiAoIGZ4LmVsZW0uc3R5bGUgJiYgZnguZWxlbS5zdHlsZVsgZngu
cHJvcCBdICE9IG51bGwgKSB7CgkJCQlmeC5lbGVtLnN0eWxlWyBmeC5wcm9wIF0g
PSBmeC5ub3cgKyBmeC51bml0OwoJCQl9IGVsc2UgewoJCQkJZnguZWxlbVsgZngu
cHJvcCBdID0gZngubm93OwoJCQl9CgkJfQoJfQp9KTsKCi8vIEVuc3VyZSBwcm9w
cyB0aGF0IGNhbid0IGJlIG5lZ2F0aXZlIGRvbid0IGdvIHRoZXJlIG9uIHVuZGVy
c2hvb3QgZWFzaW5nCmpRdWVyeS5lYWNoKCBmeEF0dHJzLmNvbmNhdC5hcHBseSgg
W10sIGZ4QXR0cnMgKSwgZnVuY3Rpb24oIGksIHByb3AgKSB7CgkvLyBleGNsdWRl
IG1hcmdpblRvcCwgbWFyZ2luTGVmdCwgbWFyZ2luQm90dG9tIGFuZCBtYXJnaW5S
aWdodCBmcm9tIHRoaXMgbGlzdAoJaWYgKCBwcm9wLmluZGV4T2YoICJtYXJnaW4i
ICkgKSB7CgkJalF1ZXJ5LmZ4LnN0ZXBbIHByb3AgXSA9IGZ1bmN0aW9uKCBmeCAp
IHsKCQkJalF1ZXJ5LnN0eWxlKCBmeC5lbGVtLCBwcm9wLCBNYXRoLm1heCgwLCBm
eC5ub3cpICsgZngudW5pdCApOwoJCX07Cgl9Cn0pOwoKaWYgKCBqUXVlcnkuZXhw
ciAmJiBqUXVlcnkuZXhwci5maWx0ZXJzICkgewoJalF1ZXJ5LmV4cHIuZmlsdGVy
cy5hbmltYXRlZCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiBqUXVlcnku
Z3JlcChqUXVlcnkudGltZXJzLCBmdW5jdGlvbiggZm4gKSB7CgkJCXJldHVybiBl
bGVtID09PSBmbi5lbGVtOwoJCX0pLmxlbmd0aDsKCX07Cn0KCi8vIFRyeSB0byBy
ZXN0b3JlIHRoZSBkZWZhdWx0IGRpc3BsYXkgdmFsdWUgb2YgYW4gZWxlbWVudApm
dW5jdGlvbiBkZWZhdWx0RGlzcGxheSggbm9kZU5hbWUgKSB7CgoJaWYgKCAhZWxl
bWRpc3BsYXlbIG5vZGVOYW1lIF0gKSB7CgoJCXZhciBib2R5ID0gZG9jdW1lbnQu
Ym9keSwKCQkJZWxlbSA9IGpRdWVyeSggIjwiICsgbm9kZU5hbWUgKyAiPiIgKS5h
cHBlbmRUbyggYm9keSApLAoJCQlkaXNwbGF5ID0gZWxlbS5jc3MoICJkaXNwbGF5
IiApOwoJCWVsZW0ucmVtb3ZlKCk7CgoJCS8vIElmIHRoZSBzaW1wbGUgd2F5IGZh
aWxzLAoJCS8vIGdldCBlbGVtZW50J3MgcmVhbCBkZWZhdWx0IGRpc3BsYXkgYnkg
YXR0YWNoaW5nIGl0IHRvIGEgdGVtcCBpZnJhbWUKCQlpZiAoIGRpc3BsYXkgPT09
ICJub25lIiB8fCBkaXNwbGF5ID09PSAiIiApIHsKCQkJLy8gTm8gaWZyYW1lIHRv
IHVzZSB5ZXQsIHNvIGNyZWF0ZSBpdAoJCQlpZiAoICFpZnJhbWUgKSB7CgkJCQlp
ZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiaWZyYW1lIiApOwoJCQkJ
aWZyYW1lLmZyYW1lQm9yZGVyID0gaWZyYW1lLndpZHRoID0gaWZyYW1lLmhlaWdo
dCA9IDA7CgkJCX0KCgkJCWJvZHkuYXBwZW5kQ2hpbGQoIGlmcmFtZSApOwoKCQkJ
Ly8gQ3JlYXRlIGEgY2FjaGVhYmxlIGNvcHkgb2YgdGhlIGlmcmFtZSBkb2N1bWVu
dCBvbiBmaXJzdCBjYWxsLgoJCQkvLyBJRSBhbmQgT3BlcmEgd2lsbCBhbGxvdyB1
cyB0byByZXVzZSB0aGUgaWZyYW1lRG9jIHdpdGhvdXQgcmUtd3JpdGluZyB0aGUg
ZmFrZSBIVE1MCgkJCS8vIGRvY3VtZW50IHRvIGl0OyBXZWJLaXQgJiBGaXJlZm94
IHdvbid0IGFsbG93IHJldXNpbmcgdGhlIGlmcmFtZSBkb2N1bWVudC4KCQkJaWYg
KCAhaWZyYW1lRG9jIHx8ICFpZnJhbWUuY3JlYXRlRWxlbWVudCApIHsKCQkJCWlm
cmFtZURvYyA9ICggaWZyYW1lLmNvbnRlbnRXaW5kb3cgfHwgaWZyYW1lLmNvbnRl
bnREb2N1bWVudCApLmRvY3VtZW50OwoJCQkJaWZyYW1lRG9jLndyaXRlKCAoIGpR
dWVyeS5zdXBwb3J0LmJveE1vZGVsID8gIjwhZG9jdHlwZSBodG1sPiIgOiAiIiAp
ICsgIjxodG1sPjxib2R5PiIgKTsKCQkJCWlmcmFtZURvYy5jbG9zZSgpOwoJCQl9
CgoJCQllbGVtID0gaWZyYW1lRG9jLmNyZWF0ZUVsZW1lbnQoIG5vZGVOYW1lICk7
CgoJCQlpZnJhbWVEb2MuYm9keS5hcHBlbmRDaGlsZCggZWxlbSApOwoKCQkJZGlz
cGxheSA9IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApOwoJCQlib2R5LnJl
bW92ZUNoaWxkKCBpZnJhbWUgKTsKCQl9CgoJCS8vIFN0b3JlIHRoZSBjb3JyZWN0
IGRlZmF1bHQgZGlzcGxheQoJCWVsZW1kaXNwbGF5WyBub2RlTmFtZSBdID0gZGlz
cGxheTsKCX0KCglyZXR1cm4gZWxlbWRpc3BsYXlbIG5vZGVOYW1lIF07Cn0KCgoK
CnZhciBnZXRPZmZzZXQsCglydGFibGUgPSAvXnQoPzphYmxlfGR8aCkkL2ksCgly
cm9vdCA9IC9eKD86Ym9keXxodG1sKSQvaTsKCmlmICggImdldEJvdW5kaW5nQ2xp
ZW50UmVjdCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICkgewoJZ2V0T2Zm
c2V0ID0gZnVuY3Rpb24oIGVsZW0sIGRvYywgZG9jRWxlbSwgYm94ICkgewoJCXRy
eSB7CgkJCWJveCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgkJfSBj
YXRjaChlKSB7fQoKCQkvLyBNYWtlIHN1cmUgd2UncmUgbm90IGRlYWxpbmcgd2l0
aCBhIGRpc2Nvbm5lY3RlZCBET00gbm9kZQoJCWlmICggIWJveCB8fCAhalF1ZXJ5
LmNvbnRhaW5zKCBkb2NFbGVtLCBlbGVtICkgKSB7CgkJCXJldHVybiBib3ggPyB7
IHRvcDogYm94LnRvcCwgbGVmdDogYm94LmxlZnQgfSA6IHsgdG9wOiAwLCBsZWZ0
OiAwIH07CgkJfQoKCQl2YXIgYm9keSA9IGRvYy5ib2R5LAoJCQl3aW4gPSBnZXRX
aW5kb3coIGRvYyApLAoJCQljbGllbnRUb3AgID0gZG9jRWxlbS5jbGllbnRUb3Ag
IHx8IGJvZHkuY2xpZW50VG9wICB8fCAwLAoJCQljbGllbnRMZWZ0ID0gZG9jRWxl
bS5jbGllbnRMZWZ0IHx8IGJvZHkuY2xpZW50TGVmdCB8fCAwLAoJCQlzY3JvbGxU
b3AgID0gd2luLnBhZ2VZT2Zmc2V0IHx8IGpRdWVyeS5zdXBwb3J0LmJveE1vZGVs
ICYmIGRvY0VsZW0uc2Nyb2xsVG9wICB8fCBib2R5LnNjcm9sbFRvcCwKCQkJc2Ny
b2xsTGVmdCA9IHdpbi5wYWdlWE9mZnNldCB8fCBqUXVlcnkuc3VwcG9ydC5ib3hN
b2RlbCAmJiBkb2NFbGVtLnNjcm9sbExlZnQgfHwgYm9keS5zY3JvbGxMZWZ0LAoJ
CQl0b3AgID0gYm94LnRvcCAgKyBzY3JvbGxUb3AgIC0gY2xpZW50VG9wLAoJCQls
ZWZ0ID0gYm94LmxlZnQgKyBzY3JvbGxMZWZ0IC0gY2xpZW50TGVmdDsKCgkJcmV0
dXJuIHsgdG9wOiB0b3AsIGxlZnQ6IGxlZnQgfTsKCX07Cgp9IGVsc2UgewoJZ2V0
T2Zmc2V0ID0gZnVuY3Rpb24oIGVsZW0sIGRvYywgZG9jRWxlbSApIHsKCQl2YXIg
Y29tcHV0ZWRTdHlsZSwKCQkJb2Zmc2V0UGFyZW50ID0gZWxlbS5vZmZzZXRQYXJl
bnQsCgkJCXByZXZPZmZzZXRQYXJlbnQgPSBlbGVtLAoJCQlib2R5ID0gZG9jLmJv
ZHksCgkJCWRlZmF1bHRWaWV3ID0gZG9jLmRlZmF1bHRWaWV3LAoJCQlwcmV2Q29t
cHV0ZWRTdHlsZSA9IGRlZmF1bHRWaWV3ID8gZGVmYXVsdFZpZXcuZ2V0Q29tcHV0
ZWRTdHlsZSggZWxlbSwgbnVsbCApIDogZWxlbS5jdXJyZW50U3R5bGUsCgkJCXRv
cCA9IGVsZW0ub2Zmc2V0VG9wLAoJCQlsZWZ0ID0gZWxlbS5vZmZzZXRMZWZ0OwoK
CQl3aGlsZSAoIChlbGVtID0gZWxlbS5wYXJlbnROb2RlKSAmJiBlbGVtICE9PSBi
b2R5ICYmIGVsZW0gIT09IGRvY0VsZW0gKSB7CgkJCWlmICggalF1ZXJ5LnN1cHBv
cnQuZml4ZWRQb3NpdGlvbiAmJiBwcmV2Q29tcHV0ZWRTdHlsZS5wb3NpdGlvbiA9
PT0gImZpeGVkIiApIHsKCQkJCWJyZWFrOwoJCQl9CgoJCQljb21wdXRlZFN0eWxl
ID0gZGVmYXVsdFZpZXcgPyBkZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVs
ZW0sIG51bGwpIDogZWxlbS5jdXJyZW50U3R5bGU7CgkJCXRvcCAgLT0gZWxlbS5z
Y3JvbGxUb3A7CgkJCWxlZnQgLT0gZWxlbS5zY3JvbGxMZWZ0OwoKCQkJaWYgKCBl
bGVtID09PSBvZmZzZXRQYXJlbnQgKSB7CgkJCQl0b3AgICs9IGVsZW0ub2Zmc2V0
VG9wOwoJCQkJbGVmdCArPSBlbGVtLm9mZnNldExlZnQ7CgoJCQkJaWYgKCBqUXVl
cnkuc3VwcG9ydC5kb2VzTm90QWRkQm9yZGVyICYmICEoalF1ZXJ5LnN1cHBvcnQu
ZG9lc0FkZEJvcmRlckZvclRhYmxlQW5kQ2VsbHMgJiYgcnRhYmxlLnRlc3QoZWxl
bS5ub2RlTmFtZSkpICkgewoJCQkJCXRvcCAgKz0gcGFyc2VGbG9hdCggY29tcHV0
ZWRTdHlsZS5ib3JkZXJUb3BXaWR0aCAgKSB8fCAwOwoJCQkJCWxlZnQgKz0gcGFy
c2VGbG9hdCggY29tcHV0ZWRTdHlsZS5ib3JkZXJMZWZ0V2lkdGggKSB8fCAwOwoJ
CQkJfQoKCQkJCXByZXZPZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQ7CgkJCQlv
ZmZzZXRQYXJlbnQgPSBlbGVtLm9mZnNldFBhcmVudDsKCQkJfQoKCQkJaWYgKCBq
UXVlcnkuc3VwcG9ydC5zdWJ0cmFjdHNCb3JkZXJGb3JPdmVyZmxvd05vdFZpc2li
bGUgJiYgY29tcHV0ZWRTdHlsZS5vdmVyZmxvdyAhPT0gInZpc2libGUiICkgewoJ
CQkJdG9wICArPSBwYXJzZUZsb2F0KCBjb21wdXRlZFN0eWxlLmJvcmRlclRvcFdp
ZHRoICApIHx8IDA7CgkJCQlsZWZ0ICs9IHBhcnNlRmxvYXQoIGNvbXB1dGVkU3R5
bGUuYm9yZGVyTGVmdFdpZHRoICkgfHwgMDsKCQkJfQoKCQkJcHJldkNvbXB1dGVk
U3R5bGUgPSBjb21wdXRlZFN0eWxlOwoJCX0KCgkJaWYgKCBwcmV2Q29tcHV0ZWRT
dHlsZS5wb3NpdGlvbiA9PT0gInJlbGF0aXZlIiB8fCBwcmV2Q29tcHV0ZWRTdHls
ZS5wb3NpdGlvbiA9PT0gInN0YXRpYyIgKSB7CgkJCXRvcCAgKz0gYm9keS5vZmZz
ZXRUb3A7CgkJCWxlZnQgKz0gYm9keS5vZmZzZXRMZWZ0OwoJCX0KCgkJaWYgKCBq
UXVlcnkuc3VwcG9ydC5maXhlZFBvc2l0aW9uICYmIHByZXZDb21wdXRlZFN0eWxl
LnBvc2l0aW9uID09PSAiZml4ZWQiICkgewoJCQl0b3AgICs9IE1hdGgubWF4KCBk
b2NFbGVtLnNjcm9sbFRvcCwgYm9keS5zY3JvbGxUb3AgKTsKCQkJbGVmdCArPSBN
YXRoLm1heCggZG9jRWxlbS5zY3JvbGxMZWZ0LCBib2R5LnNjcm9sbExlZnQgKTsK
CQl9CgoJCXJldHVybiB7IHRvcDogdG9wLCBsZWZ0OiBsZWZ0IH07Cgl9Owp9Cgpq
UXVlcnkuZm4ub2Zmc2V0ID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7CglpZiAoIGFy
Z3VtZW50cy5sZW5ndGggKSB7CgkJcmV0dXJuIG9wdGlvbnMgPT09IHVuZGVmaW5l
ZCA/CgkJCXRoaXMgOgoJCQl0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7CgkJCQlq
UXVlcnkub2Zmc2V0LnNldE9mZnNldCggdGhpcywgb3B0aW9ucywgaSApOwoJCQl9
KTsKCX0KCgl2YXIgZWxlbSA9IHRoaXNbMF0sCgkJZG9jID0gZWxlbSAmJiBlbGVt
Lm93bmVyRG9jdW1lbnQ7CgoJaWYgKCAhZG9jICkgewoJCXJldHVybiBudWxsOwoJ
fQoKCWlmICggZWxlbSA9PT0gZG9jLmJvZHkgKSB7CgkJcmV0dXJuIGpRdWVyeS5v
ZmZzZXQuYm9keU9mZnNldCggZWxlbSApOwoJfQoKCXJldHVybiBnZXRPZmZzZXQo
IGVsZW0sIGRvYywgZG9jLmRvY3VtZW50RWxlbWVudCApOwp9OwoKalF1ZXJ5Lm9m
ZnNldCA9IHsKCglib2R5T2Zmc2V0OiBmdW5jdGlvbiggYm9keSApIHsKCQl2YXIg
dG9wID0gYm9keS5vZmZzZXRUb3AsCgkJCWxlZnQgPSBib2R5Lm9mZnNldExlZnQ7
CgoJCWlmICggalF1ZXJ5LnN1cHBvcnQuZG9lc05vdEluY2x1ZGVNYXJnaW5JbkJv
ZHlPZmZzZXQgKSB7CgkJCXRvcCAgKz0gcGFyc2VGbG9hdCggalF1ZXJ5LmNzcyhi
b2R5LCAibWFyZ2luVG9wIikgKSB8fCAwOwoJCQlsZWZ0ICs9IHBhcnNlRmxvYXQo
IGpRdWVyeS5jc3MoYm9keSwgIm1hcmdpbkxlZnQiKSApIHx8IDA7CgkJfQoKCQly
ZXR1cm4geyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9OwoJfSwKCglzZXRPZmZzZXQ6
IGZ1bmN0aW9uKCBlbGVtLCBvcHRpb25zLCBpICkgewoJCXZhciBwb3NpdGlvbiA9
IGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKTsKCgkJLy8gc2V0IHBvc2l0
aW9uIGZpcnN0LCBpbi1jYXNlIHRvcC9sZWZ0IGFyZSBzZXQgZXZlbiBvbiBzdGF0
aWMgZWxlbQoJCWlmICggcG9zaXRpb24gPT09ICJzdGF0aWMiICkgewoJCQllbGVt
LnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKCQl9CgoJCXZhciBjdXJFbGVt
ID0galF1ZXJ5KCBlbGVtICksCgkJCWN1ck9mZnNldCA9IGN1ckVsZW0ub2Zmc2V0
KCksCgkJCWN1ckNTU1RvcCA9IGpRdWVyeS5jc3MoIGVsZW0sICJ0b3AiICksCgkJ
CWN1ckNTU0xlZnQgPSBqUXVlcnkuY3NzKCBlbGVtLCAibGVmdCIgKSwKCQkJY2Fs
Y3VsYXRlUG9zaXRpb24gPSAoIHBvc2l0aW9uID09PSAiYWJzb2x1dGUiIHx8IHBv
c2l0aW9uID09PSAiZml4ZWQiICkgJiYgalF1ZXJ5LmluQXJyYXkoImF1dG8iLCBb
Y3VyQ1NTVG9wLCBjdXJDU1NMZWZ0XSkgPiAtMSwKCQkJcHJvcHMgPSB7fSwgY3Vy
UG9zaXRpb24gPSB7fSwgY3VyVG9wLCBjdXJMZWZ0OwoKCQkvLyBuZWVkIHRvIGJl
IGFibGUgdG8gY2FsY3VsYXRlIHBvc2l0aW9uIGlmIGVpdGhlciB0b3Agb3IgbGVm
dCBpcyBhdXRvIGFuZCBwb3NpdGlvbiBpcyBlaXRoZXIgYWJzb2x1dGUgb3IgZml4
ZWQKCQlpZiAoIGNhbGN1bGF0ZVBvc2l0aW9uICkgewoJCQljdXJQb3NpdGlvbiA9
IGN1ckVsZW0ucG9zaXRpb24oKTsKCQkJY3VyVG9wID0gY3VyUG9zaXRpb24udG9w
OwoJCQljdXJMZWZ0ID0gY3VyUG9zaXRpb24ubGVmdDsKCQl9IGVsc2UgewoJCQlj
dXJUb3AgPSBwYXJzZUZsb2F0KCBjdXJDU1NUb3AgKSB8fCAwOwoJCQljdXJMZWZ0
ID0gcGFyc2VGbG9hdCggY3VyQ1NTTGVmdCApIHx8IDA7CgkJfQoKCQlpZiAoIGpR
dWVyeS5pc0Z1bmN0aW9uKCBvcHRpb25zICkgKSB7CgkJCW9wdGlvbnMgPSBvcHRp
b25zLmNhbGwoIGVsZW0sIGksIGN1ck9mZnNldCApOwoJCX0KCgkJaWYgKCBvcHRp
b25zLnRvcCAhPSBudWxsICkgewoJCQlwcm9wcy50b3AgPSAoIG9wdGlvbnMudG9w
IC0gY3VyT2Zmc2V0LnRvcCApICsgY3VyVG9wOwoJCX0KCQlpZiAoIG9wdGlvbnMu
bGVmdCAhPSBudWxsICkgewoJCQlwcm9wcy5sZWZ0ID0gKCBvcHRpb25zLmxlZnQg
LSBjdXJPZmZzZXQubGVmdCApICsgY3VyTGVmdDsKCQl9CgoJCWlmICggInVzaW5n
IiBpbiBvcHRpb25zICkgewoJCQlvcHRpb25zLnVzaW5nLmNhbGwoIGVsZW0sIHBy
b3BzICk7CgkJfSBlbHNlIHsKCQkJY3VyRWxlbS5jc3MoIHByb3BzICk7CgkJfQoJ
fQp9OwoKCmpRdWVyeS5mbi5leHRlbmQoewoKCXBvc2l0aW9uOiBmdW5jdGlvbigp
IHsKCQlpZiAoICF0aGlzWzBdICkgewoJCQlyZXR1cm4gbnVsbDsKCQl9CgoJCXZh
ciBlbGVtID0gdGhpc1swXSwKCgkJLy8gR2V0ICpyZWFsKiBvZmZzZXRQYXJlbnQK
CQlvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCgpLAoKCQkvLyBHZXQg
Y29ycmVjdCBvZmZzZXRzCgkJb2Zmc2V0ICAgICAgID0gdGhpcy5vZmZzZXQoKSwK
CQlwYXJlbnRPZmZzZXQgPSBycm9vdC50ZXN0KG9mZnNldFBhcmVudFswXS5ub2Rl
TmFtZSkgPyB7IHRvcDogMCwgbGVmdDogMCB9IDogb2Zmc2V0UGFyZW50Lm9mZnNl
dCgpOwoKCQkvLyBTdWJ0cmFjdCBlbGVtZW50IG1hcmdpbnMKCQkvLyBub3RlOiB3
aGVuIGFuIGVsZW1lbnQgaGFzIG1hcmdpbjogYXV0byB0aGUgb2Zmc2V0TGVmdCBh
bmQgbWFyZ2luTGVmdAoJCS8vIGFyZSB0aGUgc2FtZSBpbiBTYWZhcmkgY2F1c2lu
ZyBvZmZzZXQubGVmdCB0byBpbmNvcnJlY3RseSBiZSAwCgkJb2Zmc2V0LnRvcCAg
LT0gcGFyc2VGbG9hdCggalF1ZXJ5LmNzcyhlbGVtLCAibWFyZ2luVG9wIikgKSB8
fCAwOwoJCW9mZnNldC5sZWZ0IC09IHBhcnNlRmxvYXQoIGpRdWVyeS5jc3MoZWxl
bSwgIm1hcmdpbkxlZnQiKSApIHx8IDA7CgoJCS8vIEFkZCBvZmZzZXRQYXJlbnQg
Ym9yZGVycwoJCXBhcmVudE9mZnNldC50b3AgICs9IHBhcnNlRmxvYXQoIGpRdWVy
eS5jc3Mob2Zmc2V0UGFyZW50WzBdLCAiYm9yZGVyVG9wV2lkdGgiKSApIHx8IDA7
CgkJcGFyZW50T2Zmc2V0LmxlZnQgKz0gcGFyc2VGbG9hdCggalF1ZXJ5LmNzcyhv
ZmZzZXRQYXJlbnRbMF0sICJib3JkZXJMZWZ0V2lkdGgiKSApIHx8IDA7CgoJCS8v
IFN1YnRyYWN0IHRoZSB0d28gb2Zmc2V0cwoJCXJldHVybiB7CgkJCXRvcDogIG9m
ZnNldC50b3AgIC0gcGFyZW50T2Zmc2V0LnRvcCwKCQkJbGVmdDogb2Zmc2V0Lmxl
ZnQgLSBwYXJlbnRPZmZzZXQubGVmdAoJCX07Cgl9LAoKCW9mZnNldFBhcmVudDog
ZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkgewoJCQl2
YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQgfHwgZG9jdW1lbnQu
Ym9keTsKCQkJd2hpbGUgKCBvZmZzZXRQYXJlbnQgJiYgKCFycm9vdC50ZXN0KG9m
ZnNldFBhcmVudC5ub2RlTmFtZSkgJiYgalF1ZXJ5LmNzcyhvZmZzZXRQYXJlbnQs
ICJwb3NpdGlvbiIpID09PSAic3RhdGljIikgKSB7CgkJCQlvZmZzZXRQYXJlbnQg
PSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50OwoJCQl9CgkJCXJldHVybiBvZmZz
ZXRQYXJlbnQ7CgkJfSk7Cgl9Cn0pOwoKCi8vIENyZWF0ZSBzY3JvbGxMZWZ0IGFu
ZCBzY3JvbGxUb3AgbWV0aG9kcwpqUXVlcnkuZWFjaCgge3Njcm9sbExlZnQ6ICJw
YWdlWE9mZnNldCIsIHNjcm9sbFRvcDogInBhZ2VZT2Zmc2V0In0sIGZ1bmN0aW9u
KCBtZXRob2QsIHByb3AgKSB7Cgl2YXIgdG9wID0gL1kvLnRlc3QoIHByb3AgKTsK
CglqUXVlcnkuZm5bIG1ldGhvZCBdID0gZnVuY3Rpb24oIHZhbCApIHsKCQlyZXR1
cm4galF1ZXJ5LmFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIG1ldGhvZCwg
dmFsICkgewoJCQl2YXIgd2luID0gZ2V0V2luZG93KCBlbGVtICk7CgoJCQlpZiAo
IHZhbCA9PT0gdW5kZWZpbmVkICkgewoJCQkJcmV0dXJuIHdpbiA/IChwcm9wIGlu
IHdpbikgPyB3aW5bIHByb3AgXSA6CgkJCQkJalF1ZXJ5LnN1cHBvcnQuYm94TW9k
ZWwgJiYgd2luLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsgbWV0aG9kIF0gfHwK
CQkJCQkJd2luLmRvY3VtZW50LmJvZHlbIG1ldGhvZCBdIDoKCQkJCQllbGVtWyBt
ZXRob2QgXTsKCQkJfQoKCQkJaWYgKCB3aW4gKSB7CgkJCQl3aW4uc2Nyb2xsVG8o
CgkJCQkJIXRvcCA/IHZhbCA6IGpRdWVyeSggd2luICkuc2Nyb2xsTGVmdCgpLAoJ
CQkJCSB0b3AgPyB2YWwgOiBqUXVlcnkoIHdpbiApLnNjcm9sbFRvcCgpCgkJCQkp
OwoKCQkJfSBlbHNlIHsKCQkJCWVsZW1bIG1ldGhvZCBdID0gdmFsOwoJCQl9CgkJ
fSwgbWV0aG9kLCB2YWwsIGFyZ3VtZW50cy5sZW5ndGgsIG51bGwgKTsKCX07Cn0p
OwoKZnVuY3Rpb24gZ2V0V2luZG93KCBlbGVtICkgewoJcmV0dXJuIGpRdWVyeS5p
c1dpbmRvdyggZWxlbSApID8KCQllbGVtIDoKCQllbGVtLm5vZGVUeXBlID09PSA5
ID8KCQkJZWxlbS5kZWZhdWx0VmlldyB8fCBlbGVtLnBhcmVudFdpbmRvdyA6CgkJ
CWZhbHNlOwp9CgoKCgovLyBDcmVhdGUgd2lkdGgsIGhlaWdodCwgaW5uZXJIZWln
aHQsIGlubmVyV2lkdGgsIG91dGVySGVpZ2h0IGFuZCBvdXRlcldpZHRoIG1ldGhv
ZHMKalF1ZXJ5LmVhY2goIHsgSGVpZ2h0OiAiaGVpZ2h0IiwgV2lkdGg6ICJ3aWR0
aCIgfSwgZnVuY3Rpb24oIG5hbWUsIHR5cGUgKSB7Cgl2YXIgY2xpZW50UHJvcCA9
ICJjbGllbnQiICsgbmFtZSwKCQlzY3JvbGxQcm9wID0gInNjcm9sbCIgKyBuYW1l
LAoJCW9mZnNldFByb3AgPSAib2Zmc2V0IiArIG5hbWU7CgoJLy8gaW5uZXJIZWln
aHQgYW5kIGlubmVyV2lkdGgKCWpRdWVyeS5mblsgImlubmVyIiArIG5hbWUgXSA9
IGZ1bmN0aW9uKCkgewoJCXZhciBlbGVtID0gdGhpc1swXTsKCQlyZXR1cm4gZWxl
bSA/CgkJCWVsZW0uc3R5bGUgPwoJCQlwYXJzZUZsb2F0KCBqUXVlcnkuY3NzKCBl
bGVtLCB0eXBlLCAicGFkZGluZyIgKSApIDoKCQkJdGhpc1sgdHlwZSBdKCkgOgoJ
CQludWxsOwoJfTsKCgkvLyBvdXRlckhlaWdodCBhbmQgb3V0ZXJXaWR0aAoJalF1
ZXJ5LmZuWyAib3V0ZXIiICsgbmFtZSBdID0gZnVuY3Rpb24oIG1hcmdpbiApIHsK
CQl2YXIgZWxlbSA9IHRoaXNbMF07CgkJcmV0dXJuIGVsZW0gPwoJCQllbGVtLnN0
eWxlID8KCQkJcGFyc2VGbG9hdCggalF1ZXJ5LmNzcyggZWxlbSwgdHlwZSwgbWFy
Z2luID8gIm1hcmdpbiIgOiAiYm9yZGVyIiApICkgOgoJCQl0aGlzWyB0eXBlIF0o
KSA6CgkJCW51bGw7Cgl9OwoKCWpRdWVyeS5mblsgdHlwZSBdID0gZnVuY3Rpb24o
IHZhbHVlICkgewoJCXJldHVybiBqUXVlcnkuYWNjZXNzKCB0aGlzLCBmdW5jdGlv
biggZWxlbSwgdHlwZSwgdmFsdWUgKSB7CgkJCXZhciBkb2MsIGRvY0VsZW1Qcm9w
LCBvcmlnLCByZXQ7CgoJCQlpZiAoIGpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkg
ewoJCQkJLy8gM3JkIGNvbmRpdGlvbiBhbGxvd3MgTm9raWEgc3VwcG9ydCwgYXMg
aXQgc3VwcG9ydHMgdGhlIGRvY0VsZW0gcHJvcCBidXQgbm90IENTUzFDb21wYXQK
CQkJCWRvYyA9IGVsZW0uZG9jdW1lbnQ7CgkJCQlkb2NFbGVtUHJvcCA9IGRvYy5k
b2N1bWVudEVsZW1lbnRbIGNsaWVudFByb3AgXTsKCQkJCXJldHVybiBqUXVlcnku
c3VwcG9ydC5ib3hNb2RlbCAmJiBkb2NFbGVtUHJvcCB8fAoJCQkJCWRvYy5ib2R5
ICYmIGRvYy5ib2R5WyBjbGllbnRQcm9wIF0gfHwgZG9jRWxlbVByb3A7CgkJCX0K
CgkJCS8vIEdldCBkb2N1bWVudCB3aWR0aCBvciBoZWlnaHQKCQkJaWYgKCBlbGVt
Lm5vZGVUeXBlID09PSA5ICkgewoJCQkJLy8gRWl0aGVyIHNjcm9sbFtXaWR0aC9I
ZWlnaHRdIG9yIG9mZnNldFtXaWR0aC9IZWlnaHRdLCB3aGljaGV2ZXIgaXMgZ3Jl
YXRlcgoJCQkJZG9jID0gZWxlbS5kb2N1bWVudEVsZW1lbnQ7CgoJCQkJLy8gd2hl
biBhIHdpbmRvdyA+IGRvY3VtZW50LCBJRTYgcmVwb3J0cyBhIG9mZnNldFtXaWR0
aC9IZWlnaHRdID4gY2xpZW50W1dpZHRoL0hlaWdodF0KCQkJCS8vIHNvIHdlIGNh
bid0IHVzZSBtYXgsIGFzIGl0J2xsIGNob29zZSB0aGUgaW5jb3JyZWN0IG9mZnNl
dFtXaWR0aC9IZWlnaHRdCgkJCQkvLyBpbnN0ZWFkIHdlIHVzZSB0aGUgY29ycmVj
dCBjbGllbnRbV2lkdGgvSGVpZ2h0XQoJCQkJLy8gc3VwcG9ydDpJRTYKCQkJCWlm
ICggZG9jWyBjbGllbnRQcm9wIF0gPj0gZG9jWyBzY3JvbGxQcm9wIF0gKSB7CgkJ
CQkJcmV0dXJuIGRvY1sgY2xpZW50UHJvcCBdOwoJCQkJfQoKCQkJCXJldHVybiBN
YXRoLm1heCgKCQkJCQllbGVtLmJvZHlbIHNjcm9sbFByb3AgXSwgZG9jWyBzY3Jv
bGxQcm9wIF0sCgkJCQkJZWxlbS5ib2R5WyBvZmZzZXRQcm9wIF0sIGRvY1sgb2Zm
c2V0UHJvcCBdCgkJCQkpOwoJCQl9CgoJCQkvLyBHZXQgd2lkdGggb3IgaGVpZ2h0
IG9uIHRoZSBlbGVtZW50CgkJCWlmICggdmFsdWUgPT09IHVuZGVmaW5lZCApIHsK
CQkJCW9yaWcgPSBqUXVlcnkuY3NzKCBlbGVtLCB0eXBlICk7CgkJCQlyZXQgPSBw
YXJzZUZsb2F0KCBvcmlnICk7CgkJCQlyZXR1cm4galF1ZXJ5LmlzTnVtZXJpYygg
cmV0ICkgPyByZXQgOiBvcmlnOwoJCQl9CgoJCQkvLyBTZXQgdGhlIHdpZHRoIG9y
IGhlaWdodCBvbiB0aGUgZWxlbWVudAoJCQlqUXVlcnkoIGVsZW0gKS5jc3MoIHR5
cGUsIHZhbHVlICk7CgkJfSwgdHlwZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGgs
IG51bGwgKTsKCX07Cn0pOwoKCgoKLy8gRXhwb3NlIGpRdWVyeSB0byB0aGUgZ2xv
YmFsIG9iamVjdAp3aW5kb3cualF1ZXJ5ID0gd2luZG93LiQgPSBqUXVlcnk7Cgov
LyBFeHBvc2UgalF1ZXJ5IGFzIGFuIEFNRCBtb2R1bGUsIGJ1dCBvbmx5IGZvciBB
TUQgbG9hZGVycyB0aGF0Ci8vIHVuZGVyc3RhbmQgdGhlIGlzc3VlcyB3aXRoIGxv
YWRpbmcgbXVsdGlwbGUgdmVyc2lvbnMgb2YgalF1ZXJ5Ci8vIGluIGEgcGFnZSB0
aGF0IGFsbCBtaWdodCBjYWxsIGRlZmluZSgpLiBUaGUgbG9hZGVyIHdpbGwgaW5k
aWNhdGUKLy8gdGhleSBoYXZlIHNwZWNpYWwgYWxsb3dhbmNlcyBmb3IgbXVsdGlw
bGUgalF1ZXJ5IHZlcnNpb25zIGJ5Ci8vIHNwZWNpZnlpbmcgZGVmaW5lLmFtZC5q
UXVlcnkgPSB0cnVlLiBSZWdpc3RlciBhcyBhIG5hbWVkIG1vZHVsZSwKLy8gc2lu
Y2UgalF1ZXJ5IGNhbiBiZSBjb25jYXRlbmF0ZWQgd2l0aCBvdGhlciBmaWxlcyB0
aGF0IG1heSB1c2UgZGVmaW5lLAovLyBidXQgbm90IHVzZSBhIHByb3BlciBjb25j
YXRlbmF0aW9uIHNjcmlwdCB0aGF0IHVuZGVyc3RhbmRzIGFub255bW91cwovLyBB
TUQgbW9kdWxlcy4gQSBuYW1lZCBBTUQgaXMgc2FmZXN0IGFuZCBtb3N0IHJvYnVz
dCB3YXkgdG8gcmVnaXN0ZXIuCi8vIExvd2VyY2FzZSBqcXVlcnkgaXMgdXNlZCBi
ZWNhdXNlIEFNRCBtb2R1bGUgbmFtZXMgYXJlIGRlcml2ZWQgZnJvbQovLyBmaWxl
IG5hbWVzLCBhbmQgalF1ZXJ5IGlzIG5vcm1hbGx5IGRlbGl2ZXJlZCBpbiBhIGxv
d2VyY2FzZSBmaWxlIG5hbWUuCi8vIERvIHRoaXMgYWZ0ZXIgY3JlYXRpbmcgdGhl
IGdsb2JhbCBzbyB0aGF0IGlmIGFuIEFNRCBtb2R1bGUgd2FudHMgdG8gY2FsbAov
LyBub0NvbmZsaWN0IHRvIGhpZGUgdGhpcyB2ZXJzaW9uIG9mIGpRdWVyeSwgaXQg
d2lsbCB3b3JrLgppZiAoIHR5cGVvZiBkZWZpbmUgPT09ICJmdW5jdGlvbiIgJiYg
ZGVmaW5lLmFtZCAmJiBkZWZpbmUuYW1kLmpRdWVyeSApIHsKCWRlZmluZSggImpx
dWVyeSIsIFtdLCBmdW5jdGlvbiAoKSB7IHJldHVybiBqUXVlcnk7IH0gKTsKfQoK
Cgp9KSggd2luZG93ICk7Cg==

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=underscore.js
Content-Type: application/javascript; name=underscore.js
Content-Location: http://pygame.info/docs/_static/underscore.js
Content-Transfer-Encoding: Base64

Ly8gICAgIFVuZGVyc2NvcmUuanMgMS4xLjYKLy8gICAgIChjKSAyMDExIEplcmVt
eSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBJbmMuCi8vICAgICBVbmRlcnNjb3Jl
IGlzIGZyZWVseSBkaXN0cmlidXRhYmxlIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4K
Ly8gICAgIFBvcnRpb25zIG9mIFVuZGVyc2NvcmUgYXJlIGluc3BpcmVkIG9yIGJv
cnJvd2VkIGZyb20gUHJvdG90eXBlLAovLyAgICAgT2xpdmVyIFN0ZWVsZSdzIEZ1
bmN0aW9uYWwsIGFuZCBKb2huIFJlc2lnJ3MgTWljcm8tVGVtcGxhdGluZy4KLy8g
ICAgIEZvciBhbGwgZGV0YWlscyBhbmQgZG9jdW1lbnRhdGlvbjoKLy8gICAgIGh0
dHA6Ly9kb2N1bWVudGNsb3VkLmdpdGh1Yi5jb20vdW5kZXJzY29yZQoKKGZ1bmN0
aW9uKCkgewoKICAvLyBCYXNlbGluZSBzZXR1cAogIC8vIC0tLS0tLS0tLS0tLS0t
CgogIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRo
ZSBicm93c2VyLCBvciBgZ2xvYmFsYCBvbiB0aGUgc2VydmVyLgogIHZhciByb290
ID0gdGhpczsKCiAgLy8gU2F2ZSB0aGUgcHJldmlvdXMgdmFsdWUgb2YgdGhlIGBf
YCB2YXJpYWJsZS4KICB2YXIgcHJldmlvdXNVbmRlcnNjb3JlID0gcm9vdC5fOwoK
ICAvLyBFc3RhYmxpc2ggdGhlIG9iamVjdCB0aGF0IGdldHMgcmV0dXJuZWQgdG8g
YnJlYWsgb3V0IG9mIGEgbG9vcCBpdGVyYXRpb24uCiAgdmFyIGJyZWFrZXIgPSB7
fTsKCiAgLy8gU2F2ZSBieXRlcyBpbiB0aGUgbWluaWZpZWQgKGJ1dCBub3QgZ3pp
cHBlZCkgdmVyc2lvbjoKICB2YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlw
ZSwgT2JqUHJvdG8gPSBPYmplY3QucHJvdG90eXBlLCBGdW5jUHJvdG8gPSBGdW5j
dGlvbi5wcm90b3R5cGU7CgogIC8vIENyZWF0ZSBxdWljayByZWZlcmVuY2UgdmFy
aWFibGVzIGZvciBzcGVlZCBhY2Nlc3MgdG8gY29yZSBwcm90b3R5cGVzLgogIHZh
ciBzbGljZSAgICAgICAgICAgID0gQXJyYXlQcm90by5zbGljZSwKICAgICAgdW5z
aGlmdCAgICAgICAgICA9IEFycmF5UHJvdG8udW5zaGlmdCwKICAgICAgdG9TdHJp
bmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLAogICAgICBoYXNPd25Qcm9w
ZXJ0eSAgID0gT2JqUHJvdG8uaGFzT3duUHJvcGVydHk7CgogIC8vIEFsbCAqKkVD
TUFTY3JpcHQgNSoqIG5hdGl2ZSBmdW5jdGlvbiBpbXBsZW1lbnRhdGlvbnMgdGhh
dCB3ZSBob3BlIHRvIHVzZQogIC8vIGFyZSBkZWNsYXJlZCBoZXJlLgogIHZhcgog
ICAgbmF0aXZlRm9yRWFjaCAgICAgID0gQXJyYXlQcm90by5mb3JFYWNoLAogICAg
bmF0aXZlTWFwICAgICAgICAgID0gQXJyYXlQcm90by5tYXAsCiAgICBuYXRpdmVS
ZWR1Y2UgICAgICAgPSBBcnJheVByb3RvLnJlZHVjZSwKICAgIG5hdGl2ZVJlZHVj
ZVJpZ2h0ICA9IEFycmF5UHJvdG8ucmVkdWNlUmlnaHQsCiAgICBuYXRpdmVGaWx0
ZXIgICAgICAgPSBBcnJheVByb3RvLmZpbHRlciwKICAgIG5hdGl2ZUV2ZXJ5ICAg
ICAgICA9IEFycmF5UHJvdG8uZXZlcnksCiAgICBuYXRpdmVTb21lICAgICAgICAg
PSBBcnJheVByb3RvLnNvbWUsCiAgICBuYXRpdmVJbmRleE9mICAgICAgPSBBcnJh
eVByb3RvLmluZGV4T2YsCiAgICBuYXRpdmVMYXN0SW5kZXhPZiAgPSBBcnJheVBy
b3RvLmxhc3RJbmRleE9mLAogICAgbmF0aXZlSXNBcnJheSAgICAgID0gQXJyYXku
aXNBcnJheSwKICAgIG5hdGl2ZUtleXMgICAgICAgICA9IE9iamVjdC5rZXlzLAog
ICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQ7CgogIC8vIENy
ZWF0ZSBhIHNhZmUgcmVmZXJlbmNlIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdCBm
b3IgdXNlIGJlbG93LgogIHZhciBfID0gZnVuY3Rpb24ob2JqKSB7IHJldHVybiBu
ZXcgd3JhcHBlcihvYmopOyB9OwoKICAvLyBFeHBvcnQgdGhlIFVuZGVyc2NvcmUg
b2JqZWN0IGZvciAqKkNvbW1vbkpTKiosIHdpdGggYmFja3dhcmRzLWNvbXBhdGli
aWxpdHkKICAvLyBmb3IgdGhlIG9sZCBgcmVxdWlyZSgpYCBBUEkuIElmIHdlJ3Jl
IG5vdCBpbiBDb21tb25KUywgYWRkIGBfYCB0byB0aGUKICAvLyBnbG9iYWwgb2Jq
ZWN0LgogIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1
bGUuZXhwb3J0cykgewogICAgbW9kdWxlLmV4cG9ydHMgPSBfOwogICAgXy5fID0g
XzsKICB9IGVsc2UgewogICAgcm9vdC5fID0gXzsKICB9CgogIC8vIEN1cnJlbnQg
dmVyc2lvbi4KICBfLlZFUlNJT04gPSAnMS4xLjYnOwoKICAvLyBDb2xsZWN0aW9u
IEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIFRoZSBj
b3JuZXJzdG9uZSwgYW4gYGVhY2hgIGltcGxlbWVudGF0aW9uLCBha2EgYGZvckVh
Y2hgLgogIC8vIEhhbmRsZXMgb2JqZWN0cyBpbXBsZW1lbnRpbmcgYGZvckVhY2hg
LCBhcnJheXMsIGFuZCByYXcgb2JqZWN0cy4KICAvLyBEZWxlZ2F0ZXMgdG8gKipF
Q01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZm9yRWFjaGAgaWYgYXZhaWxhYmxlLgog
IHZhciBlYWNoID0gXy5lYWNoID0gXy5mb3JFYWNoID0gZnVuY3Rpb24ob2JqLCBp
dGVyYXRvciwgY29udGV4dCkgewogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm47
CiAgICBpZiAobmF0aXZlRm9yRWFjaCAmJiBvYmouZm9yRWFjaCA9PT0gbmF0aXZl
Rm9yRWFjaCkgewogICAgICBvYmouZm9yRWFjaChpdGVyYXRvciwgY29udGV4dCk7
CiAgICB9IGVsc2UgaWYgKF8uaXNOdW1iZXIob2JqLmxlbmd0aCkpIHsKICAgICAg
Zm9yICh2YXIgaSA9IDAsIGwgPSBvYmoubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAg
ICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2ldLCBpLCBvYmop
ID09PSBicmVha2VyKSByZXR1cm47CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAg
IGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoaGFzT3duUHJvcGVy
dHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIGlmIChpdGVyYXRvci5jYWxs
KGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaikgPT09IGJyZWFrZXIpIHJldHVy
bjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICAvLyBSZXR1cm4gdGhl
IHJlc3VsdHMgb2YgYXBwbHlpbmcgdGhlIGl0ZXJhdG9yIHRvIGVhY2ggZWxlbWVu
dC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBg
bWFwYCBpZiBhdmFpbGFibGUuCiAgXy5tYXAgPSBmdW5jdGlvbihvYmosIGl0ZXJh
dG9yLCBjb250ZXh0KSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgaWYgKG9i
aiA9PSBudWxsKSByZXR1cm4gcmVzdWx0czsKICAgIGlmIChuYXRpdmVNYXAgJiYg
b2JqLm1hcCA9PT0gbmF0aXZlTWFwKSByZXR1cm4gb2JqLm1hcChpdGVyYXRvciwg
Y29udGV4dCk7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBs
aXN0KSB7CiAgICAgIHJlc3VsdHNbcmVzdWx0cy5sZW5ndGhdID0gaXRlcmF0b3Iu
Y2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpOwogICAgfSk7CiAgICBy
ZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyAqKlJlZHVjZSoqIGJ1aWxkcyB1cCBh
IHNpbmdsZSByZXN1bHQgZnJvbSBhIGxpc3Qgb2YgdmFsdWVzLCBha2EgYGluamVj
dGAsCiAgLy8gb3IgYGZvbGRsYC4gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1
KioncyBuYXRpdmUgYHJlZHVjZWAgaWYgYXZhaWxhYmxlLgogIF8ucmVkdWNlID0g
Xy5mb2xkbCA9IF8uaW5qZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgbWVt
bywgY29udGV4dCkgewogICAgdmFyIGluaXRpYWwgPSBtZW1vICE9PSB2b2lkIDA7
CiAgICBpZiAob2JqID09IG51bGwpIG9iaiA9IFtdOwogICAgaWYgKG5hdGl2ZVJl
ZHVjZSAmJiBvYmoucmVkdWNlID09PSBuYXRpdmVSZWR1Y2UpIHsKICAgICAgaWYg
KGNvbnRleHQpIGl0ZXJhdG9yID0gXy5iaW5kKGl0ZXJhdG9yLCBjb250ZXh0KTsK
ICAgICAgcmV0dXJuIGluaXRpYWwgPyBvYmoucmVkdWNlKGl0ZXJhdG9yLCBtZW1v
KSA6IG9iai5yZWR1Y2UoaXRlcmF0b3IpOwogICAgfQogICAgZWFjaChvYmosIGZ1
bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoIWluaXRpYWwg
JiYgaW5kZXggPT09IDApIHsKICAgICAgICBtZW1vID0gdmFsdWU7CiAgICAgICAg
aW5pdGlhbCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWVtbyA9IGl0
ZXJhdG9yLmNhbGwoY29udGV4dCwgbWVtbywgdmFsdWUsIGluZGV4LCBsaXN0KTsK
ICAgICAgfQogICAgfSk7CiAgICBpZiAoIWluaXRpYWwpIHRocm93IG5ldyBUeXBl
RXJyb3IoIlJlZHVjZSBvZiBlbXB0eSBhcnJheSB3aXRoIG5vIGluaXRpYWwgdmFs
dWUiKTsKICAgIHJldHVybiBtZW1vOwogIH07CgogIC8vIFRoZSByaWdodC1hc3Nv
Y2lhdGl2ZSB2ZXJzaW9uIG9mIHJlZHVjZSwgYWxzbyBrbm93biBhcyBgZm9sZHJg
LgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBy
ZWR1Y2VSaWdodGAgaWYgYXZhaWxhYmxlLgogIF8ucmVkdWNlUmlnaHQgPSBfLmZv
bGRyID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgbWVtbywgY29udGV4dCkgewog
ICAgaWYgKG9iaiA9PSBudWxsKSBvYmogPSBbXTsKICAgIGlmIChuYXRpdmVSZWR1
Y2VSaWdodCAmJiBvYmoucmVkdWNlUmlnaHQgPT09IG5hdGl2ZVJlZHVjZVJpZ2h0
KSB7CiAgICAgIGlmIChjb250ZXh0KSBpdGVyYXRvciA9IF8uYmluZChpdGVyYXRv
ciwgY29udGV4dCk7CiAgICAgIHJldHVybiBtZW1vICE9PSB2b2lkIDAgPyBvYmou
cmVkdWNlUmlnaHQoaXRlcmF0b3IsIG1lbW8pIDogb2JqLnJlZHVjZVJpZ2h0KGl0
ZXJhdG9yKTsKICAgIH0KICAgIHZhciByZXZlcnNlZCA9IChfLmlzQXJyYXkob2Jq
KSA/IG9iai5zbGljZSgpIDogXy50b0FycmF5KG9iaikpLnJldmVyc2UoKTsKICAg
IHJldHVybiBfLnJlZHVjZShyZXZlcnNlZCwgaXRlcmF0b3IsIG1lbW8sIGNvbnRl
eHQpOwogIH07CgogIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFz
c2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC4KICBfLmZpbmQg
PSBfLmRldGVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsK
ICAgIHZhciByZXN1bHQ7CiAgICBhbnkob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5k
ZXgsIGxpc3QpIHsKICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFs
dWUsIGluZGV4LCBsaXN0KSkgewogICAgICAgIHJlc3VsdCA9IHZhbHVlOwogICAg
ICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiByZXN1
bHQ7CiAgfTsKCiAgLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgdGhhdCBwYXNz
IGEgdHJ1dGggdGVzdC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUq
KidzIG5hdGl2ZSBgZmlsdGVyYCBpZiBhdmFpbGFibGUuCiAgLy8gQWxpYXNlZCBh
cyBgc2VsZWN0YC4KICBfLmZpbHRlciA9IF8uc2VsZWN0ID0gZnVuY3Rpb24ob2Jq
LCBpdGVyYXRvciwgY29udGV4dCkgewogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAg
IGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7CiAgICBpZiAobmF0aXZl
RmlsdGVyICYmIG9iai5maWx0ZXIgPT09IG5hdGl2ZUZpbHRlcikgcmV0dXJuIG9i
ai5maWx0ZXIoaXRlcmF0b3IsIGNvbnRleHQpOwogICAgZWFjaChvYmosIGZ1bmN0
aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoaXRlcmF0b3IuY2Fs
bChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzW3Jlc3VsdHMu
bGVuZ3RoXSA9IHZhbHVlOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9
OwoKICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBmb3Igd2hpY2ggYSB0cnV0
aCB0ZXN0IGZhaWxzLgogIF8ucmVqZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRv
ciwgY29udGV4dCkgewogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIGlmIChvYmog
PT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24o
dmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIGlmICghaXRlcmF0b3IuY2FsbChj
b250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzW3Jlc3VsdHMubGVu
Z3RoXSA9IHZhbHVlOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoK
ICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNo
IGEgdHJ1dGggdGVzdC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUq
KidzIG5hdGl2ZSBgZXZlcnlgIGlmIGF2YWlsYWJsZS4KICAvLyBBbGlhc2VkIGFz
IGBhbGxgLgogIF8uZXZlcnkgPSBfLmFsbCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0
b3IsIGNvbnRleHQpIHsKICAgIHZhciByZXN1bHQgPSB0cnVlOwogICAgaWYgKG9i
aiA9PSBudWxsKSByZXR1cm4gcmVzdWx0OwogICAgaWYgKG5hdGl2ZUV2ZXJ5ICYm
IG9iai5ldmVyeSA9PT0gbmF0aXZlRXZlcnkpIHJldHVybiBvYmouZXZlcnkoaXRl
cmF0b3IsIGNvbnRleHQpOwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBp
bmRleCwgbGlzdCkgewogICAgICBpZiAoIShyZXN1bHQgPSByZXN1bHQgJiYgaXRl
cmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSkgcmV0dXJu
IGJyZWFrZXI7CiAgICB9KTsKICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLy8g
RGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3Qg
bWF0Y2hlcyBhIHRydXRoIHRlc3QuCiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNj
cmlwdCA1KioncyBuYXRpdmUgYHNvbWVgIGlmIGF2YWlsYWJsZS4KICAvLyBBbGlh
c2VkIGFzIGBhbnlgLgogIHZhciBhbnkgPSBfLnNvbWUgPSBfLmFueSA9IGZ1bmN0
aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGl0ZXJhdG9yIHx8IChp
dGVyYXRvciA9IF8uaWRlbnRpdHkpOwogICAgdmFyIHJlc3VsdCA9IGZhbHNlOwog
ICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0OwogICAgaWYgKG5hdGl2
ZVNvbWUgJiYgb2JqLnNvbWUgPT09IG5hdGl2ZVNvbWUpIHJldHVybiBvYmouc29t
ZShpdGVyYXRvciwgY29udGV4dCk7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFs
dWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIGlmIChyZXN1bHQgPSBpdGVyYXRvci5j
YWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkpIHJldHVybiBicmVha2Vy
OwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogIC8vIERldGVybWlu
ZSBpZiBhIGdpdmVuIHZhbHVlIGlzIGluY2x1ZGVkIGluIHRoZSBhcnJheSBvciBv
YmplY3QgdXNpbmcgYD09PWAuCiAgLy8gQWxpYXNlZCBhcyBgY29udGFpbnNgLgog
IF8uaW5jbHVkZSA9IF8uY29udGFpbnMgPSBmdW5jdGlvbihvYmosIHRhcmdldCkg
ewogICAgdmFyIGZvdW5kID0gZmFsc2U7CiAgICBpZiAob2JqID09IG51bGwpIHJl
dHVybiBmb3VuZDsKICAgIGlmIChuYXRpdmVJbmRleE9mICYmIG9iai5pbmRleE9m
ID09PSBuYXRpdmVJbmRleE9mKSByZXR1cm4gb2JqLmluZGV4T2YodGFyZ2V0KSAh
PSAtMTsKICAgIGFueShvYmosIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGlmIChm
b3VuZCA9IHZhbHVlID09PSB0YXJnZXQpIHJldHVybiB0cnVlOwogICAgfSk7CiAg
ICByZXR1cm4gZm91bmQ7CiAgfTsKCiAgLy8gSW52b2tlIGEgbWV0aG9kICh3aXRo
IGFyZ3VtZW50cykgb24gZXZlcnkgaXRlbSBpbiBhIGNvbGxlY3Rpb24uCiAgXy5p
bnZva2UgPSBmdW5jdGlvbihvYmosIG1ldGhvZCkgewogICAgdmFyIGFyZ3MgPSBz
bGljZS5jYWxsKGFyZ3VtZW50cywgMik7CiAgICByZXR1cm4gXy5tYXAob2JqLCBm
dW5jdGlvbih2YWx1ZSkgewogICAgICByZXR1cm4gKG1ldGhvZC5jYWxsID8gbWV0
aG9kIHx8IHZhbHVlIDogdmFsdWVbbWV0aG9kXSkuYXBwbHkodmFsdWUsIGFyZ3Mp
OwogICAgfSk7CiAgfTsKCiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNv
bW1vbiB1c2UgY2FzZSBvZiBgbWFwYDogZmV0Y2hpbmcgYSBwcm9wZXJ0eS4KICBf
LnBsdWNrID0gZnVuY3Rpb24ob2JqLCBrZXkpIHsKICAgIHJldHVybiBfLm1hcChv
YmosIGZ1bmN0aW9uKHZhbHVlKXsgcmV0dXJuIHZhbHVlW2tleV07IH0pOwogIH07
CgogIC8vIFJldHVybiB0aGUgbWF4aW11bSBlbGVtZW50IG9yIChlbGVtZW50LWJh
c2VkIGNvbXB1dGF0aW9uKS4KICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0
b3IsIGNvbnRleHQpIHsKICAgIGlmICghaXRlcmF0b3IgJiYgXy5pc0FycmF5KG9i
aikpIHJldHVybiBNYXRoLm1heC5hcHBseShNYXRoLCBvYmopOwogICAgdmFyIHJl
c3VsdCA9IHtjb21wdXRlZCA6IC1JbmZpbml0eX07CiAgICBlYWNoKG9iaiwgZnVu
Y3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHZhciBjb21wdXRlZCA9
IGl0ZXJhdG9yID8gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgs
IGxpc3QpIDogdmFsdWU7CiAgICAgIGNvbXB1dGVkID49IHJlc3VsdC5jb21wdXRl
ZCAmJiAocmVzdWx0ID0ge3ZhbHVlIDogdmFsdWUsIGNvbXB1dGVkIDogY29tcHV0
ZWR9KTsKICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdC52YWx1ZTsKICB9OwoKICAv
LyBSZXR1cm4gdGhlIG1pbmltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBj
b21wdXRhdGlvbikuCiAgXy5taW4gPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBj
b250ZXh0KSB7CiAgICBpZiAoIWl0ZXJhdG9yICYmIF8uaXNBcnJheShvYmopKSBy
ZXR1cm4gTWF0aC5taW4uYXBwbHkoTWF0aCwgb2JqKTsKICAgIHZhciByZXN1bHQg
PSB7Y29tcHV0ZWQgOiBJbmZpbml0eX07CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24o
dmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHZhciBjb21wdXRlZCA9IGl0ZXJh
dG9yID8gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3Qp
IDogdmFsdWU7CiAgICAgIGNvbXB1dGVkIDwgcmVzdWx0LmNvbXB1dGVkICYmIChy
ZXN1bHQgPSB7dmFsdWUgOiB2YWx1ZSwgY29tcHV0ZWQgOiBjb21wdXRlZH0pOwog
ICAgfSk7CiAgICByZXR1cm4gcmVzdWx0LnZhbHVlOwogIH07CgogIC8vIFNvcnQg
dGhlIG9iamVjdCdzIHZhbHVlcyBieSBhIGNyaXRlcmlvbiBwcm9kdWNlZCBieSBh
biBpdGVyYXRvci4KICBfLnNvcnRCeSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3Is
IGNvbnRleHQpIHsKICAgIHJldHVybiBfLnBsdWNrKF8ubWFwKG9iaiwgZnVuY3Rp
b24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAg
dmFsdWUgOiB2YWx1ZSwKICAgICAgICBjcml0ZXJpYSA6IGl0ZXJhdG9yLmNhbGwo
Y29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KQogICAgICB9OwogICAgfSkuc29y
dChmdW5jdGlvbihsZWZ0LCByaWdodCkgewogICAgICB2YXIgYSA9IGxlZnQuY3Jp
dGVyaWEsIGIgPSByaWdodC5jcml0ZXJpYTsKICAgICAgcmV0dXJuIGEgPCBiID8g
LTEgOiBhID4gYiA/IDEgOiAwOwogICAgfSksICd2YWx1ZScpOwogIH07CgogIC8v
IFVzZSBhIGNvbXBhcmF0b3IgZnVuY3Rpb24gdG8gZmlndXJlIG91dCBhdCB3aGF0
IGluZGV4IGFuIG9iamVjdCBzaG91bGQKICAvLyBiZSBpbnNlcnRlZCBzbyBhcyB0
byBtYWludGFpbiBvcmRlci4gVXNlcyBiaW5hcnkgc2VhcmNoLgogIF8uc29ydGVk
SW5kZXggPSBmdW5jdGlvbihhcnJheSwgb2JqLCBpdGVyYXRvcikgewogICAgaXRl
cmF0b3IgfHwgKGl0ZXJhdG9yID0gXy5pZGVudGl0eSk7CiAgICB2YXIgbG93ID0g
MCwgaGlnaCA9IGFycmF5Lmxlbmd0aDsKICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7
CiAgICAgIHZhciBtaWQgPSAobG93ICsgaGlnaCkgPj4gMTsKICAgICAgaXRlcmF0
b3IoYXJyYXlbbWlkXSkgPCBpdGVyYXRvcihvYmopID8gbG93ID0gbWlkICsgMSA6
IGhpZ2ggPSBtaWQ7CiAgICB9CiAgICByZXR1cm4gbG93OwogIH07CgogIC8vIFNh
ZmVseSBjb252ZXJ0IGFueXRoaW5nIGl0ZXJhYmxlIGludG8gYSByZWFsLCBsaXZl
IGFycmF5LgogIF8udG9BcnJheSA9IGZ1bmN0aW9uKGl0ZXJhYmxlKSB7CiAgICBp
ZiAoIWl0ZXJhYmxlKSAgICAgICAgICAgICAgICByZXR1cm4gW107CiAgICBpZiAo
aXRlcmFibGUudG9BcnJheSkgICAgICAgICByZXR1cm4gaXRlcmFibGUudG9BcnJh
eSgpOwogICAgaWYgKF8uaXNBcnJheShpdGVyYWJsZSkpICAgICAgcmV0dXJuIGl0
ZXJhYmxlOwogICAgaWYgKF8uaXNBcmd1bWVudHMoaXRlcmFibGUpKSAgcmV0dXJu
IHNsaWNlLmNhbGwoaXRlcmFibGUpOwogICAgcmV0dXJuIF8udmFsdWVzKGl0ZXJh
YmxlKTsKICB9OwoKICAvLyBSZXR1cm4gdGhlIG51bWJlciBvZiBlbGVtZW50cyBp
biBhbiBvYmplY3QuCiAgXy5zaXplID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1
cm4gXy50b0FycmF5KG9iaikubGVuZ3RoOwogIH07CgogIC8vIEFycmF5IEZ1bmN0
aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLQoKICAvLyBHZXQgdGhlIGZpcnN0IGVs
ZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhl
IGZpcnN0IE4KICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LiBBbGlhc2VkIGFzIGBo
ZWFkYC4gVGhlICoqZ3VhcmQqKiBjaGVjayBhbGxvd3MgaXQgdG8gd29yawogIC8v
IHdpdGggYF8ubWFwYC4KICBfLmZpcnN0ID0gXy5oZWFkID0gZnVuY3Rpb24oYXJy
YXksIG4sIGd1YXJkKSB7CiAgICByZXR1cm4gKG4gIT0gbnVsbCkgJiYgIWd1YXJk
ID8gc2xpY2UuY2FsbChhcnJheSwgMCwgbikgOiBhcnJheVswXTsKICB9OwoKICAv
LyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBmaXJzdCBlbnRyeSBvZiB0aGUg
YXJyYXkuIEFsaWFzZWQgYXMgYHRhaWxgLgogIC8vIEVzcGVjaWFsbHkgdXNlZnVs
IG9uIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nIGFuICoqaW5kZXgqKiB3
aWxsIHJldHVybgogIC8vIHRoZSByZXN0IG9mIHRoZSB2YWx1ZXMgaW4gdGhlIGFy
cmF5IGZyb20gdGhhdCBpbmRleCBvbndhcmQuIFRoZSAqKmd1YXJkKioKICAvLyBj
aGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuCiAgXy5yZXN0ID0g
Xy50YWlsID0gZnVuY3Rpb24oYXJyYXksIGluZGV4LCBndWFyZCkgewogICAgcmV0
dXJuIHNsaWNlLmNhbGwoYXJyYXksIChpbmRleCA9PSBudWxsKSB8fCBndWFyZCA/
IDEgOiBpbmRleCk7CiAgfTsKCiAgLy8gR2V0IHRoZSBsYXN0IGVsZW1lbnQgb2Yg
YW4gYXJyYXkuCiAgXy5sYXN0ID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgIHJldHVy
biBhcnJheVthcnJheS5sZW5ndGggLSAxXTsKICB9OwoKICAvLyBUcmltIG91dCBh
bGwgZmFsc3kgdmFsdWVzIGZyb20gYW4gYXJyYXkuCiAgXy5jb21wYWN0ID0gZnVu
Y3Rpb24oYXJyYXkpIHsKICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgZnVuY3Rp
b24odmFsdWUpeyByZXR1cm4gISF2YWx1ZTsgfSk7CiAgfTsKCiAgLy8gUmV0dXJu
IGEgY29tcGxldGVseSBmbGF0dGVuZWQgdmVyc2lvbiBvZiBhbiBhcnJheS4KICBf
LmZsYXR0ZW4gPSBmdW5jdGlvbihhcnJheSkgewogICAgcmV0dXJuIF8ucmVkdWNl
KGFycmF5LCBmdW5jdGlvbihtZW1vLCB2YWx1ZSkgewogICAgICBpZiAoXy5pc0Fy
cmF5KHZhbHVlKSkgcmV0dXJuIG1lbW8uY29uY2F0KF8uZmxhdHRlbih2YWx1ZSkp
OwogICAgICBtZW1vW21lbW8ubGVuZ3RoXSA9IHZhbHVlOwogICAgICByZXR1cm4g
bWVtbzsKICAgIH0sIFtdKTsKICB9OwoKICAvLyBSZXR1cm4gYSB2ZXJzaW9uIG9m
IHRoZSBhcnJheSB0aGF0IGRvZXMgbm90IGNvbnRhaW4gdGhlIHNwZWNpZmllZCB2
YWx1ZShzKS4KICBfLndpdGhvdXQgPSBmdW5jdGlvbihhcnJheSkgewogICAgdmFy
IHZhbHVlcyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgIHJldHVybiBf
LmZpbHRlcihhcnJheSwgZnVuY3Rpb24odmFsdWUpeyByZXR1cm4gIV8uaW5jbHVk
ZSh2YWx1ZXMsIHZhbHVlKTsgfSk7CiAgfTsKCiAgLy8gUHJvZHVjZSBhIGR1cGxp
Y2F0ZS1mcmVlIHZlcnNpb24gb2YgdGhlIGFycmF5LiBJZiB0aGUgYXJyYXkgaGFz
IGFscmVhZHkKICAvLyBiZWVuIHNvcnRlZCwgeW91IGhhdmUgdGhlIG9wdGlvbiBv
ZiB1c2luZyBhIGZhc3RlciBhbGdvcml0aG0uCiAgLy8gQWxpYXNlZCBhcyBgdW5p
cXVlYC4KICBfLnVuaXEgPSBfLnVuaXF1ZSA9IGZ1bmN0aW9uKGFycmF5LCBpc1Nv
cnRlZCkgewogICAgcmV0dXJuIF8ucmVkdWNlKGFycmF5LCBmdW5jdGlvbihtZW1v
LCBlbCwgaSkgewogICAgICBpZiAoMCA9PSBpIHx8IChpc1NvcnRlZCA9PT0gdHJ1
ZSA/IF8ubGFzdChtZW1vKSAhPSBlbCA6ICFfLmluY2x1ZGUobWVtbywgZWwpKSkg
bWVtb1ttZW1vLmxlbmd0aF0gPSBlbDsKICAgICAgcmV0dXJuIG1lbW87CiAgICB9
LCBbXSk7CiAgfTsKCiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5z
IGV2ZXJ5IGl0ZW0gc2hhcmVkIGJldHdlZW4gYWxsIHRoZQogIC8vIHBhc3NlZC1p
biBhcnJheXMuCiAgXy5pbnRlcnNlY3QgPSBmdW5jdGlvbihhcnJheSkgewogICAg
dmFyIHJlc3QgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICByZXR1cm4g
Xy5maWx0ZXIoXy51bmlxKGFycmF5KSwgZnVuY3Rpb24oaXRlbSkgewogICAgICBy
ZXR1cm4gXy5ldmVyeShyZXN0LCBmdW5jdGlvbihvdGhlcikgewogICAgICAgIHJl
dHVybiBfLmluZGV4T2Yob3RoZXIsIGl0ZW0pID49IDA7CiAgICAgIH0pOwogICAg
fSk7CiAgfTsKCiAgLy8gWmlwIHRvZ2V0aGVyIG11bHRpcGxlIGxpc3RzIGludG8g
YSBzaW5nbGUgYXJyYXkgLS0gZWxlbWVudHMgdGhhdCBzaGFyZQogIC8vIGFuIGlu
ZGV4IGdvIHRvZ2V0aGVyLgogIF8uemlwID0gZnVuY3Rpb24oKSB7CiAgICB2YXIg
YXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHZhciBsZW5ndGggPSBf
Lm1heChfLnBsdWNrKGFyZ3MsICdsZW5ndGgnKSk7CiAgICB2YXIgcmVzdWx0cyA9
IG5ldyBBcnJheShsZW5ndGgpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5n
dGg7IGkrKykgcmVzdWx0c1tpXSA9IF8ucGx1Y2soYXJncywgIiIgKyBpKTsKICAg
IHJldHVybiByZXN1bHRzOwogIH07CgogIC8vIElmIHRoZSBicm93c2VyIGRvZXNu
J3Qgc3VwcGx5IHVzIHdpdGggaW5kZXhPZiAoSSdtIGxvb2tpbmcgYXQgeW91LCAq
Kk1TSUUqKiksCiAgLy8gd2UgbmVlZCB0aGlzIGZ1bmN0aW9uLiBSZXR1cm4gdGhl
IHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuCiAgLy8gaXRl
bSBpbiBhbiBhcnJheSwgb3IgLTEgaWYgdGhlIGl0ZW0gaXMgbm90IGluY2x1ZGVk
IGluIHRoZSBhcnJheS4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUq
KidzIG5hdGl2ZSBgaW5kZXhPZmAgaWYgYXZhaWxhYmxlLgogIC8vIElmIHRoZSBh
cnJheSBpcyBsYXJnZSBhbmQgYWxyZWFkeSBpbiBzb3J0IG9yZGVyLCBwYXNzIGB0
cnVlYAogIC8vIGZvciAqKmlzU29ydGVkKiogdG8gdXNlIGJpbmFyeSBzZWFyY2gu
CiAgXy5pbmRleE9mID0gZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGlzU29ydGVkKSB7
CiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIC0xOwogICAgdmFyIGksIGw7
CiAgICBpZiAoaXNTb3J0ZWQpIHsKICAgICAgaSA9IF8uc29ydGVkSW5kZXgoYXJy
YXksIGl0ZW0pOwogICAgICByZXR1cm4gYXJyYXlbaV0gPT09IGl0ZW0gPyBpIDog
LTE7CiAgICB9CiAgICBpZiAobmF0aXZlSW5kZXhPZiAmJiBhcnJheS5pbmRleE9m
ID09PSBuYXRpdmVJbmRleE9mKSByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtKTsK
ICAgIGZvciAoaSA9IDAsIGwgPSBhcnJheS5sZW5ndGg7IGkgPCBsOyBpKyspIGlm
IChhcnJheVtpXSA9PT0gaXRlbSkgcmV0dXJuIGk7CiAgICByZXR1cm4gLTE7CiAg
fTsKCgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZl
IGBsYXN0SW5kZXhPZmAgaWYgYXZhaWxhYmxlLgogIF8ubGFzdEluZGV4T2YgPSBm
dW5jdGlvbihhcnJheSwgaXRlbSkgewogICAgaWYgKGFycmF5ID09IG51bGwpIHJl
dHVybiAtMTsKICAgIGlmIChuYXRpdmVMYXN0SW5kZXhPZiAmJiBhcnJheS5sYXN0
SW5kZXhPZiA9PT0gbmF0aXZlTGFzdEluZGV4T2YpIHJldHVybiBhcnJheS5sYXN0
SW5kZXhPZihpdGVtKTsKICAgIHZhciBpID0gYXJyYXkubGVuZ3RoOwogICAgd2hp
bGUgKGktLSkgaWYgKGFycmF5W2ldID09PSBpdGVtKSByZXR1cm4gaTsKICAgIHJl
dHVybiAtMTsKICB9OwoKICAvLyBHZW5lcmF0ZSBhbiBpbnRlZ2VyIEFycmF5IGNv
bnRhaW5pbmcgYW4gYXJpdGhtZXRpYyBwcm9ncmVzc2lvbi4gQSBwb3J0IG9mCiAg
Ly8gdGhlIG5hdGl2ZSBQeXRob24gYHJhbmdlKClgIGZ1bmN0aW9uLiBTZWUKICAv
LyBbdGhlIFB5dGhvbiBkb2N1bWVudGF0aW9uXShodHRwOi8vZG9jcy5weXRob24u
b3JnL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjcmFuZ2UpLgogIF8ucmFuZ2UgPSBm
dW5jdGlvbihzdGFydCwgc3RvcCwgc3RlcCkgewogICAgaWYgKGFyZ3VtZW50cy5s
ZW5ndGggPD0gMSkgewogICAgICBzdG9wID0gc3RhcnQgfHwgMDsKICAgICAgc3Rh
cnQgPSAwOwogICAgfQogICAgc3RlcCA9IGFyZ3VtZW50c1syXSB8fCAxOwoKICAg
IHZhciBsZW4gPSBNYXRoLm1heChNYXRoLmNlaWwoKHN0b3AgLSBzdGFydCkgLyBz
dGVwKSwgMCk7CiAgICB2YXIgaWR4ID0gMDsKICAgIHZhciByYW5nZSA9IG5ldyBB
cnJheShsZW4pOwoKICAgIHdoaWxlKGlkeCA8IGxlbikgewogICAgICByYW5nZVtp
ZHgrK10gPSBzdGFydDsKICAgICAgc3RhcnQgKz0gc3RlcDsKICAgIH0KCiAgICBy
ZXR1cm4gcmFuZ2U7CiAgfTsKCiAgLy8gRnVuY3Rpb24gKGFoZW0pIEZ1bmN0aW9u
cwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLQoKICAvLyBDcmVhdGUgYSBmdW5jdGlv
biBib3VuZCB0byBhIGdpdmVuIG9iamVjdCAoYXNzaWduaW5nIGB0aGlzYCwgYW5k
IGFyZ3VtZW50cywKICAvLyBvcHRpb25hbGx5KS4gQmluZGluZyB3aXRoIGFyZ3Vt
ZW50cyBpcyBhbHNvIGtub3duIGFzIGBjdXJyeWAuCiAgLy8gRGVsZWdhdGVzIHRv
ICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYEZ1bmN0aW9uLmJpbmRgIGlmIGF2
YWlsYWJsZS4KICAvLyBXZSBjaGVjayBmb3IgYGZ1bmMuYmluZGAgZmlyc3QsIHRv
IGZhaWwgZmFzdCB3aGVuIGBmdW5jYCBpcyB1bmRlZmluZWQuCiAgXy5iaW5kID0g
ZnVuY3Rpb24oZnVuYywgb2JqKSB7CiAgICBpZiAoZnVuYy5iaW5kID09PSBuYXRp
dmVCaW5kICYmIG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1
bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7CiAgICB2YXIgYXJncyA9IHNs
aWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgIHJldHVybiBmdW5jdGlvbigpIHsK
ICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkob2JqLCBhcmdzLmNvbmNhdChzbGljZS5j
YWxsKGFyZ3VtZW50cykpKTsKICAgIH07CiAgfTsKCiAgLy8gQmluZCBhbGwgb2Yg
YW4gb2JqZWN0J3MgbWV0aG9kcyB0byB0aGF0IG9iamVjdC4gVXNlZnVsIGZvciBl
bnN1cmluZyB0aGF0CiAgLy8gYWxsIGNhbGxiYWNrcyBkZWZpbmVkIG9uIGFuIG9i
amVjdCBiZWxvbmcgdG8gaXQuCiAgXy5iaW5kQWxsID0gZnVuY3Rpb24ob2JqKSB7
CiAgICB2YXIgZnVuY3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICBp
ZiAoZnVuY3MubGVuZ3RoID09IDApIGZ1bmNzID0gXy5mdW5jdGlvbnMob2JqKTsK
ICAgIGVhY2goZnVuY3MsIGZ1bmN0aW9uKGYpIHsgb2JqW2ZdID0gXy5iaW5kKG9i
altmXSwgb2JqKTsgfSk7CiAgICByZXR1cm4gb2JqOwogIH07CgogIC8vIE1lbW9p
emUgYW4gZXhwZW5zaXZlIGZ1bmN0aW9uIGJ5IHN0b3JpbmcgaXRzIHJlc3VsdHMu
CiAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7CiAgICB2YXIg
bWVtbyA9IHt9OwogICAgaGFzaGVyIHx8IChoYXNoZXIgPSBfLmlkZW50aXR5KTsK
ICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGtleSA9IGhhc2hlci5h
cHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICByZXR1cm4gaGFzT3duUHJvcGVy
dHkuY2FsbChtZW1vLCBrZXkpID8gbWVtb1trZXldIDogKG1lbW9ba2V5XSA9IGZ1
bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICB9OwogIH07CgogIC8vIERl
bGF5cyBhIGZ1bmN0aW9uIGZvciB0aGUgZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vj
b25kcywgYW5kIHRoZW4gY2FsbHMKICAvLyBpdCB3aXRoIHRoZSBhcmd1bWVudHMg
c3VwcGxpZWQuCiAgXy5kZWxheSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHsKICAg
IHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpOwogICAgcmV0dXJu
IHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgcmV0dXJuIGZ1bmMuYXBwbHkoZnVuYywg
YXJncyk7IH0sIHdhaXQpOwogIH07CgogIC8vIERlZmVycyBhIGZ1bmN0aW9uLCBz
Y2hlZHVsaW5nIGl0IHRvIHJ1biBhZnRlciB0aGUgY3VycmVudCBjYWxsIHN0YWNr
IGhhcwogIC8vIGNsZWFyZWQuCiAgXy5kZWZlciA9IGZ1bmN0aW9uKGZ1bmMpIHsK
ICAgIHJldHVybiBfLmRlbGF5LmFwcGx5KF8sIFtmdW5jLCAxXS5jb25jYXQoc2xp
Y2UuY2FsbChhcmd1bWVudHMsIDEpKSk7CiAgfTsKCiAgLy8gSW50ZXJuYWwgZnVu
Y3Rpb24gdXNlZCB0byBpbXBsZW1lbnQgYF8udGhyb3R0bGVgIGFuZCBgXy5kZWJv
dW5jZWAuCiAgdmFyIGxpbWl0ID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgZGVib3Vu
Y2UpIHsKICAgIHZhciB0aW1lb3V0OwogICAgcmV0dXJuIGZ1bmN0aW9uKCkgewog
ICAgICB2YXIgY29udGV4dCA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7CiAgICAg
IHZhciB0aHJvdHRsZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICB0aW1lb3V0ID0g
bnVsbDsKICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpOwogICAgICB9
OwogICAgICBpZiAoZGVib3VuY2UpIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAg
ICAgaWYgKGRlYm91bmNlIHx8ICF0aW1lb3V0KSB0aW1lb3V0ID0gc2V0VGltZW91
dCh0aHJvdHRsZXIsIHdhaXQpOwogICAgfTsKICB9OwoKICAvLyBSZXR1cm5zIGEg
ZnVuY3Rpb24sIHRoYXQsIHdoZW4gaW52b2tlZCwgd2lsbCBvbmx5IGJlIHRyaWdn
ZXJlZCBhdCBtb3N0IG9uY2UKICAvLyBkdXJpbmcgYSBnaXZlbiB3aW5kb3cgb2Yg
dGltZS4KICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCkgewogICAg
cmV0dXJuIGxpbWl0KGZ1bmMsIHdhaXQsIGZhbHNlKTsKICB9OwoKICAvLyBSZXR1
cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRv
IGJlIGludm9rZWQsIHdpbGwgbm90CiAgLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVu
Y3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVk
IGZvcgogIC8vIE4gbWlsbGlzZWNvbmRzLgogIF8uZGVib3VuY2UgPSBmdW5jdGlv
bihmdW5jLCB3YWl0KSB7CiAgICByZXR1cm4gbGltaXQoZnVuYywgd2FpdCwgdHJ1
ZSk7CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBl
eGVjdXRlZCBhdCBtb3N0IG9uZSB0aW1lLCBubyBtYXR0ZXIgaG93CiAgLy8gb2Z0
ZW4geW91IGNhbGwgaXQuIFVzZWZ1bCBmb3IgbGF6eSBpbml0aWFsaXphdGlvbi4K
ICBfLm9uY2UgPSBmdW5jdGlvbihmdW5jKSB7CiAgICB2YXIgcmFuID0gZmFsc2Us
IG1lbW87CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIGlmIChyYW4pIHJl
dHVybiBtZW1vOwogICAgICByYW4gPSB0cnVlOwogICAgICByZXR1cm4gbWVtbyA9
IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfTsKCiAgLy8g
UmV0dXJucyB0aGUgZmlyc3QgZnVuY3Rpb24gcGFzc2VkIGFzIGFuIGFyZ3VtZW50
IHRvIHRoZSBzZWNvbmQsCiAgLy8gYWxsb3dpbmcgeW91IHRvIGFkanVzdCBhcmd1
bWVudHMsIHJ1biBjb2RlIGJlZm9yZSBhbmQgYWZ0ZXIsIGFuZAogIC8vIGNvbmRp
dGlvbmFsbHkgZXhlY3V0ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24uCiAgXy53cmFw
ID0gZnVuY3Rpb24oZnVuYywgd3JhcHBlcikgewogICAgcmV0dXJuIGZ1bmN0aW9u
KCkgewogICAgICB2YXIgYXJncyA9IFtmdW5jXS5jb25jYXQoc2xpY2UuY2FsbChh
cmd1bWVudHMpKTsKICAgICAgcmV0dXJuIHdyYXBwZXIuYXBwbHkodGhpcywgYXJn
cyk7CiAgICB9OwogIH07CgogIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGlz
IHRoZSBjb21wb3NpdGlvbiBvZiBhIGxpc3Qgb2YgZnVuY3Rpb25zLCBlYWNoCiAg
Ly8gY29uc3VtaW5nIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZ1bmN0aW9uIHRo
YXQgZm9sbG93cy4KICBfLmNvbXBvc2UgPSBmdW5jdGlvbigpIHsKICAgIHZhciBm
dW5jcyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHJldHVybiBmdW5jdGlv
bigpIHsKICAgICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAg
ICAgIGZvciAodmFyIGk9ZnVuY3MubGVuZ3RoLTE7IGkgPj0gMDsgaS0tKSB7CiAg
ICAgICAgYXJncyA9IFtmdW5jc1tpXS5hcHBseSh0aGlzLCBhcmdzKV07CiAgICAg
IH0KICAgICAgcmV0dXJuIGFyZ3NbMF07CiAgICB9OwogIH07CgogIC8vIFJldHVy
bnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgb25seSBiZSBleGVjdXRlZCBhZnRlciBi
ZWluZyBjYWxsZWQgTiB0aW1lcy4KICBfLmFmdGVyID0gZnVuY3Rpb24odGltZXMs
IGZ1bmMpIHsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgaWYgKC0tdGlt
ZXMgPCAxKSB7IHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0K
ICAgIH07CiAgfTsKCgogIC8vIE9iamVjdCBGdW5jdGlvbnMKICAvLyAtLS0tLS0t
LS0tLS0tLS0tCgogIC8vIFJldHJpZXZlIHRoZSBuYW1lcyBvZiBhbiBvYmplY3Qn
cyBwcm9wZXJ0aWVzLgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoq
J3MgbmF0aXZlIGBPYmplY3Qua2V5c2AKICBfLmtleXMgPSBuYXRpdmVLZXlzIHx8
IGZ1bmN0aW9uKG9iaikgewogICAgaWYgKG9iaiAhPT0gT2JqZWN0KG9iaikpIHRo
cm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgb2JqZWN0Jyk7CiAgICB2YXIga2V5
cyA9IFtdOwogICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKGhhc093blByb3Bl
cnR5LmNhbGwob2JqLCBrZXkpKSBrZXlzW2tleXMubGVuZ3RoXSA9IGtleTsKICAg
IHJldHVybiBrZXlzOwogIH07CgogIC8vIFJldHJpZXZlIHRoZSB2YWx1ZXMgb2Yg
YW4gb2JqZWN0J3MgcHJvcGVydGllcy4KICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9i
aikgewogICAgcmV0dXJuIF8ubWFwKG9iaiwgXy5pZGVudGl0eSk7CiAgfTsKCiAg
Ly8gUmV0dXJuIGEgc29ydGVkIGxpc3Qgb2YgdGhlIGZ1bmN0aW9uIG5hbWVzIGF2
YWlsYWJsZSBvbiB0aGUgb2JqZWN0LgogIC8vIEFsaWFzZWQgYXMgYG1ldGhvZHNg
CiAgXy5mdW5jdGlvbnMgPSBfLm1ldGhvZHMgPSBmdW5jdGlvbihvYmopIHsKICAg
IHJldHVybiBfLmZpbHRlcihfLmtleXMob2JqKSwgZnVuY3Rpb24oa2V5KXsgcmV0
dXJuIF8uaXNGdW5jdGlvbihvYmpba2V5XSk7IH0pLnNvcnQoKTsKICB9OwoKICAv
LyBFeHRlbmQgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIHByb3BlcnRpZXMg
aW4gcGFzc2VkLWluIG9iamVjdChzKS4KICBfLmV4dGVuZCA9IGZ1bmN0aW9uKG9i
aikgewogICAgZWFjaChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZ1bmN0aW9u
KHNvdXJjZSkgewogICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkgewogICAg
ICAgIGlmIChzb3VyY2VbcHJvcF0gIT09IHZvaWQgMCkgb2JqW3Byb3BdID0gc291
cmNlW3Byb3BdOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBvYmo7CiAgfTsK
CiAgLy8gRmlsbCBpbiBhIGdpdmVuIG9iamVjdCB3aXRoIGRlZmF1bHQgcHJvcGVy
dGllcy4KICBfLmRlZmF1bHRzID0gZnVuY3Rpb24ob2JqKSB7CiAgICBlYWNoKHNs
aWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24oc291cmNlKSB7CiAgICAg
IGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7CiAgICAgICAgaWYgKG9ialtwcm9w
XSA9PSBudWxsKSBvYmpbcHJvcF0gPSBzb3VyY2VbcHJvcF07CiAgICAgIH0KICAg
IH0pOwogICAgcmV0dXJuIG9iajsKICB9OwoKICAvLyBDcmVhdGUgYSAoc2hhbGxv
dy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuCiAgXy5jbG9uZSA9IGZ1
bmN0aW9uKG9iaikgewogICAgcmV0dXJuIF8uaXNBcnJheShvYmopID8gb2JqLnNs
aWNlKCkgOiBfLmV4dGVuZCh7fSwgb2JqKTsKICB9OwoKICAvLyBJbnZva2VzIGlu
dGVyY2VwdG9yIHdpdGggdGhlIG9iaiwgYW5kIHRoZW4gcmV0dXJucyBvYmouCiAg
Ly8gVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byAidGFw
IGludG8iIGEgbWV0aG9kIGNoYWluLCBpbgogIC8vIG9yZGVyIHRvIHBlcmZvcm0g
b3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNo
YWluLgogIF8udGFwID0gZnVuY3Rpb24ob2JqLCBpbnRlcmNlcHRvcikgewogICAg
aW50ZXJjZXB0b3Iob2JqKTsKICAgIHJldHVybiBvYmo7CiAgfTsKCiAgLy8gUGVy
Zm9ybSBhIGRlZXAgY29tcGFyaXNvbiB0byBjaGVjayBpZiB0d28gb2JqZWN0cyBh
cmUgZXF1YWwuCiAgXy5pc0VxdWFsID0gZnVuY3Rpb24oYSwgYikgewogICAgLy8g
Q2hlY2sgb2JqZWN0IGlkZW50aXR5LgogICAgaWYgKGEgPT09IGIpIHJldHVybiB0
cnVlOwogICAgLy8gRGlmZmVyZW50IHR5cGVzPwogICAgdmFyIGF0eXBlID0gdHlw
ZW9mKGEpLCBidHlwZSA9IHR5cGVvZihiKTsKICAgIGlmIChhdHlwZSAhPSBidHlw
ZSkgcmV0dXJuIGZhbHNlOwogICAgLy8gQmFzaWMgZXF1YWxpdHkgdGVzdCAod2F0
Y2ggb3V0IGZvciBjb2VyY2lvbnMpLgogICAgaWYgKGEgPT0gYikgcmV0dXJuIHRy
dWU7CiAgICAvLyBPbmUgaXMgZmFsc3kgYW5kIHRoZSBvdGhlciB0cnV0aHkuCiAg
ICBpZiAoKCFhICYmIGIpIHx8IChhICYmICFiKSkgcmV0dXJuIGZhbHNlOwogICAg
Ly8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuCiAgICBpZiAoYS5fY2hhaW4p
IGEgPSBhLl93cmFwcGVkOwogICAgaWYgKGIuX2NoYWluKSBiID0gYi5fd3JhcHBl
ZDsKICAgIC8vIE9uZSBvZiB0aGVtIGltcGxlbWVudHMgYW4gaXNFcXVhbCgpPwog
ICAgaWYgKGEuaXNFcXVhbCkgcmV0dXJuIGEuaXNFcXVhbChiKTsKICAgIC8vIENo
ZWNrIGRhdGVzJyBpbnRlZ2VyIHZhbHVlcy4KICAgIGlmIChfLmlzRGF0ZShhKSAm
JiBfLmlzRGF0ZShiKSkgcmV0dXJuIGEuZ2V0VGltZSgpID09PSBiLmdldFRpbWUo
KTsKICAgIC8vIEJvdGggYXJlIE5hTj8KICAgIGlmIChfLmlzTmFOKGEpICYmIF8u
aXNOYU4oYikpIHJldHVybiBmYWxzZTsKICAgIC8vIENvbXBhcmUgcmVndWxhciBl
eHByZXNzaW9ucy4KICAgIGlmIChfLmlzUmVnRXhwKGEpICYmIF8uaXNSZWdFeHAo
YikpCiAgICAgIHJldHVybiBhLnNvdXJjZSAgICAgPT09IGIuc291cmNlICYmCiAg
ICAgICAgICAgICBhLmdsb2JhbCAgICAgPT09IGIuZ2xvYmFsICYmCiAgICAgICAg
ICAgICBhLmlnbm9yZUNhc2UgPT09IGIuaWdub3JlQ2FzZSAmJgogICAgICAgICAg
ICAgYS5tdWx0aWxpbmUgID09PSBiLm11bHRpbGluZTsKICAgIC8vIElmIGEgaXMg
bm90IGFuIG9iamVjdCBieSB0aGlzIHBvaW50LCB3ZSBjYW4ndCBoYW5kbGUgaXQu
CiAgICBpZiAoYXR5cGUgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7CiAgICAv
LyBDaGVjayBmb3IgZGlmZmVyZW50IGFycmF5IGxlbmd0aHMgYmVmb3JlIGNvbXBh
cmluZyBjb250ZW50cy4KICAgIGlmIChhLmxlbmd0aCAmJiAoYS5sZW5ndGggIT09
IGIubGVuZ3RoKSkgcmV0dXJuIGZhbHNlOwogICAgLy8gTm90aGluZyBlbHNlIHdv
cmtlZCwgZGVlcCBjb21wYXJlIHRoZSBjb250ZW50cy4KICAgIHZhciBhS2V5cyA9
IF8ua2V5cyhhKSwgYktleXMgPSBfLmtleXMoYik7CiAgICAvLyBEaWZmZXJlbnQg
b2JqZWN0IHNpemVzPwogICAgaWYgKGFLZXlzLmxlbmd0aCAhPSBiS2V5cy5sZW5n
dGgpIHJldHVybiBmYWxzZTsKICAgIC8vIFJlY3Vyc2l2ZSBjb21wYXJpc29uIG9m
IGNvbnRlbnRzLgogICAgZm9yICh2YXIga2V5IGluIGEpIGlmICghKGtleSBpbiBi
KSB8fCAhXy5pc0VxdWFsKGFba2V5XSwgYltrZXldKSkgcmV0dXJuIGZhbHNlOwog
ICAgcmV0dXJuIHRydWU7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiBhcnJheSBvciBv
YmplY3QgZW1wdHk/CiAgXy5pc0VtcHR5ID0gZnVuY3Rpb24ob2JqKSB7CiAgICBp
ZiAoXy5pc0FycmF5KG9iaikgfHwgXy5pc1N0cmluZyhvYmopKSByZXR1cm4gb2Jq
Lmxlbmd0aCA9PT0gMDsKICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChoYXNP
d25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgcmV0dXJuIGZhbHNlOwogICAgcmV0
dXJuIHRydWU7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIERPTSBlbGVt
ZW50PwogIF8uaXNFbGVtZW50ID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4g
ISEob2JqICYmIG9iai5ub2RlVHlwZSA9PSAxKTsKICB9OwoKICAvLyBJcyBhIGdp
dmVuIHZhbHVlIGFuIGFycmF5PwogIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5h
dGl2ZSBBcnJheS5pc0FycmF5CiAgXy5pc0FycmF5ID0gbmF0aXZlSXNBcnJheSB8
fCBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikg
PT09ICdbb2JqZWN0IEFycmF5XSc7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YXJp
YWJsZSBhbiBhcmd1bWVudHMgb2JqZWN0PwogIF8uaXNBcmd1bWVudHMgPSBmdW5j
dGlvbihvYmopIHsKICAgIHJldHVybiAhIShvYmogJiYgaGFzT3duUHJvcGVydHku
Y2FsbChvYmosICdjYWxsZWUnKSk7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1
ZSBhIGZ1bmN0aW9uPwogIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikgewog
ICAgcmV0dXJuICEhKG9iaiAmJiBvYmouY29uc3RydWN0b3IgJiYgb2JqLmNhbGwg
JiYgb2JqLmFwcGx5KTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgc3Ry
aW5nPwogIF8uaXNTdHJpbmcgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiAh
IShvYmogPT09ICcnIHx8IChvYmogJiYgb2JqLmNoYXJDb2RlQXQgJiYgb2JqLnN1
YnN0cikpOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYSBudW1iZXI/CiAg
Xy5pc051bWJlciA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiA9
PT0gMCB8fCAob2JqICYmIG9iai50b0V4cG9uZW50aWFsICYmIG9iai50b0ZpeGVk
KSk7CiAgfTsKCiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyBgTmFOYCBo
YXBwZW5zIHRvIGJlIHRoZSBvbmx5IHZhbHVlIGluIEphdmFTY3JpcHQKICAvLyB0
aGF0IGRvZXMgbm90IGVxdWFsIGl0c2VsZi4KICBfLmlzTmFOID0gZnVuY3Rpb24o
b2JqKSB7CiAgICByZXR1cm4gb2JqICE9PSBvYmo7CiAgfTsKCiAgLy8gSXMgYSBn
aXZlbiB2YWx1ZSBhIGJvb2xlYW4/CiAgXy5pc0Jvb2xlYW4gPSBmdW5jdGlvbihv
YmopIHsKICAgIHJldHVybiBvYmogPT09IHRydWUgfHwgb2JqID09PSBmYWxzZTsK
ICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgZGF0ZT8KICBfLmlzRGF0ZSA9
IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmouZ2V0VGlt
ZXpvbmVPZmZzZXQgJiYgb2JqLnNldFVUQ0Z1bGxZZWFyKTsKICB9OwoKICAvLyBJ
cyB0aGUgZ2l2ZW4gdmFsdWUgYSByZWd1bGFyIGV4cHJlc3Npb24/CiAgXy5pc1Jl
Z0V4cCA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmou
dGVzdCAmJiBvYmouZXhlYyAmJiAob2JqLmlnbm9yZUNhc2UgfHwgb2JqLmlnbm9y
ZUNhc2UgPT09IGZhbHNlKSk7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBl
cXVhbCB0byBudWxsPwogIF8uaXNOdWxsID0gZnVuY3Rpb24ob2JqKSB7CiAgICBy
ZXR1cm4gb2JqID09PSBudWxsOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFyaWFi
bGUgdW5kZWZpbmVkPwogIF8uaXNVbmRlZmluZWQgPSBmdW5jdGlvbihvYmopIHsK
ICAgIHJldHVybiBvYmogPT09IHZvaWQgMDsKICB9OwoKICAvLyBVdGlsaXR5IEZ1
bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIFJ1biBVbmRlcnNj
b3JlLmpzIGluICpub0NvbmZsaWN0KiBtb2RlLCByZXR1cm5pbmcgdGhlIGBfYCB2
YXJpYWJsZSB0byBpdHMKICAvLyBwcmV2aW91cyBvd25lci4gUmV0dXJucyBhIHJl
ZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuCiAgXy5ub0NvbmZsaWN0
ID0gZnVuY3Rpb24oKSB7CiAgICByb290Ll8gPSBwcmV2aW91c1VuZGVyc2NvcmU7
CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvLyBLZWVwIHRoZSBpZGVudGl0eSBm
dW5jdGlvbiBhcm91bmQgZm9yIGRlZmF1bHQgaXRlcmF0b3JzLgogIF8uaWRlbnRp
dHkgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlOwogIH07Cgog
IC8vIFJ1biBhIGZ1bmN0aW9uICoqbioqIHRpbWVzLgogIF8udGltZXMgPSBmdW5j
dGlvbiAobiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGZvciAodmFyIGkgPSAw
OyBpIDwgbjsgaSsrKSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGkpOwogIH07Cgog
IC8vIEFkZCB5b3VyIG93biBjdXN0b20gZnVuY3Rpb25zIHRvIHRoZSBVbmRlcnNj
b3JlIG9iamVjdCwgZW5zdXJpbmcgdGhhdAogIC8vIHRoZXkncmUgY29ycmVjdGx5
IGFkZGVkIHRvIHRoZSBPT1Agd3JhcHBlciBhcyB3ZWxsLgogIF8ubWl4aW4gPSBm
dW5jdGlvbihvYmopIHsKICAgIGVhY2goXy5mdW5jdGlvbnMob2JqKSwgZnVuY3Rp
b24obmFtZSl7CiAgICAgIGFkZFRvV3JhcHBlcihuYW1lLCBfW25hbWVdID0gb2Jq
W25hbWVdKTsKICAgIH0pOwogIH07CgogIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGlu
dGVnZXIgaWQgKHVuaXF1ZSB3aXRoaW4gdGhlIGVudGlyZSBjbGllbnQgc2Vzc2lv
bikuCiAgLy8gVXNlZnVsIGZvciB0ZW1wb3JhcnkgRE9NIGlkcy4KICB2YXIgaWRD
b3VudGVyID0gMDsKICBfLnVuaXF1ZUlkID0gZnVuY3Rpb24ocHJlZml4KSB7CiAg
ICB2YXIgaWQgPSBpZENvdW50ZXIrKzsKICAgIHJldHVybiBwcmVmaXggPyBwcmVm
aXggKyBpZCA6IGlkOwogIH07CgogIC8vIEJ5IGRlZmF1bHQsIFVuZGVyc2NvcmUg
dXNlcyBFUkItc3R5bGUgdGVtcGxhdGUgZGVsaW1pdGVycywgY2hhbmdlIHRoZQog
IC8vIGZvbGxvd2luZyB0ZW1wbGF0ZSBzZXR0aW5ncyB0byB1c2UgYWx0ZXJuYXRp
dmUgZGVsaW1pdGVycy4KICBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7CiAgICBldmFs
dWF0ZSAgICA6IC88JShbXHNcU10rPyklPi9nLAogICAgaW50ZXJwb2xhdGUgOiAv
PCU9KFtcc1xTXSs/KSU+L2cKICB9OwoKICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRl
bXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9u
LgogIC8vIFVuZGVyc2NvcmUgdGVtcGxhdGluZyBoYW5kbGVzIGFyYml0cmFyeSBk
ZWxpbWl0ZXJzLCBwcmVzZXJ2ZXMgd2hpdGVzcGFjZSwKICAvLyBhbmQgY29ycmVj
dGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS4KICBf
LnRlbXBsYXRlID0gZnVuY3Rpb24oc3RyLCBkYXRhKSB7CiAgICB2YXIgYyAgPSBf
LnRlbXBsYXRlU2V0dGluZ3M7CiAgICB2YXIgdG1wbCA9ICd2YXIgX19wPVtdLHBy
aW50PWZ1bmN0aW9uKCl7X19wLnB1c2guYXBwbHkoX19wLGFyZ3VtZW50cyk7fTsn
ICsKICAgICAgJ3dpdGgob2JqfHx7fSl7X19wLnB1c2goXCcnICsKICAgICAgc3Ry
LnJlcGxhY2UoL1xcL2csICdcXFxcJykKICAgICAgICAgLnJlcGxhY2UoLycvZywg
IlxcJyIpCiAgICAgICAgIC5yZXBsYWNlKGMuaW50ZXJwb2xhdGUsIGZ1bmN0aW9u
KG1hdGNoLCBjb2RlKSB7CiAgICAgICAgICAgcmV0dXJuICInLCIgKyBjb2RlLnJl
cGxhY2UoL1xcJy9nLCAiJyIpICsgIiwnIjsKICAgICAgICAgfSkKICAgICAgICAg
LnJlcGxhY2UoYy5ldmFsdWF0ZSB8fCBudWxsLCBmdW5jdGlvbihtYXRjaCwgY29k
ZSkgewogICAgICAgICAgIHJldHVybiAiJyk7IiArIGNvZGUucmVwbGFjZSgvXFwn
L2csICInIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2Uo
L1tcclxuXHRdL2csICcgJykgKyAiX19wLnB1c2goJyI7CiAgICAgICAgIH0pCiAg
ICAgICAgIC5yZXBsYWNlKC9cci9nLCAnXFxyJykKICAgICAgICAgLnJlcGxhY2Uo
L1xuL2csICdcXG4nKQogICAgICAgICAucmVwbGFjZSgvXHQvZywgJ1xcdCcpCiAg
ICAgICAgICsgIicpO31yZXR1cm4gX19wLmpvaW4oJycpOyI7CiAgICB2YXIgZnVu
YyA9IG5ldyBGdW5jdGlvbignb2JqJywgdG1wbCk7CiAgICByZXR1cm4gZGF0YSA/
IGZ1bmMoZGF0YSkgOiBmdW5jOwogIH07CgogIC8vIFRoZSBPT1AgV3JhcHBlcgog
IC8vIC0tLS0tLS0tLS0tLS0tLQoKICAvLyBJZiBVbmRlcnNjb3JlIGlzIGNhbGxl
ZCBhcyBhIGZ1bmN0aW9uLCBpdCByZXR1cm5zIGEgd3JhcHBlZCBvYmplY3QgdGhh
dAogIC8vIGNhbiBiZSB1c2VkIE9PLXN0eWxlLiBUaGlzIHdyYXBwZXIgaG9sZHMg
YWx0ZXJlZCB2ZXJzaW9ucyBvZiBhbGwgdGhlCiAgLy8gdW5kZXJzY29yZSBmdW5j
dGlvbnMuIFdyYXBwZWQgb2JqZWN0cyBtYXkgYmUgY2hhaW5lZC4KICB2YXIgd3Jh
cHBlciA9IGZ1bmN0aW9uKG9iaikgeyB0aGlzLl93cmFwcGVkID0gb2JqOyB9OwoK
ICAvLyBFeHBvc2UgYHdyYXBwZXIucHJvdG90eXBlYCBhcyBgXy5wcm90b3R5cGVg
CiAgXy5wcm90b3R5cGUgPSB3cmFwcGVyLnByb3RvdHlwZTsKCiAgLy8gSGVscGVy
IGZ1bmN0aW9uIHRvIGNvbnRpbnVlIGNoYWluaW5nIGludGVybWVkaWF0ZSByZXN1
bHRzLgogIHZhciByZXN1bHQgPSBmdW5jdGlvbihvYmosIGNoYWluKSB7CiAgICBy
ZXR1cm4gY2hhaW4gPyBfKG9iaikuY2hhaW4oKSA6IG9iajsKICB9OwoKICAvLyBB
IG1ldGhvZCB0byBlYXNpbHkgYWRkIGZ1bmN0aW9ucyB0byB0aGUgT09QIHdyYXBw
ZXIuCiAgdmFyIGFkZFRvV3JhcHBlciA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpIHsK
ICAgIHdyYXBwZXIucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7CiAgICAg
IHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAgICB1bnNoaWZ0
LmNhbGwoYXJncywgdGhpcy5fd3JhcHBlZCk7CiAgICAgIHJldHVybiByZXN1bHQo
ZnVuYy5hcHBseShfLCBhcmdzKSwgdGhpcy5fY2hhaW4pOwogICAgfTsKICB9OwoK
ICAvLyBBZGQgYWxsIG9mIHRoZSBVbmRlcnNjb3JlIGZ1bmN0aW9ucyB0byB0aGUg
d3JhcHBlciBvYmplY3QuCiAgXy5taXhpbihfKTsKCiAgLy8gQWRkIGFsbCBtdXRh
dG9yIEFycmF5IGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlci4KICBlYWNoKFsncG9w
JywgJ3B1c2gnLCAncmV2ZXJzZScsICdzaGlmdCcsICdzb3J0JywgJ3NwbGljZScs
ICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBtZXRob2QgPSBB
cnJheVByb3RvW25hbWVdOwogICAgd3JhcHBlci5wcm90b3R5cGVbbmFtZV0gPSBm
dW5jdGlvbigpIHsKICAgICAgbWV0aG9kLmFwcGx5KHRoaXMuX3dyYXBwZWQsIGFy
Z3VtZW50cyk7CiAgICAgIHJldHVybiByZXN1bHQodGhpcy5fd3JhcHBlZCwgdGhp
cy5fY2hhaW4pOwogICAgfTsKICB9KTsKCiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBB
cnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuCiAgZWFjaChbJ2NvbmNhdCcs
ICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBtZXRo
b2QgPSBBcnJheVByb3RvW25hbWVdOwogICAgd3JhcHBlci5wcm90b3R5cGVbbmFt
ZV0gPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHJlc3VsdChtZXRob2QuYXBw
bHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSwgdGhpcy5fY2hhaW4pOwogICAg
fTsKICB9KTsKCiAgLy8gU3RhcnQgY2hhaW5pbmcgYSB3cmFwcGVkIFVuZGVyc2Nv
cmUgb2JqZWN0LgogIHdyYXBwZXIucHJvdG90eXBlLmNoYWluID0gZnVuY3Rpb24o
KSB7CiAgICB0aGlzLl9jaGFpbiA9IHRydWU7CiAgICByZXR1cm4gdGhpczsKICB9
OwoKICAvLyBFeHRyYWN0cyB0aGUgcmVzdWx0IGZyb20gYSB3cmFwcGVkIGFuZCBj
aGFpbmVkIG9iamVjdC4KICB3cmFwcGVyLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0
aW9uKCkgewogICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7CiAgfTsKCn0pKCk7Cg==

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=doctools.js
Content-Type: application/javascript; name=doctools.js
Content-Location: http://pygame.info/docs/_static/doctools.js
Content-Transfer-Encoding: Base64

LyoKICogZG9jdG9vbHMuanMKICogfn5+fn5+fn5+fn4KICoKICogU3BoaW54IEph
dmFTY3JpcHQgdXRpbGl0aWVzIGZvciBhbGwgZG9jdW1lbnRhdGlvbi4KICoKICog
OmNvcHlyaWdodDogQ29weXJpZ2h0IDIwMDctMjAxMSBieSB0aGUgU3BoaW54IHRl
YW0sIHNlZSBBVVRIT1JTLgogKiA6bGljZW5zZTogQlNELCBzZWUgTElDRU5TRSBm
b3IgZGV0YWlscy4KICoKICovCgovKioKICogc2VsZWN0IGEgZGlmZmVyZW50IHBy
ZWZpeCBmb3IgdW5kZXJzY29yZQogKi8KJHUgPSBfLm5vQ29uZmxpY3QoKTsKCi8q
KgogKiBtYWtlIHRoZSBjb2RlIGJlbG93IGNvbXBhdGlibGUgd2l0aCBicm93c2Vy
cyB3aXRob3V0CiAqIGFuIGluc3RhbGxlZCBmaXJlYnVnIGxpa2UgZGVidWdnZXIK
aWYgKCF3aW5kb3cuY29uc29sZSB8fCAhY29uc29sZS5maXJlYnVnKSB7CiAgdmFy
IG5hbWVzID0gWyJsb2ciLCAiZGVidWciLCAiaW5mbyIsICJ3YXJuIiwgImVycm9y
IiwgImFzc2VydCIsICJkaXIiLAogICAgImRpcnhtbCIsICJncm91cCIsICJncm91
cEVuZCIsICJ0aW1lIiwgInRpbWVFbmQiLCAiY291bnQiLCAidHJhY2UiLAogICAg
InByb2ZpbGUiLCAicHJvZmlsZUVuZCJdOwogIHdpbmRvdy5jb25zb2xlID0ge307
CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBuYW1lcy5sZW5ndGg7ICsraSkKICAgIHdp
bmRvdy5jb25zb2xlW25hbWVzW2ldXSA9IGZ1bmN0aW9uKCkge307Cn0KICovCgov
KioKICogc21hbGwgaGVscGVyIGZ1bmN0aW9uIHRvIHVybGRlY29kZSBzdHJpbmdz
CiAqLwpqUXVlcnkudXJsZGVjb2RlID0gZnVuY3Rpb24oeCkgewogIHJldHVybiBk
ZWNvZGVVUklDb21wb25lbnQoeCkucmVwbGFjZSgvXCsvZywgJyAnKTsKfQoKLyoq
CiAqIHNtYWxsIGhlbHBlciBmdW5jdGlvbiB0byB1cmxlbmNvZGUgc3RyaW5ncwog
Ki8KalF1ZXJ5LnVybGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDsKCi8qKgog
KiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgdGhlIHBhcnNlZCB1cmwgcGFyYW1ldGVy
cyBvZiB0aGUKICogY3VycmVudCByZXF1ZXN0LiBNdWx0aXBsZSB2YWx1ZXMgcGVy
IGtleSBhcmUgc3VwcG9ydGVkLAogKiBpdCB3aWxsIGFsd2F5cyByZXR1cm4gYXJy
YXlzIG9mIHN0cmluZ3MgZm9yIHRoZSB2YWx1ZSBwYXJ0cy4KICovCmpRdWVyeS5n
ZXRRdWVyeVBhcmFtZXRlcnMgPSBmdW5jdGlvbihzKSB7CiAgaWYgKHR5cGVvZiBz
ID09ICd1bmRlZmluZWQnKQogICAgcyA9IGRvY3VtZW50LmxvY2F0aW9uLnNlYXJj
aDsKICB2YXIgcGFydHMgPSBzLnN1YnN0cihzLmluZGV4T2YoJz8nKSArIDEpLnNw
bGl0KCcmJyk7CiAgdmFyIHJlc3VsdCA9IHt9OwogIGZvciAodmFyIGkgPSAwOyBp
IDwgcGFydHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciB0bXAgPSBwYXJ0c1tpXS5z
cGxpdCgnPScsIDIpOwogICAgdmFyIGtleSA9IGpRdWVyeS51cmxkZWNvZGUodG1w
WzBdKTsKICAgIHZhciB2YWx1ZSA9IGpRdWVyeS51cmxkZWNvZGUodG1wWzFdKTsK
ICAgIGlmIChrZXkgaW4gcmVzdWx0KQogICAgICByZXN1bHRba2V5XS5wdXNoKHZh
bHVlKTsKICAgIGVsc2UKICAgICAgcmVzdWx0W2tleV0gPSBbdmFsdWVdOwogIH0K
ICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqCiAqIHNtYWxsIGZ1bmN0aW9uIHRvIGNo
ZWNrIGlmIGFuIGFycmF5IGNvbnRhaW5zCiAqIGEgZ2l2ZW4gaXRlbS4KICovCmpR
dWVyeS5jb250YWlucyA9IGZ1bmN0aW9uKGFyciwgaXRlbSkgewogIGZvciAodmFy
IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAoYXJyW2ldID09
IGl0ZW0pCiAgICAgIHJldHVybiB0cnVlOwogIH0KICByZXR1cm4gZmFsc2U7Cn07
CgovKioKICogaGlnaGxpZ2h0IGEgZ2l2ZW4gc3RyaW5nIG9uIGEganF1ZXJ5IG9i
amVjdCBieSB3cmFwcGluZyBpdCBpbgogKiBzcGFuIGVsZW1lbnRzIHdpdGggdGhl
IGdpdmVuIGNsYXNzIG5hbWUuCiAqLwpqUXVlcnkuZm4uaGlnaGxpZ2h0VGV4dCA9
IGZ1bmN0aW9uKHRleHQsIGNsYXNzTmFtZSkgewogIGZ1bmN0aW9uIGhpZ2hsaWdo
dChub2RlKSB7CiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAzKSB7CiAgICAgIHZh
ciB2YWwgPSBub2RlLm5vZGVWYWx1ZTsKICAgICAgdmFyIHBvcyA9IHZhbC50b0xv
d2VyQ2FzZSgpLmluZGV4T2YodGV4dCk7CiAgICAgIGlmIChwb3MgPj0gMCAmJiAh
alF1ZXJ5KG5vZGUucGFyZW50Tm9kZSkuaGFzQ2xhc3MoY2xhc3NOYW1lKSkgewog
ICAgICAgIHZhciBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIp
OwogICAgICAgIHNwYW4uY2xhc3NOYW1lID0gY2xhc3NOYW1lOwogICAgICAgIHNw
YW4uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodmFsLnN1YnN0
cihwb3MsIHRleHQubGVuZ3RoKSkpOwogICAgICAgIG5vZGUucGFyZW50Tm9kZS5p
bnNlcnRCZWZvcmUoc3Bhbiwgbm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSgK
ICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHZhbC5zdWJzdHIocG9z
ICsgdGV4dC5sZW5ndGgpKSwKICAgICAgICAgIG5vZGUubmV4dFNpYmxpbmcpKTsK
ICAgICAgICBub2RlLm5vZGVWYWx1ZSA9IHZhbC5zdWJzdHIoMCwgcG9zKTsKICAg
ICAgfQogICAgfQogICAgZWxzZSBpZiAoIWpRdWVyeShub2RlKS5pcygiYnV0dG9u
LCBzZWxlY3QsIHRleHRhcmVhIikpIHsKICAgICAgalF1ZXJ5LmVhY2gobm9kZS5j
aGlsZE5vZGVzLCBmdW5jdGlvbigpIHsKICAgICAgICBoaWdobGlnaHQodGhpcyk7
CiAgICAgIH0pOwogICAgfQogIH0KICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9u
KCkgewogICAgaGlnaGxpZ2h0KHRoaXMpOwogIH0pOwp9OwoKLyoqCiAqIFNtYWxs
IEphdmFTY3JpcHQgbW9kdWxlIGZvciB0aGUgZG9jdW1lbnRhdGlvbi4KICovCnZh
ciBEb2N1bWVudGF0aW9uID0gewoKICBpbml0IDogZnVuY3Rpb24oKSB7CiAgICB0
aGlzLmZpeEZpcmVmb3hBbmNob3JCdWcoKTsKICAgIHRoaXMuaGlnaGxpZ2h0U2Vh
cmNoV29yZHMoKTsKICAgIHRoaXMuaW5pdEluZGV4VGFibGUoKTsKICB9LAoKICAv
KioKICAgKiBpMThuIHN1cHBvcnQKICAgKi8KICBUUkFOU0xBVElPTlMgOiB7fSwK
ICBQTFVSQUxfRVhQUiA6IGZ1bmN0aW9uKG4pIHsgcmV0dXJuIG4gPT0gMSA/IDAg
OiAxOyB9LAogIExPQ0FMRSA6ICd1bmtub3duJywKCiAgLy8gZ2V0dGV4dCBhbmQg
bmdldHRleHQgZG9uJ3QgYWNjZXNzIHRoaXMgc28gdGhhdCB0aGUgZnVuY3Rpb25z
CiAgLy8gY2FuIHNhZmVseSBib3VuZCB0byBhIGRpZmZlcmVudCBuYW1lIChfID0g
RG9jdW1lbnRhdGlvbi5nZXR0ZXh0KQogIGdldHRleHQgOiBmdW5jdGlvbihzdHJp
bmcpIHsKICAgIHZhciB0cmFuc2xhdGVkID0gRG9jdW1lbnRhdGlvbi5UUkFOU0xB
VElPTlNbc3RyaW5nXTsKICAgIGlmICh0eXBlb2YgdHJhbnNsYXRlZCA9PSAndW5k
ZWZpbmVkJykKICAgICAgcmV0dXJuIHN0cmluZzsKICAgIHJldHVybiAodHlwZW9m
IHRyYW5zbGF0ZWQgPT0gJ3N0cmluZycpID8gdHJhbnNsYXRlZCA6IHRyYW5zbGF0
ZWRbMF07CiAgfSwKCiAgbmdldHRleHQgOiBmdW5jdGlvbihzaW5ndWxhciwgcGx1
cmFsLCBuKSB7CiAgICB2YXIgdHJhbnNsYXRlZCA9IERvY3VtZW50YXRpb24uVFJB
TlNMQVRJT05TW3Npbmd1bGFyXTsKICAgIGlmICh0eXBlb2YgdHJhbnNsYXRlZCA9
PSAndW5kZWZpbmVkJykKICAgICAgcmV0dXJuIChuID09IDEpID8gc2luZ3VsYXIg
OiBwbHVyYWw7CiAgICByZXR1cm4gdHJhbnNsYXRlZFtEb2N1bWVudGF0aW9uLlBM
VVJBTEVYUFIobildOwogIH0sCgogIGFkZFRyYW5zbGF0aW9ucyA6IGZ1bmN0aW9u
KGNhdGFsb2cpIHsKICAgIGZvciAodmFyIGtleSBpbiBjYXRhbG9nLm1lc3NhZ2Vz
KQogICAgICB0aGlzLlRSQU5TTEFUSU9OU1trZXldID0gY2F0YWxvZy5tZXNzYWdl
c1trZXldOwogICAgdGhpcy5QTFVSQUxfRVhQUiA9IG5ldyBGdW5jdGlvbignbics
ICdyZXR1cm4gKygnICsgY2F0YWxvZy5wbHVyYWxfZXhwciArICcpJyk7CiAgICB0
aGlzLkxPQ0FMRSA9IGNhdGFsb2cubG9jYWxlOwogIH0sCgogIC8qKgogICAqIGFk
ZCBjb250ZXh0IGVsZW1lbnRzIGxpa2UgaGVhZGVyIGFuY2hvciBsaW5rcwogICAq
LwogIGFkZENvbnRleHRFbGVtZW50cyA6IGZ1bmN0aW9uKCkgewogICAgJCgnZGl2
W2lkXSA+IDpoZWFkZXI6Zmlyc3QnKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAk
KCc8YSBjbGFzcz0iaGVhZGVybGluayI+XHUwMEI2PC9hPicpLgogICAgICBhdHRy
KCdocmVmJywgJyMnICsgdGhpcy5pZCkuCiAgICAgIGF0dHIoJ3RpdGxlJywgXygn
UGVybWFsaW5rIHRvIHRoaXMgaGVhZGxpbmUnKSkuCiAgICAgIGFwcGVuZFRvKHRo
aXMpOwogICAgfSk7CiAgICAkKCdkdFtpZF0nKS5lYWNoKGZ1bmN0aW9uKCkgewog
ICAgICAkKCc8YSBjbGFzcz0iaGVhZGVybGluayI+XHUwMEI2PC9hPicpLgogICAg
ICBhdHRyKCdocmVmJywgJyMnICsgdGhpcy5pZCkuCiAgICAgIGF0dHIoJ3RpdGxl
JywgXygnUGVybWFsaW5rIHRvIHRoaXMgZGVmaW5pdGlvbicpKS4KICAgICAgYXBw
ZW5kVG8odGhpcyk7CiAgICB9KTsKICB9LAoKICAvKioKICAgKiB3b3JrYXJvdW5k
IGEgZmlyZWZveCBzdHVwaWRpdHkKICAgKi8KICBmaXhGaXJlZm94QW5jaG9yQnVn
IDogZnVuY3Rpb24oKSB7CiAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24uaGFzaCAm
JiAkLmJyb3dzZXIubW96aWxsYSkKICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVu
Y3Rpb24oKSB7CiAgICAgICAgZG9jdW1lbnQubG9jYXRpb24uaHJlZiArPSAnJzsK
ICAgICAgfSwgMTApOwogIH0sCgogIC8qKgogICAqIGhpZ2hsaWdodCB0aGUgc2Vh
cmNoIHdvcmRzIHByb3ZpZGVkIGluIHRoZSB1cmwgaW4gdGhlIHRleHQKICAgKi8K
ICBoaWdobGlnaHRTZWFyY2hXb3JkcyA6IGZ1bmN0aW9uKCkgewogICAgdmFyIHBh
cmFtcyA9ICQuZ2V0UXVlcnlQYXJhbWV0ZXJzKCk7CiAgICB2YXIgdGVybXMgPSAo
cGFyYW1zLmhpZ2hsaWdodCkgPyBwYXJhbXMuaGlnaGxpZ2h0WzBdLnNwbGl0KC9c
cysvKSA6IFtdOwogICAgaWYgKHRlcm1zLmxlbmd0aCkgewogICAgICB2YXIgYm9k
eSA9ICQoJ2Rpdi5ib2R5Jyk7CiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0
aW9uKCkgewogICAgICAgICQuZWFjaCh0ZXJtcywgZnVuY3Rpb24oKSB7CiAgICAg
ICAgICBib2R5LmhpZ2hsaWdodFRleHQodGhpcy50b0xvd2VyQ2FzZSgpLCAnaGln
aGxpZ2h0ZWQnKTsKICAgICAgICB9KTsKICAgICAgfSwgMTApOwogICAgICAkKCc8
cCBjbGFzcz0iaGlnaGxpZ2h0LWxpbmsiPjxhIGhyZWY9ImphdmFzY3JpcHQ6RG9j
dW1lbnRhdGlvbi4nICsKICAgICAgICAnaGlkZVNlYXJjaFdvcmRzKCkiPicgKyBf
KCdIaWRlIFNlYXJjaCBNYXRjaGVzJykgKyAnPC9hPjwvcD4nKQogICAgICAgICAg
LmFwcGVuZFRvKCQoJyNzZWFyY2hib3gnKSk7CiAgICB9CiAgfSwKCiAgLyoqCiAg
ICogaW5pdCB0aGUgZG9tYWluIGluZGV4IHRvZ2dsZSBidXR0b25zCiAgICovCiAg
aW5pdEluZGV4VGFibGUgOiBmdW5jdGlvbigpIHsKICAgIHZhciB0b2dnbGVycyA9
ICQoJ2ltZy50b2dnbGVyJykuY2xpY2soZnVuY3Rpb24oKSB7CiAgICAgIHZhciBz
cmMgPSAkKHRoaXMpLmF0dHIoJ3NyYycpOwogICAgICB2YXIgaWRudW0gPSAkKHRo
aXMpLmF0dHIoJ2lkJykuc3Vic3RyKDcpOwogICAgICAkKCd0ci5jZy0nICsgaWRu
dW0pLnRvZ2dsZSgpOwogICAgICBpZiAoc3JjLnN1YnN0cigtOSkgPT0gJ21pbnVz
LnBuZycpCiAgICAgICAgJCh0aGlzKS5hdHRyKCdzcmMnLCBzcmMuc3Vic3RyKDAs
IHNyYy5sZW5ndGgtOSkgKyAncGx1cy5wbmcnKTsKICAgICAgZWxzZQogICAgICAg
ICQodGhpcykuYXR0cignc3JjJywgc3JjLnN1YnN0cigwLCBzcmMubGVuZ3RoLTgp
ICsgJ21pbnVzLnBuZycpOwogICAgfSkuY3NzKCdkaXNwbGF5JywgJycpOwogICAg
aWYgKERPQ1VNRU5UQVRJT05fT1BUSU9OUy5DT0xMQVBTRV9JTkRFWCkgewogICAg
ICAgIHRvZ2dsZXJzLmNsaWNrKCk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogaGVs
cGVyIGZ1bmN0aW9uIHRvIGhpZGUgdGhlIHNlYXJjaCBtYXJrcyBhZ2FpbgogICAq
LwogIGhpZGVTZWFyY2hXb3JkcyA6IGZ1bmN0aW9uKCkgewogICAgJCgnI3NlYXJj
aGJveCAuaGlnaGxpZ2h0LWxpbmsnKS5mYWRlT3V0KDMwMCk7CiAgICAkKCdzcGFu
LmhpZ2hsaWdodGVkJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodGVkJyk7CiAgfSwK
CiAgLyoqCiAgICogbWFrZSB0aGUgdXJsIGFic29sdXRlCiAgICovCiAgbWFrZVVS
TCA6IGZ1bmN0aW9uKHJlbGF0aXZlVVJMKSB7CiAgICByZXR1cm4gRE9DVU1FTlRB
VElPTl9PUFRJT05TLlVSTF9ST09UICsgJy8nICsgcmVsYXRpdmVVUkw7CiAgfSwK
CiAgLyoqCiAgICogZ2V0IHRoZSBjdXJyZW50IHJlbGF0aXZlIHVybAogICAqLwog
IGdldEN1cnJlbnRVUkwgOiBmdW5jdGlvbigpIHsKICAgIHZhciBwYXRoID0gZG9j
dW1lbnQubG9jYXRpb24ucGF0aG5hbWU7CiAgICB2YXIgcGFydHMgPSBwYXRoLnNw
bGl0KC9cLy8pOwogICAgJC5lYWNoKERPQ1VNRU5UQVRJT05fT1BUSU9OUy5VUkxf
Uk9PVC5zcGxpdCgvXC8vKSwgZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzID09
ICcuLicpCiAgICAgICAgcGFydHMucG9wKCk7CiAgICB9KTsKICAgIHZhciB1cmwg
PSBwYXJ0cy5qb2luKCcvJyk7CiAgICByZXR1cm4gcGF0aC5zdWJzdHJpbmcodXJs
Lmxhc3RJbmRleE9mKCcvJykgKyAxLCBwYXRoLmxlbmd0aCAtIDEpOwogIH0KfTsK
Ci8vIHF1aWNrIGFsaWFzIGZvciB0cmFuc2xhdGlvbnMKXyA9IERvY3VtZW50YXRp
b24uZ2V0dGV4dDsKCiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkgewogIERv
Y3VtZW50YXRpb24uaW5pdCgpOwp9KTsK

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=pygame.ico
Content-Type: image/x-icon; name=pygame.ico
Content-Location: http://pygame.info/docs/_static/pygame.ico
Content-Transfer-Encoding: Base64

AAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAA
AAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAA
AACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAA
AAMzMzMzMzswAAAAAAAAAAADMzO7u7MzMwAAAAAAAAAAAzO7u7u7M7MAAAAAAAAA
AAMzu7u7uzOIiIAAAAAAAAADO7u7u7uIiIiIAAAAAAAAh4O7szM4eIiIiIAAAAAA
h3d3OId/d4iBF4iIAAAAAPd3d3d3eHeIiIcYiAAAAAd3cAd3CHCHgRiIEYgAAAAH
d4AAd3j3d4iIiIiIAAAAD3cACH93iIgAAIiIiAAAAAf3eAh4iDu7szN4iHAAAAAI
9/eHg7u7u7u7uIgAAAAAAH9/iLu7u7u7u7szMAAAAAAH9zu7u7u7u7u7szAAAAAA
AIA7u7u7u7u7u7O7MAAAAAAzu7u7u7u7O7uzu7MAAAAAM7u7u7u7u7u7O7u4AAAA
A7M7u7u7u7u7s7u7swAAADO7M7u7u7u7u4g7u7MAAAA7s7szu7u7s4f/87uzAAAA
M7uz/3gzMzgI//e7sAAAAAOzt/9wg7u4CP/3uzAAAAADuz//cHi7t////zswAAAA
ADs////3u7f///87MAAAAAA7P///97u3////OwAAAAAAAz////e7s///97MAAAAA
AAO4///4u7s///OzAAAAAAAAM3//87uzs4g7sAAAAAAAAAs4eDswADO7swAAAAAA
AAADO7uzAAAAAAAAAAAAAAAAAAMzAAAAAAAAAAAA/AAD//4AAf/+AAH//AAAf/wA
AB/4AAAf8AAAD+AAAA/gAAAP4AAAD8AAAA/gAAAf4AAAH+AAAB/wAAAP+AAAB/gA
AAP4AAAD8AAAA/AAAAPwAAAD8AAAA/AAAAf4AAAH+AAAB/wAAAf+AAAP/gAAD/8A
AB//ADA//4D9f//B//8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/
AAAA//8A/wAAAP8A/wD//wAA////AAAAC7u7AAAAAAALsAB3cAAAD/AP////AAD/
j///n58AAPiI8AAA8AAA/wALu7sAgAAAC7u7u7AAAIALsLsAsLAACwu7u7sLuwAL
sLu7sAO7AAuwAAMAgLgACzD4CwjwMAAAsP8LD/CwAAA7ALuwCwAAAAi7sAu7AAAA
AAAAAAAA4AcAAMADAADAAQAAgAEAAIADAACAAQAAgAAAAMAAAADAAAAAwAAAAMAA
AADAAAAA4AAAAOABAADwAQAA+GMAAA==

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=pygame_tiny.png
Content-Type: image/png; name=pygame_tiny.png
Content-Location: http://pygame.info/docs/_static/pygame_tiny.png
Content-Transfer-Encoding: Base64

iVBORw0KGgoAAAANSUhEUgAAAMgAAAA8CAYAAAAjW/WRAAAAAXNSR0IArs4c6QAA
AAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sD
HAMlLt8ht8oAACAASURBVHja7b13mF1Vvfj9WWuXU+fMmZaZlEnvPSGQBqEEAQVU
BEWwIiqKXhWVa6/o9XovqBcbiqCAFFF6EWmhhBQIkEBCek8mmWR6OW3vvdb7x95z
ysxJAoLvc/nd+T7PwMluq3x7WWvBIAzCIAzCIAzCPwNicAoG4e0IZ5757nHVsfWX
TR3Ts8S2ibf3VLir1+q7F514zs9//JNruwcZZBD+z8K8E94565Jzlt9/wTt6RkYr
a5CRGqIhm+ZWl59c2711275hH+7oqX7huWcf0X3vZNOHxeWf+8LE7ds2XVBVldw/
bPjoZR/68Mf2LFp0ih5kkEH4fwYWn31nxYXzLnvug+/qmb564xDRnDqfRPU02g6/
wryJTzFtItx2X/rgw0+YvxDm6HulGc52tO46fsGMpivnTe2eOWF8wk67CbFjL+nn
1sinN+9uuPLhvz+7fpBBBuH/CfjQ+WOu+/mVez7+wKpJoRNOu4UpU2djGBKAO/9y
C3NG/jfjRiVpbtrNvmbL27fvsB47PG0MqTXFc68OJcsUpD7IGYvTVA6Zxa9v2Nz8
zKrKxXfft2z74OwOwtsaZs0+YfEzt5utq+6y9ZOP36tzOUf3h9//8mydPXC5VvuX
6Nz2cbptjdC7noron1x1qW46cEArpXR3d4/+r//4vG7fNE2nD35IX37JhFsHZ3cQ
3vbw7X9L/q31BZm74RfzdW9Puy4HN1z/c31g3Uzt7ZmhUxvrdfc6S1/zo3N1Npsu
eS7nuPq3PztVe3tn6Ptvntjx9Ss/UVWuTTk47YPwdoDjTvz0xNMXpE4OV1ZYduJk
hLTLPlddO5HmwwqtQXsZlq81eNf7foxphkqes0yDeO3F9GY0MyeJyl07Npw8yCCD
8LaFs+Y88B/jG3OVaJNQeChClCdd27bBECA0yk1xsGM24ydMRMqB7vb0mQt57vke
hjVYNA5LTR5kkEF4W8KJi4879/zTW0+zLSzbkuRyWXRRcLarq4unn36aTCZLZ/tO
aioFKBchHazYNI4Ui6qpqeJwu4sUYKDqBhlkEN6W8K6FW348pMpJGhK055FLbwbt
5u//4Ac/4JRTTuG6635PR8s/qK0G5eUQCJSOsm/ffp544glyuRy6iLMOH25jxDAb
KWHSBO/kFc/eHxpkkEF4W8GMWQvOe+/p6cZwSAsNeI6D4TxFOt2V1yKLFi1i2rRp
OK5i9uRNWIbG8zJ4HkjRyqc//SlOP/10HnrooRIG2bh+JfNmRkELZkzSM7///R8t
6d++MYiCQfjfDBeeHfrs6fM75lumNgG0FsyYluSWv+2lcfRxPPHkY3Q2P8Pi48Dp
uh+dbWfD5l627tWs3yhY9VIzYye+k0w2yyc/+Unq6uoQQqCUZsWT32bBrG4Emtpq
0zh4OJd64pnDDxa3bw6iYBD+N8OI+p4pWmsr74SHE2hhk26/l3tv+Atnn2bQMD2K
YcURogIhEmhAaBAGnNPt8dgz9zH8w0uBgva4+Y+/4txT9yC0b0RZpmDUCBb1b3+Q
QQbhfzUcPOQZWmuEACEEnlnNb244wMXv7KJ2SB12tKZfREv7LrkArSAZk7z/LAnm
0zz67CM8+diH6exq5ZwTH2dYrYEQgQOvNRVRb/KgDzIIbyu4b1ni9hdeMXpzDoSj
Ef74lzY+cGYXNbU12NHagDn00T8iAFdzxuIISxe/hO3dzZRxpcyBMIgnY9YggwzC
2wp27Njxh8u+H9197xMGu/e5DEn0EAlBKFYDQEdHNweaWujo6C5xwAcyiQClmTwy
x4c+eiH3PNKNUjrQOSDsUTh6FG/GxEoAi4HjgJFAI2AVMZkGFNADbAMOAi8BG4Pf
x4IQcFLwFwJSwGrgH6/jXQOYD1wJvAOIAV7w/veAx98CXFUAE4CGoH8OsCkY69sV
QsBUYCYwJMDlQeA1YB2Qe5PfDwffjwTfVsAeYN+xxX6RH9I48s/bdm387mvbiZ11
ksK2wyAEWrnEohZS9bJ/7y5cp5Ga2sq8ZshlHQ63dGAYBnV1SaQUiOw+hsWzdHZ7
5NlDmJA4g9de+1Xqn2GQMcB3gQ8TFqacbiPGm5o6iag2BaG8vadJaXSzKziktN7h
oHe4gpT2gK3AvcBtwKtltNjxwPWEmCFmhbQcbQq130U/n8vi6L8AHztK/5LAl7H5
jpgfxvhwTMvJFrpVGd4dvYvUX3tvRPM14PZ+7w0HPgwsDRhdB0x1KOjjJmBDwACj
gWuwxHmizoAE6HYFh1QWzU+AH74BhFcCc4DTgRkB0zUCxbUT+4BlwG8CIfNWw7xA
mLwLSZzhJqJOgiE0B1z0AU/g0QT8CLgpEFZvRJB8HPgoMBswqZBgSej0wNMA3cAT
wHXBOI/KiCPHzl+VyWzOrtgUi0kjzZypHiCQhoU0TKzqBqRpY4djBU9Ea6RwqKkK
0dZ6iA2vtjJtxlgMwwCnhdEjbA4echhWbyFMwZ233eDd/4j4aTnr7GhS+VIEvxAz
7Yj5qQrkqWFf5pQ18nSJowQC7Witt3qo5RmhHkujX845gUb4WiClIsCnsLlGnhk1
za8mkI2mryoVWr/iCOfKtqze4d4KXFqm4QbgJww3Pm59K4k8O+zL9T4nLau1uj0l
3Ks6tgCfK9Ik7wB+z2hztHFWVIuRpkBpdIfSuslF7/HQ2xxo9gSadqBXzLIbzO9W
GvJ4W5DzVbb3t17cn3ft4aD3VeCvR5nLauAM4GLgZOIiIabYyFkWYoylGWogElII
E3Sv0mqbq9WDaanXZjtx+BJwcyB9jwV1gSYdFuDvEPA00FL0zAeAn8lTwsPleVHk
ohAiafhhHzRIiW7ytPe3Xu39qUfSoR4N5n7fMdq2gS8BX6XBqJXvjgjjlIgWUy1E
DOGbOAK910WvzeE9lkYty0BWbwZ+APyl3BgvuOCCqfVDh/x66TvOWjxq3BjrB1d9
le9+cDmzZg7HsGxez4oN5eVI9eaIVcQQwu/Kg0/0cMK8CLv3Ovzu5q723QdGfuKP
N995X2PjGP16GMQAvk1YfN/6dhLj4tgbUIjlQSut9WZXu9d2SfVoujXQSt1Uyput
byYxLooWiLuod+rFHLmLDzXh8Fng/qK7Q4D/FFPtS6xrq5ETTHAH6ibdprT7y27h
/an7ceDdwGzC4lb5gdgY65uVCFsccWy6U6E3Oqi1DqJCIN8VQdRIH40G6IMezlUd
qIfS1wBfLSf8gE8Dn6BaDjVOiyDPjSLn2ohY0K7Oy5NSbBjg3tCD+5uuFK3qc4Ek
PxIWpgNfB95DlYyL8RYiJFAbc9CqWoK+3RKYUnda30tOkBfGtAgLccQvSlB7PJwv
tqLX5VahuTAwj8rBRODP1MrjzC9VSuO8KCJ8bMLVLQr3+m68m3sgp+8HvgDs7rt/
1plnzn7P+e9dPX/xYss0Q8I0bFasXclDf76aq7+0h9FjhyDEG0zlBRbVV39wgK7u
DDGrh+c3Tb10xerXbjwSI5RTB58mJK62/1CLcXbEJwhRohwKvylzTw+8JoQQos4Q
8oyIliPNiHo8cxYRcaZxSYVtXl7hK9n+70nA0+iNTlbv9V4CXiiSyN8W9cZnrH+v
RC4O+czVHycKREIIkZCol3Jx2tQU4Cx5cuQE67+qS5lDD3xfhASi0UTOs5EzbESk
lKhFjaH1FkeoldlmYHlgOhBoxn8DbhLjzHdaX01WWD9KYrw7imw0EaYYaGTKgXMo
F4QgjaXWOyeT0+uO4O+8E/iTON4+xbqq2rS+n8T8YEwY50UxPhZHmCKqNubeTZaR
wBViYXiS8ak4ss4QR9RJwZyISolxThS1OjeCg9504FGgt9/TpwL3G++MTrZ/XyOM
BSF/fEeijeL5jQqMJWGMM6Ool7KTOKwuAP4OtGzevNns6Gx56dz3nFcpEUKjcBV0
dnYQtut57iUbL7uLxhEWpvH61/25SvM/f0qTC3+CVOtL7DhQ+cyik9791WeXr1av
l0G+jeAa88tJjPOjhUHm/7QfERjw+/XdF6YQYrwlZLUh1Zqcbf+sJpA2fc8WvWsI
dJvCuyvVQ4t6BFgbmA/XApeKIQbGRXFEvVFQzv3b1EBSgkNMLc/MEo3mBPMzCeQM
C9xy/S+W5n3cfYSx2kLoJg+1NpelRz8fSL8xwK9pML5sXpmMW1dVIY+zESFRZi6L
vpvvO4V2FIh5IdjqRPQmJwmsAdqKcHUOcK15ReV463tJ5BRLCCMfu0SYAnlKGFFn
oF7OzqFX15kfCMwq+xj9CT4jwgLjpAjeY+lxdCoHWEVB1y8E7jS/mBhqfrMSUSn7
fbMcLfS7hkDUSMwLYuhdXkJvdS4AHlm79uVzPvWZT14cDkXwPA/XUzQfbuaX//M/
TB4/jo5siNcOTeKeh3fjud1UV0liEVEUui2iBylJO4qXX7P42U1VPLVrJkZFFVPn
nM+BZrV+2PDRtz21bFlZXWr2Y5YfAV/HEpgfLjKrtCgQTIkkEEEMuTieXCyJ+iZa
F90TiLBEnhPB2OYhhgnIHEUt+WZOKnCcY4FzeSGA7lLoVx04LgQ5lZ/w/He0jymR
EMjZFtQbyEVhjHOjkFHH1sWIorEVM10wHiUQI0xkozFcHfAaAua4Xi6JLDW/k0RO
MSGnfcdUiPK+2tE0stKIkMS4tAK11TlHb3AeCAIeAGcBPzOvqBxnXBr3TTZV3PWg
rQwYF8WEPqRwf9aJnGMjKgIzkWLciH6SPlCTSiBGSqwrKrXzvfZv0KXuC6KDxwG3
mpcnGozLKnwhV/ydcmMrsS5EKV3ZYF1bA3HZ4P2l57GRo4ZvrR1Sj5NzybouL6x5
iY0bX2XrxteYNm488xadxOSpk2luPZcnnv4Ht/xjFRGamTImw+hhEI9rHFez/4DD
yjW9rFrTw3vfdxnDRo4h7hykJ6dZuXEzF330Y2f99ZabFgUWwFE1yEeBqwHkrBDm
x+JoAo7MSwSfYLQovt7/Wv8/HfCJLDyHhpDAmB6CqAzC1KUaREsgpVEPZ1DLMxuB
q4ApwB/z057WkNIY742ipUAE/RVFfdEiyKw6IOOGL1FH+RpHB9nZPsdNCO2/l9Lo
ZoVI+/EtbRF8T6Pxn9FC+rTgadSLuZje6h4EFsrTwh+0flgV+EQqmJe+sVMyR7qk
n0E/iseAH7sXY030Jge9PhdC8WwQbv+lcVpkvHlZBXKo4TvAwXsFvAW/XZCzbeSc
EGKajYjKgPl1gJ+B/dDF86JAzLaF92QGmjwHTQz4s5xrj7B+kEQkjNI2+9FCue8X
a63ieTGWhtGbnIqxYlT9yaecanoaUqk01//h92zetIWOtg481+WZlc9x0smnUFsz
hJnT5jB33slMnnUmtY1n0KGPZ8vhKfzxzkM8+FgLFdVzOPWci4mGQ/Q+/iyNk8ex
s/kAmYwDKFkVj9c898wzdxzBFcvHq/87f3GKBUIjhQ6IRpX8XwqNQAX84RO81Aof
HcG9/Dsg+64LjRT+c9IUiGEieBYICE703RcgujR6VbYrCAn2abyS5Kbe4aAeTCHD
/ru+aPQRL1DIPu1eJ33ToloiVNCvPiJHgQl6nyL3xXYy0/eTXXKAzKImcp9oRWx1
ERbBWHy8SqERSiPrTeRQE+AyMdK8zLwojpxoIrwjjD2YE4H27+V/KwQqT7Q+VfrM
LRyNeXYUMcE6Ocjr/BQYZ3wwhhxvgNeHF0rmuOS3CcYSG1ktELoPrxqBQCLy+JVB
qUYf7vsEllAa82MVkJAfD6JqQ6xvVUGlLOp/0CbKbwMG0EbfOPueFUIF/Rb5Ptk/
r+Fwd0vYcV1cpbBsm/e+5zxq6mqorqtiz769DBlSR8gy0CrHo4/+nT/e+AeqKpPY
dhRTWpxzxrmMmD6bT77/Qr6bSnNCVYze7g7idQkO59LMq6+gImzQ2tFNVTK58MEH
H4wejUFOD0KE/mQMM/vFSwL1qYv0pRBorVFrc+Q+3056QTPpsfvJLDqI8+1O9GFV
UK9FNm2JjVoIWlOyAqZP2rgK3e4ZQF/nswOcRE0QvdID2yoyiURMIidYyNo+f0UX
3pECPHAfT+PdX/p5tTKD+0AKImUcQa2hUkCtBLDEaNMSY/tF08QRYoXCz7roAx66
vcgW6W+SCD9LIBeFkOOtEHAJMN1YEkFMsI5cWiGOUXpR0oYu/24xXhww3xVG1hgR
IGS8MyrEBBNhiPJt5v0ODa5APeHPoz/Wcv0rwkdUsH18E5lML56ncKXL8fPnkQhL
PMfhgosu5mtf+wbRsM0Lz6/mvnvvYe6smbyw5nm+9IXLWbNiBe0d7WRzOcb0tBNe
uZLs+hdZ9/LLpKfP4P2W5j1X/5wzD+9n3/59aCFCzz33XOhoPsjCEq6pkgVzUfRF
JIrUIgKtNGxwyb7vEKjCBOsDLu6tPXjPZQndXRcQpC5xC3TemhJFSBIlfgNaIxsM
zMsrYrkr2r5Er/5gkLjrDHwRiAmMD8QwL4iis7rIBPYnW+giUw/ts1nE/3aJuS9B
71ew3invjexxER0aTFGYB63ztCMTRsHHlgIhgx5o8iZT3iY3g/Dmn3pw/9yDbvUg
LLCuqMT8WBwRBe0FZqmm8K4hkHNDeM9moF0hF4eQw6XPZEU+sC7Ir4IvIkS+v3mz
Pxi9KBpPsc+og8kUxT5k2MBYHEZtdzAujCLifd/VBdlULKQM8O7PkPthB/qgLzUc
U2C+P4711Qo/ZF5caFjk53V/2uPBe+7nvPddgNIuKmdw+ee/TGdnN9VDhhCyLXJO
ltmzZzJt+n9hWyaHW1r52te/weSJE0AIGqqrWOVEOHTF5+myw7irnuX9CydyYM1m
cvEYmZo6RNalu6srN2r06NzRGGRi8cVIRPqpzcD88C0gQRhBr1YYQiAcSF/bXcIc
JXDQJflADvGZOB1pxydYKTCFRGhwtG9ixKSkS3lF6UaNISAkBCkTrDOjmCtC0ns2
O8zb6AyjyzfJ5DgLe0kYb4KJ9hRCC6SUSPqCUwGFFcJbBT+gxF0OomXdCn3QKzsU
KyewM5BN+GaVDuz3Pj9BJQREhE/sbR5II6ARWVSBIyAkUc/nyP2wA/VittBARuP8
pAMcjfXpOCIsgnhDkVPvaqzZNt4QA92uGDI9TCZpkkp5eZ9Fa01IClwt/LiALJLK
Rf0t8ZPRSAO853OIiRaiIoiA5TW+KghITyEW2IjVNsZUC2EG2lkU1IcOTCkscH7R
g/OLjtI8uatxb+/GfSRF6Lc1yPkWQooBWkVXw++zf9Zj144TkydP04QQFRUJKioS
ZHMua1fcRnfLStLMZezE+QwfMZJhddUMH1IT9MGgIhxi28EmdjoOl9aGWZA5RPev
r6fq69/jH0aYNRu3MH7kCFoOH1z2Hz/4fu/RGGRY8cXZkTCbDUmn62EIwXGRCCMs
k3/09BAXBouiUfZnHdY8nj6iFpcaatuhPhxiedohJiWnRuMkDElWKV7IpKmQknmR
KPucHOszWQ55LnEpOSkao0JKnkun2O84yKTEOCdM/N1RJodCVErJukyWVs+lQkG1
adHieUwKhejxFJtyWRJCMskOYwnB5lyODtcFoUkaBrPCEXIaXkynyWlNBEG1Nuk1
rX0HyDwXRKNOyNekJG3q6iK8lO4lLnztGhUGlYbkAB7dMQFVBsZ2j3F7JJweYnc2
i9I+c5pCUBuz4NEMTd9vR20pX1nhXNdFYrLNnA9UE8rC+kyGQ66LEDDFCDHh+DhP
1/bQ60kWNMaJRkOscHo54DgoNPWmycJoFIlgZaqXZtdFAUNMg4m2zRDTYnMuy+Zs
lnGWzSHXpda2GO/aPHHFDnqXhghdUYFMSmqEyTDTJ4/N2SwZrdCeoGFWhJYzXQiL
gJ4FSmvG2DbjLYsN2SzNngtC4t3Uc+QiknaP3BfaiCyvpypq0OF5aK0JC0FCGhhS
0PFZJb4478ssXXTaoZOWnJRcsHBhKJao5Mn7f8uHltxOVTyNx3o2bL+DJ+5PsHtv
nERlDZmciWmHmH/qR9jTtJ9hDUNZZ8MpM05l08TpPHLjTXT2pqkIxxndUO+s2LTh
miPRsVlUH1S4GJWcGI1xIOdQbZoMNU1aPZeYlJwci2EDdqtkjdapoHxiBnAZMCKv
vA1B5agQDVISQjDcNKk3DTw0tiE5LRZHK42TUjRGLZLSYIeTY7RlkTRMNJoTIhFe
En6512jLJmkYRKXE1RonpNmZE8wIh6gzTVytMRDscx26lWK8bTPettFARAgecx2G
GSYLolFqgu9XSsFzvSkqpcFxo0OsHZMafuBpJgHt+Wq+GpPGBVGqKwy2ZSQjLYvj
whEUGkMIeizNtkrNpopuuppcUk+lWXhWJWOGmnRkPRJSUhs1OXhvDyu/00pmx1HK
jno09asVw5dK4rUmpoBVqTQRKRhv2DTU2YTrDOw6k1C1QRzBkmiUF9MZtmazVBsG
IQRRUzKnM8QqS9ET1hwfDlNnWmhgdihEBMFQy2R+JIIZFmy5q5tcr4K7UyQuqWDK
0AhjDRtTCCQQk4IX02k8BSdOTnD4dAu7yuJVkeWw6zLOtjk+EsYWkgbLZFM2i2kI
oreO4pWrD9O0she30ytKwEqqp4SZ+fkaKpNRam2T1ak0Svs4N4uiWo/M79QP3P/A
49Fo5a1//fNPbxvfmE1OHZ8lZDhEE8OxIlUsaRCctCiw1nQLwhBo63j+89e/ZP7M
83h10w52trXwYrwWcaAZpRT1yWpOmD7dfXnVyivvueue54/FIJH+DlONIakJ20Ec
AqqlwdJYDCuoTghV523HQ0H+5IagcrcSQNqC4UtixLXkPYkKbCFRfjAwr05zPYod
j6aYdlEFCQxmG5G8SSIQVErJqdFIP49OYQrBODvEODuUNyHswBwZZVmMsmxAo1BI
BJWGwZxIhJGmSY1h5P2PWsPgtHgcDdQMN5j9hRq8rJ658/4u4fZ6xEeHmP2FGiZ9
pBKVhTPjcSwEhijEx6ukpCFusT3qX9l5XyfZDpcpn6yhfqxN+lCOV5Z30NvkMO7c
BNIWun1TVjet6BXZVm+Aq9qzK0fmsEtsiEG9aTDetolJSUIKlFJUNNrYVSZ23M97
hIVkVjhETivqDJOIJeg94PLsRXup+EgFjRdVEDVk3rCyhGB6uFDDZJiC5lW9OL0e
XlpzkhGhNmyjXd9c0oFw2p7LkVMKS8DoxVEMCVXaYJfjMMG2g/n353tqKJwviRxx
x0i01qRaPFRWIUxBpM7wK2tFgd4W5/GsSwJDQ+ZG2PNQ56w7br/lI+csrThw2vye
pG0bSAGmHS2JA/WZgsr1kJF6Tl+0iS9/9yqOW3wRi+csIZVzcHIunqfobm3ZsW7V
iktuu/X2Z46WDTPLVfWqtCoJdwj6QpYifzWSlIz/QFVo253t1wHnAoeDytNThQHD
T62gbpqNl/H9jAF1DBp69jls/N1hZnw0gXJUUWBFDPhdLgQzMA9VmnHrs7eThuQ4
I1x0x/+vIQTJIArjOprkWFss/e0woX41DKXAMAuOrwFUSFFUOiXygR4r5P/1QdPT
vTQ93Uu80WLW52uZ84UawlUSpQJPyECkDnl629869frr20TntoI/UjnBJlpvoD2N
xNeQhaI7TbTBJN5oY0Vl3jmOSskpMT9uISX0NDnkej32XtXKrDlx4gtksAmIHlCC
J0xoWZfGSxcc7f6VIaaA0wNBYhRdjwvJ9FDoCOGx0qBkrM7Ip92Ohbfi35WjbXwj
QOjjZ8d7wmH0niYhsg44uV7siD2ARgQS0v9g244OPn1+L3OnXseOvfDbu+OZSHLp
5/fu3b/969/4xvLzf3q+e6zSFLNoXUARIgoOc4FFSuW4GZJ6ydX1wun2pu/+e9dr
wAPAVCTUnxDl1GuHorK6KHlaihzlarp25Wh9Jc2Oh7oZc0YU5fhPi37MWX7y+z+r
i3opjlxgdJRCsr5vSUNjGOXv9f+3QCMMBtRXTfxgkhO+U0flKBvl+ss/ZV+bniBa
Y4gZn6li2ieS7H8mxebbO6maaDP1Y1VEqn0GEf09VwWRKoNYg4Fhi3x0tniORLAw
SBjgdHm8en07FSNM4sMttFc6biGhe69LutmnE7PCwLBEoeKlaKbMY87n65/rkv4e
9TsQqTP6au/o6JTSdQVjR7jceLfFScd3sGCeQTRegRCyEFgQgkzWYdvWFt57iks4
BBNHg0fVFtvsvvmFNWuc888//3XVbpVdD6KyxRPUn/gKtQzhhBRn3TJc7/pHMrzr
oe4LtUI0Lo0x8fwEQvrhv75kUQHdCoRA5TSt67N4Wc0LPzrEiEWjMcMgtC5L8Lpk
evsSlaJfDL1flKaIOUs1U/G3db534ghjFUUUKkq+FiTVTIksYpA5X6pj3tdrsaMC
7ep++rCoTS0wLcmopXFGLS1ay+CpPPmUjE1DKGkQrTIwDV+Q6X79wxVUTwkRSvrS
ettf2hlzVozx70kEEdXCuA1TcOjFFE6P7x/EGkyf8fIJ33ICQhRpb1GmDlGXuVvU
v37fKa1B0QOSMabpx/211mLCmIoEaGFZMGuiw5p1DstWKuxQKw1DK5gwNkpXt8eh
w1laDnWydH6GiL+2iudfgVBs3LJD7bbiDUAfg5SoGrfHK+JsXaYUs/DbNIUYf3bc
GH92fEAdkygxd0ozUV7a5cBKP7LWsi7Fo5fs5Yw/DMeKyUIwv1CUVKJGRckalP5y
VpftqQCUq1AemCFRgqSB3xMDzATlaN/ssv28YuloCsiddmkV866sIRT1c0WiSNcU
iESUMSv6j6W4PzKfiwhVSEy7wMiixOQUaAXxOoORp1fQtjGL06148epW6qaFqZlq
o9zC84YpaH4+Ta7Lp5mqiSGssPBD5mWYmgH41APmfuDzR8pSqhKxNFCL+O+7Gd+O
vOo//1gbj5IQRQidOAYgQzYHvakUG16BSBgSURg5FeqqguoHCfcvi+mxEyZe/z/X
/t57ixikdFD6daywKr/MRJRRvZA+7LF/WY9/1YVdD3dzx+LtzL68ltFnxEmMtvrN
BcEXMwAAFnVJREFUscZzoG1Ljn3P9HLopQzKUQxdGGXSBQlfFati76Tf1JvQvjlH
0+o0k96fwIrKIEusj7DwS+S/I6Ug0+XRe8ilYpjlS2ddKuu8jGbo/CizPlVNJGmg
HHWEuRID+qfLEF05E0WAn4vQuiSPI/KE5l/xUopZl1Wz59FumtekaduQZtMdncz9
YjXhKiNfqCgMwYGVvTg9AYNMsDGDosPihSK6HyOU9l8P0Aq5HsX6P3USqpTEGkzs
SoNwlcSKScyIxAhLhCGQAd8rwMtqnB6PXJeit9mlZ7/D4XUZtt7VKYAXV69YNnHY
kLQty+yiELL9v5ICh3jBnzpwCPYcHva3lDyw5Y2uYzKLSjgKxNvm5wy0LkhIUaJe
j6Rg9VEXAPTlm5wuj/V/ai+QgYTKsSEal8bp2J7j2W8207ohTaTWJFxrojxIHXTo
3u2Q6yoVANvv6+LQmjTn3jmCbKcq8Zj6JLsOFrS5acWOB7rItbsc96WafmyrB7CH
EOBmNJ17c6y/qQM3o1nwrTqk1IF5ExiNWUW4yqDxlBj1x4VwelVfq4h+GrhU0Oh+
5KXzyrPedMlpQYeSQYWARgiJl9Y4KR1op/6mX6EKOD5UMvlDSbp25Ui3eLz0s8MM
Wxhh9DtiflsmHH45Q8+eQvVAzSQ70CC6dB76maOUNW3939IU7PpHL8//RzNuqowW
EeKIQlb3UXfppa3Ap3bt3HLpqXMIm8dYH9VXTVGZIB+0WL4GRo0c/bu23ir3n2WQ
3uIupVq8PqWeJ4I+JJlCM8n2kbc5ayKFeB2ao8jSdDT7V6R49Tp/WYMREkz5UBWn
/mxIST1Spl2x7vdtPP8fh486gFC1waj5EYZqj04JbZ4o6VMfaxvCJ+SW9Rn2PNbD
y79so3ZaiEidb3ejwc1qnJSH063Idnj0Nntk2t3AuYXx5yUwTL94oMFQ1JmKJmmy
t1cxbH6EUadEUdlA6xRFuQwhMIXG1eBp4RfnHcGV9TSMMD1mhV3SWrA2Y9LhyaBk
BZxeReqgQ9U4EzPsM4/ub6Ro0GnNgk8m2fv3LnY86qP32X9vJvanYQyZE8a0Jeuu
a6Vnf4FBqieHMCMC7fX3EkrNIKkhJDVDDEWTK/1l5qLQD8M+OgUfa3GqnZAkJ4QI
VUiR3pWb0LrbfSqdPuhMGqsj1uvYRSERB9sslL6s31nfMqbRWPHX/7lZ/7MMUnIq
aOawi0AzzPSYGnLZnTPZmjMJCcXCiEOVochpyZacgQVMDLkccg1aPUGjpaiWmrVZ
E7QiLmGs7bE1Z9DjCvYtT/PIJ/ZngPUI5o47Piy/9tsaWjyP7VkTgcYChg/R1H+u
klxKs/YXLeU7H5Uc/6FKLvlKBcN1lt22ZGXaQgaFTLWGYqrtccCTbBMmmTYPlYOF
P6znuIsrmF2vodvj2e2w/7UcW+/qZvdjPUc0n82QwIxKaqVimu0QkdClJW5OUT3B
Yu5sk4hy2e0Z9Kq+EKlmiu0x2vZY71hsbhPsfKCL3U/2UjM1zJT3J0iMtPA8hdaC
4aZiRtglIRVaSULBMo/hhseQEOztcehMeTjpEDUxGGF47HcM2jxJhaGoEBoPGGkp
xoQU6itJ/rAlR/suh86dWR74wF4mnJegc7fDvqd68AKGTtabVFSKfKnOKMtleshj
j2uwJWvgaNFX0kVYKk6IOAwxFE+lQrR4oLRgasil1tJULLJZZovyGqS4hCcuOf7f
66ieZJOogDFDJJ3DwoiIJCI1k22XEbji4zP2jQzpPboiqvVRFFBeICUrC+ZVRxds
2xt/aNUru5x/Zql4H4N0lJhYzS5jbY+ZloMApodcxtguEelnq/0XNdNtlyGmR5WE
oYZvVlQbmqwWtHgCBxhrujRYGiOruPV33Tz+nZYsnt4ETElUS3nJ1xOMtV3qPV8y
73ck00IeE22XnmES9Yk4ex7qpm1rwQqUtqDxxBhnfSXJue8KUaH8sSekJin9Wq1G
UzHW9ogIjSc0O9MG3XtdqifZvOvrVcwQOWqkRyosmZ802DknzJjTY6z6scmrN7aX
n6wKSUMVTHZcag2FqwWNhsewJCQrYJbtIpXGFootWRMJTA65jLI8v4Cx0+PZb7Wx
MW9edvHaLR2c8p/1jDorTq32BVJSKhSCSqloNF0aDEGj5VGLYHl7jpY2QTITZXZE
UY+H1r4TOTPk0mCqgr5WmgVnRHlqSZQ1+7rQribV7LLuurYBY2sYaXBy0iUeFUhP
k5D+sobxlsLVmh2On5yr68jRiEd1RKKA6SGHtBKEpaYqeGfJWMmGzyR54GftuLkj
M8mCb9Ux79NJJkQ8xlsKS2gQWZSfycgHK4Y0mozAFa/HvLIsSMQKzvnDz0J9w6i/
hioavC1bNv3TDNLWn0Fmh1y/YjdYKxAXpba6ITSTQm6enROG7lsliik0J0RyODnN
9lcd/vFwmkdv6aZpm9sbrDk+CYglag0Wnx0jrRS20MwNO8wOg4HGQxBVindMg7nL
hvDMXb20HvAYOs5k5Ikxhk4wqRUeQnl5gV9pKE6P5/KT21cmOMxSnNTey/6WDJFp
JqdYOTzl4SEISc3UkMNU4ZIbAd6YgfsSAcSrJSfMMplPjpDh4gXz0ihcpkoXx9GE
UTjAOMtjnOWV+Bw2YLyWIre+dAedzu05nvzyQS6L1LHk7DCm8oLVEhoFjLG9otia
oGmnS+sOjym5LPXSwlU+E04Ouf3MWf/9Bhwu+WKcplUp9m/xBUksCksXwrJV0B0Y
1/GkJGopaqVXsjDREDAt5DI15GJKePHFDCvXO5z1kRixhKTaUGij1FS0leKKnySo
rVLcclUnOqeZOAZGNMBLG6C5BcbNtLn8sihDKnP5NTN93qNRpMIdF7a8lOPcD6Nt
6xjaA6it8hmjbxXDui1DcsOGhp++5/e36TejQUoM/WyvoqvdI1Epjxqb0kqz9RWH
J+5MsX9LjrZD/tFXKE1Xm+LQHpdcJt+vTJBMbAPqhYRh4yzC/WIisp/NK4G6oQbv
+3yiXz/UAD9H9FtNJYqWTXYc8Ni/Jcf0BSFCaNL9RiMFuClFV6vH3GlwyfnwxAq4
N9goaN7SCO+9MEIEryToLBF0tXhk0752dftnkYvChNPm2kyda7N9TUlMhO69Dtse
6SG10CRZnc+4l45LQmtK0bLfZfOLWbpaPAwsvDIxwuI5cBUcP9dm0lybpm0OWsFn
L4J0liAZGiAnpfO+R/9MRd9vE8HmF7M8eEMPS94bIV7ph+TL+lMKPnJlktM/EOPu
3/bw2J+7Wb/Fp4/GyRbf+8sQhiaKZ1KUjZIuv7+XbI9ixsQC4R9JexgSapPkfbzt
e2H3gcQfXtiwK8M/CX0M0tyfFQ9sd6mcaw9I7RQjwslofnlFG688c8z208Avgnqt
bZTJWegyiDmS219mg4yjxs8EguY9Hq+uyHLc0kj54IGCRFIyfpbNo3+An/8RDrf5
kvXsT1Vw4RUJqmslnip9zwJ2vubQ3aE490NH7o9SEIkKPvPTKkZNs7n72k6athek
fk2DQSQmAqd74FybwKY1GdoOejhpzd6tDnNODg9It5XLYytg2qIwry1P8fGzNfOm
wwNPglsU09m7zSGb0UfMi4ugDy88lmHvRodn7ktz7ifi2KHy9QuBnKR+pMXnfpLk
sh8n2bPZJZvRjJtmYVqisH6kbJGJr73uuKaL6RNAymNnGGqTBaaXBjz0dJjRoxt/
s3rNMvfNMkhT/wnZt91hynFWUdKukJrqI2xpwJhp9rEY5DD+vky34u8RlZcwTVsd
epVCCoHW6g2QfWkQUgzIfheel1LQ2urx0rI0vW0eTrYvPaXoTw5KwynnR0jW1PHa
CzkmzA4xe0mYZK3AU+ApXVIVIAV0e5rWJpedGxx27szROMbEVeWITKOUIJ4QvP/z
cc7/bJx92132bXOpG2EwapKFZYugvqp/Jl9gIlj3TIaDu31cr1ueZeE7IzQ0GkXt
6X7lHH2hWUkiKWioEwyt8+cuk/WZNm/qNXtsXZdj6BgD0yydR4Gfs9iyzWHHOr8a
+Y/fa2fhWWGGjTWRuq+2oVzSMCB2CaOnGP0wqPvVNZQmS5fdk2bL6izf+7dj+x5S
QG11wTnv6oaVayvXdqd3v6nzz/uU1r7+dLlns1OEI1G63LZv0AbMPbXsSkUF7Ayq
fGfgr2EOFZfDA7Q3e9z3ux5socumIMURs6yiQKRF+dhS8yAIOaLZvSnH47f14rlw
cJeDLEJKf4kXjkkWnh3lk99PsuS9ERLVIk9I/grUAgKlgMP7PNoOerzyTIZn70th
lB1H6X9FMHcjJ5osfFeYCTMt7BBFmy/3M/8ktPUo1j+XIdPjP7P64RT7dzgFZ1b7
eOpfH6ADh7e7Q+G5BQIqZ67c+L0Omnd7/e6JwIcS3HRVJ11tvlHX3ar49ZXt9LSr
osVVxdRR2ENMl6Q6RZnsUylbSyDVo/jVFW2cOh+mTzgGgwS+h2UWnPPHVkikXX+H
J+rdt4JBdvdvcNeGXN6ml4VVsP42Q8FD0hDMXBwCfzPOm4HLgfcA44CxwHf6mW8l
1NPbpbn1p51setXBkhQ2WFD+giuhfU2DppQQVGELqTzhqsKzfe9JCS3NHk/ckaK9
2Ufsnk0Orb0KQxb2axNF4+obm+r7FkXLqylaVho837TdYd82Hwd3/bKbx+9JEZKF
KIwo9o10YZm3VoU2S8bcr09C+8T59D0pdhYtCe5uVax9Okt3t0bKgt1dvO8DRWPa
s9EhGVX5jHM8VuqDAOzd5PCLL7bRvNfzQ7rKf9eUgut+2Mkzd/XiFi1nWX5Piluv
7iLdq/yxFI0HVbqSuq9f6FJ8lmxB1kdbAv77M21k2lwuPvd1RK5MGFJTYPpsDh5b
Vbu3q6vrxo0bVr4pBjGK8iDfLPo3rqO54N8SeekpjlBihoY1T2SclibvDvwN3Tb3
Dxv3RfUMgx9oXbo4q7dT8eKTGWafGqam3sgnncqxlC6S3Pmkq+4/0wXWd3OaJ/+a
4obvFLrj5jR1w02mzAzheaW7f5a0UyaZV7R8wbfJpeCpe9I8eotfMtPTrli/Mkti
iMH4WVYpw1KyNVh+aXuR8C9rh0sDOjoUf/phJ1teLF1sdXC3y6wlIYaO8KsN+hS9
LmJmBGRczU0/7mTvNo+uXmjrgC07YHcTeP0qk/Zvc3nhiQzxSkk4InhtdY7/vryV
R2/pwSljSb+6PEsqBTMXh7BscaQ8cQFnlJnwfqXxN/+0i3t/1cWXL4ExjcdmkMah
fmROCN+Uu/9JAy989tdrGk547pV1q/RbwSAauIi+nU2A3i7FeZcnCIXKqc+iAkAP
Nr2YU9vW5rYAjxyhnS8vmsufP3E+VU+VWbvV1ap49t4UtcNNJswMCOuoJZLl/128
/4OT1Tx6Wy8//3wbqogIUl2ang7F3HeEiSdkvq1jBQD6/7ZMWLcqx19+3sXhfV4J
w696OE1Hi2LiHJtYQhYYQ3PUuRRl1LshBdd/t4PHb+8tGQdAT4ciEpdMmBMiGhel
G8P0VRoYgodu6eHpu1O0HtZs2w1r1sOu/QOZow86mj2euTvFXb/q5rHbejmw083P
UznYuDrLqytzTF8YpqJKDIhIDdh+WJefbyHgr7/q5rp/b+f8M+CME4/NHIk4DB3i
aw8hYH8z3P7YlH3jJhz/xV/+8ppe3iQUK9ml+Buz5Qc3aZ7N6Mn2AGzKooF5Lrzw
eNrd8lJuzREY5IqzTuJnl38IWRGHtk7Yvb9MmKtb89z9KV5ZkWXEeIuGUQbKK6x5
0P0nVg/8d59tf7jJ5frvdnLDdzsGEBXAgV0u+7Y6zDwxREVS5te/EJgHur/51o+I
DQvWLs/y66+0s2FVdsD3PRdeW53lmXtTIAWN4y3C0SICLt6hqMhOpx+xSAE3XNXB
Xb/qIneEAwheW52lYbTB2Bm2v0dtUYjYMGHPDpdff6Wd/dtc/pXQvNvlwRt7yKVh
7AyLUKS8B6l1qZlKno40v/1GOzd+rxOAT74fKiuOnRQcMwJMw/+m68KVV0dzrV21
79u2q2dj074dvJUMMhU4uVjC9XQoll4YRUrysfniLaeU0nrzSw6//fd2x3P4C9Bf
P9ROG899V1zir8hc8TI8tMxP/pT17JWv4h+5uYflD6TJZjSJakGyRuaJJh8GFUXb
3Ph9oWmHw61Xd3HN59pY+3T2qAPfu8Xl6XvTaA3DxxlEKwoEnDcjdYFQ+xC8d6vD
Dd/v5LpvtLN/+9GJrrtdsfrvaf5+Sw97t7vEEpKqOolpF/ylvh1AizWIYcKuTQ5X
f66NB67vwUkfHYmr/54h3aMZO8MilgjGIWDl39P856Wt7HjV4f8P8Fx4ZXmWu3/T
ze7NDhpBdb0kFC7CVTC5SvcRtWb5gyl++JEWlt+XLgkATR7ra+pyzBG2YdxIv4q3
jy6+9QuTXQeHfqaj27z/tVdXqbdiTMVa/b3APQNiyyMMFp8TYdxMm/pGg0jMX+p5
cI/H6kcyPPW3Xkd53AR8qpxp9c3PcM2syXD9nfD4CjTwLPAQ8BH8bfuP3kEByXrJ
hNk2w8eaVNcbhOIyL3W62hT7tztsXevQ9E9KSTsiGDXFYvxMi/qRJokaSTjijzPV
q+k87HFgl8uWl3Ls2+Ki34RVG09Kxs+2mTDbYthYi+oGg3jC55DuDsW+bS4vPpHh
tVVZsqk31lA4Jhg1ycKOwJ4tLp0t6k0fW9EvMukWpURe38oHCcPHmQwfZ5KsNQhH
Ba4DXe2KQ/tcdr/mHHGcF50N7zwFouHC3l+RiB+xSlb6eRIhYE8TXHuzwcGucT9y
VfSqF15Ym3urBl08yHpe31FpxZACvgjcSJnDTwyD227+Ly76zW3o516kBX9XwIeC
29XANfinEf3fBnEEx+TNQ5YjHHn0OuEw/o76K/ArcA4V0cqJAT4T/8qpGTkU5kyD
BbNg6nioCKJvnge7muDlDbDileSWisTY706eOvvu6353o/OvQE0fvIB/PNfrAScg
8G8c6YFomOcuPJtFf7yLFLCAgWVOFv4u5T8Bpr1FY2oDHg6Q2hyYkUn8U6XO480f
fd2X49kQuGORQLJq/L0bx+GffGW8yXY68E+H2oG/HCEdtFETjGPMMaT40/iH6iSA
UfiH+UwL+lcXzH1/6MTf8mg3/lkg99G/yqIUIvjHz32Wvt0u30KIhAvmrRYFX0MK
ME2LRGXy0PDhI66ePGXaH373+z+3/ytlVx+cFkj48DHec/HLRi7n6EeD/U0I3qf9
MwL/+2hWTkDAn8Q/qiz6BsagA833MP4xXs/i132VgynAj/HP1bDe4FztxT9j8eYg
lH20pZvj8c9VvDjIB70R2IC/k/2jFO3PVQa+FvxVlbl3E/AtYP8RcD5gE/AivHr/
BB3VBJbAh4PE8OsRDh5wB/C7ABdVgWCpnzJlypRhwxqSzQd2tmjtNgspU4mKSidR
Wdnruu6WsWPG94yfMGn94sVLDi0+8WTFvxDKSaBpgT+xKEB0sshvTQEr8Q+XvOdf
1Kco/jl7JwCT8bPvVUWSXwV5m72BRnoG/7yKNzJRDfgbdp8QSNT6QNLawXcygSba
FxDsE/iH17xR21YGYzgV/6DSvvFUFwmhVNDOGvyDRpfx+g/NHBFEH0cFOGrGP4dx
xxucj7cShgX4m4Z/UGolhRNue/DLmjYH4zzIIAzCIAzCIAzCIAzCIPxfg/8Pq09g
cwwobTQAAAAASUVORK5CYII=

------------JT9IxdzOAbzruBfpUSKiDX
Content-Disposition: inline; filename=jquery.plugin.docscomments.htm
Content-Type: text/html; charset=iso-8859-1; name=jquery.plugin.docscomments.htm
Content-Location: http://pygame.info/docs/tut/jquery.plugin.docscomments.js
Content-Transfer-Encoding: 8bit

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL /docs/tut/jquery.plugin.docscomments.js was not found on this server.</p>
<hr>
<address>Apache/2.2.22 (Debian) Server at pygame.info Port 80</address>
</body></html>

------------JT9IxdzOAbzruBfpUSKiDX--
